---------------------------------------------------------------------------------------------
Weka Home Local installation utility. Release: 2.0.0. Copyright 2022 Weka
---------------------------------------------------------------------------------------------
Loading application images into local Docker repository
---------------------------------------------------------------------------------------------
Loaded image: public.ecr.aws/weka/wekahome-frontend:1e850a4107d0334fc3c261ef1ea430b305bb8b93
Loaded image: gohome:33414c551ec9939d784e308cab53a45f
Loaded image: gohome-debug-pod:d48067c1d33c0f7f1b895211850fdfdd
Loaded image: bitnami/grafana:8.1.0-debian-10-r0
Loaded image: wekaio/nack:0.10.1-discard-per
Loaded image: natsio/nats-box:0.13.8
Loaded image: nats:2.9.16-alpine
Loaded image: natsio/nats-server-config-reloader:0.10.1
Loaded image: natsio/prometheus-nats-exporter:0.10.1
Loaded image: bitnami/postgresql:11.14.0-debian-10-r21
Loaded image: quay.io/prometheus/node-exporter:v1.3.0
Loaded image: k8s.gcr.io/kube-state-metrics/kube-state-metrics:v2.4.1
Loaded image: quay.io/prometheus/alertmanager:v0.23.0
Loaded image: jimmidyson/configmap-reload:v0.5.0
Loaded image: prom/pushgateway:v1.4.2
Loaded image: quay.io/prometheus/prometheus:v2.34.0
Loaded image: victoriametrics/vminsert:v1.64.0-cluster
Loaded image: victoriametrics/vmselect:v1.64.0-cluster
Loaded image: victoriametrics/vmstorage:v1.64.0-cluster
Loaded image: bitnami/postgres-exporter:0.8.0-debian-10-r354
Loaded image: bitnami/postgres-exporter:0.10.0-debian-10-r166
Loaded image: lwh_smoke_tests:e25fab5665b9d5313133f01a4dd52bf1
---------------------------------------------------------------------------------------------
Installing NATS JetStream CRD
---------------------------------------------------------------------------------------------
customresourcedefinition.apiextensions.k8s.io/streams.jetstream.nats.io created
customresourcedefinition.apiextensions.k8s.io/consumers.jetstream.nats.io created
customresourcedefinition.apiextensions.k8s.io/streamtemplates.jetstream.nats.io created
customresourcedefinition.apiextensions.k8s.io/accounts.jetstream.nats.io created
---------------------------------------------------------------------------------------------
Installing homewekaio
---------------------------------------------------------------------------------------------
history.go:56: [debug] getting history for release homewekaio
Release "homewekaio" does not exist. Installing it now.
install.go:178: [debug] Original chart version: ""
install.go:199: [debug] CHART PATH: /root/wekahome_offline/home-weka-io-2.0.0.tgz

coalesce.go:199: warning: cannot overwrite table with non table for extraEnvVars (map[])
coalesce.go:199: warning: cannot overwrite table with non table for extraEnvVars (map[])
coalesce.go:199: warning: cannot overwrite table with non table for extraEnvVars (map[])
W0803 16:32:07.842339   26129 warnings.go:70] policy/v1beta1 PodSecurityPolicy is deprecated in v1.21+, unavailable in v1.25+
W0803 16:32:07.937659   26129 warnings.go:70] autoscaling/v2beta1 HorizontalPodAutoscaler is deprecated in v1.22+, unavailable in v1.25+; use autoscaling/v2 HorizontalPodAutoscaler
W0803 16:32:07.938633   26129 warnings.go:70] autoscaling/v2beta1 HorizontalPodAutoscaler is deprecated in v1.22+, unavailable in v1.25+; use autoscaling/v2 HorizontalPodAutoscaler
W0803 16:32:07.939711   26129 warnings.go:70] autoscaling/v2beta1 HorizontalPodAutoscaler is deprecated in v1.22+, unavailable in v1.25+; use autoscaling/v2 HorizontalPodAutoscaler
W0803 16:32:07.940791   26129 warnings.go:70] autoscaling/v2beta1 HorizontalPodAutoscaler is deprecated in v1.22+, unavailable in v1.25+; use autoscaling/v2 HorizontalPodAutoscaler
W0803 16:32:07.941820   26129 warnings.go:70] autoscaling/v2beta1 HorizontalPodAutoscaler is deprecated in v1.22+, unavailable in v1.25+; use autoscaling/v2 HorizontalPodAutoscaler
W0803 16:32:07.942881   26129 warnings.go:70] autoscaling/v2beta1 HorizontalPodAutoscaler is deprecated in v1.22+, unavailable in v1.25+; use autoscaling/v2 HorizontalPodAutoscaler
W0803 16:32:07.949921   26129 warnings.go:70] batch/v1beta1 CronJob is deprecated in v1.21+, unavailable in v1.25+; use batch/v1 CronJob
W0803 16:32:07.951022   26129 warnings.go:70] batch/v1beta1 CronJob is deprecated in v1.21+, unavailable in v1.25+; use batch/v1 CronJob
W0803 16:32:07.952118   26129 warnings.go:70] batch/v1beta1 CronJob is deprecated in v1.21+, unavailable in v1.25+; use batch/v1 CronJob
W0803 16:32:07.953104   26129 warnings.go:70] batch/v1beta1 CronJob is deprecated in v1.21+, unavailable in v1.25+; use batch/v1 CronJob
client.go:128: [debug] creating 1 resource(s)
client.go:128: [debug] creating 125 resource(s)
W0803 16:32:08.169024   26129 warnings.go:70] policy/v1beta1 PodSecurityPolicy is deprecated in v1.21+, unavailable in v1.25+
W0803 16:32:08.386515   26129 warnings.go:70] autoscaling/v2beta1 HorizontalPodAutoscaler is deprecated in v1.22+, unavailable in v1.25+; use autoscaling/v2 HorizontalPodAutoscaler
W0803 16:32:08.386945   26129 warnings.go:70] autoscaling/v2beta1 HorizontalPodAutoscaler is deprecated in v1.22+, unavailable in v1.25+; use autoscaling/v2 HorizontalPodAutoscaler
W0803 16:32:08.386975   26129 warnings.go:70] autoscaling/v2beta1 HorizontalPodAutoscaler is deprecated in v1.22+, unavailable in v1.25+; use autoscaling/v2 HorizontalPodAutoscaler
W0803 16:32:08.386951   26129 warnings.go:70] autoscaling/v2beta1 HorizontalPodAutoscaler is deprecated in v1.22+, unavailable in v1.25+; use autoscaling/v2 HorizontalPodAutoscaler
W0803 16:32:08.387160   26129 warnings.go:70] autoscaling/v2beta1 HorizontalPodAutoscaler is deprecated in v1.22+, unavailable in v1.25+; use autoscaling/v2 HorizontalPodAutoscaler
W0803 16:32:08.386965   26129 warnings.go:70] autoscaling/v2beta1 HorizontalPodAutoscaler is deprecated in v1.22+, unavailable in v1.25+; use autoscaling/v2 HorizontalPodAutoscaler
W0803 16:32:08.426922   26129 warnings.go:70] batch/v1beta1 CronJob is deprecated in v1.21+, unavailable in v1.25+; use batch/v1 CronJob
W0803 16:32:08.433213   26129 warnings.go:70] batch/v1beta1 CronJob is deprecated in v1.21+, unavailable in v1.25+; use batch/v1 CronJob
W0803 16:32:08.434057   26129 warnings.go:70] batch/v1beta1 CronJob is deprecated in v1.21+, unavailable in v1.25+; use batch/v1 CronJob
W0803 16:32:08.434904   26129 warnings.go:70] batch/v1beta1 CronJob is deprecated in v1.21+, unavailable in v1.25+; use batch/v1 CronJob
client.go:128: [debug] creating 1 resource(s)
client.go:528: [debug] Watching for changes to Job db-preseed with timeout of 5m0s
client.go:556: [debug] Add/Modify event for db-preseed: ADDED
client.go:595: [debug] db-preseed: Jobs active: 0, jobs failed: 0, jobs succeeded: 0
client.go:556: [debug] Add/Modify event for db-preseed: MODIFIED
client.go:595: [debug] db-preseed: Jobs active: 1, jobs failed: 0, jobs succeeded: 0
client.go:556: [debug] Add/Modify event for db-preseed: MODIFIED
client.go:595: [debug] db-preseed: Jobs active: 0, jobs failed: 0, jobs succeeded: 0
client.go:556: [debug] Add/Modify event for db-preseed: MODIFIED
client.go:299: [debug] Starting delete for "db-preseed" Job
NAME: homewekaio
LAST DEPLOYED: Thu Aug  3 16:32:03 2023
NAMESPACE: home-weka-io
STATUS: deployed
REVISION: 1
USER-SUPPLIED VALUES:
alertdispatcher:
  email_link_domain_name: 10.108.170.142
apiforwarding:
  api_forwarding_url: https://api.home.weka.io
  enabled: false
apiservice:
  autoscaling:
    enabled: true
    maxReplicas: 5
    minReplicas: 1
    targetCPUUtilizationPercentage: 70
    targetMemoryUtilizationPercentage: 80
  replica_count: 2
core:
  credentials:
    admin_login_enabled: true
diags_handler:
  autoscaling:
    enabled: true
    maxReplicas: 10
    minReplicas: 1
    targetCPUUtilizationPercentage: 70
    targetMemoryUtilizationPercentage: 80
  replica_count: 1
domain: 10.108.170.142
event_db_0:
  persistence:
    storageClass: local-path
frontend:
  autoscaling:
    enabled: true
    maxReplicas: 5
    minReplicas: 1
  replica_count: 1
garbage_collection:
  events:
    max_age: 30d
  support_files:
    max_age: 365d
global:
  ingress:
    annotations:
      nginx.ingress.kubernetes.io/proxy-body-size: 1000m
      nginx.ingress.kubernetes.io/proxy-buffering: "off"
      nginx.ingress.kubernetes.io/ssl-redirect: "false"
    domain: 10.108.170.142
    nginx:
      tls:
        cert: |
          -----BEGIN CERTIFICATE-----
          <cert-data-comes-here>
          -----END CERTIFICATE-----
        cn: server.example.com
        enabled: false
        key: |
          -----BEGIN PRIVATE KEY-----
          <private-key-data-comes-here>
          -----END PRIVATE KEY-----
  persistence:
    DBstorageClass: local-path
  support_files:
    persistence:
      enabled: true
      storageClass: local-path
    size: 15Gi
grafana:
  persistence:
    storageClass: local-path
main_db:
  persistence:
    storageClass: local-path
nats:
  maxStorage:
    alerts: 1073741000
    events: 2147483000
    forwardingHigh: 3221225000
    forwardingLow: 10737410000
    notifications: 1073741000
    stats: 10737410000
  nats:
    jetstream:
      fileStorage:
        size: 30Gi
        storageDirectory: /data
smtp_user_data:
  sender_email: weka-home-noreply@weka.io
  sender_email_name: Weka Home
  smtp_host: ""
  smtp_insecure_tls: false
  smtp_password: ""
  smtp_port: ""
  smtp_username: ""
statistics:
  autoscaling:
    enabled: true
    maxReplicas: 10
    minReplicas: 1
    targetCPUUtilizationPercentage: 70
    targetMemoryUtilizationPercentage: 80
  replica_count: 2
statsdb:
  vminsert:
    autoscaling:
      enabled: true
      maxReplicas: 5
      minReplicas: 1
      targetCPUUtilizationPercentage: 70
      targetMemoryUtilizationPercentage: 80
    replica_count: 2
  vmselect:
    persistentVolume:
      storageClass: local-path
    replica_count: 2
  vmstorage:
    persistentVolume:
      storageClass: local-path
    replica_count: 3
    retentionPeriod: 7d
support_db:
  persistence:
    storageClass: local-path

coalesce.go:199: warning: cannot overwrite table with non table for extraEnvVars (map[])
COMPUTED VALUES:
alert_generator:
  enabled: true
  priorityClassName: ""
  resources:
    limits:
      cpu: 100m
      memory: 250Mi
    requests:
      cpu: 100m
      memory: 250Mi
alert_processing:
  alert_frequency_max_period: 15m
  batch_max_size: 500
  enabled: true
  nodeSelector: {}
  priorityClassName: ""
  processing_cycle_interval: 2s
  replica_count: 1
  resources:
    limits:
      cpu: 100m
      memory: 200Mi
    requests:
      cpu: 100m
      memory: 200Mi
alertdispatcher:
  email_link_domain_name: 10.108.170.142
  enabled: true
  from_address: ""
  mailing_engine: smtp
  nodeSelector: {}
  priorityClassName: ""
  replica_count: 1
  resources:
    limits:
      cpu: 100m
      memory: 200Mi
    requests:
      cpu: 100m
      memory: 200Mi
apiforwarding:
  api_forwarding_url: https://api.home.weka.io
  enabled: false
  forwarding_analytics_enabled: true
  forwarding_bulk_size: 50
  forwarding_cluster_registration_enabled: true
  forwarding_diagnostics_enabled: true
  forwarding_events_enabled: true
  forwarding_stats_enabled: true
  forwarding_usage_report_enabled: true
  nodeSelector: {}
  priorityClassName: ""
  replica_count: 1
  resources:
    limits:
      cpu: 100m
      memory: 200Mi
    requests:
      cpu: 100m
      memory: 200Mi
apiservice:
  autoscaling:
    enabled: true
    maxReplicas: 5
    minReplicas: 1
    targetCPUUtilizationPercentage: 70
    targetMemoryUtilizationPercentage: 80
  nodeSelector: {}
  priorityClassName: ""
  replica_count: 2
  resources:
    limits:
      cpu: 200m
      memory: 250Mi
    requests:
      cpu: 200m
      memory: 250Mi
core:
  credentials:
    admin_login_enabled: true
    admin_password: ""
    admin_username: admin
    aws_role_arn: ""
    force_update: false
    secret_name: weka-home-admin-credentials
  encryption:
    force_update: false
    secret_key: ""
    secret_name: weka-home-encryption
  image: gohome:33414c551ec9939d784e308cab53a45f
  imagePullPolicy: Never
  livenessProbe:
    enabled: true
    path: /api/v3/status
  settings:
    enable_profiling: false
    filter_http_requests_user_agent_logging: kube-probe/1.23
    log_level: INFO
    port: 8000
    service_annotations: {}
db_migrator:
  priorityClassName: ""
diags_handler:
  autoscaling:
    enabled: true
    maxReplicas: 10
    minReplicas: 1
    targetCPUUtilizationPercentage: 70
    targetMemoryUtilizationPercentage: 80
  enabled: true
  nodeSelector: {}
  priorityClassName: ""
  replica_count: 1
  resources:
    limits:
      cpu: 100m
      memory: 200Mi
    requests:
      cpu: 100m
      memory: 200Mi
domain: 10.108.170.142
email_digest:
  enabled: true
  priorityClassName: ""
  resources:
    limits:
      cpu: 50m
      memory: 200Mi
    requests:
      cpu: 50m
      memory: 200Mi
event_db_0:
  audit:
    clientMinMessages: error
    logConnections: false
    logDisconnections: false
    logHostname: false
    logLinePrefix: ""
    logTimezone: ""
    pgAuditLog: ""
    pgAuditLogCatalog: "off"
  common:
    exampleValue: common-chart
    global:
      annotations:
        prometheus.io/path: /metrics
        prometheus.io/scrape: "true"
      app_name: home-weka-io
      cluster_domain_suffix: cluster.local
      database:
        events:
          databases: []
          db_template:
            database: weka_events
            force_update: false
            hostname: ""
            password: ""
            port: 5432
            secret_name_template: weka-home-event-db-credentials-
            username: weka_home
          num_event_stores: 1
        main:
          database: weka_home
          force_update: false
          hostname: ""
          password: ""
          port: 5432
          secret_name: weka-home-main-db-credentials
          username: weka_home
        readonly:
          use_main: true
        remote_access:
          database: tmate
          force_update: false
          hostname: ""
          password: ""
          port: 5432
          secret_name: weka-home-remote-access-db-credentials
          username: tmate
        support:
          database: weka_support
          force_update: false
          hostname: ""
          password: ""
          port: 5432
          secret_name: weka-home-support-db-credentials
          username: weka_home
      debug_pod:
        enable: true
        image: gohome-debug-pod:d48067c1d33c0f7f1b895211850fdfdd
        imagePullPolicy: Never
        priorityClassName: ""
      imagePullSecrets: []
      imageRegistry: ""
      ingress:
        additional_fqdns:
          api: []
          frontend: []
          frontendV2: []
          stats: []
        annotations:
          kubernetes.io/ingress.class: nginx
          nginx.ingress.kubernetes.io/backend-protocol: http
          nginx.ingress.kubernetes.io/enable-access-log: "true"
          nginx.ingress.kubernetes.io/enable-cors: "true"
          nginx.ingress.kubernetes.io/enable-modsecurity: "true"
          nginx.ingress.kubernetes.io/enable-owasp-core-rules: "true"
          nginx.ingress.kubernetes.io/proxy-body-size: 1000m
          nginx.ingress.kubernetes.io/proxy-buffering: "off"
          nginx.ingress.kubernetes.io/ssl-redirect: "false"
          nginx.ingress.kubernetes.io/use-regex: "true"
        domain: 10.108.170.142
        enabled: true
        name: weka-home-ingress
        nginx:
          tls:
            cert: |
              -----BEGIN CERTIFICATE-----
              <cert-data-comes-here>
              -----END CERTIFICATE-----
            cn: server.example.com
            enabled: false
            force_update: false
            key: |
              -----BEGIN PRIVATE KEY-----
              <private-key-data-comes-here>
              -----END PRIVATE KEY-----
            secret_name: weka-home-ingress-cert-secret
        ssl_redirect: false
        subdomain_prefixes:
          api: ""
          frontend: ""
          nextFrontend: next.home.
          remote_access: terminal.home.
          remote_access_ssh: terminal-ssh.home.
          remote_access_wss: terminal-wss.home.
          stats: ""
        use_subdomains: false
      is_offline: true
      k8s_object_prefix: ""
      keep_secrets_on_uninstall: true
      liveness_probe:
        enable: true
      metrics:
        enable_push_metrics: false
        enabled: true
        port: 9187
        push_gateway_host: prometheus-pushgateway.monitoring-system.svc.cluster.local
        push_gateway_port: 9091
        push_interval_seconds: 15
      persistence:
        DBstorageClass: local-path
      postgres_sslmode: false
      postgresql:
        existingSecret: ""
        postgresqlDatabase: postgres
        postgresqlPassword: ""
        postgresqlUsername: ""
        replicationPassword: ""
        servicePort: ""
      service_type: NodePort
      serviceMonitor:
        enabled: false
        namespace: monitoring
      statistics:
        database:
          force_update: true
          secret_name: weka-home-stats-db-credentials
      storageClass: ""
      support_files:
        bucket_name: ""
        hostPath: /opt/local-path-provisioner
        path: /support-file-uploads
        persistence:
          enabled: true
          storageClass: local-path
        size: 15Gi
        storage_provider: filesystem
      use_embedded_db: true
  commonAnnotations: {}
  commonLabels:
    app.group: common
  configurationConfigMap: ""
  containerPorts:
    postgresql: 5432
  containerSecurityContext:
    enabled: true
    runAsUser: 1001
  customLivenessProbe: {}
  customReadinessProbe: {}
  customStartupProbe: {}
  diagnosticMode:
    args:
    - infinity
    command:
    - sleep
    enabled: false
  event_store_db_pool_size: 8
  existingSecret: weka-home-event-db-credentials-0
  extendedConfConfigMap: ""
  extraDeploy: []
  extraEnv: []
  extraEnvVarsCM: ""
  fullnameOverride: ""
  global:
    annotations:
      prometheus.io/path: /metrics
      prometheus.io/scrape: "true"
    app_name: home-weka-io
    cluster_domain_suffix: cluster.local
    database:
      events:
        databases: []
        db_template:
          database: weka_events
          force_update: false
          hostname: ""
          password: ""
          port: 5432
          secret_name_template: weka-home-event-db-credentials-
          username: weka_home
        num_event_stores: 1
      main:
        database: weka_home
        force_update: false
        hostname: ""
        password: ""
        port: 5432
        secret_name: weka-home-main-db-credentials
        username: weka_home
      readonly:
        use_main: true
      remote_access:
        database: tmate
        force_update: false
        hostname: ""
        password: ""
        port: 5432
        secret_name: weka-home-remote-access-db-credentials
        username: tmate
      support:
        database: weka_support
        force_update: false
        hostname: ""
        password: ""
        port: 5432
        secret_name: weka-home-support-db-credentials
        username: weka_home
    debug_pod:
      enable: true
      image: gohome-debug-pod:d48067c1d33c0f7f1b895211850fdfdd
      imagePullPolicy: Never
      priorityClassName: ""
    imagePullSecrets: []
    imageRegistry: ""
    ingress:
      additional_fqdns:
        api: []
        frontend: []
        frontendV2: []
        stats: []
      annotations:
        kubernetes.io/ingress.class: nginx
        nginx.ingress.kubernetes.io/backend-protocol: http
        nginx.ingress.kubernetes.io/enable-access-log: "true"
        nginx.ingress.kubernetes.io/enable-cors: "true"
        nginx.ingress.kubernetes.io/enable-modsecurity: "true"
        nginx.ingress.kubernetes.io/enable-owasp-core-rules: "true"
        nginx.ingress.kubernetes.io/proxy-body-size: 1000m
        nginx.ingress.kubernetes.io/proxy-buffering: "off"
        nginx.ingress.kubernetes.io/ssl-redirect: "false"
        nginx.ingress.kubernetes.io/use-regex: "true"
      domain: 10.108.170.142
      enabled: true
      name: weka-home-ingress
      nginx:
        tls:
          cert: |
            -----BEGIN CERTIFICATE-----
            <cert-data-comes-here>
            -----END CERTIFICATE-----
          cn: server.example.com
          enabled: false
          force_update: false
          key: |
            -----BEGIN PRIVATE KEY-----
            <private-key-data-comes-here>
            -----END PRIVATE KEY-----
          secret_name: weka-home-ingress-cert-secret
      ssl_redirect: false
      subdomain_prefixes:
        api: ""
        frontend: ""
        nextFrontend: next.home.
        remote_access: terminal.home.
        remote_access_ssh: terminal-ssh.home.
        remote_access_wss: terminal-wss.home.
        stats: ""
      use_subdomains: false
    is_offline: true
    k8s_object_prefix: ""
    keep_secrets_on_uninstall: true
    liveness_probe:
      enable: true
    metrics:
      enable_push_metrics: false
      enabled: true
      port: 9187
      push_gateway_host: prometheus-pushgateway.monitoring-system.svc.cluster.local
      push_gateway_port: 9091
      push_interval_seconds: 15
    persistence:
      DBstorageClass: local-path
    postgres_sslmode: false
    postgresql:
      existingSecret: ""
      postgresqlDatabase: postgres
      postgresqlPassword: ""
      postgresqlUsername: ""
      replicationPassword: ""
      servicePort: ""
    service_type: NodePort
    serviceMonitor:
      enabled: false
      namespace: monitoring
    statistics:
      database:
        force_update: true
        secret_name: weka-home-stats-db-credentials
    storageClass: ""
    support_files:
      bucket_name: ""
      hostPath: /opt/local-path-provisioner
      path: /support-file-uploads
      persistence:
        enabled: true
        storageClass: local-path
      size: 15Gi
      storage_provider: filesystem
    use_embedded_db: true
  image:
    debug: false
    pullPolicy: Never
    pullSecrets: []
    registry: docker.io
    repository: bitnami/postgresql
    tag: 11.14.0-debian-10-r21
  initdbPassword: ""
  initdbScripts: {}
  initdbScriptsConfigMap: event-db-init-configmap-0
  initdbScriptsSecret: ""
  initdbUser: postgres
  ldap:
    baseDN: ""
    bind_password: ""
    bindDN: ""
    enabled: false
    port: ""
    prefix: ""
    scheme: ""
    search_attr: ""
    search_filter: ""
    server: ""
    suffix: ""
    tls: ""
    url: ""
  lifecycleHooks: {}
  livenessProbe:
    enabled: true
    failureThreshold: 6
    initialDelaySeconds: 30
    periodSeconds: 10
    successThreshold: 1
    timeoutSeconds: 5
  metrics:
    customMetrics: {}
    enabled: true
    extraEnvVars: []
    image:
      pullPolicy: IfNotPresent
      pullSecrets: []
      registry: docker.io
      repository: bitnami/postgres-exporter
      tag: 0.10.0-debian-10-r166
    livenessProbe:
      enabled: true
      failureThreshold: 6
      initialDelaySeconds: 5
      periodSeconds: 10
      successThreshold: 1
      timeoutSeconds: 5
    prometheusRule:
      additionalLabels: {}
      enabled: false
      namespace: ""
      rules: []
    readinessProbe:
      enabled: true
      failureThreshold: 6
      initialDelaySeconds: 5
      periodSeconds: 10
      successThreshold: 1
      timeoutSeconds: 5
    resources: {}
    securityContext:
      enabled: false
      runAsUser: 1001
    service:
      annotations:
        prometheus.io/port: "9187"
        prometheus.io/scrape: "true"
      loadBalancerIP: ""
      type: ClusterIP
    serviceMonitor:
      additionalLabels: {}
      enabled: false
      interval: ""
      metricRelabelings: []
      namespace: monitoring
      relabelings: []
      scrapeTimeout: ""
  nameOverride: event-db-0
  networkPolicy:
    allowExternal: true
    enabled: false
    explicitNamespacesSelector: {}
  persistence:
    accessModes:
    - ReadWriteOnce
    annotations: {}
    enabled: true
    existingClaim: ""
    mountPath: /bitnami/postgresql
    selector: {}
    size: 100Gi
    storageClass: local-path
    subPath: ""
  pgHbaConfiguration: ""
  postgresqlConfiguration: {}
  postgresqlDataDir: /bitnami/postgresql/data
  postgresqlDatabase: ""
  postgresqlDbUserConnectionLimit: ""
  postgresqlExtendedConf: {}
  postgresqlInitdbArgs: ""
  postgresqlInitdbWalDir: ""
  postgresqlMaxConnections: ""
  postgresqlPassword: ""
  postgresqlPghbaRemoveFilters: ""
  postgresqlPostgresConnectionLimit: ""
  postgresqlPostgresPassword: ""
  postgresqlSharedPreloadLibraries: pgaudit
  postgresqlStatementTimeout: ""
  postgresqlTcpKeepalivesCount: ""
  postgresqlTcpKeepalivesIdle: ""
  postgresqlTcpKeepalivesInterval: ""
  postgresqlUsername: postgres
  primary:
    affinity: {}
    annotations: {}
    extraInitContainers: []
    extraPodSpec: {}
    extraVolumeMounts: []
    extraVolumes: []
    labels: {}
    nodeAffinityPreset:
      key: ""
      type: ""
      values: []
    nodeSelector: {}
    podAffinityPreset: ""
    podAnnotations: {}
    podAntiAffinityPreset: soft
    podLabels: {}
    priorityClassName: ""
    service:
      clusterIP: ""
      nodePort: ""
      type: ""
    sidecars: []
    tolerations: []
  primaryAsStandBy:
    enabled: false
    primaryHost: ""
    primaryPort: ""
  psp:
    create: false
  rbac:
    create: false
  readReplicas:
    affinity: {}
    annotations: {}
    extraInitContainers: []
    extraPodSpec: {}
    extraVolumeMounts: []
    extraVolumes: []
    labels: {}
    nodeAffinityPreset:
      key: ""
      type: ""
      values: []
    nodeSelector: {}
    persistence:
      enabled: true
    podAffinityPreset: ""
    podAnnotations: {}
    podAntiAffinityPreset: soft
    podLabels: {}
    priorityClassName: ""
    resources: {}
    service:
      clusterIP: ""
      nodePort: ""
      type: ""
    sidecars: []
    tolerations: []
    topologySpreadConstraints: []
  readinessProbe:
    enabled: true
    failureThreshold: 6
    initialDelaySeconds: 5
    periodSeconds: 10
    successThreshold: 1
    timeoutSeconds: 5
  replication:
    applicationName: my_application
    enabled: false
    numSynchronousReplicas: 0
    password: repl_password
    readReplicas: 1
    singleService: true
    synchronousCommit: "off"
    uniqueServices: false
    user: repl_user
  resources:
    limits:
      cpu: 200m
      memory: 200Mi
    requests:
      cpu: 200m
      memory: 200Mi
  schedulerName: ""
  securityContext:
    enabled: true
    fsGroup: 1001
  service:
    annotations: {}
    clusterIP: ""
    externalTrafficPolicy: Cluster
    loadBalancerIP: ""
    loadBalancerSourceRanges: []
    nodePort: ""
    port: 5432
    type: ClusterIP
  serviceAccount:
    autoMount: false
    enabled: false
    name: ""
  shmVolume:
    chmod:
      enabled: true
    enabled: true
    sizeLimit: ""
  startupProbe:
    enabled: true
    failureThreshold: 10
    initialDelaySeconds: 30
    periodSeconds: 15
    successThreshold: 1
    timeoutSeconds: 5
  terminationGracePeriodSeconds: ""
  tls:
    autoGenerated: false
    certCAFilename: ""
    certFilename: ""
    certKeyFilename: ""
    certificatesSecret: ""
    crlFilename: ""
    enabled: false
    preferServerCiphers: true
  updateStrategy:
    type: RollingUpdate
  usePasswordFile: false
  volumePermissions:
    enabled: false
    image:
      pullPolicy: IfNotPresent
      pullSecrets: []
      registry: docker.io
      repository: bitnami/bitnami-shell
      tag: 10-debian-10-r299
    securityContext:
      runAsUser: 0
event_processing:
  batch_max_size: 1000
  enabled: true
  event_frequency_max_period: 15m
  nodeSelector: {}
  priorityClassName: ""
  processing_cycle_interval: 2s
  replica_count: 1
  resources:
    limits:
      cpu: 100m
      memory: 200Mi
    requests:
      cpu: 100m
      memory: 200Mi
frontend:
  autoscaling:
    enabled: true
    maxReplicas: 5
    minReplicas: 1
    targetCPUUtilizationPercentage: 70
    targetMemoryUtilizationPercentage: 80
  enabled: true
  image: public.ecr.aws/weka/wekahome-frontend:1e850a4107d0334fc3c261ef1ea430b305bb8b93
  imagePullPolicy: Never
  name: frontend
  nodeSelector: {}
  port: 80
  priorityClassName: ""
  replica_count: 1
  resources:
    limits:
      cpu: 50m
      memory: 100Mi
    requests:
      cpu: 50m
      memory: 100Mi
frontendV2:
  autoscaling:
    enabled: true
    maxReplicas: 3
    minReplicas: 1
    targetCPUUtilizationPercentage: 70
    targetMemoryUtilizationPercentage: 80
  enabled: false
  image:
    repository: public.ecr.aws/v7b3j9c8/wekahome-frontend
    tag: null
  imagePullPolicy: IfNotPresent
  nodeSelector: {}
  priorityClassName: ""
  replica_count: 1
  resources:
    limits:
      cpu: 50m
      memory: 100Mi
    requests:
      cpu: 50m
      memory: 100Mi
garbage_collection:
  clusters:
    delete_batch_size: 1000
    max_age: 90d
  events:
    delete_batch_size: 500000
    max_age: 30d
  nodeSelector: {}
  priorityClassName: ""
  remote_access:
    delete_closed_sessions_after: 365d
    legacy_session_max_age: 14d
    lost_heartbeat_expiry_age: 1h
  resources:
    limits:
      cpu: 50m
      memory: 100Mi
    requests:
      cpu: 50m
      memory: 100Mi
  schedule: '*/5 * * * *'
  support_files:
    delete_batch_size: 5000
    max_age: 365d
global:
  annotations:
    prometheus.io/path: /metrics
    prometheus.io/scrape: "true"
  app_name: home-weka-io
  cluster_domain_suffix: cluster.local
  database:
    events:
      databases: []
      db_template:
        database: weka_events
        force_update: false
        hostname: ""
        password: ""
        port: 5432
        secret_name_template: weka-home-event-db-credentials-
        username: weka_home
      num_event_stores: 1
    main:
      database: weka_home
      force_update: false
      hostname: ""
      password: ""
      port: 5432
      secret_name: weka-home-main-db-credentials
      username: weka_home
    readonly:
      use_main: true
    remote_access:
      database: tmate
      force_update: false
      hostname: ""
      password: ""
      port: 5432
      secret_name: weka-home-remote-access-db-credentials
      username: tmate
    support:
      database: weka_support
      force_update: false
      hostname: ""
      password: ""
      port: 5432
      secret_name: weka-home-support-db-credentials
      username: weka_home
  debug_pod:
    enable: true
    image: gohome-debug-pod:d48067c1d33c0f7f1b895211850fdfdd
    imagePullPolicy: Never
    priorityClassName: ""
  ingress:
    additional_fqdns:
      api: []
      frontend: []
      frontendV2: []
      stats: []
    annotations:
      kubernetes.io/ingress.class: nginx
      nginx.ingress.kubernetes.io/backend-protocol: http
      nginx.ingress.kubernetes.io/enable-access-log: "true"
      nginx.ingress.kubernetes.io/enable-cors: "true"
      nginx.ingress.kubernetes.io/enable-modsecurity: "true"
      nginx.ingress.kubernetes.io/enable-owasp-core-rules: "true"
      nginx.ingress.kubernetes.io/proxy-body-size: 1000m
      nginx.ingress.kubernetes.io/proxy-buffering: "off"
      nginx.ingress.kubernetes.io/ssl-redirect: "false"
      nginx.ingress.kubernetes.io/use-regex: "true"
    domain: 10.108.170.142
    enabled: true
    name: weka-home-ingress
    nginx:
      tls:
        cert: |
          -----BEGIN CERTIFICATE-----
          <cert-data-comes-here>
          -----END CERTIFICATE-----
        cn: server.example.com
        enabled: false
        force_update: false
        key: |
          -----BEGIN PRIVATE KEY-----
          <private-key-data-comes-here>
          -----END PRIVATE KEY-----
        secret_name: weka-home-ingress-cert-secret
    ssl_redirect: false
    subdomain_prefixes:
      api: ""
      frontend: ""
      nextFrontend: next.home.
      remote_access: terminal.home.
      remote_access_ssh: terminal-ssh.home.
      remote_access_wss: terminal-wss.home.
      stats: ""
    use_subdomains: false
  is_offline: true
  k8s_object_prefix: ""
  keep_secrets_on_uninstall: true
  liveness_probe:
    enable: true
  metrics:
    enable_push_metrics: false
    enabled: true
    port: 9187
    push_gateway_host: prometheus-pushgateway.monitoring-system.svc.cluster.local
    push_gateway_port: 9091
    push_interval_seconds: 15
  persistence:
    DBstorageClass: local-path
  postgres_sslmode: false
  postgresql:
    postgresqlDatabase: postgres
  service_type: NodePort
  serviceMonitor:
    enabled: false
    namespace: monitoring
  statistics:
    database:
      force_update: true
      secret_name: weka-home-stats-db-credentials
  support_files:
    bucket_name: ""
    hostPath: /opt/local-path-provisioner
    path: /support-file-uploads
    persistence:
      enabled: true
      storageClass: local-path
    size: 15Gi
    storage_provider: filesystem
  use_embedded_db: true
grafana:
  admin:
    api_url: ""
    existingSecret: weka-home-grafana-credentials
    existingSecretPasswordKey: password
    password: ""
    user: admin
  clusterDomain: cluster.local
  common:
    exampleValue: common-chart
    global:
      annotations:
        prometheus.io/path: /metrics
        prometheus.io/scrape: "true"
      app_name: home-weka-io
      cluster_domain_suffix: cluster.local
      database:
        events:
          databases: []
          db_template:
            database: weka_events
            force_update: false
            hostname: ""
            password: ""
            port: 5432
            secret_name_template: weka-home-event-db-credentials-
            username: weka_home
          num_event_stores: 1
        main:
          database: weka_home
          force_update: false
          hostname: ""
          password: ""
          port: 5432
          secret_name: weka-home-main-db-credentials
          username: weka_home
        readonly:
          use_main: true
        remote_access:
          database: tmate
          force_update: false
          hostname: ""
          password: ""
          port: 5432
          secret_name: weka-home-remote-access-db-credentials
          username: tmate
        support:
          database: weka_support
          force_update: false
          hostname: ""
          password: ""
          port: 5432
          secret_name: weka-home-support-db-credentials
          username: weka_home
      debug_pod:
        enable: true
        image: gohome-debug-pod:d48067c1d33c0f7f1b895211850fdfdd
        imagePullPolicy: Never
        priorityClassName: ""
      imagePullSecrets: []
      imageRegistry: ""
      ingress:
        additional_fqdns:
          api: []
          frontend: []
          frontendV2: []
          stats: []
        annotations:
          kubernetes.io/ingress.class: nginx
          nginx.ingress.kubernetes.io/backend-protocol: http
          nginx.ingress.kubernetes.io/enable-access-log: "true"
          nginx.ingress.kubernetes.io/enable-cors: "true"
          nginx.ingress.kubernetes.io/enable-modsecurity: "true"
          nginx.ingress.kubernetes.io/enable-owasp-core-rules: "true"
          nginx.ingress.kubernetes.io/proxy-body-size: 1000m
          nginx.ingress.kubernetes.io/proxy-buffering: "off"
          nginx.ingress.kubernetes.io/ssl-redirect: "false"
          nginx.ingress.kubernetes.io/use-regex: "true"
        domain: 10.108.170.142
        enabled: true
        name: weka-home-ingress
        nginx:
          tls:
            cert: |
              -----BEGIN CERTIFICATE-----
              <cert-data-comes-here>
              -----END CERTIFICATE-----
            cn: server.example.com
            enabled: false
            force_update: false
            key: |
              -----BEGIN PRIVATE KEY-----
              <private-key-data-comes-here>
              -----END PRIVATE KEY-----
            secret_name: weka-home-ingress-cert-secret
        ssl_redirect: false
        subdomain_prefixes:
          api: ""
          frontend: ""
          nextFrontend: next.home.
          remote_access: terminal.home.
          remote_access_ssh: terminal-ssh.home.
          remote_access_wss: terminal-wss.home.
          stats: ""
        use_subdomains: false
      is_offline: true
      k8s_object_prefix: ""
      keep_secrets_on_uninstall: true
      liveness_probe:
        enable: true
      metrics:
        enable_push_metrics: false
        enabled: true
        port: 9187
        push_gateway_host: prometheus-pushgateway.monitoring-system.svc.cluster.local
        push_gateway_port: 9091
        push_interval_seconds: 15
      persistence:
        DBstorageClass: local-path
      postgres_sslmode: false
      postgresql:
        postgresqlDatabase: postgres
      service_type: NodePort
      serviceMonitor:
        enabled: false
        namespace: monitoring
      statistics:
        database:
          force_update: true
          secret_name: weka-home-stats-db-credentials
      storageClass: ""
      support_files:
        bucket_name: ""
        hostPath: /opt/local-path-provisioner
        path: /support-file-uploads
        persistence:
          enabled: true
          storageClass: local-path
        size: 15Gi
        storage_provider: filesystem
      use_embedded_db: true
  commonAnnotations: {}
  commonLabels:
    app.group: common
  config:
    grafanaIniConfigMap: grafana-custom-config
    grafanaIniSecret: ""
    useGrafanaIniFile: true
  dashboardsConfigMaps:
  - configMapName: grafana-dashboards
  dashboardsProvider:
    configMapName: grafana-dashboard-provider
    enabled: true
  datasources:
    secretName: weka-home-grafana-datasources
  diagnosticMode:
    args:
    - infinity
    command:
    - sleep
    enabled: false
  enabled: true
  extraDeploy: []
  force_update: false
  fullnameOverride: ""
  global:
    annotations:
      prometheus.io/path: /metrics
      prometheus.io/scrape: "true"
    app_name: home-weka-io
    cluster_domain_suffix: cluster.local
    database:
      events:
        databases: []
        db_template:
          database: weka_events
          force_update: false
          hostname: ""
          password: ""
          port: 5432
          secret_name_template: weka-home-event-db-credentials-
          username: weka_home
        num_event_stores: 1
      main:
        database: weka_home
        force_update: false
        hostname: ""
        password: ""
        port: 5432
        secret_name: weka-home-main-db-credentials
        username: weka_home
      readonly:
        use_main: true
      remote_access:
        database: tmate
        force_update: false
        hostname: ""
        password: ""
        port: 5432
        secret_name: weka-home-remote-access-db-credentials
        username: tmate
      support:
        database: weka_support
        force_update: false
        hostname: ""
        password: ""
        port: 5432
        secret_name: weka-home-support-db-credentials
        username: weka_home
    debug_pod:
      enable: true
      image: gohome-debug-pod:d48067c1d33c0f7f1b895211850fdfdd
      imagePullPolicy: Never
      priorityClassName: ""
    imagePullSecrets: []
    imageRegistry: ""
    ingress:
      additional_fqdns:
        api: []
        frontend: []
        frontendV2: []
        stats: []
      annotations:
        kubernetes.io/ingress.class: nginx
        nginx.ingress.kubernetes.io/backend-protocol: http
        nginx.ingress.kubernetes.io/enable-access-log: "true"
        nginx.ingress.kubernetes.io/enable-cors: "true"
        nginx.ingress.kubernetes.io/enable-modsecurity: "true"
        nginx.ingress.kubernetes.io/enable-owasp-core-rules: "true"
        nginx.ingress.kubernetes.io/proxy-body-size: 1000m
        nginx.ingress.kubernetes.io/proxy-buffering: "off"
        nginx.ingress.kubernetes.io/ssl-redirect: "false"
        nginx.ingress.kubernetes.io/use-regex: "true"
      domain: 10.108.170.142
      enabled: true
      name: weka-home-ingress
      nginx:
        tls:
          cert: |
            -----BEGIN CERTIFICATE-----
            <cert-data-comes-here>
            -----END CERTIFICATE-----
          cn: server.example.com
          enabled: false
          force_update: false
          key: |
            -----BEGIN PRIVATE KEY-----
            <private-key-data-comes-here>
            -----END PRIVATE KEY-----
          secret_name: weka-home-ingress-cert-secret
      ssl_redirect: false
      subdomain_prefixes:
        api: ""
        frontend: ""
        nextFrontend: next.home.
        remote_access: terminal.home.
        remote_access_ssh: terminal-ssh.home.
        remote_access_wss: terminal-wss.home.
        stats: ""
      use_subdomains: false
    is_offline: true
    k8s_object_prefix: ""
    keep_secrets_on_uninstall: true
    liveness_probe:
      enable: true
    metrics:
      enable_push_metrics: false
      enabled: true
      port: 9187
      push_gateway_host: prometheus-pushgateway.monitoring-system.svc.cluster.local
      push_gateway_port: 9091
      push_interval_seconds: 15
    persistence:
      DBstorageClass: local-path
    postgres_sslmode: false
    postgresql:
      postgresqlDatabase: postgres
    service_type: NodePort
    serviceMonitor:
      enabled: false
      namespace: monitoring
    statistics:
      database:
        force_update: true
        secret_name: weka-home-stats-db-credentials
    storageClass: ""
    support_files:
      bucket_name: ""
      hostPath: /opt/local-path-provisioner
      path: /support-file-uploads
      persistence:
        enabled: true
        storageClass: local-path
      size: 15Gi
      storage_provider: filesystem
    use_embedded_db: true
  google_auth:
    allowed_domains: ""
    client_id: ""
    client_secret: ""
    enabled: false
    force_root_url: ""
  grafana:
    affinity: {}
    args: []
    command: []
    containerPorts:
      grafana: 3000
    containerSecurityContext:
      enabled: true
      runAsUser: 1001
    customLivenessProbe: {}
    customReadinessProbe: {}
    customStartupProbe: {}
    extraConfigmaps: {}
    extraEnvVars:
    - name: MAIN_DB_HOSTNAME
      valueFrom:
        secretKeyRef:
          key: hostname
          name: weka-home-main-db-credentials
    - name: MAIN_DB_PORT
      valueFrom:
        secretKeyRef:
          key: port
          name: weka-home-main-db-credentials
    - name: MAIN_DB_USERNAME
      valueFrom:
        secretKeyRef:
          key: username
          name: weka-home-main-db-credentials
    - name: MAIN_DB_DATABASE
      valueFrom:
        secretKeyRef:
          key: database
          name: weka-home-main-db-credentials
    - name: MAIN_DB_PASSWORD
      valueFrom:
        secretKeyRef:
          key: password
          name: weka-home-main-db-credentials
    - name: STATS_STORE_QUERY_URL
      valueFrom:
        secretKeyRef:
          key: stats_store_query_url
          name: weka-home-stats-db-credentials
    - name: GF_DASHBOARDS_DEFAULT_HOME_DASHBOARD_PATH
      value: /opt/bitnami/grafana/dashboards/cluster-summary-dashboard.json
    - name: PROMETHEUS_QUERY_URL
      valueFrom:
        secretKeyRef:
          key: prometheus_query_url
          name: weka-home-stats-db-credentials
    - name: WEBHOOK_TOKEN
      valueFrom:
        secretKeyRef:
          key: webhook_token
          name: grafana-webhook
    - name: WEBHOOK_URL
      valueFrom:
        secretKeyRef:
          key: webhook_url
          name: grafana-webhook
    extraEnvVarsCM: ""
    extraEnvVarsSecret: ""
    extraVolumeMounts: []
    extraVolumes: []
    initContainers: {}
    lifecycleHooks: {}
    livenessProbe:
      enabled: true
      failureThreshold: 6
      initialDelaySeconds: 120
      path: /api/health
      periodSeconds: 10
      scheme: HTTP
      successThreshold: 1
      timeoutSeconds: 5
    nodeAffinityPreset:
      key: ""
      type: ""
      values: []
    nodeSelector: {}
    podAffinityPreset: ""
    podAnnotations: {}
    podAntiAffinityPreset: soft
    podLabels:
      app.group: common
    podSecurityContext:
      enabled: true
      fsGroup: 1001
      runAsNonRoot: true
      runAsUser: 1001
    priorityClassName: ""
    readinessProbe:
      enabled: true
      failureThreshold: 6
      initialDelaySeconds: 30
      path: /api/health
      periodSeconds: 10
      scheme: HTTP
      successThreshold: 1
      timeoutSeconds: 5
    replicaCount: 1
    resources:
      limits: {}
      requests: {}
    schedulerName: ""
    sidecars:
    - args:
      - --volume-dir=/opt/bitnami/grafana/dashboards
      - --webhook-url=$(GRAFANA_API_DASHBOARD_RELOAD_URL)
      env:
      - name: GRAFANA_API_DASHBOARD_RELOAD_URL
        valueFrom:
          secretKeyRef:
            key: grafana_api_dashboard_reload_url
            name: weka-home-grafana-credentials
      image: jimmidyson/configmap-reload:v0.5.0
      imagePullPolicy: IfNotPresent
      name: grafana-configmap-reload
      resources: {}
      terminationMessagePath: /dev/termination-log
      terminationMessagePolicy: File
      volumeMounts:
      - mountPath: /opt/bitnami/grafana/dashboards
        name: grafana-dashboards
        readOnly: true
    startupProbe:
      enabled: false
      failureThreshold: 6
      initialDelaySeconds: 30
      path: /api/health
      periodSeconds: 10
      scheme: HTTP
      successThreshold: 1
      timeoutSeconds: 5
    tolerations: []
    topologySpreadConstraints: []
    updateStrategy:
      type: Recreate
  grafana_health_dashboard_uid: WH_Health_Dashboard_UID_1
  hostAliases: []
  image:
    pullPolicy: Never
    pullSecrets: []
    registry: docker.io
    repository: bitnami/grafana
    tag: 8.1.0-debian-10-r0
  imageRenderer:
    affinity: {}
    args: []
    command: []
    containerSecurityContext:
      enabled: true
      runAsUser: 1001
    enabled: false
    extraEnvVars: {}
    extraEnvVarsCM: ""
    extraEnvVarsSecret: ""
    image:
      pullPolicy: IfNotPresent
      pullSecrets: []
      registry: docker.io
      repository: bitnami/grafana-image-renderer
      tag: 3.3.0-debian-10-r49
    initContainers: {}
    metrics:
      annotations:
        prometheus.io/path: /metrics
        prometheus.io/port: "8080"
        prometheus.io/scrape: "true"
      enabled: false
      prometheusRule:
        additionalLabels: {}
        enabled: false
        namespace: ""
        rules: []
      serviceMonitor:
        enabled: false
        interval: ""
        namespace: ""
        scrapeTimeout: ""
    nodeAffinityPreset:
      key: ""
      type: ""
      values: []
    nodeSelector: {}
    podAffinityPreset: ""
    podAnnotations: {}
    podAntiAffinityPreset: soft
    podSecurityContext:
      enabled: true
      fsGroup: 1001
      runAsNonRoot: true
      runAsUser: 1001
    replicaCount: 1
    resources:
      limits: {}
      requests: {}
    service:
      annotations: {}
      clusterIP: ""
      externalTrafficPolicy: Cluster
      extraPorts: []
      loadBalancerIP: ""
      loadBalancerSourceRanges: []
      nodePorts:
        grafana: ""
      ports:
        imageRenderer: 8080
      type: ClusterIP
    tolerations: []
    topologySpreadConstraints: []
  ingress:
    annotations: {}
    apiVersion: ""
    enabled: false
    extraHosts: []
    extraPaths: []
    extraTls: []
    hostname: grafana.local
    ingressClassName: ""
    path: /
    pathType: ImplementationSpecific
    secrets: []
    selfSigned: false
    tls: false
  kubeVersion: ""
  ldap:
    allowSignUp: false
    configMapName: ""
    configuration: ""
    enabled: false
    secretName: ""
  metrics:
    enabled: true
    prometheusRule:
      additionalLabels: {}
      enabled: false
      namespace: ""
      rules: []
    service:
      annotations:
        prometheus.io/path: /metrics
        prometheus.io/port: "3000"
        prometheus.io/scrape: "true"
    serviceMonitor:
      additionalLabels: {}
      enabled: false
      honorLabels: false
      interval: ""
      jobLabel: ""
      metricRelabelings: []
      namespace: monitoring
      scrapeTimeout: ""
      selector: {}
  nameOverride: ""
  notifiers:
    channels:
      slack:
        enabled: false
        is_default: false
        name: NotifySlack
        token: ""
        url: ""
      webhook:
        authentication_enabled: true
        enabled: true
        is_default: true
        name: NotifyWHL
        secret_force_update: false
        secret_name: grafana-webhook
        token: ""
        url: ""
    configMapName: grafana-alerts
    org_name: Main Org.
  persistence:
    accessMode: ReadWriteOnce
    accessModes: []
    annotations: {}
    enabled: true
    existingClaim: ""
    sidecars:
    - imagePullPolicy: Never
    size: 10Gi
    storageClass: local-path
  plugins: ""
  secret_name: weka-home-grafana-credentials
  service:
    annotations: {}
    clusterIP: ""
    externalTrafficPolicy: Cluster
    extraPorts: []
    loadBalancerIP: ""
    loadBalancerSourceRanges: []
    nodePorts:
      grafana: ""
    port: 3000
    ports:
      grafana: 3000
    type: NodePort
  serviceAccount:
    annotations: {}
    automountServiceAccountToken: false
    create: true
    name: ""
  smtp:
    enabled: false
    existingSecret: ""
    existingSecretPasswordKey: password
    existingSecretUserKey: user
    fromAddress: ""
    fromName: ""
    host: ""
    password: ""
    skipVerify: "false"
    user: ""
  use_embedded: true
  volumePermissions:
    containerSecurityContext:
      runAsUser: 0
    enabled: false
    image:
      pullPolicy: IfNotPresent
      pullSecrets: []
      registry: docker.io
      repository: bitnami/bitnami-shell
      tag: 10-debian-10-r305
    resources:
      limits: {}
      requests: {}
grafana_api:
  enabled: false
  priorityClassName: ""
  resources:
    limits:
      cpu: 50m
      memory: 200Mi
    requests:
      cpu: 50m
      memory: 200Mi
  schedule: '*/1 * * * *'
license_synchronizer:
  batch_interval: 1m
  batch_size: 1000
  cycle_limit: 5m
  enabled: false
  get_weka_io_access_token: ""
  priorityClassName: ""
  resources:
    limits:
      cpu: 50m
      memory: 100Mi
    requests:
      cpu: 50m
      memory: 100Mi
main_db:
  audit:
    clientMinMessages: error
    logConnections: false
    logDisconnections: false
    logHostname: false
    logLinePrefix: ""
    logTimezone: ""
    pgAuditLog: ""
    pgAuditLogCatalog: "off"
  common:
    exampleValue: common-chart
    global:
      annotations:
        prometheus.io/path: /metrics
        prometheus.io/scrape: "true"
      app_name: home-weka-io
      cluster_domain_suffix: cluster.local
      database:
        events:
          databases: []
          db_template:
            database: weka_events
            force_update: false
            hostname: ""
            password: ""
            port: 5432
            secret_name_template: weka-home-event-db-credentials-
            username: weka_home
          num_event_stores: 1
        main:
          database: weka_home
          force_update: false
          hostname: ""
          password: ""
          port: 5432
          secret_name: weka-home-main-db-credentials
          username: weka_home
        readonly:
          use_main: true
        remote_access:
          database: tmate
          force_update: false
          hostname: ""
          password: ""
          port: 5432
          secret_name: weka-home-remote-access-db-credentials
          username: tmate
        support:
          database: weka_support
          force_update: false
          hostname: ""
          password: ""
          port: 5432
          secret_name: weka-home-support-db-credentials
          username: weka_home
      debug_pod:
        enable: true
        image: gohome-debug-pod:d48067c1d33c0f7f1b895211850fdfdd
        imagePullPolicy: Never
        priorityClassName: ""
      imagePullSecrets: []
      imageRegistry: ""
      ingress:
        additional_fqdns:
          api: []
          frontend: []
          frontendV2: []
          stats: []
        annotations:
          kubernetes.io/ingress.class: nginx
          nginx.ingress.kubernetes.io/backend-protocol: http
          nginx.ingress.kubernetes.io/enable-access-log: "true"
          nginx.ingress.kubernetes.io/enable-cors: "true"
          nginx.ingress.kubernetes.io/enable-modsecurity: "true"
          nginx.ingress.kubernetes.io/enable-owasp-core-rules: "true"
          nginx.ingress.kubernetes.io/proxy-body-size: 1000m
          nginx.ingress.kubernetes.io/proxy-buffering: "off"
          nginx.ingress.kubernetes.io/ssl-redirect: "false"
          nginx.ingress.kubernetes.io/use-regex: "true"
        domain: 10.108.170.142
        enabled: true
        name: weka-home-ingress
        nginx:
          tls:
            cert: |
              -----BEGIN CERTIFICATE-----
              <cert-data-comes-here>
              -----END CERTIFICATE-----
            cn: server.example.com
            enabled: false
            force_update: false
            key: |
              -----BEGIN PRIVATE KEY-----
              <private-key-data-comes-here>
              -----END PRIVATE KEY-----
            secret_name: weka-home-ingress-cert-secret
        ssl_redirect: false
        subdomain_prefixes:
          api: ""
          frontend: ""
          nextFrontend: next.home.
          remote_access: terminal.home.
          remote_access_ssh: terminal-ssh.home.
          remote_access_wss: terminal-wss.home.
          stats: ""
        use_subdomains: false
      is_offline: true
      k8s_object_prefix: ""
      keep_secrets_on_uninstall: true
      liveness_probe:
        enable: true
      metrics:
        enable_push_metrics: false
        enabled: true
        port: 9187
        push_gateway_host: prometheus-pushgateway.monitoring-system.svc.cluster.local
        push_gateway_port: 9091
        push_interval_seconds: 15
      persistence:
        DBstorageClass: local-path
      postgres_sslmode: false
      postgresql:
        existingSecret: ""
        postgresqlDatabase: postgres
        postgresqlPassword: ""
        postgresqlUsername: ""
        replicationPassword: ""
        servicePort: ""
      service_type: NodePort
      serviceMonitor:
        enabled: false
        namespace: monitoring
      statistics:
        database:
          force_update: true
          secret_name: weka-home-stats-db-credentials
      storageClass: ""
      support_files:
        bucket_name: ""
        hostPath: /opt/local-path-provisioner
        path: /support-file-uploads
        persistence:
          enabled: true
          storageClass: local-path
        size: 15Gi
        storage_provider: filesystem
      use_embedded_db: true
  commonAnnotations: {}
  commonLabels:
    app.group: common
  configurationConfigMap: ""
  containerPorts:
    postgresql: 5432
  containerSecurityContext:
    enabled: true
    runAsUser: 1001
  customLivenessProbe: {}
  customReadinessProbe: {}
  customStartupProbe: {}
  diagnosticMode:
    args:
    - infinity
    command:
    - sleep
    enabled: false
  existingSecret: weka-home-main-db-credentials
  extendedConfConfigMap: ""
  extraDeploy: []
  extraEnv: []
  extraEnvVarsCM: ""
  fullnameOverride: ""
  global:
    annotations:
      prometheus.io/path: /metrics
      prometheus.io/scrape: "true"
    app_name: home-weka-io
    cluster_domain_suffix: cluster.local
    database:
      events:
        databases: []
        db_template:
          database: weka_events
          force_update: false
          hostname: ""
          password: ""
          port: 5432
          secret_name_template: weka-home-event-db-credentials-
          username: weka_home
        num_event_stores: 1
      main:
        database: weka_home
        force_update: false
        hostname: ""
        password: ""
        port: 5432
        secret_name: weka-home-main-db-credentials
        username: weka_home
      readonly:
        use_main: true
      remote_access:
        database: tmate
        force_update: false
        hostname: ""
        password: ""
        port: 5432
        secret_name: weka-home-remote-access-db-credentials
        username: tmate
      support:
        database: weka_support
        force_update: false
        hostname: ""
        password: ""
        port: 5432
        secret_name: weka-home-support-db-credentials
        username: weka_home
    debug_pod:
      enable: true
      image: gohome-debug-pod:d48067c1d33c0f7f1b895211850fdfdd
      imagePullPolicy: Never
      priorityClassName: ""
    imagePullSecrets: []
    imageRegistry: ""
    ingress:
      additional_fqdns:
        api: []
        frontend: []
        frontendV2: []
        stats: []
      annotations:
        kubernetes.io/ingress.class: nginx
        nginx.ingress.kubernetes.io/backend-protocol: http
        nginx.ingress.kubernetes.io/enable-access-log: "true"
        nginx.ingress.kubernetes.io/enable-cors: "true"
        nginx.ingress.kubernetes.io/enable-modsecurity: "true"
        nginx.ingress.kubernetes.io/enable-owasp-core-rules: "true"
        nginx.ingress.kubernetes.io/proxy-body-size: 1000m
        nginx.ingress.kubernetes.io/proxy-buffering: "off"
        nginx.ingress.kubernetes.io/ssl-redirect: "false"
        nginx.ingress.kubernetes.io/use-regex: "true"
      domain: 10.108.170.142
      enabled: true
      name: weka-home-ingress
      nginx:
        tls:
          cert: |
            -----BEGIN CERTIFICATE-----
            <cert-data-comes-here>
            -----END CERTIFICATE-----
          cn: server.example.com
          enabled: false
          force_update: false
          key: |
            -----BEGIN PRIVATE KEY-----
            <private-key-data-comes-here>
            -----END PRIVATE KEY-----
          secret_name: weka-home-ingress-cert-secret
      ssl_redirect: false
      subdomain_prefixes:
        api: ""
        frontend: ""
        nextFrontend: next.home.
        remote_access: terminal.home.
        remote_access_ssh: terminal-ssh.home.
        remote_access_wss: terminal-wss.home.
        stats: ""
      use_subdomains: false
    is_offline: true
    k8s_object_prefix: ""
    keep_secrets_on_uninstall: true
    liveness_probe:
      enable: true
    metrics:
      enable_push_metrics: false
      enabled: true
      port: 9187
      push_gateway_host: prometheus-pushgateway.monitoring-system.svc.cluster.local
      push_gateway_port: 9091
      push_interval_seconds: 15
    persistence:
      DBstorageClass: local-path
    postgres_sslmode: false
    postgresql:
      existingSecret: ""
      postgresqlDatabase: postgres
      postgresqlPassword: ""
      postgresqlUsername: ""
      replicationPassword: ""
      servicePort: ""
    service_type: NodePort
    serviceMonitor:
      enabled: false
      namespace: monitoring
    statistics:
      database:
        force_update: true
        secret_name: weka-home-stats-db-credentials
    storageClass: ""
    support_files:
      bucket_name: ""
      hostPath: /opt/local-path-provisioner
      path: /support-file-uploads
      persistence:
        enabled: true
        storageClass: local-path
      size: 15Gi
      storage_provider: filesystem
    use_embedded_db: true
  image:
    debug: false
    pullPolicy: Never
    pullSecrets: []
    registry: docker.io
    repository: bitnami/postgresql
    tag: 11.14.0-debian-10-r21
  initdbPassword: ""
  initdbScripts: {}
  initdbScriptsConfigMap: main-db-init-configmap
  initdbScriptsSecret: ""
  initdbUser: postgres
  ldap:
    baseDN: ""
    bind_password: ""
    bindDN: ""
    enabled: false
    port: ""
    prefix: ""
    scheme: ""
    search_attr: ""
    search_filter: ""
    server: ""
    suffix: ""
    tls: ""
    url: ""
  lifecycleHooks: {}
  livenessProbe:
    enabled: true
    failureThreshold: 6
    initialDelaySeconds: 30
    periodSeconds: 10
    successThreshold: 1
    timeoutSeconds: 5
  main_db_pool_size: 8
  metrics:
    customMetrics: {}
    enabled: true
    extraEnvVars: []
    image:
      pullPolicy: IfNotPresent
      pullSecrets: []
      registry: docker.io
      repository: bitnami/postgres-exporter
      tag: 0.10.0-debian-10-r166
    livenessProbe:
      enabled: true
      failureThreshold: 6
      initialDelaySeconds: 5
      periodSeconds: 10
      successThreshold: 1
      timeoutSeconds: 5
    prometheusRule:
      additionalLabels: {}
      enabled: false
      namespace: ""
      rules: []
    readinessProbe:
      enabled: true
      failureThreshold: 6
      initialDelaySeconds: 5
      periodSeconds: 10
      successThreshold: 1
      timeoutSeconds: 5
    resources: {}
    securityContext:
      enabled: false
      runAsUser: 1001
    service:
      annotations:
        prometheus.io/port: "9187"
        prometheus.io/scrape: "true"
      loadBalancerIP: ""
      type: ClusterIP
    serviceMonitor:
      additionalLabels: {}
      enabled: false
      interval: ""
      metricRelabelings: []
      namespace: monitoring
      relabelings: []
      scrapeTimeout: ""
  nameOverride: main-db
  networkPolicy:
    allowExternal: true
    enabled: false
    explicitNamespacesSelector: {}
  persistence:
    accessModes:
    - ReadWriteOnce
    annotations: {}
    enabled: true
    existingClaim: ""
    mountPath: /bitnami/postgresql
    selector: {}
    size: 100Gi
    storageClass: local-path
    subPath: ""
  pgHbaConfiguration: ""
  postgresqlConfiguration: {}
  postgresqlDataDir: /bitnami/postgresql/data
  postgresqlDatabase: ""
  postgresqlDbUserConnectionLimit: ""
  postgresqlExtendedConf: {}
  postgresqlInitdbArgs: ""
  postgresqlInitdbWalDir: ""
  postgresqlMaxConnections: ""
  postgresqlPassword: ""
  postgresqlPghbaRemoveFilters: ""
  postgresqlPostgresConnectionLimit: ""
  postgresqlPostgresPassword: ""
  postgresqlSharedPreloadLibraries: pgaudit
  postgresqlStatementTimeout: ""
  postgresqlTcpKeepalivesCount: ""
  postgresqlTcpKeepalivesIdle: ""
  postgresqlTcpKeepalivesInterval: ""
  postgresqlUsername: postgres
  primary:
    affinity: {}
    annotations: {}
    extraInitContainers: []
    extraPodSpec: {}
    extraVolumeMounts: []
    extraVolumes: []
    labels: {}
    nodeAffinityPreset:
      key: ""
      type: ""
      values: []
    nodeSelector: {}
    podAffinityPreset: ""
    podAnnotations: {}
    podAntiAffinityPreset: soft
    podLabels: {}
    priorityClassName: ""
    service:
      clusterIP: ""
      nodePort: ""
      type: ""
    sidecars: []
    tolerations: []
  primaryAsStandBy:
    enabled: false
    primaryHost: ""
    primaryPort: ""
  psp:
    create: false
  rbac:
    create: false
  readReplicas:
    affinity: {}
    annotations: {}
    extraInitContainers: []
    extraPodSpec: {}
    extraVolumeMounts: []
    extraVolumes: []
    labels: {}
    nodeAffinityPreset:
      key: ""
      type: ""
      values: []
    nodeSelector: {}
    persistence:
      enabled: true
    podAffinityPreset: ""
    podAnnotations: {}
    podAntiAffinityPreset: soft
    podLabels: {}
    priorityClassName: ""
    resources: {}
    service:
      clusterIP: ""
      nodePort: ""
      type: ""
    sidecars: []
    tolerations: []
    topologySpreadConstraints: []
  readinessProbe:
    enabled: true
    failureThreshold: 6
    initialDelaySeconds: 5
    periodSeconds: 10
    successThreshold: 1
    timeoutSeconds: 5
  replication:
    applicationName: my_application
    enabled: false
    numSynchronousReplicas: 0
    password: repl_password
    readReplicas: 1
    singleService: true
    synchronousCommit: "off"
    uniqueServices: false
    user: repl_user
  resources:
    limits:
      cpu: 500m
      memory: 500Mi
    requests:
      cpu: 500m
      memory: 500Mi
  schedulerName: ""
  securityContext:
    enabled: true
    fsGroup: 1001
  service:
    annotations: {}
    clusterIP: ""
    externalTrafficPolicy: Cluster
    loadBalancerIP: ""
    loadBalancerSourceRanges: []
    nodePort: ""
    port: 5432
    type: ClusterIP
  serviceAccount:
    autoMount: false
    enabled: false
    name: ""
  shmVolume:
    chmod:
      enabled: true
    enabled: true
    sizeLimit: ""
  startupProbe:
    enabled: true
    failureThreshold: 10
    initialDelaySeconds: 30
    periodSeconds: 15
    successThreshold: 1
    timeoutSeconds: 5
  terminationGracePeriodSeconds: ""
  tls:
    autoGenerated: false
    certCAFilename: ""
    certFilename: ""
    certKeyFilename: ""
    certificatesSecret: ""
    crlFilename: ""
    enabled: false
    preferServerCiphers: true
  updateStrategy:
    type: RollingUpdate
  usePasswordFile: false
  volumePermissions:
    enabled: false
    image:
      pullPolicy: IfNotPresent
      pullSecrets: []
      registry: docker.io
      repository: bitnami/bitnami-shell
      tag: 10-debian-10-r299
    securityContext:
      runAsUser: 0
nack:
  additionalVolumeMounts: []
  additionalVolumes: []
  affinity: {}
  containerSecurityContext: {}
  global:
    annotations:
      prometheus.io/path: /metrics
      prometheus.io/scrape: "true"
    app_name: home-weka-io
    cluster_domain_suffix: cluster.local
    database:
      events:
        databases: []
        db_template:
          database: weka_events
          force_update: false
          hostname: ""
          password: ""
          port: 5432
          secret_name_template: weka-home-event-db-credentials-
          username: weka_home
        num_event_stores: 1
      main:
        database: weka_home
        force_update: false
        hostname: ""
        password: ""
        port: 5432
        secret_name: weka-home-main-db-credentials
        username: weka_home
      readonly:
        use_main: true
      remote_access:
        database: tmate
        force_update: false
        hostname: ""
        password: ""
        port: 5432
        secret_name: weka-home-remote-access-db-credentials
        username: tmate
      support:
        database: weka_support
        force_update: false
        hostname: ""
        password: ""
        port: 5432
        secret_name: weka-home-support-db-credentials
        username: weka_home
    debug_pod:
      enable: true
      image: gohome-debug-pod:d48067c1d33c0f7f1b895211850fdfdd
      imagePullPolicy: Never
      priorityClassName: ""
    ingress:
      additional_fqdns:
        api: []
        frontend: []
        frontendV2: []
        stats: []
      annotations:
        kubernetes.io/ingress.class: nginx
        nginx.ingress.kubernetes.io/backend-protocol: http
        nginx.ingress.kubernetes.io/enable-access-log: "true"
        nginx.ingress.kubernetes.io/enable-cors: "true"
        nginx.ingress.kubernetes.io/enable-modsecurity: "true"
        nginx.ingress.kubernetes.io/enable-owasp-core-rules: "true"
        nginx.ingress.kubernetes.io/proxy-body-size: 1000m
        nginx.ingress.kubernetes.io/proxy-buffering: "off"
        nginx.ingress.kubernetes.io/ssl-redirect: "false"
        nginx.ingress.kubernetes.io/use-regex: "true"
      domain: 10.108.170.142
      enabled: true
      name: weka-home-ingress
      nginx:
        tls:
          cert: |
            -----BEGIN CERTIFICATE-----
            <cert-data-comes-here>
            -----END CERTIFICATE-----
          cn: server.example.com
          enabled: false
          force_update: false
          key: |
            -----BEGIN PRIVATE KEY-----
            <private-key-data-comes-here>
            -----END PRIVATE KEY-----
          secret_name: weka-home-ingress-cert-secret
      ssl_redirect: false
      subdomain_prefixes:
        api: ""
        frontend: ""
        nextFrontend: next.home.
        remote_access: terminal.home.
        remote_access_ssh: terminal-ssh.home.
        remote_access_wss: terminal-wss.home.
        stats: ""
      use_subdomains: false
    is_offline: true
    k8s_object_prefix: ""
    keep_secrets_on_uninstall: true
    liveness_probe:
      enable: true
    metrics:
      enable_push_metrics: false
      enabled: true
      port: 9187
      push_gateway_host: prometheus-pushgateway.monitoring-system.svc.cluster.local
      push_gateway_port: 9091
      push_interval_seconds: 15
    persistence:
      DBstorageClass: local-path
    postgres_sslmode: false
    postgresql:
      postgresqlDatabase: postgres
    service_type: NodePort
    serviceMonitor:
      enabled: false
      namespace: monitoring
    statistics:
      database:
        force_update: true
        secret_name: weka-home-stats-db-credentials
    support_files:
      bucket_name: ""
      hostPath: /opt/local-path-provisioner
      path: /support-file-uploads
      persistence:
        enabled: true
        storageClass: local-path
      size: 15Gi
      storage_provider: filesystem
    use_embedded_db: true
  imagePullSecrets: []
  jetstream:
    additionalArgs: []
    enabled: true
    image:
      pullPolicy: IfNotPresent
      repository: wekaio/nack
      tag: 0.10.1-discard-per
    nats:
      url: nats://nats:4222
    tls:
      enabled: false
      settings:
        client_ca: /etc/nats/certs/ca.crt
        client_cert: /etc/nats/certs/tls.crt
        client_key: /etc/nats/certs/tls.key
        timeout: 3
  nameOverride: ""
  namespaceOverride: ""
  namespaced: true
  nodeSelector: {}
  podAnnotations: {}
  rbacRules: |
    rules:
    - apiGroups:
      - ''
      resources:
      - events
      verbs:
      - create
      - update
      - patch
    - apiGroups:
      - ''
      resources:
      - secrets
      verbs:
      - get
      - watch
      - list
    - apiGroups:
      - jetstream.nats.io
      resources:
      - streams
      - streams/status
      - consumers
      - consumers/status
      - streamtemplates
      - streamtemplates/status
      - accounts
      verbs:
      - create
      - get
      - list
      - watch
      - patch
      - update
      - delete
  readOnly: false
  resources: {}
  securityContext: {}
  serviceAccountName: ""
  tolerations: []
nats:
  additionalContainers: []
  additionalVolumeMounts: []
  additionalVolumes: []
  advertiseconfigVolume:
    emptyDir: {}
  affinity: {}
  auth:
    enabled: false
    resolver:
      allowDelete: false
      interval: 2m
      store:
        dir: /accounts/jwt
        size: 1Gi
      type: none
  bootconfig:
    image:
      pullPolicy: IfNotPresent
      repository: natsio/nats-boot-config
      tag: 0.10.1
    resources: {}
    securityContext: {}
  cluster:
    enabled: true
    extraRoutes: []
    noAdvertise: true
    replicas: 3
  commonLabels: {}
  enabled: true
  exporter:
    args: []
    enabled: true
    image:
      pullPolicy: IfNotPresent
      repository: natsio/prometheus-nats-exporter
      tag: 0.10.1
    portName: metrics
    resources: {}
    securityContext: {}
    serviceMonitor:
      annotations: {}
      enabled: false
      interval: 15s
      labels: {}
      namespace: monitoring
      path: /metrics
  external:
    url: null
  fullnameOverride: nats
  gateway:
    enabled: false
    name: default
    port: 7522
  global:
    annotations:
      prometheus.io/path: /metrics
      prometheus.io/scrape: "true"
    app_name: home-weka-io
    cluster_domain_suffix: cluster.local
    database:
      events:
        databases: []
        db_template:
          database: weka_events
          force_update: false
          hostname: ""
          password: ""
          port: 5432
          secret_name_template: weka-home-event-db-credentials-
          username: weka_home
        num_event_stores: 1
      main:
        database: weka_home
        force_update: false
        hostname: ""
        password: ""
        port: 5432
        secret_name: weka-home-main-db-credentials
        username: weka_home
      readonly:
        use_main: true
      remote_access:
        database: tmate
        force_update: false
        hostname: ""
        password: ""
        port: 5432
        secret_name: weka-home-remote-access-db-credentials
        username: tmate
      support:
        database: weka_support
        force_update: false
        hostname: ""
        password: ""
        port: 5432
        secret_name: weka-home-support-db-credentials
        username: weka_home
    debug_pod:
      enable: true
      image: gohome-debug-pod:d48067c1d33c0f7f1b895211850fdfdd
      imagePullPolicy: Never
      priorityClassName: ""
    ingress:
      additional_fqdns:
        api: []
        frontend: []
        frontendV2: []
        stats: []
      annotations:
        kubernetes.io/ingress.class: nginx
        nginx.ingress.kubernetes.io/backend-protocol: http
        nginx.ingress.kubernetes.io/enable-access-log: "true"
        nginx.ingress.kubernetes.io/enable-cors: "true"
        nginx.ingress.kubernetes.io/enable-modsecurity: "true"
        nginx.ingress.kubernetes.io/enable-owasp-core-rules: "true"
        nginx.ingress.kubernetes.io/proxy-body-size: 1000m
        nginx.ingress.kubernetes.io/proxy-buffering: "off"
        nginx.ingress.kubernetes.io/ssl-redirect: "false"
        nginx.ingress.kubernetes.io/use-regex: "true"
      domain: 10.108.170.142
      enabled: true
      name: weka-home-ingress
      nginx:
        tls:
          cert: |
            -----BEGIN CERTIFICATE-----
            <cert-data-comes-here>
            -----END CERTIFICATE-----
          cn: server.example.com
          enabled: false
          force_update: false
          key: |
            -----BEGIN PRIVATE KEY-----
            <private-key-data-comes-here>
            -----END PRIVATE KEY-----
          secret_name: weka-home-ingress-cert-secret
      ssl_redirect: false
      subdomain_prefixes:
        api: ""
        frontend: ""
        nextFrontend: next.home.
        remote_access: terminal.home.
        remote_access_ssh: terminal-ssh.home.
        remote_access_wss: terminal-wss.home.
        stats: ""
      use_subdomains: false
    is_offline: true
    k8s_object_prefix: ""
    keep_secrets_on_uninstall: true
    liveness_probe:
      enable: true
    metrics:
      enable_push_metrics: false
      enabled: true
      port: 9187
      push_gateway_host: prometheus-pushgateway.monitoring-system.svc.cluster.local
      push_gateway_port: 9091
      push_interval_seconds: 15
    persistence:
      DBstorageClass: local-path
    postgres_sslmode: false
    postgresql:
      postgresqlDatabase: postgres
    service_type: NodePort
    serviceMonitor:
      enabled: false
      namespace: monitoring
    statistics:
      database:
        force_update: true
        secret_name: weka-home-stats-db-credentials
    support_files:
      bucket_name: ""
      hostPath: /opt/local-path-provisioner
      path: /support-file-uploads
      persistence:
        enabled: true
        storageClass: local-path
      size: 15Gi
      storage_provider: filesystem
    use_embedded_db: true
  imagePullSecrets: []
  k8sClusterDomain: cluster.local
  leafnodes:
    enabled: false
    noAdvertise: false
    port: 7422
  maxMsgsPerSubject:
    alerts: -1
    events: -1
    forwardingHigh: -1
    forwardingLow: -1
    notifications: -1
    stats: -1
  maxStorage:
    alerts: 1073741000
    events: 2147483000
    forwardingHigh: 3221225000
    forwardingLow: 10737410000
    notifications: 1073741000
    stats: 10737410000
  mqtt:
    ackWait: 1m
    enabled: false
    maxAckPending: 100
  nameOverride: ""
  namespaceOverride: ""
  nats:
    advertise: false
    client:
      port: 4222
      portName: client
    configChecksumAnnotation: true
    connectRetries: 120
    dnsPolicy: ClusterFirst
    externalAccess: false
    extraEnv: []
    healthcheck:
      detectHealthz: true
      enableHealthz: true
      enableHealthzLivenessReadiness: false
      liveness:
        enabled: true
        failureThreshold: 3
        initialDelaySeconds: 10
        periodSeconds: 30
        successThreshold: 1
        timeoutSeconds: 5
      readiness:
        enabled: true
        failureThreshold: 3
        initialDelaySeconds: 10
        periodSeconds: 10
        successThreshold: 1
        timeoutSeconds: 5
      startup:
        enabled: true
        failureThreshold: 90
        initialDelaySeconds: 10
        periodSeconds: 10
        successThreshold: 1
        timeoutSeconds: 5
    hostNetwork: false
    image:
      pullPolicy: Never
      repository: nats
      tag: 2.9.16-alpine
    jetstream:
      enabled: true
      fileStorage:
        accessModes:
        - ReadWriteOnce
        enabled: true
        size: 30Gi
        storageDirectory: /data
      memStorage:
        enabled: true
        size: 1Gi
      memstorage:
        enabled: true
        size: 1Gi
    limits:
      lameDuckDuration: 30s
      lameDuckGracePeriod: 10s
      maxPayload: 16Mi
    logging: {}
    mappings: {}
    profiling:
      enabled: false
      port: 6000
    pullPolicy: Never
    resources:
      limits:
        cpu: 200m
        memory: 500Mi
      requests:
        cpu: 200m
        memory: 500Mi
    securityContext: {}
    selectorLabels: {}
    serverNamePrefix: ""
    serviceAccount:
      annotations: {}
      create: true
      name: ""
    terminationGracePeriodSeconds: 60
  natsbox:
    additionalLabels: {}
    affinity: {}
    annotations: {}
    enabled: true
    extraVolumeMounts: []
    extraVolumes: []
    image:
      pullPolicy: IfNotPresent
      repository: natsio/nats-box
      tag: 0.13.8
    imagePullSecrets: []
    nodeSelector: {}
    podAnnotations: {}
    podLabels: {}
    resources: {}
    securityContext: {}
    tolerations: []
  networkPolicy:
    allowExternal: true
    enabled: false
    extraEgress: []
    extraIngress: []
    ingressNSMatchLabels: {}
    ingressNSPodMatchLabels: {}
  nodeSelector: {}
  pidVolume:
    emptyDir: {}
  podAnnotations: {}
  podDisruptionBudget:
    enabled: true
    maxUnavailable: 1
  podManagementPolicy: Parallel
  priorityClassName: ""
  reloader:
    enabled: true
    extraConfigs: []
    image:
      pullPolicy: IfNotPresent
      repository: natsio/nats-server-config-reloader
      tag: 0.10.1
    resources: {}
    securityContext: {}
  securityContext: {}
  serviceAnnotations: {}
  statefulSetAnnotations: {}
  statefulSetPodLabels: {}
  tolerations: []
  topologyKeys: []
  topologySpreadConstraints: []
  useFQDN: true
  websocket:
    allowedOrigins: []
    enabled: false
    noTLS: true
    port: 443
    sameOrigin: false
postgres_db_defaults:
  commonAnnotations: {}
  commonLabels:
    app.group: common
  image:
    debug: true
    pullPolicy: Never
  initdbUser: postgres
  livenessProbe:
    enabled: true
  metrics:
    enabled: true
    serviceMonitor:
      enabled: false
      namespace: monitoring
  persistence:
    annotations: {}
    enabled: true
    selector: {}
    size: 100Gi
    storageClass: local-path
  readinessProbe:
    enabled: true
  startupProbe:
    enabled: true
prometheus:
  alertmanager:
    affinity: {}
    baseURL: http://localhost:9093
    clusterPeers: []
    configFileName: alertmanager.yml
    configFromSecret: ""
    configMapOverrideName: ""
    deploymentAnnotations: {}
    dnsConfig: {}
    emptyDir:
      sizeLimit: ""
    enabled: true
    extraArgs: {}
    extraConfigmapMounts: []
    extraEnv: {}
    extraInitContainers: []
    extraSecretMounts: []
    image:
      pullPolicy: Never
      repository: quay.io/prometheus/alertmanager
      tag: v0.23.0
    ingress:
      annotations: {}
      enabled: false
      extraLabels: {}
      extraPaths: []
      hosts: []
      path: /
      pathType: Prefix
      tls: []
    name: alertmanager
    nodeSelector: {}
    persistentVolume:
      accessModes:
      - ReadWriteOnce
      annotations: {}
      enabled: true
      existingClaim: ""
      mountPath: /data
      size: 2Gi
      storageClass: local-path
      subPath: ""
    podAnnotations: {}
    podDisruptionBudget:
      enabled: false
      maxUnavailable: 1
    podLabels: {}
    podSecurityPolicy:
      annotations: {}
    prefixURL: ""
    priorityClassName: ""
    probeHeaders: []
    replicaCount: 1
    resources: {}
    securityContext:
      fsGroup: 65534
      runAsGroup: 65534
      runAsNonRoot: true
      runAsUser: 65534
    service:
      annotations: {}
      clusterIP: ""
      externalIPs: []
      labels: {}
      loadBalancerIP: ""
      loadBalancerSourceRanges: []
      servicePort: 80
      sessionAffinity: None
      type: ClusterIP
    statefulSet:
      annotations: {}
      enabled: false
      headless:
        annotations: {}
        enableMeshPeer: false
        labels: {}
        servicePort: 80
      labels: {}
      podManagementPolicy: OrderedReady
    tolerations: []
    useClusterRole: true
    useExistingRole: false
  alertmanagerFiles:
    alertmanager.yml:
      global: {}
      receivers:
      - name: default-receiver
      route:
        group_interval: 5m
        group_wait: 10s
        receiver: default-receiver
        repeat_interval: 3h
  configmapReload:
    alertmanager:
      enabled: true
      extraArgs: {}
      extraConfigmapMounts: []
      extraVolumeDirs: []
      image:
        pullPolicy: Never
        repository: jimmidyson/configmap-reload
        tag: v0.5.0
      name: configmap-reload
      resources: {}
    prometheus:
      enabled: true
      extraArgs: {}
      extraConfigmapMounts: []
      extraVolumeDirs: []
      image:
        pullPolicy: Never
        repository: jimmidyson/configmap-reload
        tag: v0.5.0
      name: configmap-reload
      resources: {}
  enabled: true
  global:
    annotations:
      prometheus.io/path: /metrics
      prometheus.io/scrape: "true"
    app_name: home-weka-io
    cluster_domain_suffix: cluster.local
    database:
      events:
        databases: []
        db_template:
          database: weka_events
          force_update: false
          hostname: ""
          password: ""
          port: 5432
          secret_name_template: weka-home-event-db-credentials-
          username: weka_home
        num_event_stores: 1
      main:
        database: weka_home
        force_update: false
        hostname: ""
        password: ""
        port: 5432
        secret_name: weka-home-main-db-credentials
        username: weka_home
      readonly:
        use_main: true
      remote_access:
        database: tmate
        force_update: false
        hostname: ""
        password: ""
        port: 5432
        secret_name: weka-home-remote-access-db-credentials
        username: tmate
      support:
        database: weka_support
        force_update: false
        hostname: ""
        password: ""
        port: 5432
        secret_name: weka-home-support-db-credentials
        username: weka_home
    debug_pod:
      enable: true
      image: gohome-debug-pod:d48067c1d33c0f7f1b895211850fdfdd
      imagePullPolicy: Never
      priorityClassName: ""
    ingress:
      additional_fqdns:
        api: []
        frontend: []
        frontendV2: []
        stats: []
      annotations:
        kubernetes.io/ingress.class: nginx
        nginx.ingress.kubernetes.io/backend-protocol: http
        nginx.ingress.kubernetes.io/enable-access-log: "true"
        nginx.ingress.kubernetes.io/enable-cors: "true"
        nginx.ingress.kubernetes.io/enable-modsecurity: "true"
        nginx.ingress.kubernetes.io/enable-owasp-core-rules: "true"
        nginx.ingress.kubernetes.io/proxy-body-size: 1000m
        nginx.ingress.kubernetes.io/proxy-buffering: "off"
        nginx.ingress.kubernetes.io/ssl-redirect: "false"
        nginx.ingress.kubernetes.io/use-regex: "true"
      domain: 10.108.170.142
      enabled: true
      name: weka-home-ingress
      nginx:
        tls:
          cert: |
            -----BEGIN CERTIFICATE-----
            <cert-data-comes-here>
            -----END CERTIFICATE-----
          cn: server.example.com
          enabled: false
          force_update: false
          key: |
            -----BEGIN PRIVATE KEY-----
            <private-key-data-comes-here>
            -----END PRIVATE KEY-----
          secret_name: weka-home-ingress-cert-secret
      ssl_redirect: false
      subdomain_prefixes:
        api: ""
        frontend: ""
        nextFrontend: next.home.
        remote_access: terminal.home.
        remote_access_ssh: terminal-ssh.home.
        remote_access_wss: terminal-wss.home.
        stats: ""
      use_subdomains: false
    is_offline: true
    k8s_object_prefix: ""
    keep_secrets_on_uninstall: true
    liveness_probe:
      enable: true
    metrics:
      enable_push_metrics: false
      enabled: true
      port: 9187
      push_gateway_host: prometheus-pushgateway.monitoring-system.svc.cluster.local
      push_gateway_port: 9091
      push_interval_seconds: 15
    persistence:
      DBstorageClass: local-path
    postgres_sslmode: false
    postgresql:
      postgresqlDatabase: postgres
    service_type: NodePort
    serviceMonitor:
      enabled: false
      namespace: monitoring
    statistics:
      database:
        force_update: true
        secret_name: weka-home-stats-db-credentials
    support_files:
      bucket_name: ""
      hostPath: /opt/local-path-provisioner
      path: /support-file-uploads
      persistence:
        enabled: true
        storageClass: local-path
      size: 15Gi
      storage_provider: filesystem
    use_embedded_db: true
  kube-state-metrics:
    affinity: {}
    autosharding:
      enabled: false
    collectors:
    - certificatesigningrequests
    - configmaps
    - cronjobs
    - daemonsets
    - deployments
    - endpoints
    - horizontalpodautoscalers
    - ingresses
    - jobs
    - limitranges
    - mutatingwebhookconfigurations
    - namespaces
    - networkpolicies
    - nodes
    - persistentvolumeclaims
    - persistentvolumes
    - poddisruptionbudgets
    - pods
    - replicasets
    - replicationcontrollers
    - resourcequotas
    - secrets
    - services
    - statefulsets
    - storageclasses
    - validatingwebhookconfigurations
    - volumeattachments
    containerSecurityContext: {}
    customLabels: {}
    extraArgs: []
    global:
      annotations:
        prometheus.io/path: /metrics
        prometheus.io/scrape: "true"
      app_name: home-weka-io
      cluster_domain_suffix: cluster.local
      database:
        events:
          databases: []
          db_template:
            database: weka_events
            force_update: false
            hostname: ""
            password: ""
            port: 5432
            secret_name_template: weka-home-event-db-credentials-
            username: weka_home
          num_event_stores: 1
        main:
          database: weka_home
          force_update: false
          hostname: ""
          password: ""
          port: 5432
          secret_name: weka-home-main-db-credentials
          username: weka_home
        readonly:
          use_main: true
        remote_access:
          database: tmate
          force_update: false
          hostname: ""
          password: ""
          port: 5432
          secret_name: weka-home-remote-access-db-credentials
          username: tmate
        support:
          database: weka_support
          force_update: false
          hostname: ""
          password: ""
          port: 5432
          secret_name: weka-home-support-db-credentials
          username: weka_home
      debug_pod:
        enable: true
        image: gohome-debug-pod:d48067c1d33c0f7f1b895211850fdfdd
        imagePullPolicy: Never
        priorityClassName: ""
      ingress:
        additional_fqdns:
          api: []
          frontend: []
          frontendV2: []
          stats: []
        annotations:
          kubernetes.io/ingress.class: nginx
          nginx.ingress.kubernetes.io/backend-protocol: http
          nginx.ingress.kubernetes.io/enable-access-log: "true"
          nginx.ingress.kubernetes.io/enable-cors: "true"
          nginx.ingress.kubernetes.io/enable-modsecurity: "true"
          nginx.ingress.kubernetes.io/enable-owasp-core-rules: "true"
          nginx.ingress.kubernetes.io/proxy-body-size: 1000m
          nginx.ingress.kubernetes.io/proxy-buffering: "off"
          nginx.ingress.kubernetes.io/ssl-redirect: "false"
          nginx.ingress.kubernetes.io/use-regex: "true"
        domain: 10.108.170.142
        enabled: true
        name: weka-home-ingress
        nginx:
          tls:
            cert: |
              -----BEGIN CERTIFICATE-----
              <cert-data-comes-here>
              -----END CERTIFICATE-----
            cn: server.example.com
            enabled: false
            force_update: false
            key: |
              -----BEGIN PRIVATE KEY-----
              <private-key-data-comes-here>
              -----END PRIVATE KEY-----
            secret_name: weka-home-ingress-cert-secret
        ssl_redirect: false
        subdomain_prefixes:
          api: ""
          frontend: ""
          nextFrontend: next.home.
          remote_access: terminal.home.
          remote_access_ssh: terminal-ssh.home.
          remote_access_wss: terminal-wss.home.
          stats: ""
        use_subdomains: false
      is_offline: true
      k8s_object_prefix: ""
      keep_secrets_on_uninstall: true
      liveness_probe:
        enable: true
      metrics:
        enable_push_metrics: false
        enabled: true
        port: 9187
        push_gateway_host: prometheus-pushgateway.monitoring-system.svc.cluster.local
        push_gateway_port: 9091
        push_interval_seconds: 15
      persistence:
        DBstorageClass: local-path
      postgres_sslmode: false
      postgresql:
        postgresqlDatabase: postgres
      service_type: NodePort
      serviceMonitor:
        enabled: false
        namespace: monitoring
      statistics:
        database:
          force_update: true
          secret_name: weka-home-stats-db-credentials
      support_files:
        bucket_name: ""
        hostPath: /opt/local-path-provisioner
        path: /support-file-uploads
        persistence:
          enabled: true
          storageClass: local-path
        size: 15Gi
        storage_provider: filesystem
      use_embedded_db: true
    hostNetwork: false
    image:
      pullPolicy: IfNotPresent
      repository: k8s.gcr.io/kube-state-metrics/kube-state-metrics
      tag: v2.4.1
    imagePullSecrets: []
    kubeTargetVersionOverride: ""
    kubeconfig:
      enabled: false
    metricAllowlist: []
    metricAnnotationsAllowList: []
    metricDenylist: []
    metricLabelsAllowlist: []
    namespaceOverride: ""
    namespaces: ""
    namespacesDenylist: ""
    nodeSelector: {}
    podAnnotations: {}
    podDisruptionBudget: {}
    podSecurityPolicy:
      additionalVolumes: []
      annotations: {}
      enabled: false
    prometheus:
      monitor:
        additionalLabels: {}
        enabled: false
        honorLabels: false
        interval: ""
        jobLabel: ""
        metricRelabelings: []
        namespace: ""
        proxyUrl: ""
        relabelings: []
        scrapeTimeout: ""
        selectorOverride: {}
    prometheusScrape: true
    rbac:
      create: true
      useClusterRole: true
    releaseLabel: false
    replicas: 1
    resources: {}
    securityContext:
      enabled: true
      fsGroup: 65534
      runAsGroup: 65534
      runAsUser: 65534
    selfMonitor:
      enabled: false
    service:
      annotations: {}
      clusterIP: ""
      loadBalancerIP: ""
      nodePort: 0
      port: 8080
      type: ClusterIP
    serviceAccount:
      annotations: {}
      create: true
      imagePullSecrets: []
    tolerations: []
  kubeStateMetrics:
    enabled: true
  networkPolicy:
    enabled: false
  nodeExporter:
    container:
      securityContext:
        allowPrivilegeEscalation: false
    dnsConfig: {}
    enabled: true
    extraArgs: {}
    extraConfigmapMounts: []
    extraHostPathMounts: []
    extraInitContainers: []
    hostNetwork: true
    hostPID: true
    hostRootfs: true
    image:
      pullPolicy: Never
      repository: quay.io/prometheus/node-exporter
      tag: v1.3.0
    name: node-exporter
    nodeSelector: {}
    pod:
      labels: {}
    podAnnotations: {}
    podDisruptionBudget:
      enabled: false
      maxUnavailable: 1
    podSecurityPolicy:
      annotations: {}
    priorityClassName: ""
    resources: {}
    securityContext:
      fsGroup: 65534
      runAsGroup: 65534
      runAsNonRoot: true
      runAsUser: 65534
    service:
      annotations:
        prometheus.io/scrape: "true"
      clusterIP: None
      externalIPs: []
      hostPort: 9100
      labels: {}
      loadBalancerIP: ""
      loadBalancerSourceRanges: []
      servicePort: 9100
      type: ClusterIP
    tolerations: []
    updateStrategy:
      type: RollingUpdate
  podLabels:
    app.group: common
  podSecurityPolicy:
    enabled: false
  pushgateway:
    deploymentAnnotations: {}
    dnsConfig: {}
    enabled: true
    extraArgs: {}
    extraInitContainers: []
    image:
      pullPolicy: Never
      repository: prom/pushgateway
      tag: v1.4.2
    ingress:
      annotations: {}
      enabled: false
      extraPaths: []
      hosts: []
      path: /
      pathType: Prefix
      tls: []
    name: pushgateway
    nodeSelector: {}
    persistentVolume:
      accessModes:
      - ReadWriteOnce
      annotations: {}
      enabled: false
      existingClaim: ""
      mountPath: /data
      size: 2Gi
      storageClass: local-path
      subPath: ""
    podAnnotations: {}
    podDisruptionBudget:
      enabled: false
      maxUnavailable: 1
    podLabels: {}
    podSecurityPolicy:
      annotations: {}
    priorityClassName: ""
    replicaCount: 1
    resources: {}
    securityContext:
      runAsNonRoot: true
      runAsUser: 65534
    service:
      annotations:
        prometheus.io/probe: pushgateway
      clusterIP: ""
      externalIPs: []
      labels: {}
      loadBalancerIP: ""
      loadBalancerSourceRanges: []
      servicePort: 9091
      type: ClusterIP
    tolerations: []
    verticalAutoscaler:
      enabled: false
  rbac:
    create: true
  ruleFiles: {}
  server:
    affinity: {}
    alertmanagers: []
    baseURL: ""
    configMapOverrideName: ""
    configPath: /etc/config/prometheus.yml
    defaultFlagsOverride: []
    deploymentAnnotations: {}
    dnsConfig: {}
    dnsPolicy: ClusterFirst
    emptyDir:
      sizeLimit: ""
    enableServiceLinks: true
    enabled: true
    env: []
    extraArgs: {}
    extraConfigmapMounts: []
    extraFlags:
    - web.enable-lifecycle
    extraHostPathMounts: []
    extraInitContainers: []
    extraObjects: []
    extraSecretMounts: []
    extraVolumeMounts: []
    extraVolumes: []
    global:
      evaluation_interval: 1m
      scrape_interval: 1m
      scrape_timeout: 10s
    hostAliases: []
    hostNetwork: false
    image:
      pullPolicy: Never
      repository: quay.io/prometheus/prometheus
      tag: v2.34.0
    ingress:
      annotations: {}
      enabled: false
      extraLabels: {}
      extraPaths: []
      hosts: []
      path: /
      pathType: Prefix
      tls: []
    livenessProbeFailureThreshold: 3
    livenessProbeInitialDelay: 30
    livenessProbePeriodSeconds: 15
    livenessProbeSuccessThreshold: 1
    livenessProbeTimeout: 10
    name: server
    nodeSelector: {}
    persistentVolume:
      accessModes:
      - ReadWriteOnce
      annotations: {}
      enabled: true
      existingClaim: ""
      mountPath: /data
      size: 8Gi
      storageClass: local-path
      subPath: ""
    podAnnotations: {}
    podDisruptionBudget:
      enabled: false
      maxUnavailable: 1
    podLabels: {}
    podSecurityPolicy:
      annotations: {}
    prefixURL: ""
    priorityClassName: ""
    probeHeaders: []
    probeScheme: HTTP
    readinessProbeFailureThreshold: 3
    readinessProbeInitialDelay: 30
    readinessProbePeriodSeconds: 5
    readinessProbeSuccessThreshold: 1
    readinessProbeTimeout: 4
    remoteRead: []
    remoteWrite: []
    replicaCount: 1
    resources: {}
    retention: 15d
    securityContext:
      fsGroup: 65534
      runAsGroup: 65534
      runAsNonRoot: true
      runAsUser: 65534
    service:
      annotations: {}
      clusterIP: ""
      enabled: true
      externalIPs: []
      gRPC:
        enabled: false
        servicePort: 10901
      labels: {}
      loadBalancerIP: ""
      loadBalancerSourceRanges: []
      servicePort: 80
      sessionAffinity: None
      statefulsetReplica:
        enabled: false
        replica: 0
      type: ClusterIP
    sidecarContainers: {}
    sidecarTemplateValues: {}
    startupProbe:
      enabled: false
      failureThreshold: 30
      periodSeconds: 5
      timeoutSeconds: 10
    statefulSet:
      annotations: {}
      enabled: false
      headless:
        annotations: {}
        gRPC:
          enabled: false
          servicePort: 10901
        labels: {}
        servicePort: 80
      labels: {}
      podManagementPolicy: OrderedReady
    storagePath: ""
    tcpSocketProbeEnabled: false
    terminationGracePeriodSeconds: 300
    tolerations: []
    verticalAutoscaler:
      enabled: false
  serverFiles:
    alerting_rules.yml: {}
    alerts: {}
    prometheus.yml:
      rule_files:
      - /etc/config/recording_rules.yml
      - /etc/config/alerting_rules.yml
      - /etc/config/rules
      - /etc/config/alerts
      scrape_configs:
      - job_name: prometheus
        static_configs:
        - targets:
          - localhost:9090
      - bearer_token_file: /var/run/secrets/kubernetes.io/serviceaccount/token
        job_name: kubernetes-apiservers
        kubernetes_sd_configs:
        - role: endpoints
        relabel_configs:
        - action: keep
          regex: default;kubernetes;https
          source_labels:
          - __meta_kubernetes_namespace
          - __meta_kubernetes_service_name
          - __meta_kubernetes_endpoint_port_name
        scheme: https
        tls_config:
          ca_file: /var/run/secrets/kubernetes.io/serviceaccount/ca.crt
          insecure_skip_verify: true
      - bearer_token_file: /var/run/secrets/kubernetes.io/serviceaccount/token
        job_name: kubernetes-nodes
        kubernetes_sd_configs:
        - role: node
        relabel_configs:
        - action: labelmap
          regex: __meta_kubernetes_node_label_(.+)
        - replacement: kubernetes.default.svc:443
          target_label: __address__
        - regex: (.+)
          replacement: /api/v1/nodes/$1/proxy/metrics
          source_labels:
          - __meta_kubernetes_node_name
          target_label: __metrics_path__
        scheme: https
        tls_config:
          ca_file: /var/run/secrets/kubernetes.io/serviceaccount/ca.crt
          insecure_skip_verify: true
      - bearer_token_file: /var/run/secrets/kubernetes.io/serviceaccount/token
        job_name: kubernetes-nodes-cadvisor
        kubernetes_sd_configs:
        - role: node
        relabel_configs:
        - action: labelmap
          regex: __meta_kubernetes_node_label_(.+)
        - replacement: kubernetes.default.svc:443
          target_label: __address__
        - regex: (.+)
          replacement: /api/v1/nodes/$1/proxy/metrics/cadvisor
          source_labels:
          - __meta_kubernetes_node_name
          target_label: __metrics_path__
        scheme: https
        tls_config:
          ca_file: /var/run/secrets/kubernetes.io/serviceaccount/ca.crt
          insecure_skip_verify: true
      - honor_labels: true
        job_name: kubernetes-service-endpoints
        kubernetes_sd_configs:
        - role: endpoints
        relabel_configs:
        - action: keep
          regex: true
          source_labels:
          - __meta_kubernetes_service_annotation_prometheus_io_scrape
        - action: drop
          regex: true
          source_labels:
          - __meta_kubernetes_service_annotation_prometheus_io_scrape_slow
        - action: replace
          regex: (https?)
          source_labels:
          - __meta_kubernetes_service_annotation_prometheus_io_scheme
          target_label: __scheme__
        - action: replace
          regex: (.+)
          source_labels:
          - __meta_kubernetes_service_annotation_prometheus_io_path
          target_label: __metrics_path__
        - action: replace
          regex: ([^:]+)(?::\d+)?;(\d+)
          replacement: $1:$2
          source_labels:
          - __address__
          - __meta_kubernetes_service_annotation_prometheus_io_port
          target_label: __address__
        - action: labelmap
          regex: __meta_kubernetes_service_annotation_prometheus_io_param_(.+)
          replacement: __param_$1
        - action: labelmap
          regex: __meta_kubernetes_service_label_(.+)
        - action: replace
          source_labels:
          - __meta_kubernetes_namespace
          target_label: namespace
        - action: replace
          source_labels:
          - __meta_kubernetes_service_name
          target_label: service
        - action: replace
          source_labels:
          - __meta_kubernetes_pod_node_name
          target_label: node
      - honor_labels: true
        job_name: kubernetes-service-endpoints-slow
        kubernetes_sd_configs:
        - role: endpoints
        relabel_configs:
        - action: keep
          regex: true
          source_labels:
          - __meta_kubernetes_service_annotation_prometheus_io_scrape_slow
        - action: replace
          regex: (https?)
          source_labels:
          - __meta_kubernetes_service_annotation_prometheus_io_scheme
          target_label: __scheme__
        - action: replace
          regex: (.+)
          source_labels:
          - __meta_kubernetes_service_annotation_prometheus_io_path
          target_label: __metrics_path__
        - action: replace
          regex: ([^:]+)(?::\d+)?;(\d+)
          replacement: $1:$2
          source_labels:
          - __address__
          - __meta_kubernetes_service_annotation_prometheus_io_port
          target_label: __address__
        - action: labelmap
          regex: __meta_kubernetes_service_annotation_prometheus_io_param_(.+)
          replacement: __param_$1
        - action: labelmap
          regex: __meta_kubernetes_service_label_(.+)
        - action: replace
          source_labels:
          - __meta_kubernetes_namespace
          target_label: namespace
        - action: replace
          source_labels:
          - __meta_kubernetes_service_name
          target_label: service
        - action: replace
          source_labels:
          - __meta_kubernetes_pod_node_name
          target_label: node
        scrape_interval: 5m
        scrape_timeout: 30s
      - honor_labels: true
        job_name: prometheus-pushgateway
        kubernetes_sd_configs:
        - role: service
        relabel_configs:
        - action: keep
          regex: pushgateway
          source_labels:
          - __meta_kubernetes_service_annotation_prometheus_io_probe
      - honor_labels: true
        job_name: kubernetes-services
        kubernetes_sd_configs:
        - role: service
        metrics_path: /probe
        params:
          module:
          - http_2xx
        relabel_configs:
        - action: keep
          regex: true
          source_labels:
          - __meta_kubernetes_service_annotation_prometheus_io_probe
        - source_labels:
          - __address__
          target_label: __param_target
        - replacement: blackbox
          target_label: __address__
        - source_labels:
          - __param_target
          target_label: instance
        - action: labelmap
          regex: __meta_kubernetes_service_label_(.+)
        - source_labels:
          - __meta_kubernetes_namespace
          target_label: namespace
        - source_labels:
          - __meta_kubernetes_service_name
          target_label: service
      - honor_labels: true
        job_name: kubernetes-pods
        kubernetes_sd_configs:
        - role: pod
        relabel_configs:
        - action: keep
          regex: true
          source_labels:
          - __meta_kubernetes_pod_annotation_prometheus_io_scrape
        - action: drop
          regex: true
          source_labels:
          - __meta_kubernetes_pod_annotation_prometheus_io_scrape_slow
        - action: replace
          regex: (https?)
          source_labels:
          - __meta_kubernetes_pod_annotation_prometheus_io_scheme
          target_label: __scheme__
        - action: replace
          regex: (.+)
          source_labels:
          - __meta_kubernetes_pod_annotation_prometheus_io_path
          target_label: __metrics_path__
        - action: replace
          regex: ([^:]+)(?::\d+)?;(\d+)
          replacement: $1:$2
          source_labels:
          - __address__
          - __meta_kubernetes_pod_annotation_prometheus_io_port
          target_label: __address__
        - action: labelmap
          regex: __meta_kubernetes_pod_annotation_prometheus_io_param_(.+)
          replacement: __param_$1
        - action: labelmap
          regex: __meta_kubernetes_pod_label_(.+)
        - action: replace
          source_labels:
          - __meta_kubernetes_namespace
          target_label: namespace
        - action: replace
          source_labels:
          - __meta_kubernetes_pod_name
          target_label: pod
        - action: drop
          regex: Pending|Succeeded|Failed|Completed
          source_labels:
          - __meta_kubernetes_pod_phase
      - honor_labels: true
        job_name: kubernetes-pods-slow
        kubernetes_sd_configs:
        - role: pod
        relabel_configs:
        - action: keep
          regex: true
          source_labels:
          - __meta_kubernetes_pod_annotation_prometheus_io_scrape_slow
        - action: replace
          regex: (https?)
          source_labels:
          - __meta_kubernetes_pod_annotation_prometheus_io_scheme
          target_label: __scheme__
        - action: replace
          regex: (.+)
          source_labels:
          - __meta_kubernetes_pod_annotation_prometheus_io_path
          target_label: __metrics_path__
        - action: replace
          regex: ([^:]+)(?::\d+)?;(\d+)
          replacement: $1:$2
          source_labels:
          - __address__
          - __meta_kubernetes_pod_annotation_prometheus_io_port
          target_label: __address__
        - action: labelmap
          regex: __meta_kubernetes_pod_annotation_prometheus_io_param_(.+)
          replacement: __param_$1
        - action: labelmap
          regex: __meta_kubernetes_pod_label_(.+)
        - action: replace
          source_labels:
          - __meta_kubernetes_namespace
          target_label: namespace
        - action: replace
          source_labels:
          - __meta_kubernetes_pod_name
          target_label: pod
        - action: drop
          regex: Pending|Succeeded|Failed|Completed
          source_labels:
          - __meta_kubernetes_pod_phase
        scrape_interval: 5m
        scrape_timeout: 30s
    recording_rules.yml: {}
    rules: {}
  serviceAccounts:
    alertmanager:
      annotations: {}
      create: true
    nodeExporter:
      annotations: {}
      create: true
    pushgateway:
      annotations: {}
      create: true
    server:
      annotations: {}
      create: true
remote_access:
  api_keys:
    erl_cookie: ""
    hmac_key: ""
    mailgun_api_key: ""
    secret_key_base: ""
    secret_name: homewekaio-secret-remote-access-api-keys
    wsapi_key: ""
  enable_web_access: true
  enabled: false
  ingress:
    annotations: {}
    domain: ""
    enabled: true
    name: weka-home-remote-access-ingress
  master:
    image: public.ecr.aws/weka/tmate-master:weka
    mail_from_address: ""
    pg_poolsize: 10
    port: 4000
    replica_count: 2
    resources:
      limits:
        cpu: 200m
        memory: 300Mi
      requests:
        cpu: 200m
        memory: 300Mi
    service:
      annotations: {}
      type: NodePort
  settings:
    kill_expired_sessions: true
    kill_unknown_sessions: false
  ssh_keys:
    secret_name: homewekaio-secret-remote-access-ssh-keys
  ssh_server:
    image: public.ecr.aws/weka/tmate-ssh-server:weka
    replica_count: 3
    resources:
      limits:
        cpu: 100m
        memory: 200Mi
      requests:
        cpu: 100m
        memory: 200Mi
    service:
      annotations: {}
      type: LoadBalancer
  use_proxy_protocol: false
  websocket:
    image: public.ecr.aws/weka/tmate-websocket:weka
    resources:
      limits:
        cpu: 200m
        memory: 500Mi
      requests:
        cpu: 200m
        memory: 500Mi
    service:
      annotations: {}
      type: NodePort
    webhooks:
      retry_count: 3
      retry_interval: 10
  whitelisted_cidrs: []
remote_access_db:
  audit:
    clientMinMessages: error
    logConnections: false
    logDisconnections: false
    logHostname: false
    logLinePrefix: ""
    logTimezone: ""
    pgAuditLog: ""
    pgAuditLogCatalog: "off"
  common:
    exampleValue: common-chart
    global:
      annotations:
        prometheus.io/path: /metrics
        prometheus.io/scrape: "true"
      app_name: home-weka-io
      cluster_domain_suffix: cluster.local
      database:
        events:
          databases: []
          db_template:
            database: weka_events
            force_update: false
            hostname: ""
            password: ""
            port: 5432
            secret_name_template: weka-home-event-db-credentials-
            username: weka_home
          num_event_stores: 1
        main:
          database: weka_home
          force_update: false
          hostname: ""
          password: ""
          port: 5432
          secret_name: weka-home-main-db-credentials
          username: weka_home
        readonly:
          use_main: true
        remote_access:
          database: tmate
          force_update: false
          hostname: ""
          password: ""
          port: 5432
          secret_name: weka-home-remote-access-db-credentials
          username: tmate
        support:
          database: weka_support
          force_update: false
          hostname: ""
          password: ""
          port: 5432
          secret_name: weka-home-support-db-credentials
          username: weka_home
      debug_pod:
        enable: true
        image: gohome-debug-pod:d48067c1d33c0f7f1b895211850fdfdd
        imagePullPolicy: Never
        priorityClassName: ""
      imagePullSecrets: []
      imageRegistry: ""
      ingress:
        additional_fqdns:
          api: []
          frontend: []
          frontendV2: []
          stats: []
        annotations:
          kubernetes.io/ingress.class: nginx
          nginx.ingress.kubernetes.io/backend-protocol: http
          nginx.ingress.kubernetes.io/enable-access-log: "true"
          nginx.ingress.kubernetes.io/enable-cors: "true"
          nginx.ingress.kubernetes.io/enable-modsecurity: "true"
          nginx.ingress.kubernetes.io/enable-owasp-core-rules: "true"
          nginx.ingress.kubernetes.io/proxy-body-size: 1000m
          nginx.ingress.kubernetes.io/proxy-buffering: "off"
          nginx.ingress.kubernetes.io/ssl-redirect: "false"
          nginx.ingress.kubernetes.io/use-regex: "true"
        domain: 10.108.170.142
        enabled: true
        name: weka-home-ingress
        nginx:
          tls:
            cert: |
              -----BEGIN CERTIFICATE-----
              <cert-data-comes-here>
              -----END CERTIFICATE-----
            cn: server.example.com
            enabled: false
            force_update: false
            key: |
              -----BEGIN PRIVATE KEY-----
              <private-key-data-comes-here>
              -----END PRIVATE KEY-----
            secret_name: weka-home-ingress-cert-secret
        ssl_redirect: false
        subdomain_prefixes:
          api: ""
          frontend: ""
          nextFrontend: next.home.
          remote_access: terminal.home.
          remote_access_ssh: terminal-ssh.home.
          remote_access_wss: terminal-wss.home.
          stats: ""
        use_subdomains: false
      is_offline: true
      k8s_object_prefix: ""
      keep_secrets_on_uninstall: true
      liveness_probe:
        enable: true
      metrics:
        enable_push_metrics: false
        enabled: true
        port: 9187
        push_gateway_host: prometheus-pushgateway.monitoring-system.svc.cluster.local
        push_gateway_port: 9091
        push_interval_seconds: 15
      persistence:
        DBstorageClass: local-path
      postgres_sslmode: false
      postgresql:
        existingSecret: ""
        postgresqlDatabase: postgres
        postgresqlPassword: ""
        postgresqlUsername: ""
        replicationPassword: ""
        servicePort: ""
      service_type: NodePort
      serviceMonitor:
        enabled: false
        namespace: monitoring
      statistics:
        database:
          force_update: true
          secret_name: weka-home-stats-db-credentials
      storageClass: ""
      support_files:
        bucket_name: ""
        hostPath: /opt/local-path-provisioner
        path: /support-file-uploads
        persistence:
          enabled: true
          storageClass: local-path
        size: 15Gi
        storage_provider: filesystem
      use_embedded_db: true
  commonAnnotations: {}
  commonLabels:
    app.group: common
  configurationConfigMap: ""
  containerPorts:
    postgresql: 5432
  containerSecurityContext:
    enabled: true
    runAsUser: 1001
  customLivenessProbe: {}
  customReadinessProbe: {}
  customStartupProbe: {}
  diagnosticMode:
    args:
    - infinity
    command:
    - sleep
    enabled: false
  enabled: false
  existingSecret: weka-home-remote-access-db-credentials
  extendedConfConfigMap: ""
  extraDeploy: []
  extraEnv: []
  extraEnvVarsCM: ""
  fullnameOverride: ""
  global:
    annotations:
      prometheus.io/path: /metrics
      prometheus.io/scrape: "true"
    app_name: home-weka-io
    cluster_domain_suffix: cluster.local
    database:
      events:
        databases: []
        db_template:
          database: weka_events
          force_update: false
          hostname: ""
          password: ""
          port: 5432
          secret_name_template: weka-home-event-db-credentials-
          username: weka_home
        num_event_stores: 1
      main:
        database: weka_home
        force_update: false
        hostname: ""
        password: ""
        port: 5432
        secret_name: weka-home-main-db-credentials
        username: weka_home
      readonly:
        use_main: true
      remote_access:
        database: tmate
        force_update: false
        hostname: ""
        password: ""
        port: 5432
        secret_name: weka-home-remote-access-db-credentials
        username: tmate
      support:
        database: weka_support
        force_update: false
        hostname: ""
        password: ""
        port: 5432
        secret_name: weka-home-support-db-credentials
        username: weka_home
    debug_pod:
      enable: true
      image: gohome-debug-pod:d48067c1d33c0f7f1b895211850fdfdd
      imagePullPolicy: Never
      priorityClassName: ""
    imagePullSecrets: []
    imageRegistry: ""
    ingress:
      additional_fqdns:
        api: []
        frontend: []
        frontendV2: []
        stats: []
      annotations:
        kubernetes.io/ingress.class: nginx
        nginx.ingress.kubernetes.io/backend-protocol: http
        nginx.ingress.kubernetes.io/enable-access-log: "true"
        nginx.ingress.kubernetes.io/enable-cors: "true"
        nginx.ingress.kubernetes.io/enable-modsecurity: "true"
        nginx.ingress.kubernetes.io/enable-owasp-core-rules: "true"
        nginx.ingress.kubernetes.io/proxy-body-size: 1000m
        nginx.ingress.kubernetes.io/proxy-buffering: "off"
        nginx.ingress.kubernetes.io/ssl-redirect: "false"
        nginx.ingress.kubernetes.io/use-regex: "true"
      domain: 10.108.170.142
      enabled: true
      name: weka-home-ingress
      nginx:
        tls:
          cert: |
            -----BEGIN CERTIFICATE-----
            <cert-data-comes-here>
            -----END CERTIFICATE-----
          cn: server.example.com
          enabled: false
          force_update: false
          key: |
            -----BEGIN PRIVATE KEY-----
            <private-key-data-comes-here>
            -----END PRIVATE KEY-----
          secret_name: weka-home-ingress-cert-secret
      ssl_redirect: false
      subdomain_prefixes:
        api: ""
        frontend: ""
        nextFrontend: next.home.
        remote_access: terminal.home.
        remote_access_ssh: terminal-ssh.home.
        remote_access_wss: terminal-wss.home.
        stats: ""
      use_subdomains: false
    is_offline: true
    k8s_object_prefix: ""
    keep_secrets_on_uninstall: true
    liveness_probe:
      enable: true
    metrics:
      enable_push_metrics: false
      enabled: true
      port: 9187
      push_gateway_host: prometheus-pushgateway.monitoring-system.svc.cluster.local
      push_gateway_port: 9091
      push_interval_seconds: 15
    persistence:
      DBstorageClass: local-path
    postgres_sslmode: false
    postgresql:
      existingSecret: ""
      postgresqlDatabase: postgres
      postgresqlPassword: ""
      postgresqlUsername: ""
      replicationPassword: ""
      servicePort: ""
    service_type: NodePort
    serviceMonitor:
      enabled: false
      namespace: monitoring
    statistics:
      database:
        force_update: true
        secret_name: weka-home-stats-db-credentials
    storageClass: ""
    support_files:
      bucket_name: ""
      hostPath: /opt/local-path-provisioner
      path: /support-file-uploads
      persistence:
        enabled: true
        storageClass: local-path
      size: 15Gi
      storage_provider: filesystem
    use_embedded_db: true
  image:
    debug: true
    pullPolicy: Never
    pullSecrets: []
    registry: docker.io
    repository: bitnami/postgresql
    tag: 11.14.0-debian-10-r21
  initdbPassword: ""
  initdbScripts: {}
  initdbScriptsConfigMap: remote-access-db-init-configmap
  initdbScriptsSecret: ""
  initdbUser: postgres
  ldap:
    baseDN: ""
    bind_password: ""
    bindDN: ""
    enabled: false
    port: ""
    prefix: ""
    scheme: ""
    search_attr: ""
    search_filter: ""
    server: ""
    suffix: ""
    tls: ""
    url: ""
  lifecycleHooks: {}
  livenessProbe:
    enabled: true
    failureThreshold: 6
    initialDelaySeconds: 30
    periodSeconds: 10
    successThreshold: 1
    timeoutSeconds: 5
  metrics:
    customMetrics: {}
    enabled: true
    extraEnvVars: []
    image:
      pullPolicy: IfNotPresent
      pullSecrets: []
      registry: docker.io
      repository: bitnami/postgres-exporter
      tag: 0.10.0-debian-10-r166
    livenessProbe:
      enabled: true
      failureThreshold: 6
      initialDelaySeconds: 5
      periodSeconds: 10
      successThreshold: 1
      timeoutSeconds: 5
    prometheusRule:
      additionalLabels: {}
      enabled: false
      namespace: ""
      rules: []
    readinessProbe:
      enabled: true
      failureThreshold: 6
      initialDelaySeconds: 5
      periodSeconds: 10
      successThreshold: 1
      timeoutSeconds: 5
    resources: {}
    securityContext:
      enabled: false
      runAsUser: 1001
    service:
      annotations:
        prometheus.io/port: "9187"
        prometheus.io/scrape: "true"
      loadBalancerIP: ""
      type: ClusterIP
    serviceMonitor:
      additionalLabels: {}
      enabled: false
      interval: ""
      metricRelabelings: []
      namespace: monitoring
      relabelings: []
      scrapeTimeout: ""
  nameOverride: remote-access-db
  networkPolicy:
    allowExternal: true
    enabled: false
    explicitNamespacesSelector: {}
  persistence:
    accessModes:
    - ReadWriteOnce
    annotations: {}
    enabled: true
    existingClaim: ""
    mountPath: /bitnami/postgresql
    selector: {}
    size: 100Gi
    storageClass: local-path
    subPath: ""
  pgHbaConfiguration: ""
  postgresqlConfiguration: {}
  postgresqlDataDir: /bitnami/postgresql/data
  postgresqlDatabase: ""
  postgresqlDbUserConnectionLimit: ""
  postgresqlExtendedConf: {}
  postgresqlInitdbArgs: ""
  postgresqlInitdbWalDir: ""
  postgresqlMaxConnections: ""
  postgresqlPassword: ""
  postgresqlPghbaRemoveFilters: ""
  postgresqlPostgresConnectionLimit: ""
  postgresqlPostgresPassword: ""
  postgresqlSharedPreloadLibraries: pgaudit
  postgresqlStatementTimeout: ""
  postgresqlTcpKeepalivesCount: ""
  postgresqlTcpKeepalivesIdle: ""
  postgresqlTcpKeepalivesInterval: ""
  postgresqlUsername: postgres
  primary:
    affinity: {}
    annotations: {}
    extraInitContainers: []
    extraPodSpec: {}
    extraVolumeMounts: []
    extraVolumes: []
    labels: {}
    nodeAffinityPreset:
      key: ""
      type: ""
      values: []
    nodeSelector: {}
    podAffinityPreset: ""
    podAnnotations: {}
    podAntiAffinityPreset: soft
    podLabels: {}
    priorityClassName: ""
    service:
      clusterIP: ""
      nodePort: ""
      type: ""
    sidecars: []
    tolerations: []
  primaryAsStandBy:
    enabled: false
    primaryHost: ""
    primaryPort: ""
  psp:
    create: false
  rbac:
    create: false
  readReplicas:
    affinity: {}
    annotations: {}
    extraInitContainers: []
    extraPodSpec: {}
    extraVolumeMounts: []
    extraVolumes: []
    labels: {}
    nodeAffinityPreset:
      key: ""
      type: ""
      values: []
    nodeSelector: {}
    persistence:
      enabled: true
    podAffinityPreset: ""
    podAnnotations: {}
    podAntiAffinityPreset: soft
    podLabels: {}
    priorityClassName: ""
    resources: {}
    service:
      clusterIP: ""
      nodePort: ""
      type: ""
    sidecars: []
    tolerations: []
    topologySpreadConstraints: []
  readinessProbe:
    enabled: true
    failureThreshold: 6
    initialDelaySeconds: 5
    periodSeconds: 10
    successThreshold: 1
    timeoutSeconds: 5
  replication:
    applicationName: my_application
    enabled: false
    numSynchronousReplicas: 0
    password: repl_password
    readReplicas: 1
    singleService: true
    synchronousCommit: "off"
    uniqueServices: false
    user: repl_user
  resources:
    limits:
      cpu: 200m
      memory: 200Mi
    requests:
      cpu: 200m
      memory: 200Mi
  schedulerName: ""
  securityContext:
    enabled: true
    fsGroup: 1001
  service:
    annotations: {}
    clusterIP: ""
    externalTrafficPolicy: Cluster
    loadBalancerIP: ""
    loadBalancerSourceRanges: []
    nodePort: ""
    port: 5432
    type: ClusterIP
  serviceAccount:
    autoMount: false
    enabled: false
    name: ""
  shmVolume:
    chmod:
      enabled: true
    enabled: true
    sizeLimit: ""
  startupProbe:
    enabled: true
    failureThreshold: 10
    initialDelaySeconds: 30
    periodSeconds: 15
    successThreshold: 1
    timeoutSeconds: 5
  terminationGracePeriodSeconds: ""
  tls:
    autoGenerated: false
    certCAFilename: ""
    certFilename: ""
    certKeyFilename: ""
    certificatesSecret: ""
    crlFilename: ""
    enabled: false
    preferServerCiphers: true
  updateStrategy:
    type: RollingUpdate
  usePasswordFile: false
  volumePermissions:
    enabled: false
    image:
      pullPolicy: IfNotPresent
      pullSecrets: []
      registry: docker.io
      repository: bitnami/bitnami-shell
      tag: 10-debian-10-r299
    securityContext:
      runAsUser: 0
smtp_user_data:
  sender_email: weka-home-noreply@weka.io
  sender_email_name: Weka Home
  smtp_host: ""
  smtp_insecure_tls: false
  smtp_password: ""
  smtp_port: ""
  smtp_username: ""
statistics:
  autoscaling:
    enabled: true
    maxReplicas: 10
    minReplicas: 1
    targetCPUUtilizationPercentage: 70
    targetMemoryUtilizationPercentage: 80
  enabled: true
  nodeSelector: {}
  priorityClassName: ""
  replica_count: 2
  resources:
    limits:
      cpu: 250m
      memory: 250Mi
    requests:
      cpu: 250m
      memory: 250Mi
  settings:
    concurrent_stats_uploads: -1
    queue_timeout: 60s
    upload_strategy: push-to-stream
stats_worker:
  autoscaling:
    enabled: true
    maxReplicas: 20
    minReplicas: 1
    targetCPUUtilizationPercentage: 80
    targetMemoryUtilizationPercentage: 80
  enabled: true
  nodeSelector: {}
  priorityClassName: ""
  replica_count: 1
  resources:
    limits:
      cpu: 1000m
      memory: 1000Mi
    requests:
      cpu: 1000m
      memory: 1000Mi
  settings:
    concurrent_stats_uploads: 8
    upload_strategy: push-to-vm
statsdb:
  clusterDomainSuffix: cluster.local
  extraSecrets: []
  global:
    annotations:
      prometheus.io/path: /metrics
      prometheus.io/scrape: "true"
    app_name: home-weka-io
    cluster_domain_suffix: cluster.local
    database:
      events:
        databases: []
        db_template:
          database: weka_events
          force_update: false
          hostname: ""
          password: ""
          port: 5432
          secret_name_template: weka-home-event-db-credentials-
          username: weka_home
        num_event_stores: 1
      main:
        database: weka_home
        force_update: false
        hostname: ""
        password: ""
        port: 5432
        secret_name: weka-home-main-db-credentials
        username: weka_home
      readonly:
        use_main: true
      remote_access:
        database: tmate
        force_update: false
        hostname: ""
        password: ""
        port: 5432
        secret_name: weka-home-remote-access-db-credentials
        username: tmate
      support:
        database: weka_support
        force_update: false
        hostname: ""
        password: ""
        port: 5432
        secret_name: weka-home-support-db-credentials
        username: weka_home
    debug_pod:
      enable: true
      image: gohome-debug-pod:d48067c1d33c0f7f1b895211850fdfdd
      imagePullPolicy: Never
      priorityClassName: ""
    ingress:
      additional_fqdns:
        api: []
        frontend: []
        frontendV2: []
        stats: []
      annotations:
        kubernetes.io/ingress.class: nginx
        nginx.ingress.kubernetes.io/backend-protocol: http
        nginx.ingress.kubernetes.io/enable-access-log: "true"
        nginx.ingress.kubernetes.io/enable-cors: "true"
        nginx.ingress.kubernetes.io/enable-modsecurity: "true"
        nginx.ingress.kubernetes.io/enable-owasp-core-rules: "true"
        nginx.ingress.kubernetes.io/proxy-body-size: 1000m
        nginx.ingress.kubernetes.io/proxy-buffering: "off"
        nginx.ingress.kubernetes.io/ssl-redirect: "false"
        nginx.ingress.kubernetes.io/use-regex: "true"
      domain: 10.108.170.142
      enabled: true
      name: weka-home-ingress
      nginx:
        tls:
          cert: |
            -----BEGIN CERTIFICATE-----
            <cert-data-comes-here>
            -----END CERTIFICATE-----
          cn: server.example.com
          enabled: false
          force_update: false
          key: |
            -----BEGIN PRIVATE KEY-----
            <private-key-data-comes-here>
            -----END PRIVATE KEY-----
          secret_name: weka-home-ingress-cert-secret
      ssl_redirect: false
      subdomain_prefixes:
        api: ""
        frontend: ""
        nextFrontend: next.home.
        remote_access: terminal.home.
        remote_access_ssh: terminal-ssh.home.
        remote_access_wss: terminal-wss.home.
        stats: ""
      use_subdomains: false
    is_offline: true
    k8s_object_prefix: ""
    keep_secrets_on_uninstall: true
    liveness_probe:
      enable: true
    metrics:
      enable_push_metrics: false
      enabled: true
      port: 9187
      push_gateway_host: prometheus-pushgateway.monitoring-system.svc.cluster.local
      push_gateway_port: 9091
      push_interval_seconds: 15
    persistence:
      DBstorageClass: local-path
    postgres_sslmode: false
    postgresql:
      postgresqlDatabase: postgres
    service_type: NodePort
    serviceMonitor:
      enabled: false
      namespace: monitoring
    statistics:
      database:
        force_update: true
        secret_name: weka-home-stats-db-credentials
    support_files:
      bucket_name: ""
      hostPath: /opt/local-path-provisioner
      path: /support-file-uploads
      persistence:
        enabled: true
        storageClass: local-path
      size: 15Gi
      storage_provider: filesystem
    use_embedded_db: true
  printNotes: true
  rbac:
    create: true
    extraLabels: {}
    namespaced: false
    pspEnabled: true
  serviceAccount:
    automountToken: true
    create: true
    extraLabels: {}
  vminsert:
    affinity: {}
    annotations: {}
    automountServiceAccountToken: true
    autoscaling:
      enabled: true
      maxReplicas: 5
      minReplicas: 1
      targetCPUUtilizationPercentage: 70
      targetMemoryUtilizationPercentage: 80
    containerWorkingDir: ""
    enabled: true
    env: []
    extraArgs:
      envflag.enable: "true"
      envflag.prefix: VM_
      loggerFormat: json
    extraLabels:
      app.group: hpa
    fullnameOverride: ""
    horizontalPodAutoscaler:
      enabled: false
      maxReplicas: 10
      metrics: []
      minReplicas: 2
    image:
      pullPolicy: Never
      repository: victoriametrics/vminsert
      tag: v1.64.0-cluster
    ingress:
      annotations: {}
      enabled: false
      extraLabels: {}
      hosts: []
      tls: []
    initContainers: []
    name: vminsert
    nodeSelector: {}
    podAnnotations:
      prometheus.io/path: /metrics
      prometheus.io/scrape: "true"
    podDisruptionBudget:
      enabled: false
      labels: {}
    podSecurityContext: {}
    priorityClassName: ""
    probe:
      liveness:
        failureThreshold: 3
        initialDelaySeconds: 5
        periodSeconds: 15
        timeoutSeconds: 5
      readiness:
        failureThreshold: 3
        initialDelaySeconds: 5
        periodSeconds: 15
        timeoutSeconds: 5
    replica_count: 2
    replicaCount: 2
    resources:
      limits:
        cpu: 250m
        memory: 500Mi
      requests:
        cpu: 250m
        memory: 500Mi
    securityContext: {}
    service:
      annotations: {}
      clusterIP: ""
      externalIPs: []
      labels: {}
      loadBalancerIP: ""
      loadBalancerSourceRanges: []
      servicePort: 8480
      type: ClusterIP
    serviceMonitor:
      annotations: {}
      enabled: false
      extraLabels: {}
      namespace: monitoring
    suppresStorageFQDNsRender: false
    tolerations: []
  vmselect:
    affinity: {}
    annotations: {}
    automountServiceAccountToken: true
    cacheMountPath: /cache
    containerWorkingDir: ""
    enabled: true
    env: []
    extraArgs:
      envflag.enable: "true"
      envflag.prefix: VM_
      loggerFormat: json
    extraContainers: []
    extraHostPathMounts: []
    extraLabels:
      app.group: common
    extraVolumeMounts: []
    extraVolumes: []
    fullnameOverride: ""
    horizontalPodAutoscaler:
      enabled: false
      maxReplicas: 10
      metrics: []
      minReplicas: 2
    image:
      pullPolicy: Never
      repository: victoriametrics/vmselect
      tag: v1.64.0-cluster
    ingress:
      annotations: {}
      enabled: false
      extraLabels: {}
      hosts: []
      tls: []
    initContainers: []
    name: vmselect
    nodeSelector: {}
    persistentVolume:
      accessModes:
      - ReadWriteOnce
      annotations: {}
      enabled: true
      existingClaim: ""
      size: 1Gi
      storageClass: local-path
      subPath: ""
    podAnnotations:
      prometheus.io/path: /metrics
      prometheus.io/scrape: "true"
    podDisruptionBudget:
      enabled: false
      labels: {}
    podSecurityContext: {}
    priorityClassName: ""
    probe:
      liveness:
        failureThreshold: 3
        initialDelaySeconds: 5
        periodSeconds: 15
        timeoutSeconds: 5
      readiness:
        failureThreshold: 3
        initialDelaySeconds: 5
        periodSeconds: 15
        timeoutSeconds: 5
    replica_count: 2
    replicaCount: 2
    resources:
      limits:
        cpu: 200m
        memory: 500Mi
      requests:
        cpu: 200m
        memory: 500Mi
    securityContext: {}
    service:
      annotations: {}
      clusterIP: ""
      externalIPs: []
      labels: {}
      loadBalancerIP: ""
      loadBalancerSourceRanges: []
      servicePort: 8481
      type: ClusterIP
    serviceMonitor:
      annotations: {}
      enabled: false
      extraLabels: {}
      namespace: monitoring
    statefulSet:
      enabled: true
      podManagementPolicy: OrderedReady
      service:
        annotations: {}
        labels: {}
        servicePort: 8481
    suppresStorageFQDNsRender: false
    tolerations: []
  vmstorage:
    affinity: {}
    annotations: {}
    automountServiceAccountToken: true
    containerWorkingDir: ""
    enabled: true
    env: []
    extraArgs:
      envflag.enable: "true"
      envflag.prefix: VM_
      loggerFormat: json
      search.maxUniqueTimeseries: "10000000"
    extraContainers: []
    extraHostPathMounts: []
    extraLabels:
      app.group: common
    extraVolumeMounts: []
    extraVolumes: []
    image:
      pullPolicy: Never
      repository: victoriametrics/vmstorage
      tag: v1.64.0-cluster
    initContainers: []
    name: vmstorage
    nodeSelector: {}
    persistentVolume:
      accessModes:
      - ReadWriteOnce
      annotations: {}
      enabled: true
      existingClaim: ""
      mountPath: /storage
      size: 100Gi
      storageClass: local-path
      subPath: ""
    podAnnotations:
      prometheus.io/path: /metrics
      prometheus.io/scrape: "true"
    podDisruptionBudget:
      enabled: false
      labels: {}
    podManagementPolicy: OrderedReady
    podSecurityContext: {}
    priorityClassName: ""
    probe:
      liveness:
        failureThreshold: 10
        initialDelaySeconds: 30
        periodSeconds: 30
        tcpSocket:
          port: http
        timeoutSeconds: 5
      readiness:
        failureThreshold: 3
        httpGet:
          path: /health
          port: http
        initialDelaySeconds: 5
        periodSeconds: 15
        timeoutSeconds: 5
    replica_count: 3
    replicaCount: 3
    resources:
      limits:
        cpu: 500m
        memory: 2Gi
      requests:
        cpu: 500m
        memory: 2Gi
    retentionPeriod: 7d
    securityContext: {}
    service:
      annotations: {}
      labels: {}
      servicePort: 8482
      vminsertPort: 8400
      vmselectPort: 8401
    serviceMonitor:
      annotations: {}
      enabled: false
      extraLabels: {}
      namespace: monitoring
    terminationGracePeriodSeconds: 60
    tolerations: []
    vmbackupmanager:
      destination: ""
      disableDaily: false
      disableHourly: false
      disableMonthly: false
      disableWeekly: false
      enable: false
      env: []
      eula: false
      extraArgs:
        envflag.enable: "true"
        envflag.prefix: VM_
        loggerFormat: json
      image:
        repository: victoriametrics/vmbackupmanager
        tag: v1.64.0-enterprise
      livenessProbe:
        failureThreshold: 10
        initialDelaySeconds: 30
        periodSeconds: 30
        tcpSocket:
          port: manager-http
        timeoutSeconds: 5
      readinessProbe:
        failureThreshold: 3
        httpGet:
          path: /health
          port: manager-http
        initialDelaySeconds: 5
        periodSeconds: 15
        timeoutSeconds: 5
      resources: {}
      retention:
        keepLastDaily: 2
        keepLastHourly: 2
        keepLastMonthly: 2
        keepLastWeekly: 2
support_db:
  audit:
    clientMinMessages: error
    logConnections: false
    logDisconnections: false
    logHostname: false
    logLinePrefix: ""
    logTimezone: ""
    pgAuditLog: ""
    pgAuditLogCatalog: "off"
  common:
    exampleValue: common-chart
    global:
      annotations:
        prometheus.io/path: /metrics
        prometheus.io/scrape: "true"
      app_name: home-weka-io
      cluster_domain_suffix: cluster.local
      database:
        events:
          databases: []
          db_template:
            database: weka_events
            force_update: false
            hostname: ""
            password: ""
            port: 5432
            secret_name_template: weka-home-event-db-credentials-
            username: weka_home
          num_event_stores: 1
        main:
          database: weka_home
          force_update: false
          hostname: ""
          password: ""
          port: 5432
          secret_name: weka-home-main-db-credentials
          username: weka_home
        readonly:
          use_main: true
        remote_access:
          database: tmate
          force_update: false
          hostname: ""
          password: ""
          port: 5432
          secret_name: weka-home-remote-access-db-credentials
          username: tmate
        support:
          database: weka_support
          force_update: false
          hostname: ""
          password: ""
          port: 5432
          secret_name: weka-home-support-db-credentials
          username: weka_home
      debug_pod:
        enable: true
        image: gohome-debug-pod:d48067c1d33c0f7f1b895211850fdfdd
        imagePullPolicy: Never
        priorityClassName: ""
      imagePullSecrets: []
      imageRegistry: ""
      ingress:
        additional_fqdns:
          api: []
          frontend: []
          frontendV2: []
          stats: []
        annotations:
          kubernetes.io/ingress.class: nginx
          nginx.ingress.kubernetes.io/backend-protocol: http
          nginx.ingress.kubernetes.io/enable-access-log: "true"
          nginx.ingress.kubernetes.io/enable-cors: "true"
          nginx.ingress.kubernetes.io/enable-modsecurity: "true"
          nginx.ingress.kubernetes.io/enable-owasp-core-rules: "true"
          nginx.ingress.kubernetes.io/proxy-body-size: 1000m
          nginx.ingress.kubernetes.io/proxy-buffering: "off"
          nginx.ingress.kubernetes.io/ssl-redirect: "false"
          nginx.ingress.kubernetes.io/use-regex: "true"
        domain: 10.108.170.142
        enabled: true
        name: weka-home-ingress
        nginx:
          tls:
            cert: |
              -----BEGIN CERTIFICATE-----
              <cert-data-comes-here>
              -----END CERTIFICATE-----
            cn: server.example.com
            enabled: false
            force_update: false
            key: |
              -----BEGIN PRIVATE KEY-----
              <private-key-data-comes-here>
              -----END PRIVATE KEY-----
            secret_name: weka-home-ingress-cert-secret
        ssl_redirect: false
        subdomain_prefixes:
          api: ""
          frontend: ""
          nextFrontend: next.home.
          remote_access: terminal.home.
          remote_access_ssh: terminal-ssh.home.
          remote_access_wss: terminal-wss.home.
          stats: ""
        use_subdomains: false
      is_offline: true
      k8s_object_prefix: ""
      keep_secrets_on_uninstall: true
      liveness_probe:
        enable: true
      metrics:
        enable_push_metrics: false
        enabled: true
        port: 9187
        push_gateway_host: prometheus-pushgateway.monitoring-system.svc.cluster.local
        push_gateway_port: 9091
        push_interval_seconds: 15
      persistence:
        DBstorageClass: local-path
      postgres_sslmode: false
      postgresql:
        existingSecret: ""
        postgresqlDatabase: postgres
        postgresqlPassword: ""
        postgresqlUsername: ""
        replicationPassword: ""
        servicePort: ""
      service_type: NodePort
      serviceMonitor:
        enabled: false
        namespace: monitoring
      statistics:
        database:
          force_update: true
          secret_name: weka-home-stats-db-credentials
      storageClass: ""
      support_files:
        bucket_name: ""
        hostPath: /opt/local-path-provisioner
        path: /support-file-uploads
        persistence:
          enabled: true
          storageClass: local-path
        size: 15Gi
        storage_provider: filesystem
      use_embedded_db: true
  commonAnnotations: {}
  commonLabels:
    app.group: common
  configurationConfigMap: ""
  containerPorts:
    postgresql: 5432
  containerSecurityContext:
    enabled: true
    runAsUser: 1001
  customLivenessProbe: {}
  customReadinessProbe: {}
  customStartupProbe: {}
  diagnosticMode:
    args:
    - infinity
    command:
    - sleep
    enabled: false
  existingSecret: weka-home-support-db-credentials
  extendedConfConfigMap: ""
  extraDeploy: []
  extraEnv: []
  extraEnvVarsCM: ""
  fullnameOverride: ""
  global:
    annotations:
      prometheus.io/path: /metrics
      prometheus.io/scrape: "true"
    app_name: home-weka-io
    cluster_domain_suffix: cluster.local
    database:
      events:
        databases: []
        db_template:
          database: weka_events
          force_update: false
          hostname: ""
          password: ""
          port: 5432
          secret_name_template: weka-home-event-db-credentials-
          username: weka_home
        num_event_stores: 1
      main:
        database: weka_home
        force_update: false
        hostname: ""
        password: ""
        port: 5432
        secret_name: weka-home-main-db-credentials
        username: weka_home
      readonly:
        use_main: true
      remote_access:
        database: tmate
        force_update: false
        hostname: ""
        password: ""
        port: 5432
        secret_name: weka-home-remote-access-db-credentials
        username: tmate
      support:
        database: weka_support
        force_update: false
        hostname: ""
        password: ""
        port: 5432
        secret_name: weka-home-support-db-credentials
        username: weka_home
    debug_pod:
      enable: true
      image: gohome-debug-pod:d48067c1d33c0f7f1b895211850fdfdd
      imagePullPolicy: Never
      priorityClassName: ""
    imagePullSecrets: []
    imageRegistry: ""
    ingress:
      additional_fqdns:
        api: []
        frontend: []
        frontendV2: []
        stats: []
      annotations:
        kubernetes.io/ingress.class: nginx
        nginx.ingress.kubernetes.io/backend-protocol: http
        nginx.ingress.kubernetes.io/enable-access-log: "true"
        nginx.ingress.kubernetes.io/enable-cors: "true"
        nginx.ingress.kubernetes.io/enable-modsecurity: "true"
        nginx.ingress.kubernetes.io/enable-owasp-core-rules: "true"
        nginx.ingress.kubernetes.io/proxy-body-size: 1000m
        nginx.ingress.kubernetes.io/proxy-buffering: "off"
        nginx.ingress.kubernetes.io/ssl-redirect: "false"
        nginx.ingress.kubernetes.io/use-regex: "true"
      domain: 10.108.170.142
      enabled: true
      name: weka-home-ingress
      nginx:
        tls:
          cert: |
            -----BEGIN CERTIFICATE-----
            <cert-data-comes-here>
            -----END CERTIFICATE-----
          cn: server.example.com
          enabled: false
          force_update: false
          key: |
            -----BEGIN PRIVATE KEY-----
            <private-key-data-comes-here>
            -----END PRIVATE KEY-----
          secret_name: weka-home-ingress-cert-secret
      ssl_redirect: false
      subdomain_prefixes:
        api: ""
        frontend: ""
        nextFrontend: next.home.
        remote_access: terminal.home.
        remote_access_ssh: terminal-ssh.home.
        remote_access_wss: terminal-wss.home.
        stats: ""
      use_subdomains: false
    is_offline: true
    k8s_object_prefix: ""
    keep_secrets_on_uninstall: true
    liveness_probe:
      enable: true
    metrics:
      enable_push_metrics: false
      enabled: true
      port: 9187
      push_gateway_host: prometheus-pushgateway.monitoring-system.svc.cluster.local
      push_gateway_port: 9091
      push_interval_seconds: 15
    persistence:
      DBstorageClass: local-path
    postgres_sslmode: false
    postgresql:
      existingSecret: ""
      postgresqlDatabase: postgres
      postgresqlPassword: ""
      postgresqlUsername: ""
      replicationPassword: ""
      servicePort: ""
    service_type: NodePort
    serviceMonitor:
      enabled: false
      namespace: monitoring
    statistics:
      database:
        force_update: true
        secret_name: weka-home-stats-db-credentials
    storageClass: ""
    support_files:
      bucket_name: ""
      hostPath: /opt/local-path-provisioner
      path: /support-file-uploads
      persistence:
        enabled: true
        storageClass: local-path
      size: 15Gi
      storage_provider: filesystem
    use_embedded_db: true
  image:
    debug: false
    pullPolicy: Never
    pullSecrets: []
    registry: docker.io
    repository: bitnami/postgresql
    tag: 11.14.0-debian-10-r21
  initdbPassword: ""
  initdbScripts: {}
  initdbScriptsConfigMap: support-db-init-configmap
  initdbScriptsSecret: ""
  initdbUser: postgres
  ldap:
    baseDN: ""
    bind_password: ""
    bindDN: ""
    enabled: false
    port: ""
    prefix: ""
    scheme: ""
    search_attr: ""
    search_filter: ""
    server: ""
    suffix: ""
    tls: ""
    url: ""
  lifecycleHooks: {}
  livenessProbe:
    enabled: true
    failureThreshold: 6
    initialDelaySeconds: 30
    periodSeconds: 10
    successThreshold: 1
    timeoutSeconds: 5
  metrics:
    customMetrics: {}
    enabled: true
    extraEnvVars: []
    image:
      pullPolicy: IfNotPresent
      pullSecrets: []
      registry: docker.io
      repository: bitnami/postgres-exporter
      tag: 0.10.0-debian-10-r166
    livenessProbe:
      enabled: true
      failureThreshold: 6
      initialDelaySeconds: 5
      periodSeconds: 10
      successThreshold: 1
      timeoutSeconds: 5
    prometheusRule:
      additionalLabels: {}
      enabled: false
      namespace: ""
      rules: []
    readinessProbe:
      enabled: true
      failureThreshold: 6
      initialDelaySeconds: 5
      periodSeconds: 10
      successThreshold: 1
      timeoutSeconds: 5
    resources: {}
    securityContext:
      enabled: false
      runAsUser: 1001
    service:
      annotations:
        prometheus.io/port: "9187"
        prometheus.io/scrape: "true"
      loadBalancerIP: ""
      type: ClusterIP
    serviceMonitor:
      additionalLabels: {}
      enabled: false
      interval: ""
      metricRelabelings: []
      namespace: monitoring
      relabelings: []
      scrapeTimeout: ""
  nameOverride: support-db
  networkPolicy:
    allowExternal: true
    enabled: false
    explicitNamespacesSelector: {}
  persistence:
    accessModes:
    - ReadWriteOnce
    annotations: {}
    enabled: true
    existingClaim: ""
    mountPath: /bitnami/postgresql
    selector: {}
    size: 100Gi
    storageClass: local-path
    subPath: ""
  pgHbaConfiguration: ""
  postgresqlConfiguration: {}
  postgresqlDataDir: /bitnami/postgresql/data
  postgresqlDatabase: ""
  postgresqlDbUserConnectionLimit: ""
  postgresqlExtendedConf: {}
  postgresqlInitdbArgs: ""
  postgresqlInitdbWalDir: ""
  postgresqlMaxConnections: ""
  postgresqlPassword: ""
  postgresqlPghbaRemoveFilters: ""
  postgresqlPostgresConnectionLimit: ""
  postgresqlPostgresPassword: ""
  postgresqlSharedPreloadLibraries: pgaudit
  postgresqlStatementTimeout: ""
  postgresqlTcpKeepalivesCount: ""
  postgresqlTcpKeepalivesIdle: ""
  postgresqlTcpKeepalivesInterval: ""
  postgresqlUsername: postgres
  primary:
    affinity: {}
    annotations: {}
    extraInitContainers: []
    extraPodSpec: {}
    extraVolumeMounts: []
    extraVolumes: []
    labels: {}
    nodeAffinityPreset:
      key: ""
      type: ""
      values: []
    nodeSelector: {}
    podAffinityPreset: ""
    podAnnotations: {}
    podAntiAffinityPreset: soft
    podLabels: {}
    priorityClassName: ""
    service:
      clusterIP: ""
      nodePort: ""
      type: ""
    sidecars: []
    tolerations: []
  primaryAsStandBy:
    enabled: false
    primaryHost: ""
    primaryPort: ""
  psp:
    create: false
  rbac:
    create: false
  readReplicas:
    affinity: {}
    annotations: {}
    extraInitContainers: []
    extraPodSpec: {}
    extraVolumeMounts: []
    extraVolumes: []
    labels: {}
    nodeAffinityPreset:
      key: ""
      type: ""
      values: []
    nodeSelector: {}
    persistence:
      enabled: true
    podAffinityPreset: ""
    podAnnotations: {}
    podAntiAffinityPreset: soft
    podLabels: {}
    priorityClassName: ""
    resources: {}
    service:
      clusterIP: ""
      nodePort: ""
      type: ""
    sidecars: []
    tolerations: []
    topologySpreadConstraints: []
  readinessProbe:
    enabled: true
    failureThreshold: 6
    initialDelaySeconds: 5
    periodSeconds: 10
    successThreshold: 1
    timeoutSeconds: 5
  replication:
    applicationName: my_application
    enabled: false
    numSynchronousReplicas: 0
    password: repl_password
    readReplicas: 1
    singleService: true
    synchronousCommit: "off"
    uniqueServices: false
    user: repl_user
  resources:
    limits:
      cpu: 200m
      memory: 200Mi
    requests:
      cpu: 200m
      memory: 200Mi
  schedulerName: ""
  securityContext:
    enabled: true
    fsGroup: 1001
  service:
    annotations: {}
    clusterIP: ""
    externalTrafficPolicy: Cluster
    loadBalancerIP: ""
    loadBalancerSourceRanges: []
    nodePort: ""
    port: 5432
    type: ClusterIP
  serviceAccount:
    autoMount: false
    enabled: false
    name: ""
  shmVolume:
    chmod:
      enabled: true
    enabled: true
    sizeLimit: ""
  startupProbe:
    enabled: true
    failureThreshold: 10
    initialDelaySeconds: 30
    periodSeconds: 15
    successThreshold: 1
    timeoutSeconds: 5
  support_file_db_pool_size: 8
  terminationGracePeriodSeconds: ""
  tls:
    autoGenerated: false
    certCAFilename: ""
    certFilename: ""
    certKeyFilename: ""
    certificatesSecret: ""
    crlFilename: ""
    enabled: false
    preferServerCiphers: true
  updateStrategy:
    type: RollingUpdate
  usePasswordFile: false
  volumePermissions:
    enabled: false
    image:
      pullPolicy: IfNotPresent
      pullSecrets: []
      registry: docker.io
      repository: bitnami/bitnami-shell
      tag: 10-debian-10-r299
    securityContext:
      runAsUser: 0
tags:
  embedded_db: true

HOOKS:
---
# Source: home-weka-io/charts/nats/templates/tests/test-request-reply.yaml
apiVersion: v1
kind: Pod
metadata:
  name: "nats-test-request-reply"
  labels:
    chart: nats-0.19.13
    app: nats-test-request-reply
  annotations:
    "helm.sh/hook": test
spec:
  containers:
  - name: nats-box
    image: natsio/nats-box:0.13.8
    env:
    - name: NATS_HOST
      value: nats
    command:
    - /bin/sh
    - -ec
    - |
      nats reply -s nats://$NATS_HOST:4222 'name.>' --command "echo 1" &
    - |
      "&&"
    - |
      name=$(nats request -s nats://$NATS_HOST:4222 name.test '' 2>/dev/null)
    - |
      "&&"
    - |
      [ $name = test ]

  restartPolicy: Never
---
# Source: home-weka-io/templates/job-db-migrator.yaml
apiVersion: batch/v1
kind: Job
metadata:
  name: db-migrator
  labels:
    app.kubernetes.io/name: db-migrator
    app.kubernetes.io/instance: "homewekaio"
    app: db-migrator
  annotations:
    "helm.sh/hook": pre-upgrade
spec:
  ttlSecondsAfterFinished: 60
  backoffLimit: 10
  template:
    metadata:
      labels:
        app: db-migrator
        app.kubernetes.io/name: db-migrator
        app.kubernetes.io/instance: "homewekaio"
    spec:
      serviceAccountName: home-weka-io-serviceaccount
      restartPolicy: OnFailure
      containers:
        - name: db-migrate
          image: gohome:33414c551ec9939d784e308cab53a45f
          imagePullPolicy: Never
          resources:
            limits:
              cpu: 200m
              memory: 250Mi
            requests:
              cpu: 200m
              memory: 250Mi
          command:
            - ./wekahome
            - migrate
          env:
            - name: IS_OFFLINE
              value: "true"
            - name: GOHOME_API_BIND_TO
              value: ""
            - name: LOG_LEVEL
              value: INFO
            - name: PORT
              value: "8000"
            - name: MAIN_DB_POOL_SIZE
              value: "8"
            - name: SUPPORT_FILE_DB_POOL_SIZE
              value: "8"
            - name: EVENT_STORE_DB_POOL_SIZE
              value: "8"
            - name: FILTER_HTTP_REQUESTS_USER_AGENT_LOGGING
              value: "kube-probe/1.23"
            - name: NATS_URL
              value: "nats://nats:4222"
            - name: LIVENESS_PROBE_ENABLED
              value: "1"
            - name: SUPPORT_FILES_PATH
              value: /support-file-uploads
            - name: EMAIL_LINK_DOMAIN_NAME
              value: 10.108.170.142
            - name: EMAIL_LINK_DOMAIN_PROTOCOL
              value: http
            - name: METRICS_PORT
              value: "9187"
            - name: FORWARDING_ENABLED
              value: "false"
            - name: FORWARDING_URL
              value: https://api.home.weka.io
            - name: FORWARDING_CLUSTER_REGISTRATION_ENABLED
              value: "true"
            - name: FORWARDING_EVENTS_ENABLED
              value: "true"
            - name: FORWARDING_USAGE_REPORT_ENABLED
              value: "true"
            - name: FORWARDING_ANALYTICS_ENABLED
              value: "true"
            - name: FORWARDING_DIAGNOSTICS_ENABLED
              value: "true"
            - name: FORWARDING_STATS_ENABLED
              value: "true"
            - name: FORWARDING_BULK_SIZE
              value: "50"
            # ------------- START DB connectivity ---------------- #
            # USING MAIN DB WITHOUT READONLY REPLICAS
            - name: MAIN_DB_HOSTNAME
              valueFrom:
                secretKeyRef:
                  name: weka-home-main-db-credentials
                  key: hostname
            - name: READONLY_DB_HOSTNAME
              valueFrom:
                secretKeyRef:
                  name: weka-home-main-db-credentials
                  key: hostname
            - name: SUPPORT_DB_HOSTNAME
              valueFrom:
                secretKeyRef:
                  name: weka-home-support-db-credentials
                  key: hostname
            - name: MAIN_DB_PORT
              valueFrom:
                secretKeyRef:
                  name: weka-home-main-db-credentials
                  key: port
            - name: READONLY_DB_PORT
              valueFrom:
                secretKeyRef:
                  name: weka-home-main-db-credentials
                  key: port
            - name: SUPPORT_DB_PORT
              valueFrom:
                secretKeyRef:
                  name: weka-home-support-db-credentials
                  key: port
            - name: MAIN_DB_USERNAME
              valueFrom:
                secretKeyRef:
                  name: weka-home-main-db-credentials
                  key: username
            - name: READONLY_DB_USERNAME
              valueFrom:
                secretKeyRef:
                  name: weka-home-main-db-credentials
                  key: username
            - name: SUPPORT_DB_USERNAME
              valueFrom:
                secretKeyRef:
                  name: weka-home-support-db-credentials
                  key: username
            - name: MAIN_DB_PASSWORD
              valueFrom:
                secretKeyRef:
                  name: weka-home-main-db-credentials
                  key: password
            - name: READONLY_DB_PASSWORD
              valueFrom:
                secretKeyRef:
                  name: weka-home-main-db-credentials
                  key: password
            - name: SUPPORT_DB_PASSWORD
              valueFrom:
                secretKeyRef:
                  name: weka-home-support-db-credentials
                  key: password
            - name: MAIN_DB_DATABASE
              valueFrom:
                secretKeyRef:
                  name: weka-home-main-db-credentials
                  key: database
            - name: READONLY_DB_DATABASE
              valueFrom:
                secretKeyRef:
                  name: weka-home-main-db-credentials
                  key: database
            - name: SUPPORT_DB_DATABASE
              valueFrom:
                secretKeyRef:
                  name: weka-home-support-db-credentials
                  key: database
            - name: NUM_EVENT_STORES
              value: "1"
            - name: EVENT_STORE_0_HOSTNAME
              valueFrom:
                secretKeyRef:
                  name: weka-home-event-db-credentials-0
                  key: hostname
            - name: EVENT_STORE_0_PORT
              valueFrom:
                secretKeyRef:
                  name: weka-home-event-db-credentials-0
                  key: port
            - name: EVENT_STORE_0_USERNAME
              valueFrom:
                secretKeyRef:
                  name: weka-home-event-db-credentials-0
                  key: username
            - name: EVENT_STORE_0_PASSWORD
              valueFrom:
                secretKeyRef:
                  name: weka-home-event-db-credentials-0
                  key: password
            - name: EVENT_STORE_0_DATABASE
              valueFrom:
                secretKeyRef:
                  name: weka-home-event-db-credentials-0
                  key: database
            
            - name: DATABASE_URL
              value: "postgres://$(MAIN_DB_USERNAME):$(MAIN_DB_PASSWORD)@$(MAIN_DB_HOSTNAME):$(MAIN_DB_PORT)/$(MAIN_DB_DATABASE)?sslmode=disable"

            - name: RO_DATABASE_URL
              value: "postgres://$(READONLY_DB_USERNAME):$(READONLY_DB_PASSWORD)@$(READONLY_DB_HOSTNAME):$(READONLY_DB_PORT)/$(READONLY_DB_DATABASE)?sslmode=disable"
            - name: SUPPORT_FILES_DATABASE_URL
              value: "postgres://$(SUPPORT_DB_USERNAME):$(SUPPORT_DB_PASSWORD)@$(SUPPORT_DB_HOSTNAME):$(SUPPORT_DB_PORT)/$(SUPPORT_DB_DATABASE)?sslmode=disable"
            - name: EVENT_STORE_0_URL
              value: "postgres://$(EVENT_STORE_0_USERNAME):$(EVENT_STORE_0_PASSWORD)@$(EVENT_STORE_0_HOSTNAME):$(EVENT_STORE_0_PORT)/$(EVENT_STORE_0_DATABASE)?sslmode=disable"
            # ------------- END DB connectivity ---------------- #
            # ------------- START STATS DB connectivity ----------- #
            - name: STATS_STORE_URL
              valueFrom:
                secretKeyRef:
                  name: weka-home-stats-db-credentials
                  key: stats_store_url
            - name: STATS_STORE_QUERY_URL
              valueFrom:
                secretKeyRef:
                  name: weka-home-stats-db-credentials
                  key: stats_store_query_url
            - name: NUM_STATS_STORES
              value: "1"
            # ------------- END STATS DB connectivity ----------- #
            - name: ADMIN_USERNAME
              valueFrom:
                secretKeyRef:
                    name: weka-home-admin-credentials
                    key: admin_username
            - name: ADMIN_PASSWORD
              valueFrom:
                secretKeyRef:
                    name: weka-home-admin-credentials
                    key: admin_password
---
# Source: home-weka-io/templates/job-db-preseed.yaml
apiVersion: batch/v1
kind: Job
metadata:
  name: db-preseed
  labels:
    app.kubernetes.io/name: db-preseed
    app.kubernetes.io/instance: "homewekaio"
    app: db-preseed
  annotations:
    "helm.sh/hook": post-install
    "helm.sh/hook-delete-policy": hook-succeeded
spec:
  ttlSecondsAfterFinished: 60
  backoffLimit: 10
  template:
    metadata:
      labels:
        app: db-preseed
        app.kubernetes.io/name: db-preseed
        app.kubernetes.io/instance: "homewekaio"
    spec:
      serviceAccountName: home-weka-io-serviceaccount
      restartPolicy: OnFailure
      containers:
        - name: db-migrate
          image: gohome:33414c551ec9939d784e308cab53a45f
          imagePullPolicy: Never
          resources:
            limits:
              cpu: 200m
              memory: 250Mi
            requests:
              cpu: 200m
              memory: 250Mi
          command:
            - ./wekahome
            - migrate
          env:
            - name: IS_OFFLINE
              value: "true"
            - name: GOHOME_API_BIND_TO
              value: ""
            - name: LOG_LEVEL
              value: INFO
            - name: PORT
              value: "8000"
            - name: MAIN_DB_POOL_SIZE
              value: "8"
            - name: SUPPORT_FILE_DB_POOL_SIZE
              value: "8"
            - name: EVENT_STORE_DB_POOL_SIZE
              value: "8"
            - name: FILTER_HTTP_REQUESTS_USER_AGENT_LOGGING
              value: "kube-probe/1.23"
            - name: NATS_URL
              value: "nats://nats:4222"
            - name: LIVENESS_PROBE_ENABLED
              value: "1"
            - name: SUPPORT_FILES_PATH
              value: /support-file-uploads
            - name: EMAIL_LINK_DOMAIN_NAME
              value: 10.108.170.142
            - name: EMAIL_LINK_DOMAIN_PROTOCOL
              value: http
            - name: METRICS_PORT
              value: "9187"
            - name: FORWARDING_ENABLED
              value: "false"
            - name: FORWARDING_URL
              value: https://api.home.weka.io
            - name: FORWARDING_CLUSTER_REGISTRATION_ENABLED
              value: "true"
            - name: FORWARDING_EVENTS_ENABLED
              value: "true"
            - name: FORWARDING_USAGE_REPORT_ENABLED
              value: "true"
            - name: FORWARDING_ANALYTICS_ENABLED
              value: "true"
            - name: FORWARDING_DIAGNOSTICS_ENABLED
              value: "true"
            - name: FORWARDING_STATS_ENABLED
              value: "true"
            - name: FORWARDING_BULK_SIZE
              value: "50"
            # ------------- START DB connectivity ---------------- #
            # USING MAIN DB WITHOUT READONLY REPLICAS
            - name: MAIN_DB_HOSTNAME
              valueFrom:
                secretKeyRef:
                  name: weka-home-main-db-credentials
                  key: hostname
            - name: READONLY_DB_HOSTNAME
              valueFrom:
                secretKeyRef:
                  name: weka-home-main-db-credentials
                  key: hostname
            - name: SUPPORT_DB_HOSTNAME
              valueFrom:
                secretKeyRef:
                  name: weka-home-support-db-credentials
                  key: hostname
            - name: MAIN_DB_PORT
              valueFrom:
                secretKeyRef:
                  name: weka-home-main-db-credentials
                  key: port
            - name: READONLY_DB_PORT
              valueFrom:
                secretKeyRef:
                  name: weka-home-main-db-credentials
                  key: port
            - name: SUPPORT_DB_PORT
              valueFrom:
                secretKeyRef:
                  name: weka-home-support-db-credentials
                  key: port
            - name: MAIN_DB_USERNAME
              valueFrom:
                secretKeyRef:
                  name: weka-home-main-db-credentials
                  key: username
            - name: READONLY_DB_USERNAME
              valueFrom:
                secretKeyRef:
                  name: weka-home-main-db-credentials
                  key: username
            - name: SUPPORT_DB_USERNAME
              valueFrom:
                secretKeyRef:
                  name: weka-home-support-db-credentials
                  key: username
            - name: MAIN_DB_PASSWORD
              valueFrom:
                secretKeyRef:
                  name: weka-home-main-db-credentials
                  key: password
            - name: READONLY_DB_PASSWORD
              valueFrom:
                secretKeyRef:
                  name: weka-home-main-db-credentials
                  key: password
            - name: SUPPORT_DB_PASSWORD
              valueFrom:
                secretKeyRef:
                  name: weka-home-support-db-credentials
                  key: password
            - name: MAIN_DB_DATABASE
              valueFrom:
                secretKeyRef:
                  name: weka-home-main-db-credentials
                  key: database
            - name: READONLY_DB_DATABASE
              valueFrom:
                secretKeyRef:
                  name: weka-home-main-db-credentials
                  key: database
            - name: SUPPORT_DB_DATABASE
              valueFrom:
                secretKeyRef:
                  name: weka-home-support-db-credentials
                  key: database
            - name: NUM_EVENT_STORES
              value: "1"
            - name: EVENT_STORE_0_HOSTNAME
              valueFrom:
                secretKeyRef:
                  name: weka-home-event-db-credentials-0
                  key: hostname
            - name: EVENT_STORE_0_PORT
              valueFrom:
                secretKeyRef:
                  name: weka-home-event-db-credentials-0
                  key: port
            - name: EVENT_STORE_0_USERNAME
              valueFrom:
                secretKeyRef:
                  name: weka-home-event-db-credentials-0
                  key: username
            - name: EVENT_STORE_0_PASSWORD
              valueFrom:
                secretKeyRef:
                  name: weka-home-event-db-credentials-0
                  key: password
            - name: EVENT_STORE_0_DATABASE
              valueFrom:
                secretKeyRef:
                  name: weka-home-event-db-credentials-0
                  key: database
            
            - name: DATABASE_URL
              value: "postgres://$(MAIN_DB_USERNAME):$(MAIN_DB_PASSWORD)@$(MAIN_DB_HOSTNAME):$(MAIN_DB_PORT)/$(MAIN_DB_DATABASE)?sslmode=disable"

            - name: RO_DATABASE_URL
              value: "postgres://$(READONLY_DB_USERNAME):$(READONLY_DB_PASSWORD)@$(READONLY_DB_HOSTNAME):$(READONLY_DB_PORT)/$(READONLY_DB_DATABASE)?sslmode=disable"
            - name: SUPPORT_FILES_DATABASE_URL
              value: "postgres://$(SUPPORT_DB_USERNAME):$(SUPPORT_DB_PASSWORD)@$(SUPPORT_DB_HOSTNAME):$(SUPPORT_DB_PORT)/$(SUPPORT_DB_DATABASE)?sslmode=disable"
            - name: EVENT_STORE_0_URL
              value: "postgres://$(EVENT_STORE_0_USERNAME):$(EVENT_STORE_0_PASSWORD)@$(EVENT_STORE_0_HOSTNAME):$(EVENT_STORE_0_PORT)/$(EVENT_STORE_0_DATABASE)?sslmode=disable"
            # ------------- END DB connectivity ---------------- #
            # ------------- START STATS DB connectivity ----------- #
            - name: STATS_STORE_URL
              valueFrom:
                secretKeyRef:
                  name: weka-home-stats-db-credentials
                  key: stats_store_url
            - name: STATS_STORE_QUERY_URL
              valueFrom:
                secretKeyRef:
                  name: weka-home-stats-db-credentials
                  key: stats_store_query_url
            - name: NUM_STATS_STORES
              value: "1"
            # ------------- END STATS DB connectivity ----------- #
            - name: ADMIN_USERNAME
              valueFrom:
                secretKeyRef:
                    name: weka-home-admin-credentials
                    key: admin_username
            - name: ADMIN_PASSWORD
              valueFrom:
                secretKeyRef:
                    name: weka-home-admin-credentials
                    key: admin_password
            - name: WEKA_SECRET_KEY
              valueFrom:
                secretKeyRef:
                    name: weka-home-encryption
                    key: encryption_secret_key
MANIFEST:
---
# Source: home-weka-io/charts/statsdb/templates/podsecuritypolicy.yaml
apiVersion: policy/v1beta1
kind: PodSecurityPolicy
metadata:
  name: homewekaio-statsdb
  namespace: home-weka-io
  labels:
    helm.sh/chart: statsdb-0.9.1
    app.kubernetes.io/managed-by: Helm
  annotations:
    seccomp.security.alpha.kubernetes.io/allowedProfileNames: 'docker/default'
    seccomp.security.alpha.kubernetes.io/defaultProfileName:  'docker/default'
spec:
  privileged: false
  allowPrivilegeEscalation: false
  requiredDropCapabilities:
    # Default set from Docker, with DAC_OVERRIDE and CHOWN
    - ALL
  volumes:
    - 'configMap'
    - 'emptyDir'
    - 'projected'
    - 'secret'
    - 'downwardAPI'
    - 'persistentVolumeClaim'
  hostNetwork: false
  hostIPC: false
  hostPID: false
  runAsUser:
    rule: 'RunAsAny'
  seLinux:
    rule: 'RunAsAny'
  supplementalGroups:
    rule: 'RunAsAny'
  fsGroup:
    rule: 'RunAsAny'
  readOnlyRootFilesystem: false
---
# Source: home-weka-io/charts/nats/templates/pdb.yaml
apiVersion: policy/v1
kind: PodDisruptionBudget
metadata:
  name: nats
  namespace: home-weka-io
  labels:
    helm.sh/chart: nats-0.19.13
    app.kubernetes.io/name: nats
    app.kubernetes.io/instance: homewekaio
    app.kubernetes.io/version: "2.9.16"
    app.kubernetes.io/managed-by: Helm
spec:
  maxUnavailable: 1
  selector:
    matchLabels:
      app.kubernetes.io/name: nats
      app.kubernetes.io/instance: homewekaio
---
# Source: home-weka-io/charts/grafana/templates/serviceaccount.yaml
apiVersion: v1
kind: ServiceAccount
metadata:
  name: homewekaio-grafana
  namespace: home-weka-io
  labels:
    app.kubernetes.io/name: grafana
    helm.sh/chart: grafana-7.6.1
    app.kubernetes.io/instance: homewekaio
    app.kubernetes.io/managed-by: Helm
    app.group: common
secrets:
  - name: homewekaio-grafana-admin
  - name: weka-home-grafana-datasources
automountServiceAccountToken: false
---
# Source: home-weka-io/charts/nack/templates/rbac-jetstream-controller.yml
apiVersion: v1
kind: ServiceAccount
metadata:
  name: jetstream-controller
  namespace: home-weka-io
---
# Source: home-weka-io/charts/nats/templates/rbac.yaml
apiVersion: v1
kind: ServiceAccount
metadata:
  name: nats
  namespace: home-weka-io
  labels:
    helm.sh/chart: nats-0.19.13
    app.kubernetes.io/name: nats
    app.kubernetes.io/instance: homewekaio
    app.kubernetes.io/version: "2.9.16"
    app.kubernetes.io/managed-by: Helm
---
# Source: home-weka-io/charts/prometheus/charts/kube-state-metrics/templates/serviceaccount.yaml
apiVersion: v1
kind: ServiceAccount
metadata:
  labels:    
    helm.sh/chart: kube-state-metrics-4.7.0
    app.kubernetes.io/managed-by: Helm
    app.kubernetes.io/component: metrics
    app.kubernetes.io/part-of: kube-state-metrics
    app.kubernetes.io/name: kube-state-metrics
    app.kubernetes.io/instance: homewekaio
    app.kubernetes.io/version: "2.4.1"
  name: homewekaio-kube-state-metrics
  namespace: home-weka-io
imagePullSecrets:
  []
---
# Source: home-weka-io/charts/prometheus/templates/alertmanager/serviceaccount.yaml
apiVersion: v1
kind: ServiceAccount
metadata:
  labels:
    component: "alertmanager"
    app: prometheus
    release: homewekaio
    chart: prometheus-15.8.6
    heritage: Helm
  name: homewekaio-prometheus-alertmanager
  namespace: home-weka-io
  annotations:
    {}
---
# Source: home-weka-io/charts/prometheus/templates/node-exporter/serviceaccount.yaml
apiVersion: v1
kind: ServiceAccount
metadata:
  labels:
    component: "node-exporter"
    app: prometheus
    release: homewekaio
    chart: prometheus-15.8.6
    heritage: Helm
  name: homewekaio-prometheus-node-exporter
  namespace: home-weka-io
  annotations:
    {}
---
# Source: home-weka-io/charts/prometheus/templates/pushgateway/serviceaccount.yaml
apiVersion: v1
kind: ServiceAccount
metadata:
  labels:
    component: "pushgateway"
    app: prometheus
    release: homewekaio
    chart: prometheus-15.8.6
    heritage: Helm
  name: homewekaio-prometheus-pushgateway
  namespace: home-weka-io
  annotations:
    {}
---
# Source: home-weka-io/charts/prometheus/templates/server/serviceaccount.yaml
apiVersion: v1
kind: ServiceAccount
metadata:
  labels:
    component: "server"
    app: prometheus
    release: homewekaio
    chart: prometheus-15.8.6
    heritage: Helm
  name: homewekaio-prometheus-server
  namespace: home-weka-io
  annotations:
    {}
---
# Source: home-weka-io/charts/statsdb/templates/serviceaccount.yaml
apiVersion: v1
kind: ServiceAccount
metadata:
  labels:
    helm.sh/chart: statsdb-0.9.1
    app.kubernetes.io/managed-by: Helm
  name: homewekaio-statsdb
  namespace: home-weka-io
---
# Source: home-weka-io/templates/serviceaccount.yaml
apiVersion: v1
kind: ServiceAccount
metadata:
  name: home-weka-io-serviceaccount
  namespace: home-weka-io
  labels:
    app: home-weka-io-serviceaccount
    app.kubernetes.io/name: home-weka-io-serviceaccount
    app.kubernetes.io/instance: "homewekaio"
---
# Source: home-weka-io/templates/encryption-secrets.yaml
# CREATING NEW SECRET
apiVersion: v1
kind: Secret
metadata:
  name: weka-home-encryption
  annotations:
    "helm.sh/resource-policy": keep
type: Opaque
data:
  encryption_secret_key: TXVwbjFua3ZWNk9Dc3ZwNDJMMmVERlo4eWR4WlVuZjJRUE40ZFUycWxabEpPTGYyY0JZenh4U0VpeTJBTkF4SA==
---
# Source: home-weka-io/templates/grafana-admin-secrets.yaml
apiVersion: v1
kind: Secret
metadata:
  name: weka-home-grafana-credentials
  annotations:
    "helm.sh/resource-policy": keep
type: Opaque
data:
  user: YWRtaW4=
  password: M3NudlRraVJrQg==
  api_url: aHR0cDovL2hvbWUtd2VrYS1pby1ncmFmYW5hLmhvbWUtd2VrYS1pby5zdmMuY2x1c3Rlci5sb2NhbDozMDAwL2FwaS8=
  grafana_api_dashboard_reload_url: aHR0cDovL2FkbWluOjNzbnZUa2lSa0JAMTI3LjAuMC4xOjMwMDAvYXBpL2FkbWluL3Byb3Zpc2lvbmluZy9kYXNoYm9hcmRzL3JlbG9hZA==
---
# Source: home-weka-io/templates/grafana-datasource-secrets.yaml
apiVersion: v1
kind: Secret
metadata:
  name: weka-home-grafana-datasources
type: Opaque
stringData:
  datasources.yaml: |
    apiVersion: 1
    datasources:
      - name: VictoriaMetrics
        uid: VictoriaMetrics_UID
        type: prometheus
        url: ${STATS_STORE_QUERY_URL}
        isDefault: true
        editable: false
        jsonData:
          timeInterval: 60
          manageAlerts: false

      - name: Prometheus
        uid: Prometheus_UID
        type: prometheus
        url: ${PROMETHEUS_QUERY_URL}
        access: proxy
        isDefault: false
        editable: false
        jsonData:
          timeInterval: 15
          manageAlerts: false

      - name: Postgres
        type: postgres
        url: ${MAIN_DB_HOSTNAME}:${MAIN_DB_PORT}
        user: ${MAIN_DB_USERNAME}
        secureJsonData:
          password: ${MAIN_DB_PASSWORD}
        jsonData:
          sslmode: "disable"
          maxOpenConns: 8
          maxIdleConns: 2
          connMaxLifetime: 600
          postgresVersion: 1000
          timescaledb: false
          manageAlerts: false
        database: ${MAIN_DB_DATABASE}
        editable: false
---
# Source: home-weka-io/templates/secrets-admin-credentials.yaml
# CREATING NEW ADMIN CREDENTIALS SECRET
apiVersion: v1
kind: Secret
metadata:
  name: weka-home-admin-credentials
  annotations:
    "helm.sh/resource-policy": keep
type: Opaque
data:
  admin_username: YWRtaW4=
  admin_password: WmF2enBDWUt6Sw==
---
# Source: home-weka-io/templates/secrets-database.yaml
# DATABASE SECRETS
apiVersion: v1
kind: Secret
metadata:
  name: weka-home-main-db-credentials
  annotations:
    "helm.sh/resource-policy": keep
type: Opaque
data:
  hostname: "aG9tZXdla2Fpby1tYWluLWRi"
  port: NTQzMg==
  postgresql-username: "d2VrYV9ob21l"
  username: "d2VrYV9ob21l"
  postgresql-password: "dUxjMTN6YzdkUA=="
  password: "dUxjMTN6YzdkUA=="
  postgresql-postgres-password: "dUxjMTN6YzdkUA=="
  database: "d2VrYV9ob21l"
---
# Source: home-weka-io/templates/secrets-database.yaml
apiVersion: v1
kind: Secret
metadata:
  name: weka-home-support-db-credentials
  annotations:
    "helm.sh/resource-policy": keep
type: Opaque
data:
  hostname: "aG9tZXdla2Fpby1zdXBwb3J0LWRi"
  port: NTQzMg==
  postgresql-username: "d2VrYV9ob21l"
  username: "d2VrYV9ob21l"
  postgresql-password: "M0NPaVljaWs3Qw=="
  password: "M0NPaVljaWs3Qw=="
  postgresql-postgres-password: "M0NPaVljaWs3Qw=="
  database: "d2VrYV9zdXBwb3J0"
---
# Source: home-weka-io/templates/secrets-event-database.yaml
apiVersion: v1
kind: Secret
metadata:
  name: weka-home-event-db-credentials-0
  annotations:
    "helm.sh/resource-policy": keep
type: Opaque
data:
  hostname: "aG9tZXdla2Fpby1ldmVudC1kYi0w"
  port: NTQzMg==
  username: "d2VrYV9ob21l"
  postgresql-username: "d2VrYV9ob21l"
  postgresql-password: "RERWcFZyWkhSTA=="
  postgresql-postgres-password: "RERWcFZyWkhSTA=="
  password: "RERWcFZyWkhSTA=="
  database: "d2VrYV9ldmVudHM="
---
# Source: home-weka-io/templates/secrets-grafana-webhook-credentials.yaml
# CREATING NEW CREDENTIALS SECRET
apiVersion: v1
kind: Secret
metadata:
  name: grafana-webhook
  annotations:
    "helm.sh/resource-policy": keep
type: Opaque
data:

  webhook_token: SW5MT2UxQnNlb2JNeDJITDRBQml1SjUwb2xLZEF4ZmlpUjZwOFIxWmpLblFONGZlSUU2UmdjQ3l2RVRUWG9XMA==
  webhook_url: aHR0cDovL2hvbWUtd2VrYS1pby1hcGkuaG9tZS13ZWthLWlvLnN2Yy5jbHVzdGVyLmxvY2FsOjgwMDAvYXBpL3Y0L2FsZXJ0cy9ncmFmYW5hLXdlYmhvb2s/dG9rZW49SW5MT2UxQnNlb2JNeDJITDRBQml1SjUwb2xLZEF4ZmlpUjZwOFIxWmpLblFONGZlSUU2UmdjQ3l2RVRUWG9XMA==
---
# Source: home-weka-io/templates/secrets-stats-database.yaml
# CREATING STATISTICS DATABASE SECRET
apiVersion: v1
kind: Secret
metadata:
  name: weka-home-stats-db-credentials
  annotations:
    "helm.sh/resource-policy": keep
type: Opaque
data:
  stats_store_url: "aHR0cDovL2hvbWV3ZWthaW8tc3RhdHNkYi12bWluc2VydC5ob21lLXdla2EtaW8uc3ZjLmNsdXN0ZXIubG9jYWw6ODQ4MC9pbnNlcnQvMC9wcm9tZXRoZXVzL2FwaS92MS9pbXBvcnQvcHJvbWV0aGV1cw=="
  stats_store_query_url: "aHR0cDovL2hvbWV3ZWthaW8tc3RhdHNkYi12bXNlbGVjdC5ob21lLXdla2EtaW8uc3ZjLmNsdXN0ZXIubG9jYWw6ODQ4MS9zZWxlY3QvMC9wcm9tZXRoZXVz"
  prometheus_query_url: "aHR0cDovL2hvbWV3ZWthaW8tcHJvbWV0aGV1cy1zZXJ2ZXIuaG9tZS13ZWthLWlvLnN2Yy5jbHVzdGVyLmxvY2Fs"
---
# Source: home-weka-io/charts/grafana/templates/configmap.yaml
apiVersion: v1
kind: ConfigMap
metadata:
  name: homewekaio-grafana-envvars
  namespace: home-weka-io
  labels:
    app.kubernetes.io/name: grafana
    helm.sh/chart: grafana-7.6.1
    app.kubernetes.io/instance: homewekaio
    app.kubernetes.io/managed-by: Helm
    app.group: common
    app.kubernetes.io/component: grafana
data:
  GF_SECURITY_ADMIN_USER: "admin"
  GF_INSTALL_PLUGINS: ""
  GF_PATHS_PLUGINS: "/opt/bitnami/grafana/data/plugins"
  GF_AUTH_LDAP_ENABLED: "false"
  GF_AUTH_LDAP_CONFIG_FILE: "/opt/bitnami/grafana/conf/ldap.toml"
  GF_AUTH_LDAP_ALLOW_SIGN_UP: "false"
  GF_PATHS_PROVISIONING: "/opt/bitnami/grafana/conf/provisioning"
  GF_PATHS_CONFIG: "/opt/bitnami/grafana/conf/grafana.ini"
  GF_PATHS_DATA: "/opt/bitnami/grafana/data"
  GF_PATHS_LOGS: "/opt/bitnami/grafana/logs"
---
# Source: home-weka-io/charts/nats/templates/configmap.yaml
apiVersion: v1
kind: ConfigMap
metadata:
  name: nats-config
  namespace: home-weka-io
  labels:
    helm.sh/chart: nats-0.19.13
    app.kubernetes.io/name: nats
    app.kubernetes.io/instance: homewekaio
    app.kubernetes.io/version: "2.9.16"
    app.kubernetes.io/managed-by: Helm
data:
  nats.conf: |
    # NATS Clients Port
    port: 4222

    # PID file shared with configuration reloader.
    pid_file: "/var/run/nats/nats.pid"

    ###############
    #             #
    # Monitoring  #
    #             #
    ###############
    http: 8222
    server_name:$POD_NAME
    ###################################
    #                                 #
    # NATS JetStream                  #
    #                                 #
    ###################################
    jetstream {
      max_mem: 1Gi
      store_dir: /data

      max_file:30Gi
    }
    ###################################
    #                                 #
    # NATS Full Mesh Clustering Setup #
    #                                 #
    ###################################
    cluster {
      port: 6222
      name: nats

      routes = [
        nats://nats-0.nats.home-weka-io.svc.cluster.local:6222,nats://nats-1.nats.home-weka-io.svc.cluster.local:6222,nats://nats-2.nats.home-weka-io.svc.cluster.local:6222,
        
      ]
      cluster_advertise: $CLUSTER_ADVERTISE
      no_advertise: true

      connect_retries: 120
    }
    max_payload: 16Mi
    lame_duck_grace_period: 10s
    lame_duck_duration: 30s
---
# Source: home-weka-io/charts/prometheus/templates/alertmanager/cm.yaml
apiVersion: v1
kind: ConfigMap
metadata:
  labels:
    component: "alertmanager"
    app: prometheus
    release: homewekaio
    chart: prometheus-15.8.6
    heritage: Helm
  name: homewekaio-prometheus-alertmanager
  namespace: home-weka-io
data:
  alertmanager.yml: |
    global: {}
    receivers:
    - name: default-receiver
    route:
      group_interval: 5m
      group_wait: 10s
      receiver: default-receiver
      repeat_interval: 3h
---
# Source: home-weka-io/charts/prometheus/templates/server/cm.yaml
apiVersion: v1
kind: ConfigMap
metadata:
  labels:
    component: "server"
    app: prometheus
    release: homewekaio
    chart: prometheus-15.8.6
    heritage: Helm
  name: homewekaio-prometheus-server
  namespace: home-weka-io
data:
  alerting_rules.yml: |
    {}
  alerts: |
    {}
  prometheus.yml: |
    global:
      evaluation_interval: 1m
      scrape_interval: 1m
      scrape_timeout: 10s
    rule_files:
    - /etc/config/recording_rules.yml
    - /etc/config/alerting_rules.yml
    - /etc/config/rules
    - /etc/config/alerts
    scrape_configs:
    - job_name: prometheus
      static_configs:
      - targets:
        - localhost:9090
    - bearer_token_file: /var/run/secrets/kubernetes.io/serviceaccount/token
      job_name: kubernetes-apiservers
      kubernetes_sd_configs:
      - role: endpoints
      relabel_configs:
      - action: keep
        regex: default;kubernetes;https
        source_labels:
        - __meta_kubernetes_namespace
        - __meta_kubernetes_service_name
        - __meta_kubernetes_endpoint_port_name
      scheme: https
      tls_config:
        ca_file: /var/run/secrets/kubernetes.io/serviceaccount/ca.crt
        insecure_skip_verify: true
    - bearer_token_file: /var/run/secrets/kubernetes.io/serviceaccount/token
      job_name: kubernetes-nodes
      kubernetes_sd_configs:
      - role: node
      relabel_configs:
      - action: labelmap
        regex: __meta_kubernetes_node_label_(.+)
      - replacement: kubernetes.default.svc:443
        target_label: __address__
      - regex: (.+)
        replacement: /api/v1/nodes/$1/proxy/metrics
        source_labels:
        - __meta_kubernetes_node_name
        target_label: __metrics_path__
      scheme: https
      tls_config:
        ca_file: /var/run/secrets/kubernetes.io/serviceaccount/ca.crt
        insecure_skip_verify: true
    - bearer_token_file: /var/run/secrets/kubernetes.io/serviceaccount/token
      job_name: kubernetes-nodes-cadvisor
      kubernetes_sd_configs:
      - role: node
      relabel_configs:
      - action: labelmap
        regex: __meta_kubernetes_node_label_(.+)
      - replacement: kubernetes.default.svc:443
        target_label: __address__
      - regex: (.+)
        replacement: /api/v1/nodes/$1/proxy/metrics/cadvisor
        source_labels:
        - __meta_kubernetes_node_name
        target_label: __metrics_path__
      scheme: https
      tls_config:
        ca_file: /var/run/secrets/kubernetes.io/serviceaccount/ca.crt
        insecure_skip_verify: true
    - honor_labels: true
      job_name: kubernetes-service-endpoints
      kubernetes_sd_configs:
      - role: endpoints
      relabel_configs:
      - action: keep
        regex: true
        source_labels:
        - __meta_kubernetes_service_annotation_prometheus_io_scrape
      - action: drop
        regex: true
        source_labels:
        - __meta_kubernetes_service_annotation_prometheus_io_scrape_slow
      - action: replace
        regex: (https?)
        source_labels:
        - __meta_kubernetes_service_annotation_prometheus_io_scheme
        target_label: __scheme__
      - action: replace
        regex: (.+)
        source_labels:
        - __meta_kubernetes_service_annotation_prometheus_io_path
        target_label: __metrics_path__
      - action: replace
        regex: ([^:]+)(?::\d+)?;(\d+)
        replacement: $1:$2
        source_labels:
        - __address__
        - __meta_kubernetes_service_annotation_prometheus_io_port
        target_label: __address__
      - action: labelmap
        regex: __meta_kubernetes_service_annotation_prometheus_io_param_(.+)
        replacement: __param_$1
      - action: labelmap
        regex: __meta_kubernetes_service_label_(.+)
      - action: replace
        source_labels:
        - __meta_kubernetes_namespace
        target_label: namespace
      - action: replace
        source_labels:
        - __meta_kubernetes_service_name
        target_label: service
      - action: replace
        source_labels:
        - __meta_kubernetes_pod_node_name
        target_label: node
    - honor_labels: true
      job_name: kubernetes-service-endpoints-slow
      kubernetes_sd_configs:
      - role: endpoints
      relabel_configs:
      - action: keep
        regex: true
        source_labels:
        - __meta_kubernetes_service_annotation_prometheus_io_scrape_slow
      - action: replace
        regex: (https?)
        source_labels:
        - __meta_kubernetes_service_annotation_prometheus_io_scheme
        target_label: __scheme__
      - action: replace
        regex: (.+)
        source_labels:
        - __meta_kubernetes_service_annotation_prometheus_io_path
        target_label: __metrics_path__
      - action: replace
        regex: ([^:]+)(?::\d+)?;(\d+)
        replacement: $1:$2
        source_labels:
        - __address__
        - __meta_kubernetes_service_annotation_prometheus_io_port
        target_label: __address__
      - action: labelmap
        regex: __meta_kubernetes_service_annotation_prometheus_io_param_(.+)
        replacement: __param_$1
      - action: labelmap
        regex: __meta_kubernetes_service_label_(.+)
      - action: replace
        source_labels:
        - __meta_kubernetes_namespace
        target_label: namespace
      - action: replace
        source_labels:
        - __meta_kubernetes_service_name
        target_label: service
      - action: replace
        source_labels:
        - __meta_kubernetes_pod_node_name
        target_label: node
      scrape_interval: 5m
      scrape_timeout: 30s
    - honor_labels: true
      job_name: prometheus-pushgateway
      kubernetes_sd_configs:
      - role: service
      relabel_configs:
      - action: keep
        regex: pushgateway
        source_labels:
        - __meta_kubernetes_service_annotation_prometheus_io_probe
    - honor_labels: true
      job_name: kubernetes-services
      kubernetes_sd_configs:
      - role: service
      metrics_path: /probe
      params:
        module:
        - http_2xx
      relabel_configs:
      - action: keep
        regex: true
        source_labels:
        - __meta_kubernetes_service_annotation_prometheus_io_probe
      - source_labels:
        - __address__
        target_label: __param_target
      - replacement: blackbox
        target_label: __address__
      - source_labels:
        - __param_target
        target_label: instance
      - action: labelmap
        regex: __meta_kubernetes_service_label_(.+)
      - source_labels:
        - __meta_kubernetes_namespace
        target_label: namespace
      - source_labels:
        - __meta_kubernetes_service_name
        target_label: service
    - honor_labels: true
      job_name: kubernetes-pods
      kubernetes_sd_configs:
      - role: pod
      relabel_configs:
      - action: keep
        regex: true
        source_labels:
        - __meta_kubernetes_pod_annotation_prometheus_io_scrape
      - action: drop
        regex: true
        source_labels:
        - __meta_kubernetes_pod_annotation_prometheus_io_scrape_slow
      - action: replace
        regex: (https?)
        source_labels:
        - __meta_kubernetes_pod_annotation_prometheus_io_scheme
        target_label: __scheme__
      - action: replace
        regex: (.+)
        source_labels:
        - __meta_kubernetes_pod_annotation_prometheus_io_path
        target_label: __metrics_path__
      - action: replace
        regex: ([^:]+)(?::\d+)?;(\d+)
        replacement: $1:$2
        source_labels:
        - __address__
        - __meta_kubernetes_pod_annotation_prometheus_io_port
        target_label: __address__
      - action: labelmap
        regex: __meta_kubernetes_pod_annotation_prometheus_io_param_(.+)
        replacement: __param_$1
      - action: labelmap
        regex: __meta_kubernetes_pod_label_(.+)
      - action: replace
        source_labels:
        - __meta_kubernetes_namespace
        target_label: namespace
      - action: replace
        source_labels:
        - __meta_kubernetes_pod_name
        target_label: pod
      - action: drop
        regex: Pending|Succeeded|Failed|Completed
        source_labels:
        - __meta_kubernetes_pod_phase
    - honor_labels: true
      job_name: kubernetes-pods-slow
      kubernetes_sd_configs:
      - role: pod
      relabel_configs:
      - action: keep
        regex: true
        source_labels:
        - __meta_kubernetes_pod_annotation_prometheus_io_scrape_slow
      - action: replace
        regex: (https?)
        source_labels:
        - __meta_kubernetes_pod_annotation_prometheus_io_scheme
        target_label: __scheme__
      - action: replace
        regex: (.+)
        source_labels:
        - __meta_kubernetes_pod_annotation_prometheus_io_path
        target_label: __metrics_path__
      - action: replace
        regex: ([^:]+)(?::\d+)?;(\d+)
        replacement: $1:$2
        source_labels:
        - __address__
        - __meta_kubernetes_pod_annotation_prometheus_io_port
        target_label: __address__
      - action: labelmap
        regex: __meta_kubernetes_pod_annotation_prometheus_io_param_(.+)
        replacement: __param_$1
      - action: labelmap
        regex: __meta_kubernetes_pod_label_(.+)
      - action: replace
        source_labels:
        - __meta_kubernetes_namespace
        target_label: namespace
      - action: replace
        source_labels:
        - __meta_kubernetes_pod_name
        target_label: pod
      - action: drop
        regex: Pending|Succeeded|Failed|Completed
        source_labels:
        - __meta_kubernetes_pod_phase
      scrape_interval: 5m
      scrape_timeout: 30s
    alerting:
      alertmanagers:
      - kubernetes_sd_configs:
          - role: pod
        tls_config:
          ca_file: /var/run/secrets/kubernetes.io/serviceaccount/ca.crt
        bearer_token_file: /var/run/secrets/kubernetes.io/serviceaccount/token
        relabel_configs:
        - source_labels: [__meta_kubernetes_namespace]
          regex: home-weka-io
          action: keep
        - source_labels: [__meta_kubernetes_pod_label_app]
          regex: prometheus
          action: keep
        - source_labels: [__meta_kubernetes_pod_label_component]
          regex: alertmanager
          action: keep
        - source_labels: [__meta_kubernetes_pod_annotation_prometheus_io_probe]
          regex: .*
          action: keep
        - source_labels: [__meta_kubernetes_pod_container_port_number]
          regex: "9093"
          action: keep
  recording_rules.yml: |
    {}
  rules: |
    {}
---
# Source: home-weka-io/templates/configmaps-db-init.yaml
# MAIN_DB INITDB CONFIGMAP
apiVersion: v1
kind: ConfigMap
data:
  initdb.sh: |
    psql -v ON_ERROR_STOP=1 --username "$POSTGRES_USER" --dbname "$POSTGRES_DB" <<- EOF
      CREATE USER weka_home WITH PASSWORD '${POSTGRES_PASSWORD}';
      CREATE DATABASE "weka_home" WITH OWNER "weka_home" ENCODING "utf-8";
      GRANT ALL PRIVILEGES ON DATABASE "weka_home" TO weka_home;
      ALTER USER weka_home WITH SUPERUSER;
    EOF
metadata:
  name: main-db-init-configmap
---
# Source: home-weka-io/templates/configmaps-db-init.yaml
# REMOTE_ACCESS_DB INITDB CONFIGMAP
apiVersion: v1
kind: ConfigMap
data:
  initdb.sh: |
    psql -v ON_ERROR_STOP=1 --username "$POSTGRES_USER" --dbname "$POSTGRES_DB" <<- EOF
      CREATE USER tmate WITH PASSWORD '${POSTGRES_PASSWORD}';
      CREATE DATABASE "tmate" WITH OWNER "tmate" ENCODING "utf-8";
      GRANT ALL PRIVILEGES ON DATABASE "tmate" TO tmate;
      ALTER USER tmate WITH SUPERUSER;
    EOF
metadata:
  name: remote-access-db-init-configmap
---
# Source: home-weka-io/templates/configmaps-db-init.yaml
# SUPPORT_DB INITDB CONFIGMAP
apiVersion: v1
kind: ConfigMap
data:
  initdb.sh: |
    psql -v ON_ERROR_STOP=1 --username "$POSTGRES_USER" --dbname "$POSTGRES_DB" <<- EOF
      CREATE USER weka_home WITH PASSWORD '${POSTGRES_PASSWORD}';
      CREATE DATABASE "weka_support" WITH OWNER "weka_home" ENCODING "utf-8";
      GRANT ALL PRIVILEGES ON DATABASE "weka_support" TO weka_home;
      ALTER USER weka_home WITH SUPERUSER;
    EOF
metadata:
  name: support-db-init-configmap
---
# Source: home-weka-io/templates/configmaps-db-init.yaml
# EVENT_DB_0 INITDB CONFIGMAP
apiVersion: v1
kind: ConfigMap
data:
  initdb.sh: |
    psql -v ON_ERROR_STOP=1 --username "$POSTGRES_USER" --dbname "$POSTGRES_DB" <<- EOF
      CREATE USER "weka_home" WITH PASSWORD '${POSTGRES_PASSWORD}';
      CREATE DATABASE "weka_events" WITH OWNER "weka_home" ENCODING "utf-8";
      GRANT ALL PRIVILEGES ON DATABASE "weka_events" TO weka_home;
      ALTER USER weka_home WITH SUPERUSER;
    EOF
metadata:
  name: event-db-init-configmap-0
---
# Source: home-weka-io/templates/grafana-alert-configmaps.yaml
apiVersion: v1
kind: ConfigMap
metadata:
  name: grafana-alerts
data:
  alert-notification-channels.yaml: |-
    delete_notifiers:
      - name: NotifyWHL
        uid: NotifyWHL_id

    notifiers:
      - name: NotifyWHL
        type: webhook
        uid: NotifyWHL_id
        org_name: Main Org.
        is_default: true
        send_reminder: false
        frequency: 10m
        disable_resolve_message: false
        settings:
          url: ${WEBHOOK_URL}
    #      http_method: POST
---
# Source: home-weka-io/templates/grafana-custom-config.yaml
apiVersion: v1
kind: ConfigMap
metadata:
  name: grafana-custom-config
data:
  grafana.ini: |-
    [server]
    domain = 10.108.170.142
    root_url = %(protocol)s://%(domain)s/stats
    serve_from_sub_path = true
    enable_gzip = true
---
# Source: home-weka-io/templates/grafana-dashboard-configmaps.yaml
apiVersion: v1
kind: ConfigMap
metadata:
  name: grafana-dashboards
data:
  cluster-summary-dashboard.json: |-
    {
      "annotations": {
        "list": [
          {
            "builtIn": 1,
            "datasource": "-- Grafana --",
            "enable": true,
            "hide": true,
            "iconColor": "rgba(0, 211, 255, 1)",
            "name": "Annotations & Alerts",
            "type": "dashboard"
          }
        ]
      },
      "editable": true,
      "gnetId": null,
      "graphTooltip": 0,
      "id": null,
      "iteration": 1635682248444,
      "links": [
        {
          "icon": "external link",
          "includeVars": true,
          "keepTime": true,
          "tags": [
            "wekahome"
          ],
          "targetBlank": true,
          "type": "dashboards"
        }
      ],
      "panels": [
        {
          "collapsed": false,
          "datasource": "VictoriaMetrics",
          "gridPos": {
            "h": 1,
            "w": 24,
            "x": 0,
            "y": 0
          },
          "id": 44,
          "panels": [],
          "title": "Cluster Info",
          "type": "row"
        },
        {
          "cacheTimeout": null,
          "datasource": "Postgres",
          "description": "",
          "fieldConfig": {
            "defaults": {
              "color": {
                "fixedColor": "dark-purple",
                "mode": "fixed"
              },
              "custom": {},
              "decimals": 0,
              "mappings": [
                {
                  "from": "",
                  "id": 1,
                  "text": "NO",
                  "to": "",
                  "type": 1,
                  "value": "false"
                }
              ],
              "thresholds": {
                "mode": "absolute",
                "steps": [
                  {
                    "color": "green",
                    "value": null
                  },
                  {
                    "color": "red",
                    "value": 80
                  }
                ]
              },
              "unit": "none"
            },
            "overrides": []
          },
          "gridPos": {
            "h": 3,
            "w": 7,
            "x": 0,
            "y": 1
          },
          "hideTimeOverride": true,
          "id": 47,
          "interval": "10m",
          "links": [],
          "maxDataPoints": 24,
          "options": {
            "colorMode": "background",
            "graphMode": "none",
            "justifyMode": "center",
            "orientation": "auto",
            "reduceOptions": {
              "calcs": [
                "lastNotNull"
              ],
              "fields": "/.*/",
              "values": false
            },
            "text": {},
            "textMode": "value_and_name"
          },
          "pluginVersion": "7.4.2",
          "targets": [
            {
              "format": "table",
              "group": [],
              "metricColumn": "none",
              "rawQuery": true,
              "rawSql": "SELECT \n  customers.name as \"CUSTOMER\", \n  clusters.name \"CLUSTER NAME\", \n  version as \"VERSION\" \nFROM customers RIGHT JOIN clusters ON customers.id=clusters.customer_id \n WHERE (( '$customer_name' != '' AND customers.name ='$customer_name' AND clusters.id::text = '$cluster_guid')\n OR ('$customer_name' = '' AND '$customer_name' = '' AND clusters.name = '$cluster_name'))",
              "refId": "A",
              "select": [
                [
                  {
                    "params": [
                      "value"
                    ],
                    "type": "column"
                  }
                ]
              ],
              "timeColumn": "time",
              "where": [
                {
                  "name": "$__timeFilter",
                  "params": [],
                  "type": "macro"
                }
              ]
            }
          ],
          "timeFrom": null,
          "timeShift": "5m",
          "title": "",
          "transparent": true,
          "type": "stat"
        },
        {
          "cacheTimeout": null,
          "datasource": "-- Mixed --",
          "description": "",
          "fieldConfig": {
            "defaults": {
              "color": {
                "fixedColor": "dark-purple",
                "mode": "fixed"
              },
              "custom": {},
              "decimals": 0,
              "mappings": [],
              "thresholds": {
                "mode": "absolute",
                "steps": [
                  {
                    "color": "green",
                    "value": null
                  },
                  {
                    "color": "red",
                    "value": 80
                  }
                ]
              },
              "unit": "none"
            },
            "overrides": []
          },
          "gridPos": {
            "h": 3,
            "w": 7,
            "x": 8,
            "y": 1
          },
          "hideTimeOverride": true,
          "id": 58,
          "interval": "10m",
          "links": [],
          "maxDataPoints": 24,
          "options": {
            "colorMode": "background",
            "graphMode": "area",
            "justifyMode": "center",
            "orientation": "vertical",
            "reduceOptions": {
              "calcs": [
                "last"
              ],
              "fields": "",
              "values": false
            },
            "text": {},
            "textMode": "auto"
          },
          "pluginVersion": "7.4.2",
          "targets": [
            {
              "datasource": "VictoriaMetrics",
              "expr": "count(count by(host_id) (statistics.times_queried{cluster_guid=\"$cluster_guid\"}))",
              "interval": "10m",
              "legendFormat": "TOTAL HOSTS",
              "refId": "D"
            },
            {
              "datasource": "VictoriaMetrics",
              "expr": "count(count by(host_id) (ssd.drive_media_blocks_read{cluster_guid=\"$cluster_guid\"}))",
              "interval": "10m",
              "legendFormat": "BACKENDS",
              "refId": "G"
            },
            {
              "datasource": "VictoriaMetrics",
              "expr": "count(count by(host_id) (statistics.times_queried{cluster_guid=\"$cluster_guid\"})) - count(count by(host_id) (ssd.drive_media_blocks_read{cluster_guid=\"$cluster_guid\"}))",
              "interval": "10m",
              "legendFormat": "CLIENTS",
              "refId": "H"
            },
            {
              "datasource": "VictoriaMetrics",
              "expr": "count(count by(node_id,disk) (ssd.drive_media_blocks_read{cluster_guid=\"$cluster_guid\"}))",
              "format": "time_series",
              "interval": "10m",
              "legendFormat": "DRIVES",
              "refId": "C"
            }
          ],
          "timeFrom": null,
          "timeShift": "5m",
          "title": "",
          "transparent": true,
          "type": "stat"
        },
        {
          "cacheTimeout": null,
          "datasource": "VictoriaMetrics",
          "description": "",
          "fieldConfig": {
            "defaults": {
              "color": {
                "fixedColor": "rgb(98, 37, 128)",
                "mode": "fixed"
              },
              "custom": {},
              "decimals": 0,
              "mappings": [],
              "thresholds": {
                "mode": "absolute",
                "steps": [
                  {
                    "color": "green",
                    "value": null
                  },
                  {
                    "color": "red",
                    "value": 80
                  }
                ]
              },
              "unit": "none"
            },
            "overrides": []
          },
          "gridPos": {
            "h": 3,
            "w": 9,
            "x": 15,
            "y": 1
          },
          "hideTimeOverride": true,
          "id": 50,
          "interval": "10m",
          "links": [],
          "maxDataPoints": 24,
          "options": {
            "colorMode": "background",
            "graphMode": "area",
            "justifyMode": "center",
            "orientation": "auto",
            "reduceOptions": {
              "calcs": [
                "lastNotNull"
              ],
              "fields": "",
              "values": false
            },
            "text": {},
            "textMode": "auto"
          },
          "pluginVersion": "7.4.2",
          "targets": [
            {
              "expr": "count(count by(node_id) (frontend.fe_idle_cycles{cluster_guid=\"$cluster_guid\"})) + count(count by(node_id) (reactor.idle_cycles{cluster_guid=\"$cluster_guid\"}))",
              "hide": false,
              "interval": "10m",
              "legendFormat": "TOTAL NODES",
              "refId": "E"
            },
            {
              "expr": "count(count by(host_id) (statistics.times_queried{cluster_guid=\"$cluster_guid\"}))",
              "interval": "10m",
              "legendFormat": "MGMT NODES",
              "refId": "F"
            },
            {
              "expr": "count(count by(node_id) (reactor.idle_cycles{cluster_guid=\"$cluster_guid\"}))",
              "interval": "10m",
              "legendFormat": "IO NODES",
              "refId": "I"
            },
            {
              "expr": "count(count by(node_id) (frontend.fe_idle_cycles{cluster_guid=\"$cluster_guid\"}))",
              "format": "time_series",
              "instant": false,
              "interval": "10m",
              "legendFormat": "FE ROLES",
              "refId": "A"
            },
            {
              "expr": "count(count by(node_id) (bucket.read_bytes{cluster_guid=\"$cluster_guid\"}))",
              "format": "time_series",
              "interval": "10m",
              "legendFormat": "COMPUTE ROLES",
              "refId": "J"
            },
            {
              "expr": "count(count by(node_id) (ssd.drive_media_blocks_read{cluster_guid=\"$cluster_guid\"}))",
              "format": "time_series",
              "interval": "10m",
              "legendFormat": "DRIVE ROLES",
              "refId": "B"
            }
          ],
          "timeFrom": null,
          "timeShift": "5m",
          "title": "",
          "transparent": true,
          "type": "stat"
        },
        {
          "collapsed": false,
          "datasource": "VictoriaMetrics",
          "gridPos": {
            "h": 1,
            "w": 24,
            "x": 0,
            "y": 4
          },
          "id": 25,
          "interval": "1m",
          "maxDataPoints": 250,
          "panels": [],
          "title": "Basic IO stats",
          "type": "row"
        },
        {
          "aliasColors": {},
          "bars": false,
          "dashLength": 10,
          "dashes": false,
          "datasource": "VictoriaMetrics",
          "fieldConfig": {
            "defaults": {
              "custom": {}
            },
            "overrides": []
          },
          "fill": 0,
          "fillGradient": 0,
          "gridPos": {
            "h": 7,
            "w": 9,
            "x": 0,
            "y": 5
          },
          "hiddenSeries": false,
          "id": 23,
          "interval": "1m",
          "legend": {
            "alignAsTable": false,
            "avg": false,
            "current": false,
            "max": false,
            "min": false,
            "show": true,
            "total": false,
            "values": false
          },
          "lines": true,
          "linewidth": 4,
          "maxDataPoints": 250,
          "nullPointMode": "connected",
          "options": {
            "alertThreshold": true
          },
          "percentage": false,
          "pluginVersion": "7.4.2",
          "pointradius": 2,
          "points": false,
          "renderer": "flot",
          "seriesOverrides": [
            {
              "$$hashKey": "object:347",
              "alias": "READ",
              "color": "#8F3BB8"
            },
            {
              "$$hashKey": "object:355",
              "alias": "WRITE",
              "color": "#DEB6F2"
            },
            {
              "$$hashKey": "object:932",
              "alias": "TOTAL",
              "color": "#FFF899",
              "fill": 1,
              "linewidth": 1
            }
          ],
          "spaceLength": 10,
          "stack": false,
          "steppedLine": false,
          "targets": [
            {
              "expr": "sum without(host_id,node_id) (rate({__name__=~\"ops_driver.reads(_rdma)?\",cluster_guid=\"$cluster_guid\"}))",
              "hide": false,
              "interval": "1m",
              "legendFormat": "READ",
              "refId": "A"
            },
            {
              "expr": "sum without(host_id,node_id) (rate({__name__=~\"ops_driver.writes(_rdma)?\",cluster_guid=\"$cluster_guid\"}))",
              "hide": false,
              "interval": "",
              "legendFormat": "WRITE",
              "refId": "B"
            },
            {
              "expr": "sum without(host_id,node_id) (rate({__name__=~\"ops_driver.(reads|writes)(_rdma)?\",cluster_guid=\"$cluster_guid\"}))",
              "hide": false,
              "interval": "",
              "legendFormat": "TOTAL",
              "refId": "C"
            }
          ],
          "thresholds": [],
          "timeFrom": null,
          "timeRegions": [],
          "timeShift": null,
          "title": "IOps",
          "tooltip": {
            "shared": true,
            "sort": 0,
            "value_type": "cumulative"
          },
          "type": "graph",
          "xaxis": {
            "buckets": null,
            "mode": "time",
            "name": null,
            "show": true,
            "values": []
          },
          "yaxes": [
            {
              "$$hashKey": "object:855",
              "format": "iops",
              "label": null,
              "logBase": 1,
              "max": null,
              "min": "0",
              "show": true
            },
            {
              "$$hashKey": "object:856",
              "format": "short",
              "label": null,
              "logBase": 1,
              "max": null,
              "min": null,
              "show": true
            }
          ],
          "yaxis": {
            "align": false,
            "alignLevel": null
          }
        },
        {
          "aliasColors": {},
          "bars": false,
          "dashLength": 10,
          "dashes": false,
          "datasource": "VictoriaMetrics",
          "fieldConfig": {
            "defaults": {
              "custom": {}
            },
            "overrides": []
          },
          "fill": 0,
          "fillGradient": 0,
          "gridPos": {
            "h": 7,
            "w": 9,
            "x": 9,
            "y": 5
          },
          "hiddenSeries": false,
          "id": 27,
          "interval": "1m",
          "legend": {
            "alignAsTable": false,
            "avg": false,
            "current": false,
            "max": false,
            "min": false,
            "show": true,
            "total": false,
            "values": false
          },
          "lines": true,
          "linewidth": 4,
          "maxDataPoints": 250,
          "nullPointMode": "connected",
          "options": {
            "alertThreshold": true
          },
          "percentage": false,
          "pluginVersion": "7.4.2",
          "pointradius": 2,
          "points": false,
          "renderer": "flot",
          "seriesOverrides": [
            {
              "$$hashKey": "object:277",
              "alias": "READ",
              "color": "#8F3BB8"
            },
            {
              "$$hashKey": "object:285",
              "alias": "WRITE",
              "color": "#DEB6F2"
            },
            {
              "$$hashKey": "object:1008",
              "alias": "TOTAL",
              "color": "#FFF899",
              "fill": 1,
              "linewidth": 1
            }
          ],
          "spaceLength": 10,
          "stack": false,
          "steppedLine": false,
          "targets": [
            {
              "expr": "sum without(host_id,node_id) (rate({__name__=~\"ops_driver.read_bytes(_rdma)?\",cluster_guid=\"$cluster_guid\"}))",
              "interval": "1m",
              "legendFormat": "READ",
              "refId": "A"
            },
            {
              "expr": "sum without(host_id,node_id) (rate({__name__=~\"ops_driver.write_bytes(_rdma)?\",cluster_guid=\"$cluster_guid\"}))",
              "interval": "",
              "legendFormat": "WRITE",
              "refId": "B"
            },
            {
              "expr": "sum without(host_id,node_id) (rate({__name__=~\"ops_driver.(read|write)_bytes(_rdma)?\",cluster_guid=\"$cluster_guid\"}))",
              "interval": "",
              "legendFormat": "TOTAL",
              "refId": "C"
            }
          ],
          "thresholds": [],
          "timeFrom": null,
          "timeRegions": [],
          "timeShift": null,
          "title": "Throughput",
          "tooltip": {
            "shared": true,
            "sort": 0,
            "value_type": "cumulative"
          },
          "type": "graph",
          "xaxis": {
            "buckets": null,
            "mode": "time",
            "name": null,
            "show": true,
            "values": []
          },
          "yaxes": [
            {
              "$$hashKey": "object:1165",
              "format": "Bps",
              "label": null,
              "logBase": 1,
              "max": null,
              "min": "0",
              "show": true
            },
            {
              "$$hashKey": "object:1166",
              "format": "short",
              "label": null,
              "logBase": 1,
              "max": null,
              "min": null,
              "show": true
            }
          ],
          "yaxis": {
            "align": false,
            "alignLevel": null
          }
        },
        {
          "datasource": "VictoriaMetrics",
          "fieldConfig": {
            "defaults": {
              "color": {
                "fixedColor": "dark-purple",
                "mode": "fixed"
              },
              "custom": {},
              "decimals": 2,
              "mappings": [],
              "noValue": "N/A",
              "thresholds": {
                "mode": "absolute",
                "steps": [
                  {
                    "color": "green",
                    "value": null
                  },
                  {
                    "color": "red",
                    "value": 80
                  }
                ]
              },
              "unit": "iops"
            },
            "overrides": []
          },
          "gridPos": {
            "h": 7,
            "w": 3,
            "x": 18,
            "y": 5
          },
          "id": 54,
          "options": {
            "reduceOptions": {
              "calcs": [
                "last"
              ],
              "fields": "",
              "values": false
            },
            "showThresholdLabels": false,
            "showThresholdMarkers": false,
            "text": {}
          },
          "pluginVersion": "7.4.2",
          "targets": [
            {
              "expr": "sum without(host_id,node_id) (rate({__name__=~\"ops_driver.(write|read)s(_rdma)?\",cluster_guid=\"$cluster_guid\"})) ",
              "interval": "",
              "legendFormat": "",
              "refId": "A"
            }
          ],
          "timeFrom": null,
          "timeShift": null,
          "title": "IOps",
          "transparent": true,
          "type": "gauge"
        },
        {
          "datasource": "VictoriaMetrics",
          "fieldConfig": {
            "defaults": {
              "color": {
                "fixedColor": "dark-purple",
                "mode": "fixed"
              },
              "custom": {},
              "mappings": [],
              "noValue": "N/A",
              "thresholds": {
                "mode": "absolute",
                "steps": [
                  {
                    "color": "green",
                    "value": null
                  },
                  {
                    "color": "red",
                    "value": 80
                  }
                ]
              },
              "unit": "Bps"
            },
            "overrides": []
          },
          "gridPos": {
            "h": 7,
            "w": 3,
            "x": 21,
            "y": 5
          },
          "id": 55,
          "options": {
            "reduceOptions": {
              "calcs": [
                "last"
              ],
              "fields": "",
              "values": false
            },
            "showThresholdLabels": false,
            "showThresholdMarkers": false,
            "text": {}
          },
          "pluginVersion": "7.4.2",
          "targets": [
            {
              "expr": "sum without(host_id,node_id) (rate({__name__=~\"ops_driver.(write|read)_bytes(_rdma)?\", cluster_guid=\"$cluster_guid\"}))",
              "interval": "",
              "legendFormat": "",
              "refId": "A"
            }
          ],
          "timeFrom": null,
          "timeShift": null,
          "title": "Throughput",
          "transparent": true,
          "type": "gauge"
        },
        {
          "aliasColors": {},
          "bars": false,
          "dashLength": 10,
          "dashes": false,
          "datasource": "VictoriaMetrics",
          "fieldConfig": {
            "defaults": {
              "custom": {}
            },
            "overrides": []
          },
          "fill": 0,
          "fillGradient": 0,
          "gridPos": {
            "h": 7,
            "w": 9,
            "x": 0,
            "y": 12
          },
          "hiddenSeries": false,
          "id": 29,
          "interval": "1m",
          "legend": {
            "alignAsTable": false,
            "avg": false,
            "current": false,
            "max": false,
            "min": false,
            "show": true,
            "total": false,
            "values": false
          },
          "lines": true,
          "linewidth": 1,
          "maxDataPoints": 250,
          "nullPointMode": "null as zero",
          "options": {
            "alertThreshold": true
          },
          "percentage": false,
          "pluginVersion": "7.4.2",
          "pointradius": 2,
          "points": false,
          "renderer": "flot",
          "seriesOverrides": [
            {
              "$$hashKey": "object:608",
              "alias": "Average",
              "color": "#CA95E5",
              "linewidth": 4
            },
            {
              "$$hashKey": "object:609",
              "alias": "Max",
              "color": "#CA95E5",
              "fillBelowTo": "Min"
            },
            {
              "$$hashKey": "object:610",
              "alias": "Min",
              "color": "#CA95E5"
            }
          ],
          "spaceLength": 10,
          "stack": false,
          "steppedLine": false,
          "targets": [
            {
              "expr": "avg without(host_id, node_id, rdma) (rate(label_replace({__name__=~\"ops_driver.write_latency(_rdma)?\", cluster_guid=\"$cluster_guid\"},\"rdma\", \"rdma\", \"__name__\",\".*_rdma\")) /\nignoring(metric_type) rate(label_replace({__name__=~\"ops_driver.writes(_rdma)?\", cluster_guid=\"$cluster_guid\"},\"rdma\", \"rdma\", \"__name__\",\".*_rdma\"))) / 10",
              "interval": "1m",
              "legendFormat": "Average",
              "refId": "A"
            },
            {
              "expr": "max without(host_id, node_id, rdma) (rate(label_replace({__name__=~\"ops_driver.write_latency(_rdma)?\", cluster_guid=\"$cluster_guid\"},\"rdma\", \"rdma\", \"__name__\",\".*_rdma\")) /\nignoring(metric_type) rate(label_replace({__name__=~\"ops_driver.writes(_rdma)?\", cluster_guid=\"$cluster_guid\"},\"rdma\", \"rdma\", \"__name__\",\".*_rdma\"))) / 10",
              "hide": false,
              "interval": "1m",
              "legendFormat": "Max",
              "refId": "B"
            },
            {
              "expr": "min without(host_id, node_id, rdma) (rate(label_replace({__name__=~\"ops_driver.write_latency(_rdma)?\", cluster_guid=\"$cluster_guid\"},\"rdma\", \"rdma\", \"__name__\",\".*_rdma\")) /\nignoring(metric_type) rate(label_replace({__name__=~\"ops_driver.writes(_rdma)?\", cluster_guid=\"$cluster_guid\"},\"rdma\", \"rdma\", \"__name__\",\".*_rdma\"))) / 10",
              "hide": false,
              "interval": "1m",
              "legendFormat": "Min",
              "refId": "C"
            }
          ],
          "thresholds": [],
          "timeFrom": null,
          "timeRegions": [],
          "timeShift": null,
          "title": "WRITE Latency",
          "tooltip": {
            "shared": true,
            "sort": 0,
            "value_type": "cumulative"
          },
          "type": "graph",
          "xaxis": {
            "buckets": null,
            "mode": "time",
            "name": null,
            "show": true,
            "values": []
          },
          "yaxes": [
            {
              "$$hashKey": "object:659",
              "format": "µs",
              "label": null,
              "logBase": 1,
              "max": null,
              "min": "0",
              "show": true
            },
            {
              "$$hashKey": "object:660",
              "format": "µs",
              "label": null,
              "logBase": 1,
              "max": null,
              "min": null,
              "show": true
            }
          ],
          "yaxis": {
            "align": false,
            "alignLevel": null
          }
        },
        {
          "aliasColors": {},
          "bars": false,
          "dashLength": 10,
          "dashes": false,
          "datasource": "VictoriaMetrics",
          "fieldConfig": {
            "defaults": {
              "custom": {}
            },
            "overrides": []
          },
          "fill": 0,
          "fillGradient": 0,
          "gridPos": {
            "h": 7,
            "w": 9,
            "x": 9,
            "y": 12
          },
          "hiddenSeries": false,
          "id": 30,
          "interval": "1m",
          "legend": {
            "alignAsTable": false,
            "avg": false,
            "current": false,
            "max": false,
            "min": false,
            "show": true,
            "total": false,
            "values": false
          },
          "lines": true,
          "linewidth": 1,
          "maxDataPoints": 250,
          "nullPointMode": "null as zero",
          "options": {
            "alertThreshold": true
          },
          "percentage": false,
          "pluginVersion": "7.4.2",
          "pointradius": 2,
          "points": false,
          "renderer": "flot",
          "seriesOverrides": [
            {
              "$$hashKey": "object:757",
              "alias": "Average",
              "color": "#8F3BB8",
              "linewidth": 4
            },
            {
              "$$hashKey": "object:758",
              "alias": "Min",
              "color": "#8F3BB8"
            },
            {
              "$$hashKey": "object:759",
              "alias": "Max",
              "color": "#8F3BB8",
              "fillBelowTo": "Min"
            }
          ],
          "spaceLength": 10,
          "stack": false,
          "steppedLine": false,
          "targets": [
            {
              "expr": "avg without(host_id, node_id, rdma) (rate(label_replace({__name__=~\"ops_driver.read_latency(_rdma)?\", cluster_guid=\"$cluster_guid\"},\"rdma\", \"rdma\", \"__name__\",\".*_rdma\")) /\nignoring(metric_type) rate(label_replace({__name__=~\"ops_driver.reads(_rdma)?\", cluster_guid=\"$cluster_guid\"},\"rdma\", \"rdma\", \"__name__\",\".*_rdma\"))) / 10",
              "interval": "1m",
              "legendFormat": "Average",
              "refId": "A"
            },
            {
              "expr": "min without(host_id, node_id, rdma) (rate(label_replace({__name__=~\"ops_driver.read_latency(_rdma)?\", cluster_guid=\"$cluster_guid\"},\"rdma\", \"rdma\", \"__name__\",\".*_rdma\")) /\nignoring(metric_type) rate(label_replace({__name__=~\"ops_driver.reads(_rdma)?\", cluster_guid=\"$cluster_guid\"},\"rdma\", \"rdma\", \"__name__\",\".*_rdma\"))) / 10",
              "interval": "1m",
              "legendFormat": "Min",
              "refId": "B"
            },
            {
              "expr": "max without(host_id, node_id, rdma) (rate(label_replace({__name__=~\"ops_driver.read_latency(_rdma)?\", cluster_guid=\"$cluster_guid\"},\"rdma\", \"rdma\", \"__name__\",\".*_rdma\")) /\nignoring(metric_type) rate(label_replace({__name__=~\"ops_driver.reads(_rdma)?\", cluster_guid=\"$cluster_guid\"},\"rdma\", \"rdma\", \"__name__\",\".*_rdma\"))) / 10",
              "interval": "1m",
              "legendFormat": "Max",
              "refId": "C"
            }
          ],
          "thresholds": [],
          "timeFrom": null,
          "timeRegions": [],
          "timeShift": null,
          "title": "READ Latency",
          "tooltip": {
            "shared": true,
            "sort": 0,
            "value_type": "cumulative"
          },
          "type": "graph",
          "xaxis": {
            "buckets": null,
            "mode": "time",
            "name": null,
            "show": true,
            "values": []
          },
          "yaxes": [
            {
              "$$hashKey": "object:741",
              "format": "µs",
              "label": null,
              "logBase": 1,
              "max": null,
              "min": "0",
              "show": true
            },
            {
              "$$hashKey": "object:742",
              "format": "µs",
              "label": null,
              "logBase": 1,
              "max": null,
              "min": null,
              "show": true
            }
          ],
          "yaxis": {
            "align": false,
            "alignLevel": null
          }
        },
        {
          "aliasColors": {
            "READ": "#8F3BB8",
            "WRITE": "#DEB6F2"
          },
          "breakPoint": "100%",
          "cacheTimeout": null,
          "combine": {
            "label": "Others",
            "threshold": 0
          },
          "datasource": "VictoriaMetrics",
          "fieldConfig": {
            "defaults": {
              "custom": {},
              "thresholds": {
                "mode": "absolute",
                "steps": []
              }
            },
            "overrides": []
          },
          "fontSize": "60%",
          "format": "none",
          "gridPos": {
            "h": 7,
            "w": 3,
            "x": 18,
            "y": 12
          },
          "hideTimeOverride": true,
          "id": 40,
          "interval": "10m",
          "legend": {
            "percentage": true,
            "percentageDecimals": 0,
            "show": true,
            "sort": null,
            "sortDesc": null,
            "values": false
          },
          "legendType": "Under graph",
          "links": [],
          "maxDataPoints": 250,
          "nullPointMode": "connected",
          "pieType": "donut",
          "pluginVersion": "7.3.5",
          "strokeWidth": "0",
          "targets": [
            {
              "expr": "sum without(node_id,metric_type,host_id) (rate({__name__=~\"ops_driver.reads(_rdma)?\",cluster_guid=\"$cluster_guid\"}))",
              "instant": false,
              "interval": "10m",
              "legendFormat": "READ",
              "refId": "A"
            },
            {
              "expr": "sum without(node_id,metric_type,host_id) (rate({__name__=~\"ops_driver.writes(_rdma)?\",cluster_guid=\"$cluster_guid\"}))",
              "instant": false,
              "interval": "10m",
              "legendFormat": "WRITE",
              "refId": "B"
            }
          ],
          "timeFrom": null,
          "timeShift": "5m",
          "title": "IO distribution",
          "transparent": true,
          "type": "grafana-piechart-panel",
          "valueName": "current"
        },
        {
          "aliasColors": {},
          "bars": false,
          "cacheTimeout": null,
          "dashLength": 10,
          "dashes": false,
          "datasource": "VictoriaMetrics",
          "description": "",
          "fieldConfig": {
            "defaults": {
              "color": {},
              "custom": {},
              "thresholds": {
                "mode": "absolute",
                "steps": []
              },
              "unit": "decbytes"
            },
            "overrides": []
          },
          "fill": 0,
          "fillGradient": 0,
          "gridPos": {
            "h": 7,
            "w": 3,
            "x": 21,
            "y": 12
          },
          "hiddenSeries": false,
          "id": 38,
          "interval": "10m",
          "legend": {
            "avg": false,
            "current": false,
            "max": false,
            "min": false,
            "show": true,
            "total": false,
            "values": false
          },
          "lines": true,
          "linewidth": 2,
          "links": [],
          "maxDataPoints": 100,
          "nullPointMode": "null as zero",
          "options": {
            "alertThreshold": true
          },
          "percentage": false,
          "pluginVersion": "7.4.2",
          "pointradius": 2,
          "points": false,
          "renderer": "flot",
          "seriesOverrides": [
            {
              "$$hashKey": "object:1891",
              "alias": "WRITE",
              "color": "#DEB6F2"
            },
            {
              "$$hashKey": "object:1899",
              "alias": "READ",
              "color": "#8F3BB8"
            }
          ],
          "spaceLength": 10,
          "stack": false,
          "steppedLine": false,
          "targets": [
            {
              "expr": "avg without(host_id, node_id, rdma) (rate(label_replace({__name__=~\"ops_driver.read_bytes(_rdma)?\", cluster_guid=\"$cluster_guid\"},\"rdma\", \"rdma\", \"__name__\",\".*_rdma\")) /\nignoring(metric_type) rate(label_replace({__name__=~\"ops_driver.reads(_rdma)?\", cluster_guid=\"$cluster_guid\"},\"rdma\", \"rdma\", \"__name__\",\".*_rdma\")))",
              "format": "time_series",
              "instant": false,
              "interval": "1m",
              "legendFormat": "READ",
              "refId": "A"
            },
            {
              "expr": "avg without(host_id, node_id, rdma) (rate(label_replace({__name__=~\"ops_driver.write_bytes(_rdma)?\", cluster_guid=\"$cluster_guid\"},\"rdma\", \"rdma\", \"__name__\",\".*_rdma\")) /\nignoring(metric_type) rate(label_replace({__name__=~\"ops_driver.writes(_rdma)?\", cluster_guid=\"$cluster_guid\"},\"rdma\", \"rdma\", \"__name__\",\".*_rdma\"))) ",
              "interval": "",
              "legendFormat": "WRITE",
              "refId": "B"
            }
          ],
          "thresholds": [],
          "timeFrom": null,
          "timeRegions": [],
          "timeShift": null,
          "title": "Average IO size",
          "tooltip": {
            "shared": true,
            "sort": 0,
            "value_type": "individual"
          },
          "transparent": true,
          "type": "graph",
          "xaxis": {
            "buckets": null,
            "mode": "time",
            "name": null,
            "show": true,
            "values": []
          },
          "yaxes": [
            {
              "$$hashKey": "object:328",
              "format": "decbytes",
              "label": null,
              "logBase": 1,
              "max": null,
              "min": "0",
              "show": true
            },
            {
              "$$hashKey": "object:329",
              "format": "short",
              "label": null,
              "logBase": 1,
              "max": null,
              "min": null,
              "show": false
            }
          ],
          "yaxis": {
            "align": false,
            "alignLevel": null
          }
        },
        {
          "collapsed": false,
          "datasource": "VictoriaMetrics",
          "gridPos": {
            "h": 1,
            "w": 24,
            "x": 0,
            "y": 19
          },
          "id": 52,
          "panels": [],
          "title": "Cluster Performance",
          "type": "row"
        },
        {
          "aliasColors": {},
          "bars": false,
          "dashLength": 10,
          "dashes": false,
          "datasource": "VictoriaMetrics",
          "description": "",
          "fieldConfig": {
            "defaults": {
              "custom": {},
              "unit": "percentunit"
            },
            "overrides": []
          },
          "fill": 0,
          "fillGradient": 0,
          "gridPos": {
            "h": 7,
            "w": 9,
            "x": 0,
            "y": 20
          },
          "hiddenSeries": false,
          "id": 49,
          "interval": "1m",
          "legend": {
            "avg": false,
            "current": false,
            "max": false,
            "min": false,
            "show": true,
            "total": false,
            "values": false
          },
          "lines": true,
          "linewidth": 1,
          "maxDataPoints": 250,
          "nullPointMode": "null",
          "options": {
            "alertThreshold": true
          },
          "percentage": false,
          "pluginVersion": "7.4.2",
          "pointradius": 2,
          "points": false,
          "renderer": "flot",
          "seriesOverrides": [
            {
              "$$hashKey": "object:433",
              "alias": "Average",
              "color": "#8F3BB8",
              "linewidth": 4
            },
            {
              "$$hashKey": "object:522",
              "alias": "Min",
              "color": "#8F3BB8"
            },
            {
              "$$hashKey": "object:530",
              "alias": "Max",
              "color": "#8F3BB8",
              "fillBelowTo": "Min",
              "fillGradient": 1,
              "lines": false
            },
            {
              "$$hashKey": "object:538",
              "alias": "Min",
              "lines": false
            }
          ],
          "spaceLength": 10,
          "stack": false,
          "steppedLine": false,
          "targets": [
            {
              "expr": "avg(1 - rate(reactor.idle_cycles{cluster_guid=\"$cluster_guid\"}) / ignoring(metric_type) (reactor.cycles_per_second{cluster_guid=\"$cluster_guid\"}) )",
              "interval": "",
              "legendFormat": "Average",
              "refId": "A"
            },
            {
              "expr": "min(1 - rate(reactor.idle_cycles{cluster_guid=\"$cluster_guid\"}) / ignoring(metric_type) (reactor.cycles_per_second{cluster_guid=\"$cluster_guid\"}) )",
              "interval": "",
              "legendFormat": "Min",
              "refId": "B"
            },
            {
              "expr": "max(1 - rate(reactor.idle_cycles{cluster_guid=\"$cluster_guid\"}) / ignoring(metric_type) (reactor.cycles_per_second{cluster_guid=\"$cluster_guid\"}) )",
              "interval": "",
              "legendFormat": "Max",
              "refId": "C"
            }
          ],
          "thresholds": [],
          "timeFrom": null,
          "timeRegions": [],
          "timeShift": null,
          "title": "Backend CPU UIilization",
          "tooltip": {
            "shared": true,
            "sort": 0,
            "value_type": "individual"
          },
          "type": "graph",
          "xaxis": {
            "buckets": null,
            "mode": "time",
            "name": null,
            "show": true,
            "values": []
          },
          "yaxes": [
            {
              "$$hashKey": "object:591",
              "decimals": 1,
              "format": "percentunit",
              "label": "",
              "logBase": 1,
              "max": "1",
              "min": "0",
              "show": true
            },
            {
              "$$hashKey": "object:592",
              "decimals": null,
              "format": "short",
              "label": null,
              "logBase": 1,
              "max": null,
              "min": null,
              "show": false
            }
          ],
          "yaxis": {
            "align": false,
            "alignLevel": null
          }
        }
      ],
      "refresh": "5m",
      "schemaVersion": 27,
      "style": "dark",
      "tags": [
        "wekahome"
      ],
      "templating": {
        "list": [
          {
            "allValue": null,
            "current": {
              "selected": false,
              "text": "",
              "value": ""
            },
            "datasource": "Postgres",
            "definition": "SELECT customers.name \nFROM customers JOIN clusters ON customers.id=clusters.customer_id \nWHERE clusters.stats_enabled = true and clusters.last_seen >= $__timeFrom()\n",
            "description": null,
            "error": null,
            "hide": 0,
            "includeAll": false,
            "label": "Customer",
            "multi": false,
            "name": "customer_name",
            "options": [],
            "query": "SELECT customers.name \nFROM customers JOIN clusters ON customers.id=clusters.customer_id \nWHERE clusters.stats_enabled = true and clusters.last_seen >= $__timeFrom()\n",
            "refresh": 2,
            "regex": "",
            "skipUrlSync": false,
            "sort": 1,
            "tagValuesQuery": "",
            "tags": [],
            "tagsQuery": "",
            "type": "query",
            "useTags": false
          },
          {
            "allValue": null,
            "current": {
              "selected": false,
              "text": "Weka-scholar-west",
              "value": "Weka-scholar-west"
            },
            "datasource": "Postgres",
            "definition": "SELECT clusters.name\n FROM customers RIGHT JOIN clusters ON customers.id=clusters.customer_id\n WHERE clusters.stats_enabled = true\n AND ($__timeFilter(clusters.last_seen) OR clusters.last_seen >= (NOW() - INTERVAL '1 hours' )) \n AND (( '$customer_name' != '' AND customers.name ='$customer_name')\n OR '$customer_name' = '')",
            "description": null,
            "error": null,
            "hide": 0,
            "includeAll": false,
            "label": "Cluster name",
            "multi": false,
            "name": "cluster_name",
            "options": [],
            "query": "SELECT clusters.name\n FROM customers RIGHT JOIN clusters ON customers.id=clusters.customer_id\n WHERE clusters.stats_enabled = true\n AND ($__timeFilter(clusters.last_seen) OR clusters.last_seen >= (NOW() - INTERVAL '1 hours' )) \n AND (( '$customer_name' != '' AND customers.name ='$customer_name')\n OR '$customer_name' = '')",
            "refresh": 2,
            "regex": "",
            "skipUrlSync": false,
            "sort": 1,
            "tagValuesQuery": "",
            "tags": [],
            "tagsQuery": "",
            "type": "query",
            "useTags": false
          },
          {
            "allValue": null,
            "current": {
              "selected": false,
              "text": "",
              "value": ""
            },
            "datasource": "Postgres",
            "definition": "SELECT clusters.id\n FROM customers RIGHT JOIN clusters ON customers.id=clusters.customer_id\n WHERE ('$customer_name' = '' AND clusters.name = '$cluster_name')\n OR (customers.name = '$customer_name' AND clusters.name = '$cluster_name')",
            "description": null,
            "error": null,
            "hide": 2,
            "includeAll": false,
            "label": null,
            "multi": false,
            "name": "cluster_guid",
            "options": [],
            "query": "SELECT clusters.id\n FROM customers RIGHT JOIN clusters ON customers.id=clusters.customer_id\n WHERE ('$customer_name' = '' AND clusters.name = '$cluster_name')\n OR (customers.name = '$customer_name' AND clusters.name = '$cluster_name')",
            "refresh": 2,
            "regex": "",
            "skipUrlSync": false,
            "sort": 0,
            "tagValuesQuery": "",
            "tags": [],
            "tagsQuery": "",
            "type": "query",
            "useTags": false
          }
        ]
      },
      "time": {
        "from": "now-24h",
        "to": "now"
      },
      "timepicker": {
        "refresh_intervals": [
          "1m",
          "5m",
          "15m",
          "30m",
          "1h",
          "2h",
          "1d"
        ]
      },
      "timezone": "browser",
      "title": "Cluster Summary",
      "uid": "00QG7XYMz",
      "version": 0
    }
  go-processes.json: |-
    {
      "annotations": {
        "list": [
          {
            "builtIn": 1,
            "datasource": "-- Grafana --",
            "enable": true,
            "hide": true,
            "iconColor": "rgba(0, 211, 255, 1)",
            "name": "Annotations & Alerts",
            "target": {
              "limit": 100,
              "matchAny": false,
              "tags": [],
              "type": "dashboard"
            },
            "type": "dashboard"
          }
        ]
      },
      "description": "Process status published by Go Prometheus client library, e.g. memory used, fds open, GC details",
      "editable": true,
      "gnetId": 6671,
      "graphTooltip": 0,
      "id": 17,
      "iteration": 1644154085437,
      "links": [],
      "panels": [
        {
          "aliasColors": {},
          "bars": false,
          "dashLength": 10,
          "dashes": false,
          "datasource": "Prometheus",
          "editable": true,
          "error": false,
          "fill": 1,
          "fillGradient": 0,
          "grid": {},
          "gridPos": {
            "h": 8,
            "w": 12,
            "x": 0,
            "y": 0
          },
          "hiddenSeries": false,
          "id": 1,
          "isNew": true,
          "legend": {
            "alignAsTable": true,
            "avg": true,
            "current": true,
            "max": true,
            "min": false,
            "rightSide": false,
            "show": true,
            "total": false,
            "values": true
          },
          "lines": true,
          "linewidth": 2,
          "links": [],
          "nullPointMode": "connected",
          "options": {
            "alertThreshold": true
          },
          "percentage": false,
          "pluginVersion": "8.1.0",
          "pointradius": 5,
          "points": false,
          "renderer": "flot",
          "seriesOverrides": [
            {
              "alias": "resident",
              "yaxis": 2
            }
          ],
          "spaceLength": 10,
          "stack": false,
          "steppedLine": false,
          "targets": [
            {
              "expr": "process_resident_memory_bytes{kubernetes_namespace=~\"^($namespace)$\", app_kubernetes_io_name=~\"^$component$\", kubernetes_pod_name=~\"^($pod)$\"}",
              "format": "time_series",
              "interval": "",
              "intervalFactor": 2,
              "legendFormat": "{{kubernetes_pod_name}} - resident",
              "metric": "process_resident_memory_bytes",
              "refId": "A",
              "step": 4
            },
            {
              "expr": "process_virtual_memory_bytes{kubernetes_namespace=~\"^($namespace)$\", app_kubernetes_io_name=~\"^$component$\", kubernetes_pod_name=~\"^($pod)$\"}",
              "format": "time_series",
              "interval": "",
              "intervalFactor": 2,
              "legendFormat": "{{kubernetes_pod_name}} - virtual",
              "metric": "process_virtual_memory_bytes",
              "refId": "B",
              "step": 4
            }
          ],
          "thresholds": [],
          "timeFrom": null,
          "timeRegions": [],
          "timeShift": null,
          "title": "process memory",
          "tooltip": {
            "msResolution": false,
            "shared": true,
            "sort": 0,
            "value_type": "cumulative"
          },
          "type": "graph",
          "xaxis": {
            "buckets": null,
            "mode": "time",
            "name": null,
            "show": true,
            "values": []
          },
          "yaxes": [
            {
              "format": "bytes",
              "label": null,
              "logBase": 1,
              "max": null,
              "min": null,
              "show": true
            },
            {
              "format": "short",
              "label": null,
              "logBase": 1,
              "max": null,
              "min": null,
              "show": true
            }
          ],
          "yaxis": {
            "align": false,
            "alignLevel": null
          }
        },
        {
          "aliasColors": {},
          "bars": false,
          "dashLength": 10,
          "dashes": false,
          "datasource": "Prometheus",
          "editable": true,
          "error": false,
          "fill": 1,
          "fillGradient": 0,
          "grid": {},
          "gridPos": {
            "h": 8,
            "w": 12,
            "x": 12,
            "y": 0
          },
          "hiddenSeries": false,
          "id": 4,
          "isNew": true,
          "legend": {
            "alignAsTable": true,
            "avg": true,
            "current": true,
            "max": true,
            "min": false,
            "rightSide": false,
            "show": true,
            "total": false,
            "values": true
          },
          "lines": true,
          "linewidth": 2,
          "links": [],
          "nullPointMode": "connected",
          "options": {
            "alertThreshold": true
          },
          "percentage": false,
          "pluginVersion": "8.1.0",
          "pointradius": 5,
          "points": false,
          "renderer": "flot",
          "seriesOverrides": [
            {
              "alias": "resident",
              "yaxis": 1
            }
          ],
          "spaceLength": 10,
          "stack": false,
          "steppedLine": false,
          "targets": [
            {
              "expr": "rate(process_resident_memory_bytes{kubernetes_namespace=~\"^($namespace)$\",app_kubernetes_io_name=~\"^$component$\", kubernetes_pod_name=~\"^($pod)$\"}[$interval])",
              "format": "time_series",
              "intervalFactor": 2,
              "legendFormat": "{{kubernetes_pod_name}} - resident",
              "metric": "process_resident_memory_bytes",
              "refId": "A",
              "step": 4
            },
            {
              "expr": "deriv(process_virtual_memory_bytes{kubernetes_namespace=~\"^($namespace)$\",app_kubernetes_io_name=~\"^$component$\", kubernetes_pod_name=~\"^($pod)$\"}[$interval])",
              "format": "time_series",
              "intervalFactor": 2,
              "legendFormat": "{{kubernetes_pod_name}} - virtual",
              "metric": "process_virtual_memory_bytes",
              "refId": "B",
              "step": 4
            }
          ],
          "thresholds": [],
          "timeFrom": null,
          "timeRegions": [],
          "timeShift": null,
          "title": "process memory deriv",
          "tooltip": {
            "msResolution": false,
            "shared": true,
            "sort": 0,
            "value_type": "cumulative"
          },
          "type": "graph",
          "xaxis": {
            "buckets": null,
            "mode": "time",
            "name": null,
            "show": true,
            "values": []
          },
          "yaxes": [
            {
              "format": "bytes",
              "label": null,
              "logBase": 1,
              "max": null,
              "min": null,
              "show": true
            },
            {
              "format": "short",
              "label": null,
              "logBase": 1,
              "max": null,
              "min": null,
              "show": true
            }
          ],
          "yaxis": {
            "align": false,
            "alignLevel": null
          }
        },
        {
          "aliasColors": {},
          "bars": false,
          "dashLength": 10,
          "dashes": false,
          "datasource": "Prometheus",
          "editable": true,
          "error": false,
          "fill": 1,
          "fillGradient": 0,
          "grid": {},
          "gridPos": {
            "h": 7,
            "w": 12,
            "x": 0,
            "y": 8
          },
          "hiddenSeries": false,
          "id": 2,
          "isNew": true,
          "legend": {
            "alignAsTable": true,
            "avg": true,
            "current": true,
            "max": true,
            "min": false,
            "rightSide": false,
            "show": true,
            "total": false,
            "values": true
          },
          "lines": true,
          "linewidth": 2,
          "links": [],
          "nullPointMode": "connected",
          "options": {
            "alertThreshold": true
          },
          "percentage": false,
          "pluginVersion": "8.1.0",
          "pointradius": 5,
          "points": false,
          "renderer": "flot",
          "seriesOverrides": [
            {
              "alias": "alloc rate",
              "yaxis": 2
            }
          ],
          "spaceLength": 10,
          "stack": false,
          "steppedLine": false,
          "targets": [
            {
              "expr": "go_memstats_alloc_bytes{kubernetes_namespace=~\"^($namespace)$\",app_kubernetes_io_name=~\"^$component$\", kubernetes_pod_name=~\"^($pod)$\"}",
              "format": "time_series",
              "intervalFactor": 2,
              "legendFormat": "{{kubernetes_pod_name}} - bytes allocated",
              "metric": "go_memstats_alloc_bytes",
              "refId": "A",
              "step": 4
            },
            {
              "expr": "rate(go_memstats_alloc_bytes_total{kubernetes_namespace=~\"^($namespace)$\",app_kubernetes_io_name=~\"^$component$\", kubernetes_pod_name=~\"^($pod)$\"}[30s])",
              "format": "time_series",
              "intervalFactor": 2,
              "legendFormat": "{{kubernetes_pod_name}} - alloc rate",
              "metric": "go_memstats_alloc_bytes_total",
              "refId": "B",
              "step": 4
            },
            {
              "expr": "go_memstats_stack_inuse_bytes{kubernetes_namespace=~\"^($namespace)$\",app_kubernetes_io_name=~\"^$component$\", kubernetes_pod_name=~\"^($pod)$\"}",
              "format": "time_series",
              "intervalFactor": 2,
              "legendFormat": "{{kubernetes_pod_name}} - stack inuse",
              "metric": "go_memstats_stack_inuse_bytes",
              "refId": "C",
              "step": 4
            },
            {
              "expr": "go_memstats_heap_inuse_bytes{kubernetes_namespace=~\"^($namespace)$\",app_kubernetes_io_name=~\"^$component$\", kubernetes_pod_name=~\"^($pod)$\"}",
              "format": "time_series",
              "hide": false,
              "intervalFactor": 2,
              "legendFormat": "{{kubernetes_pod_name}} - heap inuse",
              "metric": "go_memstats_heap_inuse_bytes",
              "refId": "D",
              "step": 4
            }
          ],
          "thresholds": [],
          "timeFrom": null,
          "timeRegions": [],
          "timeShift": null,
          "title": "go memstats",
          "tooltip": {
            "msResolution": false,
            "shared": true,
            "sort": 0,
            "value_type": "cumulative"
          },
          "type": "graph",
          "xaxis": {
            "buckets": null,
            "mode": "time",
            "name": null,
            "show": true,
            "values": []
          },
          "yaxes": [
            {
              "format": "bytes",
              "label": null,
              "logBase": 1,
              "max": null,
              "min": null,
              "show": true
            },
            {
              "format": "Bps",
              "label": null,
              "logBase": 1,
              "max": null,
              "min": null,
              "show": true
            }
          ],
          "yaxis": {
            "align": false,
            "alignLevel": null
          }
        },
        {
          "aliasColors": {},
          "bars": false,
          "dashLength": 10,
          "dashes": false,
          "datasource": "Prometheus",
          "editable": true,
          "error": false,
          "fill": 1,
          "fillGradient": 0,
          "grid": {},
          "gridPos": {
            "h": 7,
            "w": 12,
            "x": 12,
            "y": 8
          },
          "hiddenSeries": false,
          "id": 5,
          "isNew": true,
          "legend": {
            "alignAsTable": true,
            "avg": true,
            "current": true,
            "max": true,
            "min": false,
            "rightSide": false,
            "show": true,
            "total": false,
            "values": true
          },
          "lines": true,
          "linewidth": 2,
          "links": [],
          "nullPointMode": "connected",
          "options": {
            "alertThreshold": true
          },
          "percentage": false,
          "pluginVersion": "8.1.0",
          "pointradius": 5,
          "points": false,
          "renderer": "flot",
          "seriesOverrides": [
            {
              "alias": "alloc rate",
              "yaxis": 2
            }
          ],
          "spaceLength": 10,
          "stack": false,
          "steppedLine": false,
          "targets": [
            {
              "expr": "deriv(go_memstats_alloc_bytes{kubernetes_namespace=~\"^($namespace)$\",app_kubernetes_io_name=~\"^$component$\", kubernetes_pod_name=~\"^($pod)$\"}[$interval])",
              "format": "time_series",
              "intervalFactor": 2,
              "legendFormat": "{{kubernetes_pod_name}} - bytes allocated",
              "metric": "go_memstats_alloc_bytes",
              "refId": "A",
              "step": 4
            },
            {
              "expr": "rate(go_memstats_alloc_bytes_total{kubernetes_namespace=~\"^($namespace)$\",app_kubernetes_io_name=~\"^$component$\", kubernetes_pod_name=~\"^($pod)$\"}[$interval])",
              "format": "time_series",
              "intervalFactor": 2,
              "legendFormat": "{{kubernetes_pod_name}} - alloc rate",
              "metric": "go_memstats_alloc_bytes_total",
              "refId": "B",
              "step": 4
            },
            {
              "expr": "deriv(go_memstats_stack_inuse_bytes{kubernetes_namespace=~\"^($namespace)$\",app_kubernetes_io_name=~\"^$component$\", kubernetes_pod_name=~\"^($pod)$\"}[$interval])",
              "format": "time_series",
              "intervalFactor": 2,
              "legendFormat": "{{kubernetes_pod_name}} - stack inuse",
              "metric": "go_memstats_stack_inuse_bytes",
              "refId": "C",
              "step": 4
            },
            {
              "expr": "deriv(go_memstats_heap_inuse_bytes{kubernetes_namespace=~\"^($namespace)$\",app_kubernetes_io_name=~\"^$component$\", kubernetes_pod_name=~\"^($pod)$\"}[$interval])",
              "format": "time_series",
              "hide": false,
              "intervalFactor": 2,
              "legendFormat": "{{kubernetes_pod_name}} - heap inuse",
              "metric": "go_memstats_heap_inuse_bytes",
              "refId": "D",
              "step": 4
            }
          ],
          "thresholds": [],
          "timeFrom": null,
          "timeRegions": [],
          "timeShift": null,
          "title": "go memstats deriv",
          "tooltip": {
            "msResolution": false,
            "shared": true,
            "sort": 0,
            "value_type": "cumulative"
          },
          "type": "graph",
          "xaxis": {
            "buckets": null,
            "mode": "time",
            "name": null,
            "show": true,
            "values": []
          },
          "yaxes": [
            {
              "format": "bytes",
              "label": null,
              "logBase": 1,
              "max": null,
              "min": null,
              "show": true
            },
            {
              "format": "Bps",
              "label": null,
              "logBase": 1,
              "max": null,
              "min": null,
              "show": true
            }
          ],
          "yaxis": {
            "align": false,
            "alignLevel": null
          }
        },
        {
          "aliasColors": {},
          "bars": false,
          "dashLength": 10,
          "dashes": false,
          "datasource": "Prometheus",
          "editable": true,
          "error": false,
          "fill": 1,
          "fillGradient": 0,
          "grid": {},
          "gridPos": {
            "h": 7,
            "w": 12,
            "x": 0,
            "y": 15
          },
          "hiddenSeries": false,
          "id": 3,
          "isNew": true,
          "legend": {
            "alignAsTable": true,
            "avg": true,
            "current": true,
            "max": true,
            "min": false,
            "rightSide": false,
            "show": true,
            "total": false,
            "values": true
          },
          "lines": true,
          "linewidth": 2,
          "links": [],
          "nullPointMode": "connected",
          "options": {
            "alertThreshold": true
          },
          "percentage": false,
          "pluginVersion": "8.1.0",
          "pointradius": 5,
          "points": false,
          "renderer": "flot",
          "seriesOverrides": [],
          "spaceLength": 10,
          "stack": false,
          "steppedLine": false,
          "targets": [
            {
              "expr": "process_open_fds{kubernetes_namespace=~\"^($namespace)$\",app_kubernetes_io_name=~\"^$component$\", kubernetes_pod_name=~\"^($pod)$\"}",
              "format": "time_series",
              "intervalFactor": 2,
              "legendFormat": "{{kubernetes_pod_name}}",
              "metric": "process_open_fds",
              "refId": "A",
              "step": 4
            }
          ],
          "thresholds": [],
          "timeFrom": null,
          "timeRegions": [],
          "timeShift": null,
          "title": "open fds",
          "tooltip": {
            "msResolution": false,
            "shared": true,
            "sort": 0,
            "value_type": "cumulative"
          },
          "type": "graph",
          "xaxis": {
            "buckets": null,
            "mode": "time",
            "name": null,
            "show": true,
            "values": []
          },
          "yaxes": [
            {
              "format": "short",
              "label": null,
              "logBase": 1,
              "max": null,
              "min": null,
              "show": true
            },
            {
              "format": "short",
              "label": null,
              "logBase": 1,
              "max": null,
              "min": null,
              "show": true
            }
          ],
          "yaxis": {
            "align": false,
            "alignLevel": null
          }
        },
        {
          "aliasColors": {},
          "bars": false,
          "dashLength": 10,
          "dashes": false,
          "datasource": "Prometheus",
          "editable": true,
          "error": false,
          "fill": 1,
          "fillGradient": 0,
          "grid": {},
          "gridPos": {
            "h": 7,
            "w": 12,
            "x": 12,
            "y": 15
          },
          "hiddenSeries": false,
          "id": 6,
          "isNew": true,
          "legend": {
            "alignAsTable": true,
            "avg": true,
            "current": true,
            "max": true,
            "min": false,
            "rightSide": false,
            "show": true,
            "total": false,
            "values": true
          },
          "lines": true,
          "linewidth": 2,
          "links": [],
          "nullPointMode": "connected",
          "options": {
            "alertThreshold": true
          },
          "percentage": false,
          "pluginVersion": "8.1.0",
          "pointradius": 5,
          "points": false,
          "renderer": "flot",
          "seriesOverrides": [],
          "spaceLength": 10,
          "stack": false,
          "steppedLine": false,
          "targets": [
            {
              "expr": "deriv(process_open_fds{kubernetes_namespace=~\"^($namespace)$\",app_kubernetes_io_name=~\"^$component$\", kubernetes_pod_name=~\"^($pod)$\"}[$interval])",
              "format": "time_series",
              "intervalFactor": 2,
              "legendFormat": "{{kubernetes_pod_name}}",
              "metric": "process_open_fds",
              "refId": "A",
              "step": 4
            }
          ],
          "thresholds": [],
          "timeFrom": null,
          "timeRegions": [],
          "timeShift": null,
          "title": "open fds deriv",
          "tooltip": {
            "msResolution": false,
            "shared": true,
            "sort": 0,
            "value_type": "cumulative"
          },
          "type": "graph",
          "xaxis": {
            "buckets": null,
            "mode": "time",
            "name": null,
            "show": true,
            "values": []
          },
          "yaxes": [
            {
              "format": "short",
              "label": null,
              "logBase": 1,
              "max": null,
              "min": null,
              "show": true
            },
            {
              "format": "short",
              "label": null,
              "logBase": 1,
              "max": null,
              "min": null,
              "show": true
            }
          ],
          "yaxis": {
            "align": false,
            "alignLevel": null
          }
        },
        {
          "aliasColors": {},
          "bars": false,
          "dashLength": 10,
          "dashes": false,
          "datasource": "Prometheus",
          "editable": true,
          "error": false,
          "fill": 1,
          "fillGradient": 0,
          "grid": {},
          "gridPos": {
            "h": 7,
            "w": 12,
            "x": 0,
            "y": 22
          },
          "hiddenSeries": false,
          "id": 7,
          "isNew": true,
          "legend": {
            "alignAsTable": true,
            "avg": true,
            "current": true,
            "max": true,
            "min": false,
            "rightSide": false,
            "show": true,
            "total": false,
            "values": true
          },
          "lines": true,
          "linewidth": 2,
          "links": [],
          "nullPointMode": "connected",
          "options": {
            "alertThreshold": true
          },
          "percentage": false,
          "pluginVersion": "8.1.0",
          "pointradius": 5,
          "points": false,
          "renderer": "flot",
          "seriesOverrides": [],
          "spaceLength": 10,
          "stack": false,
          "steppedLine": false,
          "targets": [
            {
              "expr": "go_goroutines{kubernetes_namespace=~\"^($namespace)$\",app_kubernetes_io_name=~\"^$component$\", kubernetes_pod_name=~\"^($pod)$\"}",
              "format": "time_series",
              "intervalFactor": 2,
              "legendFormat": "{{kubernetes_pod_name}}",
              "metric": "go_goroutines",
              "refId": "A",
              "step": 4
            }
          ],
          "thresholds": [],
          "timeFrom": null,
          "timeRegions": [],
          "timeShift": null,
          "title": "Goroutines",
          "tooltip": {
            "msResolution": false,
            "shared": true,
            "sort": 0,
            "value_type": "cumulative"
          },
          "type": "graph",
          "xaxis": {
            "buckets": null,
            "mode": "time",
            "name": null,
            "show": true,
            "values": []
          },
          "yaxes": [
            {
              "format": "short",
              "label": null,
              "logBase": 1,
              "max": null,
              "min": null,
              "show": true
            },
            {
              "format": "short",
              "label": null,
              "logBase": 1,
              "max": null,
              "min": null,
              "show": true
            }
          ],
          "yaxis": {
            "align": false,
            "alignLevel": null
          }
        },
        {
          "aliasColors": {},
          "bars": false,
          "dashLength": 10,
          "dashes": false,
          "datasource": "Prometheus",
          "editable": true,
          "error": false,
          "fill": 1,
          "fillGradient": 0,
          "grid": {},
          "gridPos": {
            "h": 7,
            "w": 12,
            "x": 12,
            "y": 22
          },
          "hiddenSeries": false,
          "id": 8,
          "isNew": true,
          "legend": {
            "alignAsTable": true,
            "avg": true,
            "current": true,
            "max": true,
            "min": false,
            "rightSide": false,
            "show": true,
            "total": false,
            "values": true
          },
          "lines": true,
          "linewidth": 2,
          "links": [],
          "nullPointMode": "connected",
          "options": {
            "alertThreshold": true
          },
          "percentage": false,
          "pluginVersion": "8.1.0",
          "pointradius": 5,
          "points": false,
          "renderer": "flot",
          "seriesOverrides": [],
          "spaceLength": 10,
          "stack": false,
          "steppedLine": false,
          "targets": [
            {
              "expr": "go_gc_duration_seconds{kubernetes_namespace=~\"^($namespace)$\",app_kubernetes_io_name=~\"^$component$\", kubernetes_pod_name=~\"^($pod)$\"}",
              "format": "time_series",
              "intervalFactor": 2,
              "legendFormat": "{{kubernetes_pod_name}}: {{quantile}}",
              "metric": "go_gc_duration_seconds",
              "refId": "A",
              "step": 4
            }
          ],
          "thresholds": [],
          "timeFrom": null,
          "timeRegions": [],
          "timeShift": null,
          "title": "GC duration quantiles",
          "tooltip": {
            "msResolution": false,
            "shared": true,
            "sort": 0,
            "value_type": "cumulative"
          },
          "type": "graph",
          "xaxis": {
            "buckets": null,
            "mode": "time",
            "name": null,
            "show": true,
            "values": []
          },
          "yaxes": [
            {
              "format": "s",
              "label": null,
              "logBase": 1,
              "max": null,
              "min": null,
              "show": true
            },
            {
              "format": "short",
              "label": null,
              "logBase": 1,
              "max": null,
              "min": null,
              "show": true
            }
          ],
          "yaxis": {
            "align": false,
            "alignLevel": null
          }
        }
      ],
      "refresh": "",
      "schemaVersion": 30,
      "style": "dark",
      "tags": [],
      "templating": {
        "list": [
          {
            "allValue": ".*",
            "current": {
              "selected": true,
              "text": [
                "home-weka-io"
              ],
              "value": [
                "home-weka-io"
              ]
            },
            "datasource": "Prometheus",
            "definition": "label_values(go_memstats_alloc_bytes, kubernetes_namespace)",
            "description": null,
            "error": null,
            "hide": 0,
            "includeAll": true,
            "label": null,
            "multi": true,
            "name": "namespace",
            "options": [],
            "query": {
              "query": "label_values(go_memstats_alloc_bytes, kubernetes_namespace)",
              "refId": "Prometheus-namespace-Variable-Query"
            },
            "refresh": 2,
            "regex": "",
            "skipUrlSync": false,
            "sort": 1,
            "tagValuesQuery": "",
            "tagsQuery": "",
            "type": "query",
            "useTags": false
          },
          {
            "allValue": ".*",
            "current": {
              "selected": true,
              "text": [
                "stats-handler"
              ],
              "value": [
                "stats-handler"
              ]
            },
            "datasource": "Prometheus",
            "definition": "label_values(process_resident_memory_bytes{kubernetes_namespace=~\"$namespace\"}, app)",
            "description": null,
            "error": null,
            "hide": 0,
            "includeAll": true,
            "label": null,
            "multi": true,
            "name": "component",
            "options": [],
            "query": {
              "query": "label_values(process_resident_memory_bytes{kubernetes_namespace=~\"$namespace\"}, app)",
              "refId": "Prometheus-component-Variable-Query"
            },
            "refresh": 2,
            "regex": "",
            "skipUrlSync": false,
            "sort": 0,
            "tagValuesQuery": "",
            "tagsQuery": "",
            "type": "query",
            "useTags": false
          },
          {
            "allValue": ".*",
            "current": {
              "selected": true,
              "text": [
                "All"
              ],
              "value": [
                "$__all"
              ]
            },
            "datasource": "Prometheus",
            "definition": "label_values(process_resident_memory_bytes{kubernetes_namespace=~\"$namespace\", app_kubernetes_io_name=~\"$component\"}, kubernetes_pod_name)",
            "description": null,
            "error": null,
            "hide": 0,
            "includeAll": true,
            "label": null,
            "multi": true,
            "name": "pod",
            "options": [],
            "query": {
              "query": "label_values(process_resident_memory_bytes{kubernetes_namespace=~\"$namespace\", app_kubernetes_io_name=~\"$component\"}, kubernetes_pod_name)",
              "refId": "Prometheus-pod-Variable-Query"
            },
            "refresh": 2,
            "regex": "",
            "skipUrlSync": false,
            "sort": 0,
            "tagValuesQuery": "",
            "tagsQuery": "",
            "type": "query",
            "useTags": false
          },
          {
            "auto": false,
            "auto_count": 30,
            "auto_min": "10s",
            "current": {
              "selected": false,
              "text": "5m",
              "value": "5m"
            },
            "datasource": null,
            "description": null,
            "error": null,
            "hide": 0,
            "includeAll": false,
            "label": "",
            "multi": false,
            "name": "interval",
            "options": [
              {
                "selected": false,
                "text": "1m",
                "value": "1m"
              },
              {
                "selected": true,
                "text": "5m",
                "value": "5m"
              },
              {
                "selected": false,
                "text": "10m",
                "value": "10m"
              },
              {
                "selected": false,
                "text": "30m",
                "value": "30m"
              },
              {
                "selected": false,
                "text": "1h",
                "value": "1h"
              }
            ],
            "query": "1m,5m,10m,30m,1h",
            "queryValue": "",
            "refresh": 2,
            "skipUrlSync": false,
            "type": "interval"
          }
        ]
      },
      "time": {
        "from": "now-3h",
        "to": "now"
      },
      "timepicker": {
        "refresh_intervals": [
          "5s",
          "10s",
          "30s",
          "1m",
          "5m",
          "15m",
          "30m",
          "1h",
          "2h",
          "1d"
        ],
        "time_options": [
          "5m",
          "15m",
          "1h",
          "6h",
          "12h",
          "24h",
          "2d",
          "7d",
          "30d"
        ]
      },
      "timezone": "browser",
      "title": "Go Processes",
      "uid": "bbFZFgvmz",
      "version": 9
    }
  health_dashboard.json: |-
    {
      "annotations": {
        "list": [
          {
            "builtIn": 1,
            "datasource": "-- Grafana --",
            "enable": true,
            "hide": true,
            "iconColor": "rgba(0, 211, 255, 1)",
            "name": "Annotations & Alerts",
            "target": {
              "limit": 100,
              "matchAny": false,
              "tags": [],
              "type": "dashboard"
            },
            "type": "dashboard"
          }
        ]
      },
      "editable": true,
      "gnetId": null,
      "graphTooltip": 0,
      "id": 6,
      "links": [],
      "panels": [
        {
          "collapsed": false,
          "datasource": null,
          "gridPos": {
            "h": 1,
            "w": 24,
            "x": 0,
            "y": 0
          },
          "id": 14,
          "panels": [],
          "title": "Used Space",
          "type": "row"
        },
        {
          "alert": {
            "alertRuleTags": {},
            "conditions": [
              {
                "evaluator": {
                  "params": [
                    80
                  ],
                  "type": "gt"
                },
                "operator": {
                  "type": "and"
                },
                "query": {
                  "params": [
                    "A",
                    "5m",
                    "now"
                  ]
                },
                "reducer": {
                  "params": [],
                  "type": "avg"
                },
                "type": "query"
              }
            ],
            "executionErrorState": "alerting",
            "for": "5m",
            "frequency": "1m",
            "handler": 1,
            "name": "Used Space in %  alert",
            "noDataState": "keep_state",
            "notifications": []
          },
          "aliasColors": {},
          "bars": false,
          "dashLength": 10,
          "dashes": false,
          "datasource": "Prometheus",
          "decimals": 2,
          "fieldConfig": {
            "defaults": {
              "displayName": "WHL Data Volume",
              "unit": "percent"
            },
            "overrides": []
          },
          "fill": 1,
          "fillGradient": 0,
          "gridPos": {
            "h": 9,
            "w": 24,
            "x": 0,
            "y": 1
          },
          "hiddenSeries": false,
          "id": 6,
          "legend": {
            "avg": false,
            "current": true,
            "max": false,
            "min": false,
            "show": true,
            "total": false,
            "values": true
          },
          "lines": true,
          "linewidth": 1,
          "nullPointMode": "null",
          "options": {
            "alertThreshold": true
          },
          "percentage": false,
          "pluginVersion": "8.1.0",
          "pointradius": 2,
          "points": false,
          "renderer": "flot",
          "seriesOverrides": [],
          "spaceLength": 10,
          "stack": false,
          "steppedLine": false,
          "targets": [
            {
              "exemplar": true,
              "expr": "(sum (node_filesystem_size_bytes{mountpoint=\"/opt/local-path-provisioner\"}) by (instance) - sum (node_filesystem_free_bytes{mountpoint=\"/opt/local-path-provisioner\"}) by (instance)) / sum (node_filesystem_size_bytes{mountpoint=\"/opt/local-path-provisioner\"}) by (instance) * 100",
              "interval": "",
              "legendFormat": "",
              "refId": "A"
            }
          ],
          "thresholds": [
            {
              "colorMode": "critical",
              "fill": true,
              "line": true,
              "op": "gt",
              "value": 80,
              "visible": true
            }
          ],
          "timeFrom": null,
          "timeRegions": [],
          "timeShift": null,
          "title": "Used Space in % ",
          "tooltip": {
            "shared": true,
            "sort": 0,
            "value_type": "individual"
          },
          "type": "graph",
          "xaxis": {
            "buckets": null,
            "mode": "time",
            "name": null,
            "show": true,
            "values": []
          },
          "yaxes": [
            {
              "$$hashKey": "object:370",
              "decimals": 2,
              "format": "percent",
              "label": null,
              "logBase": 1,
              "max": null,
              "min": null,
              "show": true
            },
            {
              "$$hashKey": "object:371",
              "format": "short",
              "label": null,
              "logBase": 1,
              "max": null,
              "min": null,
              "show": true
            }
          ],
          "yaxis": {
            "align": false,
            "alignLevel": null
          }
        },
        {
          "collapsed": false,
          "datasource": null,
          "gridPos": {
            "h": 1,
            "w": 24,
            "x": 0,
            "y": 10
          },
          "id": 16,
          "panels": [],
          "title": "Stats Alerts",
          "type": "row"
        },
        {
          "alert": {
            "alertRuleTags": {},
            "conditions": [
              {
                "evaluator": {
                  "params": [
                    0.9
                  ],
                  "type": "gt"
                },
                "operator": {
                  "type": "and"
                },
                "query": {
                  "params": [
                    "A",
                    "5m",
                    "now"
                  ]
                },
                "reducer": {
                  "params": [],
                  "type": "avg"
                },
                "type": "query"
              }
            ],
            "executionErrorState": "alerting",
            "for": "5m",
            "frequency": "1m",
            "handler": 1,
            "name": "vmstorage space usage alert",
            "noDataState": "keep_state",
            "notifications": []
          },
          "aliasColors": {},
          "bars": false,
          "dashLength": 10,
          "dashes": false,
          "datasource": "Prometheus",
          "decimals": 0,
          "fieldConfig": {
            "defaults": {
              "unit": "percentunit"
            },
            "overrides": []
          },
          "fill": 1,
          "fillGradient": 0,
          "gridPos": {
            "h": 9,
            "w": 12,
            "x": 0,
            "y": 11
          },
          "hiddenSeries": false,
          "id": 10,
          "interval": "5m",
          "legend": {
            "alignAsTable": true,
            "avg": false,
            "current": true,
            "max": false,
            "min": false,
            "rightSide": true,
            "show": true,
            "total": false,
            "values": true
          },
          "lines": true,
          "linewidth": 1,
          "nullPointMode": "null",
          "options": {
            "alertThreshold": true
          },
          "percentage": false,
          "pluginVersion": "8.1.0",
          "pointradius": 2,
          "points": false,
          "renderer": "flot",
          "seriesOverrides": [],
          "spaceLength": 10,
          "stack": false,
          "steppedLine": false,
          "targets": [
            {
              "expr": "label_replace(sum by(kubernetes_pod_name)(vm_data_size_bytes) / ( sum by(kubernetes_pod_name)(vm_data_size_bytes) + sum by(kubernetes_pod_name)(vm_free_disk_space_bytes)), \"storage_node\", \"vmstorage-$1\", \"kubernetes_pod_name\", \".*-([0-9]*)$\") ",
              "interval": "",
              "legendFormat": "{{storage_node}}",
              "refId": "A"
            }
          ],
          "thresholds": [
            {
              "colorMode": "critical",
              "fill": true,
              "line": true,
              "op": "gt",
              "value": 0.9,
              "visible": true
            }
          ],
          "timeFrom": null,
          "timeRegions": [],
          "timeShift": null,
          "title": "vmstorage space usage",
          "tooltip": {
            "shared": true,
            "sort": 2,
            "value_type": "individual"
          },
          "type": "graph",
          "xaxis": {
            "buckets": null,
            "mode": "time",
            "name": null,
            "show": true,
            "values": []
          },
          "yaxes": [
            {
              "$$hashKey": "object:245",
              "decimals": null,
              "format": "percentunit",
              "label": "",
              "logBase": 1,
              "max": "1",
              "min": "0",
              "show": true
            },
            {
              "$$hashKey": "object:246",
              "format": "short",
              "label": null,
              "logBase": 1,
              "max": null,
              "min": null,
              "show": true
            }
          ],
          "yaxis": {
            "align": false,
            "alignLevel": null
          }
        },
        {
          "alert": {
            "alertRuleTags": {},
            "conditions": [
              {
                "evaluator": {
                  "params": [
                    115
                  ],
                  "type": "gt"
                },
                "operator": {
                  "type": "and"
                },
                "query": {
                  "params": [
                    "A",
                    "5m",
                    "now"
                  ]
                },
                "reducer": {
                  "params": [],
                  "type": "avg"
                },
                "type": "query"
              }
            ],
            "executionErrorState": "alerting",
            "for": "5m",
            "frequency": "1m",
            "handler": 1,
            "name": "Queue Wait Duration alert",
            "noDataState": "keep_state",
            "notifications": []
          },
          "aliasColors": {},
          "bars": false,
          "dashLength": 10,
          "dashes": false,
          "datasource": "Prometheus",
          "fill": 1,
          "fillGradient": 0,
          "gridPos": {
            "h": 9,
            "w": 12,
            "x": 12,
            "y": 11
          },
          "hiddenSeries": false,
          "id": 12,
          "interval": "5m",
          "legend": {
            "alignAsTable": true,
            "avg": false,
            "current": false,
            "max": false,
            "min": false,
            "rightSide": true,
            "show": true,
            "total": false,
            "values": false
          },
          "lines": true,
          "linewidth": 1,
          "nullPointMode": "null",
          "options": {
            "alertThreshold": true
          },
          "percentage": false,
          "pluginVersion": "8.1.0",
          "pointradius": 2,
          "points": false,
          "renderer": "flot",
          "seriesOverrides": [],
          "spaceLength": 10,
          "stack": false,
          "steppedLine": false,
          "targets": [
            {
              "exemplar": true,
              "expr": "histogram_quantile(0.99, sum(rate(wekahome_stats_semaphore_acquire_duration_bucket[2m])) by (le))",
              "hide": false,
              "interval": "",
              "legendFormat": "99%",
              "refId": "A"
            }
          ],
          "thresholds": [
            {
              "colorMode": "critical",
              "fill": true,
              "line": true,
              "op": "gt",
              "value": 115,
              "visible": true
            }
          ],
          "timeFrom": null,
          "timeRegions": [],
          "timeShift": null,
          "title": "Queue Wait Duration",
          "tooltip": {
            "shared": true,
            "sort": 0,
            "value_type": "individual"
          },
          "type": "graph",
          "xaxis": {
            "buckets": null,
            "mode": "time",
            "name": null,
            "show": true,
            "values": []
          },
          "yaxes": [
            {
              "format": "s",
              "label": null,
              "logBase": 1,
              "max": null,
              "min": null,
              "show": true
            },
            {
              "format": "short",
              "label": null,
              "logBase": 1,
              "max": null,
              "min": null,
              "show": true
            }
          ],
          "yaxis": {
            "align": false,
            "alignLevel": null
          }
        }
      ],
      "refresh": "2h",
      "schemaVersion": 30,
      "style": "dark",
      "tags": [],
      "templating": {
        "list": []
      },
      "time": {
        "from": "now-12h",
        "to": "now"
      },
      "timepicker": {},
      "timezone": "",
      "title": "WekaHome Health Dashboard",
      "uid": "WH_Health_Dashboard_UID_1",
      "version": 5
    }
  kubernetes-monitoring-overview_rev1.json: |-
    {
      "__inputs": [
        {
          "name": "DS_PROMETHEUS",
          "label": "Prometheus",
          "description": "",
          "type": "datasource",
          "pluginId": "prometheus",
          "pluginName": "Prometheus"
        }
      ],
      "__requires": [
        {
          "type": "panel",
          "id": "bargauge",
          "name": "Bar gauge",
          "version": ""
        },
        {
          "type": "panel",
          "id": "gauge",
          "name": "Gauge",
          "version": ""
        },
        {
          "type": "grafana",
          "id": "grafana",
          "name": "Grafana",
          "version": "8.0.3"
        },
        {
          "type": "panel",
          "id": "graph",
          "name": "Graph (old)",
          "version": ""
        },
        {
          "type": "datasource",
          "id": "prometheus",
          "name": "Prometheus",
          "version": "1.0.0"
        },
        {
          "type": "panel",
          "id": "stat",
          "name": "Stat",
          "version": ""
        }
      ],
      "annotations": {
        "list": [
          {
            "builtIn": 1,
            "datasource": "-- Grafana --",
            "enable": true,
            "hide": true,
            "iconColor": "rgba(0, 211, 255, 1)",
            "name": "Annotations & Alerts",
            "type": "dashboard"
          }
        ]
      },
      "description": "Dashboard for Kubernetes cluster with Prometheus.",
      "editable": true,
      "gnetId": 14623,
      "graphTooltip": 0,
      "id": null,
      "iteration": 1624542377135,
      "links": [],
      "panels": [
        {
          "collapsed": false,
          "datasource": "${DS_PROMETHEUS}",
          "gridPos": {
            "h": 1,
            "w": 24,
            "x": 0,
            "y": 0
          },
          "id": 79,
          "panels": [],
          "title": "Cluster Health",
          "type": "row"
        },
        {
          "cacheTimeout": null,
          "datasource": "$cluster",
          "fieldConfig": {
            "defaults": {
              "color": {
                "mode": "thresholds"
              },
              "mappings": [
                {
                  "options": {
                    "match": "null",
                    "result": {
                      "text": "UP"
                    }
                  },
                  "type": "special"
                }
              ],
              "thresholds": {
                "mode": "absolute",
                "steps": [
                  {
                    "color": "green",
                    "value": null
                  },
                  {
                    "color": "red",
                    "value": 80
                  }
                ]
              },
              "unit": "none"
            },
            "overrides": []
          },
          "gridPos": {
            "h": 4,
            "w": 4,
            "x": 0,
            "y": 1
          },
          "id": 81,
          "interval": null,
          "links": [],
          "maxDataPoints": 100,
          "options": {
            "colorMode": "value",
            "graphMode": "none",
            "justifyMode": "auto",
            "orientation": "horizontal",
            "reduceOptions": {
              "calcs": [
                "sum"
              ],
              "fields": "",
              "values": false
            },
            "text": {},
            "textMode": "auto"
          },
          "pluginVersion": "8.0.3",
          "targets": [
            {
              "expr": "sum(up{job=~\"apiserver|kube-scheduler|kube-controller-manager\"} == 0)",
              "refId": "A"
            }
          ],
          "timeFrom": null,
          "timeShift": null,
          "title": "Control Plane Status",
          "type": "stat"
        },
        {
          "cacheTimeout": null,
          "datasource": "${DS_PROMETHEUS}",
          "fieldConfig": {
            "defaults": {
              "color": {
                "mode": "thresholds"
              },
              "mappings": [
                {
                  "options": {
                    "match": "null",
                    "result": {
                      "color": "#299c46",
                      "text": "0"
                    }
                  },
                  "type": "special"
                }
              ],
              "thresholds": {
                "mode": "absolute",
                "steps": [
                  {
                    "color": "#299c46",
                    "value": null
                  },
                  {
                    "color": "rgba(237, 129, 40, 0.89)",
                    "value": 1
                  },
                  {
                    "color": "#d44a3a",
                    "value": 3
                  }
                ]
              },
              "unit": "none"
            },
            "overrides": []
          },
          "gridPos": {
            "h": 2,
            "w": 4,
            "x": 4,
            "y": 1
          },
          "id": 117,
          "interval": null,
          "links": [],
          "maxDataPoints": 100,
          "options": {
            "colorMode": "background",
            "graphMode": "none",
            "justifyMode": "auto",
            "orientation": "horizontal",
            "reduceOptions": {
              "calcs": [
                "lastNotNull"
              ],
              "fields": "",
              "values": false
            },
            "text": {},
            "textMode": "auto"
          },
          "pluginVersion": "8.0.3",
          "targets": [
            {
              "exemplar": true,
              "expr": "sum(kube_node_spec_unschedulable)",
              "format": "time_series",
              "interval": "",
              "intervalFactor": 1,
              "legendFormat": "",
              "refId": "A"
            }
          ],
          "title": "Node Unschedulable",
          "type": "stat"
        },
        {
          "datasource": null,
          "fieldConfig": {
            "defaults": {
              "color": {
                "mode": "thresholds"
              },
              "mappings": [],
              "thresholds": {
                "mode": "absolute",
                "steps": [
                  {
                    "color": "green",
                    "value": null
                  },
                  {
                    "color": "red",
                    "value": 80
                  }
                ]
              }
            },
            "overrides": []
          },
          "gridPos": {
            "h": 4,
            "w": 4,
            "x": 8,
            "y": 1
          },
          "id": 127,
          "links": [],
          "options": {
            "displayMode": "gradient",
            "orientation": "auto",
            "reduceOptions": {
              "calcs": [
                "lastNotNull"
              ],
              "fields": "",
              "values": false
            },
            "showUnfilled": true,
            "text": {}
          },
          "pluginVersion": "8.0.3",
          "targets": [
            {
              "expr": "sum(kube_node_info{node=~\"$Node\"})",
              "format": "time_series",
              "intervalFactor": 2,
              "legendFormat": "Total",
              "refId": "A"
            },
            {
              "exemplar": true,
              "expr": "sum(kube_node_status_condition{condition=\"Ready\", node=~\"$Node\", status!=\"true\"})",
              "format": "time_series",
              "instant": false,
              "interval": "",
              "intervalFactor": 2,
              "legendFormat": "Unavailable",
              "refId": "B"
            }
          ],
          "timeFrom": null,
          "timeShift": null,
          "title": "Nodes",
          "type": "bargauge"
        },
        {
          "cacheTimeout": null,
          "datasource": "$cluster",
          "description": "requested cores / all capacity cores",
          "fieldConfig": {
            "defaults": {
              "color": {
                "mode": "thresholds"
              },
              "decimals": 2,
              "mappings": [
                {
                  "options": {
                    "match": "null",
                    "result": {
                      "text": "N/A"
                    }
                  },
                  "type": "special"
                }
              ],
              "max": 100,
              "min": 0,
              "thresholds": {
                "mode": "absolute",
                "steps": [
                  {
                    "color": "#629e51",
                    "value": null
                  },
                  {
                    "color": "#f9934e",
                    "value": 65
                  },
                  {
                    "color": "#e24d42",
                    "value": 90
                  }
                ]
              },
              "unit": "percent"
            },
            "overrides": []
          },
          "gridPos": {
            "h": 4,
            "w": 3,
            "x": 12,
            "y": 1
          },
          "id": 6,
          "interval": null,
          "links": [],
          "maxDataPoints": 100,
          "options": {
            "orientation": "horizontal",
            "reduceOptions": {
              "calcs": [
                "lastNotNull"
              ],
              "fields": "",
              "values": false
            },
            "showThresholdLabels": false,
            "showThresholdMarkers": true,
            "text": {}
          },
          "pluginVersion": "8.0.3",
          "targets": [
            {
              "exemplar": true,
              "expr": "sum (kube_pod_container_resource_requests{node=~\"^$Node$\",resource=\"cpu\"}) / sum (machine_cpu_cores{kubernetes_io_hostname=~\"^$Node$\"}) * 100",
              "format": "time_series",
              "interval": "10s",
              "intervalFactor": 1,
              "legendFormat": "",
              "refId": "A",
              "step": 10
            }
          ],
          "title": "CPU Requested ($Node)",
          "type": "gauge"
        },
        {
          "cacheTimeout": null,
          "datasource": "$cluster",
          "description": "requested mem/all capacity mem",
          "fieldConfig": {
            "defaults": {
              "color": {
                "mode": "thresholds"
              },
              "mappings": [
                {
                  "options": {
                    "match": "null",
                    "result": {
                      "text": "N/A"
                    }
                  },
                  "type": "special"
                }
              ],
              "max": 100,
              "min": 0,
              "thresholds": {
                "mode": "absolute",
                "steps": [
                  {
                    "color": "#629e51",
                    "value": null
                  },
                  {
                    "color": "#f9934e",
                    "value": 65
                  },
                  {
                    "color": "#e24d42",
                    "value": 90
                  }
                ]
              },
              "unit": "percent"
            },
            "overrides": []
          },
          "gridPos": {
            "h": 4,
            "w": 3,
            "x": 15,
            "y": 1
          },
          "id": 4,
          "interval": null,
          "links": [],
          "maxDataPoints": 100,
          "options": {
            "orientation": "horizontal",
            "reduceOptions": {
              "calcs": [
                "lastNotNull"
              ],
              "fields": "",
              "values": false
            },
            "showThresholdLabels": false,
            "showThresholdMarkers": true,
            "text": {}
          },
          "pluginVersion": "8.0.3",
          "targets": [
            {
              "exemplar": true,
              "expr": "sum (kube_pod_container_resource_requests{node=~\"^$Node$\",resource=\"memory\"}) / sum (machine_memory_bytes{kubernetes_io_hostname=~\"^$Node$\"}) * 100",
              "format": "time_series",
              "interval": "10s",
              "intervalFactor": 1,
              "legendFormat": "",
              "refId": "A",
              "step": 10
            }
          ],
          "title": "Memory Requeted ($Node)",
          "type": "gauge"
        },
        {
          "cacheTimeout": null,
          "datasource": "${DS_PROMETHEUS}",
          "fieldConfig": {
            "defaults": {
              "color": {
                "mode": "thresholds"
              },
              "mappings": [
                {
                  "options": {
                    "match": "null",
                    "result": {
                      "color": "#299c46",
                      "text": "0"
                    }
                  },
                  "type": "special"
                }
              ],
              "thresholds": {
                "mode": "absolute",
                "steps": [
                  {
                    "color": "#299c46",
                    "value": null
                  },
                  {
                    "color": "rgba(237, 129, 40, 0.89)",
                    "value": 1
                  },
                  {
                    "color": "#d44a3a"
                  }
                ]
              },
              "unit": "none"
            },
            "overrides": []
          },
          "gridPos": {
            "h": 2,
            "w": 3,
            "x": 18,
            "y": 1
          },
          "id": 119,
          "interval": null,
          "links": [],
          "maxDataPoints": 100,
          "options": {
            "colorMode": "background",
            "graphMode": "none",
            "justifyMode": "auto",
            "orientation": "horizontal",
            "reduceOptions": {
              "calcs": [
                "lastNotNull"
              ],
              "fields": "",
              "values": false
            },
            "text": {},
            "textMode": "auto"
          },
          "pluginVersion": "8.0.3",
          "targets": [
            {
              "expr": "sum(kube_node_status_condition{condition=\"DiskPressure\", node=~\"$Node\", status!=\"false\"})",
              "format": "time_series",
              "intervalFactor": 1,
              "refId": "A"
            }
          ],
          "title": "Disk Pressure",
          "type": "stat"
        },
        {
          "cacheTimeout": null,
          "datasource": "${DS_PROMETHEUS}",
          "fieldConfig": {
            "defaults": {
              "color": {
                "mode": "thresholds"
              },
              "mappings": [
                {
                  "options": {
                    "match": "null",
                    "result": {
                      "color": "#299c46",
                      "text": "0"
                    }
                  },
                  "type": "special"
                }
              ],
              "thresholds": {
                "mode": "absolute",
                "steps": [
                  {
                    "color": "#299c46",
                    "value": null
                  },
                  {
                    "color": "rgba(237, 129, 40, 0.89)",
                    "value": 1
                  },
                  {
                    "color": "#d44a3a"
                  }
                ]
              },
              "unit": "none"
            },
            "overrides": []
          },
          "gridPos": {
            "h": 2,
            "w": 3,
            "x": 21,
            "y": 1
          },
          "id": 125,
          "interval": null,
          "links": [],
          "maxDataPoints": 100,
          "options": {
            "colorMode": "background",
            "graphMode": "area",
            "justifyMode": "auto",
            "orientation": "horizontal",
            "reduceOptions": {
              "calcs": [
                "lastNotNull"
              ],
              "fields": "",
              "values": false
            },
            "text": {},
            "textMode": "auto"
          },
          "pluginVersion": "8.0.3",
          "targets": [
            {
              "expr": "sum(kube_node_status_condition{condition=\"NetworkUnavailable\", node=~\"$Node\", status!=\"false\"})",
              "format": "time_series",
              "intervalFactor": 1,
              "refId": "A"
            }
          ],
          "title": "Network Unavailable",
          "type": "stat"
        },
        {
          "cacheTimeout": null,
          "datasource": "$cluster",
          "fieldConfig": {
            "defaults": {
              "color": {
                "mode": "thresholds"
              },
              "mappings": [
                {
                  "options": {
                    "match": "null",
                    "result": {
                      "text": "N/A"
                    }
                  },
                  "type": "special"
                }
              ],
              "thresholds": {
                "mode": "absolute",
                "steps": [
                  {
                    "color": "#299c46",
                    "value": null
                  },
                  {
                    "color": "rgba(237, 129, 40, 0.89)",
                    "value": 1
                  },
                  {
                    "color": "#d44a3a",
                    "value": 3
                  }
                ]
              },
              "unit": "none"
            },
            "overrides": []
          },
          "gridPos": {
            "h": 2,
            "w": 4,
            "x": 4,
            "y": 3
          },
          "id": 83,
          "interval": null,
          "links": [],
          "maxDataPoints": 100,
          "options": {
            "colorMode": "value",
            "graphMode": "none",
            "justifyMode": "auto",
            "orientation": "horizontal",
            "reduceOptions": {
              "calcs": [
                "lastNotNull"
              ],
              "fields": "",
              "values": false
            },
            "text": {},
            "textMode": "auto"
          },
          "pluginVersion": "8.0.3",
          "targets": [
            {
              "expr": "sum(kube_node_status_condition{condition=\"Ready\",status!=\"true\"})",
              "refId": "A"
            }
          ],
          "timeFrom": null,
          "timeShift": null,
          "title": "Node Not Ready",
          "type": "stat"
        },
        {
          "cacheTimeout": null,
          "datasource": "${DS_PROMETHEUS}",
          "fieldConfig": {
            "defaults": {
              "color": {
                "mode": "thresholds"
              },
              "mappings": [
                {
                  "options": {
                    "match": "null",
                    "result": {
                      "color": "#299c46",
                      "text": "0"
                    }
                  },
                  "type": "special"
                }
              ],
              "thresholds": {
                "mode": "absolute",
                "steps": [
                  {
                    "color": "#299c46",
                    "value": null
                  },
                  {
                    "color": "rgba(237, 129, 40, 0.89)",
                    "value": 1
                  },
                  {
                    "color": "#d44a3a"
                  }
                ]
              },
              "unit": "none"
            },
            "overrides": []
          },
          "gridPos": {
            "h": 2,
            "w": 3,
            "x": 18,
            "y": 3
          },
          "id": 121,
          "interval": null,
          "links": [],
          "maxDataPoints": 100,
          "options": {
            "colorMode": "background",
            "graphMode": "none",
            "justifyMode": "auto",
            "orientation": "horizontal",
            "reduceOptions": {
              "calcs": [
                "lastNotNull"
              ],
              "fields": "",
              "values": false
            },
            "text": {},
            "textMode": "auto"
          },
          "pluginVersion": "8.0.3",
          "targets": [
            {
              "expr": "sum(kube_node_status_condition{condition=\"MemoryPressure\", node=~\"$Node\", status!=\"false\"})",
              "format": "time_series",
              "intervalFactor": 1,
              "refId": "A"
            }
          ],
          "title": "Memory Pressure",
          "type": "stat"
        },
        {
          "cacheTimeout": null,
          "datasource": "${DS_PROMETHEUS}",
          "fieldConfig": {
            "defaults": {
              "color": {
                "mode": "thresholds"
              },
              "mappings": [
                {
                  "options": {
                    "match": "null",
                    "result": {
                      "color": "#299c46",
                      "text": "0"
                    }
                  },
                  "type": "special"
                }
              ],
              "thresholds": {
                "mode": "absolute",
                "steps": [
                  {
                    "color": "#299c46",
                    "value": null
                  },
                  {
                    "color": "rgba(237, 129, 40, 0.89)",
                    "value": 1
                  },
                  {
                    "color": "#d44a3a"
                  }
                ]
              },
              "unit": "none"
            },
            "overrides": []
          },
          "gridPos": {
            "h": 2,
            "w": 3,
            "x": 21,
            "y": 3
          },
          "id": 123,
          "interval": null,
          "links": [],
          "maxDataPoints": 100,
          "options": {
            "colorMode": "background",
            "graphMode": "none",
            "justifyMode": "auto",
            "orientation": "horizontal",
            "reduceOptions": {
              "calcs": [
                "lastNotNull"
              ],
              "fields": "",
              "values": false
            },
            "text": {},
            "textMode": "auto"
          },
          "pluginVersion": "8.0.3",
          "targets": [
            {
              "expr": "sum(kube_node_status_condition{condition=\"PIDPressure\", node=~\"$Node\", status!=\"false\"})",
              "format": "time_series",
              "intervalFactor": 1,
              "refId": "A"
            }
          ],
          "title": "PID Pressure",
          "type": "stat"
        },
        {
          "collapsed": false,
          "datasource": "${DS_PROMETHEUS}",
          "gridPos": {
            "h": 1,
            "w": 24,
            "x": 0,
            "y": 5
          },
          "id": 71,
          "panels": [],
          "title": "Total usage",
          "type": "row"
        },
        {
          "cacheTimeout": null,
          "datasource": "$cluster",
          "fieldConfig": {
            "defaults": {
              "color": {
                "mode": "thresholds"
              },
              "mappings": [],
              "max": 100,
              "min": 0,
              "thresholds": {
                "mode": "absolute",
                "steps": [
                  {
                    "color": "green",
                    "value": null
                  },
                  {
                    "color": "red",
                    "value": 80
                  }
                ]
              },
              "unit": "percent"
            },
            "overrides": []
          },
          "gridPos": {
            "h": 5,
            "w": 4,
            "x": 0,
            "y": 6
          },
          "id": 66,
          "links": [],
          "options": {
            "orientation": "horizontal",
            "reduceOptions": {
              "calcs": [
                "lastNotNull"
              ],
              "fields": "",
              "values": false
            },
            "showThresholdLabels": false,
            "showThresholdMarkers": true,
            "text": {}
          },
          "pluginVersion": "8.0.3",
          "repeat": null,
          "repeatDirection": "v",
          "targets": [
            {
              "exemplar": true,
              "expr": "(sum(kube_pod_info{kubernetes_node=~\"^$Node$\"})) * 100 / (sum(kube_node_info) * 110)",
              "format": "time_series",
              "interval": "10s",
              "intervalFactor": 1,
              "legendFormat": "",
              "refId": "A",
              "step": 10
            }
          ],
          "timeFrom": null,
          "timeShift": null,
          "title": "Pod Usage ($Node)",
          "type": "gauge"
        },
        {
          "cacheTimeout": null,
          "datasource": "$cluster",
          "fieldConfig": {
            "defaults": {
              "color": {
                "mode": "thresholds"
              },
              "mappings": [],
              "max": 100,
              "min": 0,
              "thresholds": {
                "mode": "absolute",
                "steps": [
                  {
                    "color": "green",
                    "value": null
                  },
                  {
                    "color": "red",
                    "value": 80
                  }
                ]
              },
              "unit": "percent"
            },
            "overrides": []
          },
          "gridPos": {
            "h": 5,
            "w": 6,
            "x": 4,
            "y": 6
          },
          "id": 97,
          "links": [],
          "options": {
            "displayMode": "lcd",
            "orientation": "horizontal",
            "reduceOptions": {
              "calcs": [
                "lastNotNull"
              ],
              "fields": "",
              "values": false
            },
            "showUnfilled": true,
            "text": {}
          },
          "pluginVersion": "8.0.3",
          "targets": [
            {
              "expr": "100 - (avg (irate(node_cpu_seconds_total{mode=\"idle\",kubernetes_node=~\"^$Node$\",job=\"kubernetes-service-endpoints\"}[5m])) * 100)",
              "instant": false,
              "legendFormat": "",
              "refId": "A"
            }
          ],
          "timeFrom": null,
          "timeShift": null,
          "title": "CPU Usage ($Node)",
          "type": "bargauge"
        },
        {
          "cacheTimeout": null,
          "datasource": "$cluster",
          "fieldConfig": {
            "defaults": {
              "color": {
                "mode": "thresholds"
              },
              "mappings": [],
              "max": 100,
              "min": 0,
              "thresholds": {
                "mode": "absolute",
                "steps": [
                  {
                    "color": "green",
                    "value": null
                  },
                  {
                    "color": "red",
                    "value": 80
                  }
                ]
              },
              "unit": "percent"
            },
            "overrides": []
          },
          "gridPos": {
            "h": 5,
            "w": 7,
            "x": 10,
            "y": 6
          },
          "id": 99,
          "links": [],
          "options": {
            "displayMode": "lcd",
            "orientation": "horizontal",
            "reduceOptions": {
              "calcs": [
                "lastNotNull"
              ],
              "fields": "",
              "values": false
            },
            "showUnfilled": true,
            "text": {}
          },
          "pluginVersion": "8.0.3",
          "targets": [
            {
              "expr": "100 * (1- ((avg_over_time(node_memory_MemFree_bytes{kubernetes_node=~\"^$Node$\", job=\"kubernetes-service-endpoints\"}[5m]) + avg_over_time(node_memory_Cached_bytes{kubernetes_node=~\"^$Node$\", job=\"kubernetes-service-endpoints\"}[10m]) + avg_over_time(node_memory_Buffers_bytes{kubernetes_node=~\"^$Node$\",job=\"kubernetes-service-endpoints\"}[5m])) / avg_over_time(node_memory_MemTotal_bytes{kubernetes_node=~\"^$Node$\",job=\"kubernetes-service-endpoints\"}[5m])))",
              "legendFormat": "{{kubernetes_node}}",
              "refId": "A"
            }
          ],
          "timeFrom": null,
          "timeShift": null,
          "title": "Mem Usage ($Node)",
          "type": "bargauge"
        },
        {
          "cacheTimeout": null,
          "datasource": "$cluster",
          "fieldConfig": {
            "defaults": {
              "color": {
                "mode": "thresholds"
              },
              "mappings": [],
              "max": 100,
              "min": 0,
              "thresholds": {
                "mode": "absolute",
                "steps": [
                  {
                    "color": "green",
                    "value": null
                  },
                  {
                    "color": "red",
                    "value": 80
                  }
                ]
              },
              "unit": "percent"
            },
            "overrides": []
          },
          "gridPos": {
            "h": 5,
            "w": 7,
            "x": 17,
            "y": 6
          },
          "id": 7,
          "links": [],
          "options": {
            "displayMode": "lcd",
            "orientation": "horizontal",
            "reduceOptions": {
              "calcs": [
                "lastNotNull"
              ],
              "fields": "",
              "values": false
            },
            "showUnfilled": true,
            "text": {}
          },
          "pluginVersion": "8.0.3",
          "targets": [
            {
              "expr": "sum (container_fs_usage_bytes{device=~\"^/dev/.*$\",id=\"/\",kubernetes_io_hostname=~\"^$Node$\",job=\"kubernetes-service-endpoints\"}) / sum (container_fs_limit_bytes{device=~\"^/dev/.*$\",id=\"/\",kubernetes_io_hostname=~\"^$Node$\"}) * 100",
              "format": "time_series",
              "hide": true,
              "interval": "10s",
              "intervalFactor": 1,
              "legendFormat": "",
              "metric": "",
              "refId": "A",
              "step": 10
            },
            {
              "expr": "100 - ((node_filesystem_avail_bytes{mountpoint=\"/\",fstype!=\"rootfs\",kubernetes_node=~\"^$Node$\",job=\"kubernetes-service-endpoints\"} * 100) / node_filesystem_size_bytes{mountpoint=\"/\",fstype!=\"rootfs\",kubernetes_node=~\"^$Node$\",job=\"kubernetes-service-endpoints\"})",
              "instant": false,
              "legendFormat": "{{kubernetes_node}}",
              "refId": "B"
            }
          ],
          "timeFrom": null,
          "timeShift": null,
          "title": "Filesystem Usage ($Node)",
          "type": "bargauge"
        },
        {
          "cacheTimeout": null,
          "datasource": "$cluster",
          "fieldConfig": {
            "defaults": {
              "color": {
                "fixedColor": "rgb(31, 120, 193)",
                "mode": "fixed"
              },
              "mappings": [
                {
                  "options": {
                    "match": "null",
                    "result": {
                      "text": "N/A"
                    }
                  },
                  "type": "special"
                }
              ],
              "thresholds": {
                "mode": "absolute",
                "steps": [
                  {
                    "color": "green",
                    "value": null
                  },
                  {
                    "color": "red",
                    "value": 80
                  }
                ]
              },
              "unit": "none"
            },
            "overrides": []
          },
          "gridPos": {
            "h": 4,
            "w": 2,
            "x": 0,
            "y": 11
          },
          "id": 75,
          "interval": null,
          "links": [],
          "maxDataPoints": 100,
          "options": {
            "colorMode": "none",
            "graphMode": "area",
            "justifyMode": "auto",
            "orientation": "horizontal",
            "reduceOptions": {
              "calcs": [
                "lastNotNull"
              ],
              "fields": "",
              "values": false
            },
            "text": {},
            "textMode": "auto"
          },
          "pluginVersion": "8.0.3",
          "targets": [
            {
              "expr": "count(kube_pod_info{node=~\"^$Node$\"})",
              "format": "time_series",
              "interval": "10s",
              "intervalFactor": 1,
              "refId": "A",
              "step": 10
            }
          ],
          "title": "Pods",
          "type": "stat"
        },
        {
          "cacheTimeout": null,
          "datasource": "$cluster",
          "fieldConfig": {
            "defaults": {
              "color": {
                "fixedColor": "rgb(31, 120, 193)",
                "mode": "fixed"
              },
              "mappings": [
                {
                  "options": {
                    "match": "null",
                    "result": {
                      "text": "N/A"
                    }
                  },
                  "type": "special"
                }
              ],
              "thresholds": {
                "mode": "absolute",
                "steps": [
                  {
                    "color": "#299c46",
                    "value": null
                  },
                  {
                    "color": "rgba(237, 129, 40, 0.89)",
                    "value": 35
                  },
                  {
                    "color": "#d44a3a",
                    "value": 65
                  }
                ]
              },
              "unit": "none"
            },
            "overrides": []
          },
          "gridPos": {
            "h": 4,
            "w": 2,
            "x": 2,
            "y": 11
          },
          "id": 77,
          "interval": null,
          "links": [],
          "maxDataPoints": 100,
          "options": {
            "colorMode": "none",
            "graphMode": "area",
            "justifyMode": "auto",
            "orientation": "horizontal",
            "reduceOptions": {
              "calcs": [
                "lastNotNull"
              ],
              "fields": "",
              "values": false
            },
            "text": {},
            "textMode": "auto"
          },
          "pluginVersion": "8.0.3",
          "targets": [
            {
              "exemplar": true,
              "expr": "sum(kube_node_info) * 110",
              "interval": "",
              "legendFormat": "",
              "refId": "A"
            }
          ],
          "timeFrom": null,
          "timeShift": null,
          "title": "Capacity pods",
          "type": "stat"
        },
        {
          "cacheTimeout": null,
          "datasource": "$cluster",
          "fieldConfig": {
            "defaults": {
              "color": {
                "fixedColor": "rgb(31, 120, 193)",
                "mode": "fixed"
              },
              "decimals": 2,
              "mappings": [
                {
                  "options": {
                    "match": "null",
                    "result": {
                      "text": "N/A"
                    }
                  },
                  "type": "special"
                }
              ],
              "thresholds": {
                "mode": "absolute",
                "steps": [
                  {
                    "color": "green",
                    "value": null
                  },
                  {
                    "color": "red",
                    "value": 80
                  }
                ]
              },
              "unit": "none"
            },
            "overrides": []
          },
          "gridPos": {
            "h": 4,
            "w": 2,
            "x": 4,
            "y": 11
          },
          "id": 11,
          "interval": null,
          "links": [],
          "maxDataPoints": 100,
          "options": {
            "colorMode": "none",
            "graphMode": "area",
            "justifyMode": "auto",
            "orientation": "horizontal",
            "reduceOptions": {
              "calcs": [
                "lastNotNull"
              ],
              "fields": "",
              "values": false
            },
            "text": {},
            "textMode": "auto"
          },
          "pluginVersion": "8.0.3",
          "targets": [
            {
              "expr": "sum (rate (container_cpu_usage_seconds_total{id=\"/\",kubernetes_io_hostname=~\"^$Node$\"}[2m]))",
              "format": "time_series",
              "interval": "10s",
              "intervalFactor": 1,
              "refId": "A",
              "step": 10
            }
          ],
          "title": "Used",
          "type": "stat"
        },
        {
          "cacheTimeout": null,
          "datasource": "$cluster",
          "fieldConfig": {
            "defaults": {
              "color": {
                "fixedColor": "rgb(31, 120, 193)",
                "mode": "fixed"
              },
              "decimals": 2,
              "mappings": [
                {
                  "options": {
                    "match": "null",
                    "result": {
                      "text": "N/A"
                    }
                  },
                  "type": "special"
                }
              ],
              "thresholds": {
                "mode": "absolute",
                "steps": [
                  {
                    "color": "green",
                    "value": null
                  },
                  {
                    "color": "red",
                    "value": 80
                  }
                ]
              },
              "unit": "none"
            },
            "overrides": []
          },
          "gridPos": {
            "h": 4,
            "w": 2,
            "x": 6,
            "y": 11
          },
          "id": 73,
          "interval": null,
          "links": [],
          "maxDataPoints": 100,
          "options": {
            "colorMode": "none",
            "graphMode": "area",
            "justifyMode": "auto",
            "orientation": "horizontal",
            "reduceOptions": {
              "calcs": [
                "lastNotNull"
              ],
              "fields": "",
              "values": false
            },
            "text": {},
            "textMode": "auto"
          },
          "pluginVersion": "8.0.3",
          "targets": [
            {
              "exemplar": true,
              "expr": "sum (kube_pod_container_resource_requests{node=~\"^$Node$\",resource=\"cpu\"})",
              "format": "time_series",
              "interval": "10s",
              "intervalFactor": 1,
              "legendFormat": "",
              "refId": "A",
              "step": 10
            }
          ],
          "title": "Requests",
          "type": "stat"
        },
        {
          "cacheTimeout": null,
          "datasource": "$cluster",
          "fieldConfig": {
            "defaults": {
              "color": {
                "fixedColor": "rgb(31, 120, 193)",
                "mode": "fixed"
              },
              "decimals": 2,
              "mappings": [
                {
                  "options": {
                    "match": "null",
                    "result": {
                      "text": "N/A"
                    }
                  },
                  "type": "special"
                }
              ],
              "thresholds": {
                "mode": "absolute",
                "steps": [
                  {
                    "color": "green",
                    "value": null
                  },
                  {
                    "color": "red",
                    "value": 80
                  }
                ]
              },
              "unit": "none"
            },
            "overrides": []
          },
          "gridPos": {
            "h": 4,
            "w": 2,
            "x": 8,
            "y": 11
          },
          "id": 69,
          "interval": null,
          "links": [],
          "maxDataPoints": 100,
          "options": {
            "colorMode": "none",
            "graphMode": "area",
            "justifyMode": "auto",
            "orientation": "horizontal",
            "reduceOptions": {
              "calcs": [
                "lastNotNull"
              ],
              "fields": "",
              "values": false
            },
            "text": {},
            "textMode": "auto"
          },
          "pluginVersion": "8.0.3",
          "targets": [
            {
              "expr": "sum (machine_cpu_cores{kubernetes_io_hostname=~\"^$Node$\"})",
              "format": "time_series",
              "interval": "10s",
              "intervalFactor": 1,
              "refId": "A",
              "step": 10
            }
          ],
          "title": "Total",
          "type": "stat"
        },
        {
          "cacheTimeout": null,
          "datasource": "$cluster",
          "fieldConfig": {
            "defaults": {
              "color": {
                "fixedColor": "rgb(31, 120, 193)",
                "mode": "fixed"
              },
              "decimals": 2,
              "mappings": [
                {
                  "options": {
                    "match": "null",
                    "result": {
                      "text": "N/A"
                    }
                  },
                  "type": "special"
                }
              ],
              "thresholds": {
                "mode": "absolute",
                "steps": [
                  {
                    "color": "green",
                    "value": null
                  },
                  {
                    "color": "red",
                    "value": 80
                  }
                ]
              },
              "unit": "bytes"
            },
            "overrides": []
          },
          "gridPos": {
            "h": 4,
            "w": 2,
            "x": 10,
            "y": 11
          },
          "id": 9,
          "interval": null,
          "links": [],
          "maxDataPoints": 100,
          "options": {
            "colorMode": "none",
            "graphMode": "area",
            "justifyMode": "auto",
            "orientation": "horizontal",
            "reduceOptions": {
              "calcs": [
                "lastNotNull"
              ],
              "fields": "",
              "values": false
            },
            "text": {},
            "textMode": "auto"
          },
          "pluginVersion": "8.0.3",
          "targets": [
            {
              "expr": "sum (container_memory_working_set_bytes{id=\"/\",kubernetes_io_hostname=~\"^$Node$\"})",
              "format": "time_series",
              "interval": "10s",
              "intervalFactor": 1,
              "refId": "A",
              "step": 10
            }
          ],
          "title": "Used",
          "type": "stat"
        },
        {
          "cacheTimeout": null,
          "datasource": "$cluster",
          "fieldConfig": {
            "defaults": {
              "color": {
                "fixedColor": "rgb(31, 120, 193)",
                "mode": "fixed"
              },
              "decimals": 2,
              "mappings": [
                {
                  "options": {
                    "match": "null",
                    "result": {
                      "text": "N/A"
                    }
                  },
                  "type": "special"
                }
              ],
              "thresholds": {
                "mode": "absolute",
                "steps": [
                  {
                    "color": "green",
                    "value": null
                  },
                  {
                    "color": "red",
                    "value": 80
                  }
                ]
              },
              "unit": "bytes"
            },
            "overrides": []
          },
          "gridPos": {
            "h": 4,
            "w": 2,
            "x": 12,
            "y": 11
          },
          "id": 74,
          "interval": null,
          "links": [],
          "maxDataPoints": 100,
          "options": {
            "colorMode": "none",
            "graphMode": "area",
            "justifyMode": "auto",
            "orientation": "horizontal",
            "reduceOptions": {
              "calcs": [
                "lastNotNull"
              ],
              "fields": "",
              "values": false
            },
            "text": {},
            "textMode": "auto"
          },
          "pluginVersion": "8.0.3",
          "targets": [
            {
              "exemplar": true,
              "expr": "sum (kube_pod_container_resource_requests{node=~\"^$Node$\",resource=\"memory\"})",
              "format": "time_series",
              "interval": "10s",
              "intervalFactor": 1,
              "legendFormat": "",
              "refId": "A",
              "step": 10
            }
          ],
          "title": "Requests",
          "type": "stat"
        },
        {
          "cacheTimeout": null,
          "datasource": "$cluster",
          "fieldConfig": {
            "defaults": {
              "color": {
                "fixedColor": "rgb(31, 120, 193)",
                "mode": "fixed"
              },
              "decimals": 2,
              "mappings": [
                {
                  "options": {
                    "match": "null",
                    "result": {
                      "text": "N/A"
                    }
                  },
                  "type": "special"
                }
              ],
              "thresholds": {
                "mode": "absolute",
                "steps": [
                  {
                    "color": "green",
                    "value": null
                  },
                  {
                    "color": "red",
                    "value": 80
                  }
                ]
              },
              "unit": "bytes"
            },
            "overrides": []
          },
          "gridPos": {
            "h": 4,
            "w": 3,
            "x": 14,
            "y": 11
          },
          "id": 65,
          "interval": null,
          "links": [],
          "maxDataPoints": 100,
          "options": {
            "colorMode": "none",
            "graphMode": "area",
            "justifyMode": "auto",
            "orientation": "horizontal",
            "reduceOptions": {
              "calcs": [
                "lastNotNull"
              ],
              "fields": "",
              "values": false
            },
            "text": {},
            "textMode": "auto"
          },
          "pluginVersion": "8.0.3",
          "targets": [
            {
              "expr": "sum (machine_memory_bytes{kubernetes_io_hostname=~\"^$Node$\"})",
              "format": "time_series",
              "interval": "10s",
              "intervalFactor": 1,
              "refId": "A",
              "step": 10
            }
          ],
          "title": "Total",
          "type": "stat"
        },
        {
          "cacheTimeout": null,
          "datasource": "$cluster",
          "fieldConfig": {
            "defaults": {
              "color": {
                "fixedColor": "rgb(31, 120, 193)",
                "mode": "fixed"
              },
              "decimals": 2,
              "mappings": [
                {
                  "options": {
                    "match": "null",
                    "result": {
                      "text": "N/A"
                    }
                  },
                  "type": "special"
                }
              ],
              "thresholds": {
                "mode": "absolute",
                "steps": [
                  {
                    "color": "green",
                    "value": null
                  },
                  {
                    "color": "red",
                    "value": 80
                  }
                ]
              },
              "unit": "bytes"
            },
            "overrides": []
          },
          "gridPos": {
            "h": 4,
            "w": 3,
            "x": 17,
            "y": 11
          },
          "id": 13,
          "interval": null,
          "links": [],
          "maxDataPoints": 100,
          "options": {
            "colorMode": "none",
            "graphMode": "area",
            "justifyMode": "auto",
            "orientation": "horizontal",
            "reduceOptions": {
              "calcs": [
                "lastNotNull"
              ],
              "fields": "",
              "values": false
            },
            "text": {},
            "textMode": "auto"
          },
          "pluginVersion": "8.0.3",
          "targets": [
            {
              "expr": "sum (container_fs_usage_bytes{device=~\"^/dev/.*$\",id=\"/\",kubernetes_io_hostname=~\"^$Node$\"})",
              "format": "time_series",
              "interval": "10s",
              "intervalFactor": 1,
              "refId": "A",
              "step": 10
            }
          ],
          "title": "Used",
          "type": "stat"
        },
        {
          "cacheTimeout": null,
          "datasource": "$cluster",
          "fieldConfig": {
            "defaults": {
              "color": {
                "fixedColor": "rgb(31, 120, 193)",
                "mode": "fixed"
              },
              "decimals": 2,
              "mappings": [
                {
                  "options": {
                    "match": "null",
                    "result": {
                      "text": "N/A"
                    }
                  },
                  "type": "special"
                }
              ],
              "thresholds": {
                "mode": "absolute",
                "steps": [
                  {
                    "color": "green",
                    "value": null
                  },
                  {
                    "color": "red",
                    "value": 80
                  }
                ]
              },
              "unit": "bytes"
            },
            "overrides": []
          },
          "gridPos": {
            "h": 4,
            "w": 4,
            "x": 20,
            "y": 11
          },
          "id": 14,
          "interval": null,
          "links": [],
          "maxDataPoints": 100,
          "options": {
            "colorMode": "none",
            "graphMode": "area",
            "justifyMode": "auto",
            "orientation": "horizontal",
            "reduceOptions": {
              "calcs": [
                "lastNotNull"
              ],
              "fields": "",
              "values": false
            },
            "text": {},
            "textMode": "auto"
          },
          "pluginVersion": "8.0.3",
          "targets": [
            {
              "expr": "sum (container_fs_limit_bytes{device=~\"^/dev/.*$\",id=\"/\",kubernetes_io_hostname=~\"^$Node$\"})",
              "format": "time_series",
              "interval": "10s",
              "intervalFactor": 1,
              "refId": "A",
              "step": 10
            }
          ],
          "title": "Total",
          "type": "stat"
        },
        {
          "collapsed": false,
          "datasource": "${DS_PROMETHEUS}",
          "gridPos": {
            "h": 1,
            "w": 24,
            "x": 0,
            "y": 15
          },
          "id": 47,
          "panels": [],
          "title": "Top projects and pods usage",
          "type": "row"
        },
        {
          "aliasColors": {},
          "bars": true,
          "dashLength": 10,
          "dashes": false,
          "datasource": "$cluster",
          "fieldConfig": {
            "defaults": {
              "links": []
            },
            "overrides": []
          },
          "fill": 1,
          "fillGradient": 0,
          "gridPos": {
            "h": 7,
            "w": 12,
            "x": 0,
            "y": 16
          },
          "hiddenSeries": false,
          "id": 91,
          "legend": {
            "avg": false,
            "current": false,
            "max": false,
            "min": false,
            "rightSide": false,
            "show": false,
            "total": false,
            "values": false
          },
          "lines": false,
          "linewidth": 1,
          "nullPointMode": "null",
          "options": {
            "alertThreshold": true
          },
          "percentage": false,
          "pluginVersion": "8.0.3",
          "pointradius": 2,
          "points": false,
          "renderer": "flot",
          "seriesOverrides": [],
          "spaceLength": 10,
          "stack": false,
          "steppedLine": false,
          "targets": [
            {
              "exemplar": true,
              "expr": "topk(10,sum(kube_pod_container_resource_requests{resource=\"cpu\"}) by (namespace))",
              "interval": "",
              "legendFormat": "{{namespace}}",
              "refId": "A"
            }
          ],
          "thresholds": [],
          "timeFrom": null,
          "timeRegions": [],
          "timeShift": null,
          "title": "Top 10 project based on CPU requests",
          "tooltip": {
            "shared": false,
            "sort": 0,
            "value_type": "individual"
          },
          "type": "graph",
          "xaxis": {
            "buckets": null,
            "mode": "series",
            "name": null,
            "show": true,
            "values": [
              "current"
            ]
          },
          "yaxes": [
            {
              "format": "short",
              "label": "Cores",
              "logBase": 1,
              "max": null,
              "min": null,
              "show": true
            },
            {
              "format": "short",
              "label": null,
              "logBase": 1,
              "max": null,
              "min": null,
              "show": true
            }
          ],
          "yaxis": {
            "align": false,
            "alignLevel": null
          }
        },
        {
          "aliasColors": {},
          "bars": false,
          "dashLength": 10,
          "dashes": false,
          "datasource": "$cluster",
          "decimals": null,
          "fieldConfig": {
            "defaults": {
              "links": []
            },
            "overrides": []
          },
          "fill": 1,
          "fillGradient": 0,
          "gridPos": {
            "h": 7,
            "w": 12,
            "x": 12,
            "y": 16
          },
          "hiddenSeries": false,
          "id": 93,
          "legend": {
            "alignAsTable": true,
            "avg": true,
            "current": true,
            "max": false,
            "min": false,
            "rightSide": true,
            "show": true,
            "total": false,
            "values": true
          },
          "lines": true,
          "linewidth": 1,
          "nullPointMode": "null",
          "options": {
            "alertThreshold": true
          },
          "percentage": false,
          "pluginVersion": "8.0.3",
          "pointradius": 2,
          "points": false,
          "renderer": "flot",
          "seriesOverrides": [],
          "spaceLength": 10,
          "stack": false,
          "steppedLine": true,
          "targets": [
            {
              "exemplar": true,
              "expr": "sum(rate (container_cpu_usage_seconds_total{image!=\"\",name=~\"^k8s_.*\",kubernetes_io_hostname=~\"^$Node$\", namespace=~\"^$namespace$\",container=~\"^$application$\"}[5m])) by (pod)",
              "hide": false,
              "interval": "10s",
              "legendFormat": "{{pod}}",
              "refId": "A"
            }
          ],
          "thresholds": [],
          "timeFrom": null,
          "timeRegions": [],
          "timeShift": null,
          "title": "Pods based CPU usage",
          "tooltip": {
            "shared": true,
            "sort": 2,
            "value_type": "individual"
          },
          "type": "graph",
          "xaxis": {
            "buckets": null,
            "mode": "time",
            "name": null,
            "show": true,
            "values": []
          },
          "yaxes": [
            {
              "format": "short",
              "label": "cores",
              "logBase": 1,
              "max": null,
              "min": null,
              "show": true
            },
            {
              "format": "short",
              "label": null,
              "logBase": 1,
              "max": null,
              "min": null,
              "show": true
            }
          ],
          "yaxis": {
            "align": false,
            "alignLevel": null
          }
        },
        {
          "aliasColors": {},
          "bars": true,
          "dashLength": 10,
          "dashes": false,
          "datasource": "$cluster",
          "fieldConfig": {
            "defaults": {
              "links": []
            },
            "overrides": []
          },
          "fill": 1,
          "fillGradient": 0,
          "gridPos": {
            "h": 7,
            "w": 12,
            "x": 0,
            "y": 23
          },
          "hiddenSeries": false,
          "id": 89,
          "legend": {
            "alignAsTable": false,
            "avg": false,
            "current": true,
            "hideEmpty": false,
            "hideZero": false,
            "max": false,
            "min": false,
            "rightSide": false,
            "show": false,
            "total": false,
            "values": true
          },
          "lines": false,
          "linewidth": 1,
          "nullPointMode": "null",
          "options": {
            "alertThreshold": true
          },
          "percentage": false,
          "pluginVersion": "8.0.3",
          "pointradius": 2,
          "points": false,
          "renderer": "flot",
          "seriesOverrides": [],
          "spaceLength": 10,
          "stack": false,
          "steppedLine": false,
          "targets": [
            {
              "exemplar": true,
              "expr": "topk(10,sum(kube_pod_container_resource_requests{resource=\"memory\"}) by (namespace))",
              "format": "time_series",
              "interval": "",
              "legendFormat": "{{namespace}}",
              "refId": "A"
            }
          ],
          "thresholds": [],
          "timeFrom": null,
          "timeRegions": [],
          "timeShift": null,
          "title": "Top 10 project based on mem request",
          "tooltip": {
            "shared": false,
            "sort": 1,
            "value_type": "individual"
          },
          "type": "graph",
          "xaxis": {
            "buckets": null,
            "mode": "series",
            "name": null,
            "show": true,
            "values": [
              "current"
            ]
          },
          "yaxes": [
            {
              "format": "decbytes",
              "label": null,
              "logBase": 1,
              "max": null,
              "min": null,
              "show": true
            },
            {
              "format": "bytes",
              "label": null,
              "logBase": 1,
              "max": null,
              "min": null,
              "show": true
            }
          ],
          "yaxis": {
            "align": false,
            "alignLevel": null
          }
        },
        {
          "aliasColors": {},
          "bars": false,
          "dashLength": 10,
          "dashes": false,
          "datasource": "$cluster",
          "decimals": 1,
          "fieldConfig": {
            "defaults": {
              "links": []
            },
            "overrides": []
          },
          "fill": 1,
          "fillGradient": 0,
          "gridPos": {
            "h": 7,
            "w": 12,
            "x": 12,
            "y": 23
          },
          "hiddenSeries": false,
          "id": 95,
          "interval": "",
          "legend": {
            "alignAsTable": true,
            "avg": true,
            "current": true,
            "hideEmpty": false,
            "max": true,
            "min": true,
            "rightSide": true,
            "show": true,
            "total": false,
            "values": true
          },
          "lines": true,
          "linewidth": 1,
          "nullPointMode": "null",
          "options": {
            "alertThreshold": true
          },
          "percentage": false,
          "pluginVersion": "8.0.3",
          "pointradius": 2,
          "points": false,
          "renderer": "flot",
          "seriesOverrides": [],
          "spaceLength": 10,
          "stack": false,
          "steppedLine": true,
          "targets": [
            {
              "exemplar": true,
              "expr": "sum(container_memory_working_set_bytes{container!=\"\" ,namespace=~\"^$namespace$\",container=~\"^$application$\", container!=\"POD\"}) by (pod)",
              "format": "time_series",
              "interval": "",
              "intervalFactor": 2,
              "legendFormat": "{{pod}}",
              "refId": "A"
            }
          ],
          "thresholds": [],
          "timeFrom": null,
          "timeRegions": [],
          "timeShift": null,
          "title": "Pods based Memory usage",
          "tooltip": {
            "shared": true,
            "sort": 0,
            "value_type": "individual"
          },
          "type": "graph",
          "xaxis": {
            "buckets": null,
            "mode": "time",
            "name": null,
            "show": true,
            "values": []
          },
          "yaxes": [
            {
              "decimals": null,
              "format": "decbytes",
              "label": "",
              "logBase": 1,
              "max": null,
              "min": null,
              "show": true
            },
            {
              "decimals": null,
              "format": "decbytes",
              "label": "",
              "logBase": 1,
              "max": null,
              "min": null,
              "show": true
            }
          ],
          "yaxis": {
            "align": false,
            "alignLevel": 7
          }
        },
        {
          "aliasColors": {},
          "bars": false,
          "dashLength": 10,
          "dashes": false,
          "datasource": "$cluster",
          "fieldConfig": {
            "defaults": {
              "links": []
            },
            "overrides": []
          },
          "fill": 1,
          "fillGradient": 0,
          "gridPos": {
            "h": 6,
            "w": 24,
            "x": 0,
            "y": 30
          },
          "hiddenSeries": false,
          "id": 101,
          "legend": {
            "avg": false,
            "current": false,
            "max": false,
            "min": false,
            "show": true,
            "total": false,
            "values": false
          },
          "lines": true,
          "linewidth": 1,
          "nullPointMode": "null",
          "options": {
            "alertThreshold": true
          },
          "percentage": false,
          "pluginVersion": "8.0.3",
          "pointradius": 2,
          "points": false,
          "renderer": "flot",
          "seriesOverrides": [],
          "spaceLength": 10,
          "stack": false,
          "steppedLine": false,
          "targets": [
            {
              "expr": "increase(kube_pod_container_status_restarts_total[5m]) > 0",
              "legendFormat": "{{container}}",
              "refId": "A"
            }
          ],
          "thresholds": [],
          "timeFrom": null,
          "timeRegions": [],
          "timeShift": null,
          "title": "Container restart",
          "tooltip": {
            "shared": true,
            "sort": 0,
            "value_type": "individual"
          },
          "type": "graph",
          "xaxis": {
            "buckets": null,
            "mode": "time",
            "name": null,
            "show": true,
            "values": []
          },
          "yaxes": [
            {
              "format": "short",
              "label": null,
              "logBase": 1,
              "max": null,
              "min": null,
              "show": true
            },
            {
              "format": "short",
              "label": null,
              "logBase": 1,
              "max": null,
              "min": null,
              "show": true
            }
          ],
          "yaxis": {
            "align": false,
            "alignLevel": null
          }
        },
        {
          "collapsed": false,
          "datasource": "${DS_PROMETHEUS}",
          "gridPos": {
            "h": 1,
            "w": 24,
            "x": 0,
            "y": 36
          },
          "id": 103,
          "panels": [],
          "title": "Apiserver",
          "type": "row"
        },
        {
          "aliasColors": {},
          "bars": false,
          "dashLength": 10,
          "dashes": false,
          "datasource": "$cluster",
          "fieldConfig": {
            "defaults": {
              "links": []
            },
            "overrides": []
          },
          "fill": 1,
          "fillGradient": 0,
          "gridPos": {
            "h": 8,
            "w": 12,
            "x": 0,
            "y": 37
          },
          "hiddenSeries": false,
          "id": 105,
          "legend": {
            "avg": false,
            "current": false,
            "max": false,
            "min": false,
            "show": true,
            "total": false,
            "values": false
          },
          "lines": true,
          "linewidth": 1,
          "nullPointMode": "null",
          "options": {
            "alertThreshold": true
          },
          "percentage": false,
          "pluginVersion": "8.0.3",
          "pointradius": 2,
          "points": false,
          "renderer": "flot",
          "seriesOverrides": [],
          "spaceLength": 10,
          "stack": false,
          "steppedLine": false,
          "targets": [
            {
              "expr": "sum(rate(apiserver_request_total[5m])) by (verb)",
              "interval": "",
              "legendFormat": "{{verb}}",
              "refId": "A"
            }
          ],
          "thresholds": [],
          "timeFrom": null,
          "timeRegions": [],
          "timeShift": null,
          "title": "Apiserver request rate",
          "tooltip": {
            "shared": true,
            "sort": 0,
            "value_type": "individual"
          },
          "type": "graph",
          "xaxis": {
            "buckets": null,
            "mode": "time",
            "name": null,
            "show": true,
            "values": []
          },
          "yaxes": [
            {
              "format": "short",
              "label": null,
              "logBase": 1,
              "max": null,
              "min": null,
              "show": true
            },
            {
              "format": "short",
              "label": null,
              "logBase": 1,
              "max": null,
              "min": null,
              "show": true
            }
          ],
          "yaxis": {
            "align": false,
            "alignLevel": null
          }
        },
        {
          "aliasColors": {},
          "bars": false,
          "dashLength": 10,
          "dashes": false,
          "datasource": "$cluster",
          "fieldConfig": {
            "defaults": {
              "links": []
            },
            "overrides": []
          },
          "fill": 1,
          "fillGradient": 0,
          "gridPos": {
            "h": 8,
            "w": 12,
            "x": 12,
            "y": 37
          },
          "hiddenSeries": false,
          "id": 115,
          "legend": {
            "avg": false,
            "current": false,
            "max": false,
            "min": false,
            "show": true,
            "total": false,
            "values": false
          },
          "lines": true,
          "linewidth": 1,
          "nullPointMode": "null",
          "options": {
            "alertThreshold": true
          },
          "percentage": false,
          "pluginVersion": "8.0.3",
          "pointradius": 2,
          "points": false,
          "renderer": "flot",
          "seriesOverrides": [],
          "spaceLength": 10,
          "stack": false,
          "steppedLine": false,
          "targets": [
            {
              "expr": "sum by (code) (rate(apiserver_request_total[5m]))",
              "interval": "",
              "legendFormat": "",
              "refId": "A"
            }
          ],
          "thresholds": [],
          "timeFrom": null,
          "timeRegions": [],
          "timeShift": null,
          "title": "API server total requests code",
          "tooltip": {
            "shared": true,
            "sort": 0,
            "value_type": "individual"
          },
          "type": "graph",
          "xaxis": {
            "buckets": null,
            "mode": "time",
            "name": null,
            "show": true,
            "values": []
          },
          "yaxes": [
            {
              "format": "percent",
              "label": null,
              "logBase": 1,
              "max": null,
              "min": null,
              "show": true
            },
            {
              "format": "short",
              "label": null,
              "logBase": 1,
              "max": null,
              "min": null,
              "show": true
            }
          ],
          "yaxis": {
            "align": false,
            "alignLevel": null
          }
        },
        {
          "aliasColors": {},
          "bars": false,
          "dashLength": 10,
          "dashes": false,
          "datasource": "$cluster",
          "description": "95th percentile request latency for Kubernetes apiserver component",
          "fieldConfig": {
            "defaults": {
              "links": []
            },
            "overrides": []
          },
          "fill": 1,
          "fillGradient": 0,
          "gridPos": {
            "h": 8,
            "w": 12,
            "x": 0,
            "y": 45
          },
          "hiddenSeries": false,
          "id": 109,
          "legend": {
            "avg": false,
            "current": false,
            "max": false,
            "min": false,
            "show": true,
            "total": false,
            "values": false
          },
          "lines": true,
          "linewidth": 1,
          "nullPointMode": "null",
          "options": {
            "alertThreshold": true
          },
          "percentage": false,
          "pluginVersion": "8.0.3",
          "pointradius": 2,
          "points": false,
          "renderer": "flot",
          "seriesOverrides": [],
          "spaceLength": 10,
          "stack": false,
          "steppedLine": false,
          "targets": [
            {
              "expr": "histogram_quantile(0.95, sum(rate(apiserver_request_duration_seconds_bucket{verb!~\"CONNECT|WATCH\"}[5m])) by (le))",
              "interval": "",
              "legendFormat": "p95",
              "refId": "A"
            },
            {
              "expr": "histogram_quantile(0.90, sum(rate(apiserver_request_duration_seconds_bucket{verb!~\"CONNECT|WATCH\"}[5m])) by (le))",
              "interval": "",
              "legendFormat": "p90",
              "refId": "B"
            },
            {
              "expr": "histogram_quantile(0.5, sum(rate(apiserver_request_duration_seconds_bucket{verb!~\"CONNECT|WATCH\"}[5m])) by (le))",
              "interval": "",
              "legendFormat": "p50 ",
              "refId": "C"
            }
          ],
          "thresholds": [],
          "timeFrom": null,
          "timeRegions": [],
          "timeShift": null,
          "title": "Apiserver request latency",
          "tooltip": {
            "shared": true,
            "sort": 0,
            "value_type": "individual"
          },
          "type": "graph",
          "xaxis": {
            "buckets": null,
            "mode": "time",
            "name": null,
            "show": true,
            "values": []
          },
          "yaxes": [
            {
              "format": "s",
              "label": null,
              "logBase": 1,
              "max": null,
              "min": null,
              "show": true
            },
            {
              "format": "short",
              "label": null,
              "logBase": 1,
              "max": null,
              "min": null,
              "show": true
            }
          ],
          "yaxis": {
            "align": false,
            "alignLevel": null
          }
        },
        {
          "aliasColors": {},
          "bars": false,
          "dashLength": 10,
          "dashes": false,
          "datasource": "$cluster",
          "fieldConfig": {
            "defaults": {
              "links": []
            },
            "overrides": []
          },
          "fill": 1,
          "fillGradient": 0,
          "gridPos": {
            "h": 8,
            "w": 12,
            "x": 12,
            "y": 45
          },
          "hiddenSeries": false,
          "id": 107,
          "legend": {
            "avg": false,
            "current": false,
            "max": false,
            "min": false,
            "show": true,
            "total": false,
            "values": false
          },
          "lines": true,
          "linewidth": 1,
          "nullPointMode": "null",
          "options": {
            "alertThreshold": true
          },
          "percentage": false,
          "pluginVersion": "8.0.3",
          "pointradius": 2,
          "points": false,
          "renderer": "flot",
          "seriesOverrides": [],
          "spaceLength": 10,
          "stack": false,
          "steppedLine": false,
          "targets": [
            {
              "expr": "histogram_quantile(0.95, sum(rate(workqueue_queue_duration_seconds_bucket[5m])) by (le))",
              "interval": "",
              "legendFormat": "p95",
              "refId": "A"
            },
            {
              "expr": "histogram_quantile(0.90, sum(rate(workqueue_queue_duration_seconds_bucket[5m])) by (le))",
              "interval": "",
              "legendFormat": "p90",
              "refId": "B"
            },
            {
              "expr": "histogram_quantile(0.5, sum(rate(workqueue_queue_duration_seconds_bucket[5m])) by (le))",
              "interval": "",
              "legendFormat": "p50",
              "refId": "C"
            }
          ],
          "thresholds": [],
          "timeFrom": null,
          "timeRegions": [],
          "timeShift": null,
          "title": "Workqueue service time",
          "tooltip": {
            "shared": true,
            "sort": 0,
            "value_type": "individual"
          },
          "type": "graph",
          "xaxis": {
            "buckets": null,
            "mode": "time",
            "name": null,
            "show": true,
            "values": []
          },
          "yaxes": [
            {
              "format": "s",
              "label": "service time",
              "logBase": 1,
              "max": null,
              "min": null,
              "show": true
            },
            {
              "format": "short",
              "label": null,
              "logBase": 1,
              "max": null,
              "min": null,
              "show": true
            }
          ],
          "yaxis": {
            "align": false,
            "alignLevel": null
          }
        },
        {
          "aliasColors": {},
          "bars": false,
          "dashLength": 10,
          "dashes": false,
          "datasource": "$cluster",
          "description": "etcd request latency (p95)",
          "fieldConfig": {
            "defaults": {
              "links": []
            },
            "overrides": []
          },
          "fill": 1,
          "fillGradient": 0,
          "gridPos": {
            "h": 8,
            "w": 12,
            "x": 0,
            "y": 53
          },
          "hiddenSeries": false,
          "id": 113,
          "legend": {
            "avg": false,
            "current": false,
            "max": false,
            "min": false,
            "show": true,
            "total": false,
            "values": false
          },
          "lines": true,
          "linewidth": 1,
          "nullPointMode": "null",
          "options": {
            "alertThreshold": true
          },
          "percentage": false,
          "pluginVersion": "8.0.3",
          "pointradius": 2,
          "points": false,
          "renderer": "flot",
          "seriesOverrides": [],
          "spaceLength": 10,
          "stack": false,
          "steppedLine": false,
          "targets": [
            {
              "expr": "histogram_quantile(0.95, sum(rate(etcd_request_duration_seconds_bucket[5m])) by (le))",
              "interval": "",
              "legendFormat": "p95",
              "refId": "A"
            },
            {
              "expr": "histogram_quantile(0.90, sum(rate(etcd_request_duration_seconds_bucket[5m])) by (le))",
              "interval": "",
              "legendFormat": "p90",
              "refId": "B"
            },
            {
              "expr": "histogram_quantile(0.5, sum(rate(etcd_request_duration_seconds_bucket[5m])) by (le))",
              "interval": "",
              "legendFormat": "p50",
              "refId": "C"
            }
          ],
          "thresholds": [],
          "timeFrom": null,
          "timeRegions": [],
          "timeShift": null,
          "title": "Etcd request latency",
          "tooltip": {
            "shared": true,
            "sort": 0,
            "value_type": "individual"
          },
          "type": "graph",
          "xaxis": {
            "buckets": null,
            "mode": "time",
            "name": null,
            "show": true,
            "values": []
          },
          "yaxes": [
            {
              "format": "s",
              "label": null,
              "logBase": 1,
              "max": null,
              "min": null,
              "show": true
            },
            {
              "format": "short",
              "label": null,
              "logBase": 1,
              "max": null,
              "min": null,
              "show": true
            }
          ],
          "yaxis": {
            "align": false,
            "alignLevel": null
          }
        },
        {
          "aliasColors": {},
          "bars": false,
          "dashLength": 10,
          "dashes": false,
          "datasource": "$cluster",
          "fieldConfig": {
            "defaults": {
              "links": []
            },
            "overrides": []
          },
          "fill": 1,
          "fillGradient": 0,
          "gridPos": {
            "h": 8,
            "w": 12,
            "x": 12,
            "y": 53
          },
          "hiddenSeries": false,
          "id": 111,
          "legend": {
            "avg": false,
            "current": false,
            "max": false,
            "min": false,
            "show": true,
            "total": false,
            "values": false
          },
          "lines": true,
          "linewidth": 1,
          "nullPointMode": "null",
          "options": {
            "alertThreshold": true
          },
          "percentage": false,
          "pluginVersion": "8.0.3",
          "pointradius": 2,
          "points": false,
          "renderer": "flot",
          "seriesOverrides": [],
          "spaceLength": 10,
          "stack": false,
          "steppedLine": false,
          "targets": [
            {
              "expr": "histogram_quantile(0.95, sum(rate(workqueue_work_duration_seconds_bucket[5m])) by (le))",
              "interval": "",
              "legendFormat": "p95",
              "refId": "A"
            },
            {
              "expr": "histogram_quantile(0.9, sum(rate(workqueue_work_duration_seconds_bucket[5m])) by (le))",
              "interval": "",
              "legendFormat": "p90",
              "refId": "B"
            },
            {
              "expr": "histogram_quantile(0.5, sum(rate(workqueue_work_duration_seconds_bucket[5m])) by (le))",
              "interval": "",
              "legendFormat": "p50",
              "refId": "C"
            }
          ],
          "thresholds": [],
          "timeFrom": null,
          "timeRegions": [],
          "timeShift": null,
          "title": "Workqueue processing time",
          "tooltip": {
            "shared": true,
            "sort": 0,
            "value_type": "individual"
          },
          "type": "graph",
          "xaxis": {
            "buckets": null,
            "mode": "time",
            "name": null,
            "show": true,
            "values": []
          },
          "yaxes": [
            {
              "format": "s",
              "label": null,
              "logBase": 1,
              "max": null,
              "min": null,
              "show": true
            },
            {
              "format": "short",
              "label": null,
              "logBase": 1,
              "max": null,
              "min": null,
              "show": true
            }
          ],
          "yaxis": {
            "align": false,
            "alignLevel": null
          }
        },
        {
          "collapsed": false,
          "datasource": "${DS_PROMETHEUS}",
          "gridPos": {
            "h": 1,
            "w": 24,
            "x": 0,
            "y": 61
          },
          "id": 34,
          "panels": [],
          "title": "Network I/O",
          "type": "row"
        },
        {
          "aliasColors": {},
          "bars": false,
          "dashLength": 10,
          "dashes": false,
          "datasource": "$cluster",
          "decimals": 2,
          "fieldConfig": {
            "defaults": {
              "links": []
            },
            "overrides": []
          },
          "fill": 1,
          "fillGradient": 0,
          "gridPos": {
            "h": 6,
            "w": 12,
            "x": 0,
            "y": 62
          },
          "hiddenSeries": false,
          "id": 57,
          "legend": {
            "alignAsTable": true,
            "avg": true,
            "current": true,
            "max": false,
            "min": false,
            "rightSide": true,
            "show": true,
            "sideWidth": 200,
            "total": false,
            "values": true
          },
          "lines": true,
          "linewidth": 1,
          "links": [],
          "nullPointMode": "connected",
          "options": {
            "alertThreshold": true
          },
          "percentage": false,
          "pluginVersion": "8.0.3",
          "pointradius": 5,
          "points": false,
          "renderer": "flot",
          "seriesOverrides": [],
          "spaceLength": 10,
          "stack": false,
          "steppedLine": false,
          "targets": [
            {
              "expr": "sum (rate (container_network_receive_bytes_total{image!=\"\",name=~\"^k8s_.*\",kubernetes_io_hostname=~\"^$Node$\"}[2m])) by (kubernetes_io_role)",
              "format": "time_series",
              "interval": "10s",
              "intervalFactor": 1,
              "legendFormat": "-> {{ kubernetes_io_role }}",
              "refId": "A"
            },
            {
              "expr": "- sum (rate (container_network_transmit_bytes_total{image!=\"\",name=~\"^k8s_.*\",kubernetes_io_hostname=~\"^$Node$\"}[2m])) by (kubernetes_io_role)",
              "format": "time_series",
              "interval": "10s",
              "intervalFactor": 1,
              "legendFormat": "<- {{ kubernetes_io_role }}",
              "refId": "B"
            },
            {
              "expr": "sum (rate (container_network_receive_bytes_total{image!=\"\",name=~\"^k8s_.*\",kubernetes_io_hostname=~\"^$Node$\"}[2m])) by (kubernetes_io_role,kubernetes_io_hostname)",
              "format": "time_series",
              "interval": "10s",
              "intervalFactor": 1,
              "legendFormat": "-> {{ kubernetes_io_role }}: {{ kubernetes_io_hostname }}",
              "refId": "C"
            },
            {
              "expr": "- sum (rate (container_network_transmit_bytes_total{image!=\"\",name=~\"^k8s_.*\",kubernetes_io_hostname=~\"^$Node$\"}[2m])) by (kubernetes_io_role,kubernetes_io_hostname)",
              "format": "time_series",
              "interval": "10s",
              "intervalFactor": 1,
              "legendFormat": "<- {{ kubernetes_io_role }}: {{ kubernetes_io_hostname }}",
              "refId": "D"
            }
          ],
          "thresholds": [],
          "timeFrom": null,
          "timeRegions": [],
          "timeShift": null,
          "title": "Nodes network I/O (2m avg)",
          "tooltip": {
            "shared": true,
            "sort": 2,
            "value_type": "individual"
          },
          "type": "graph",
          "xaxis": {
            "buckets": null,
            "mode": "time",
            "name": null,
            "show": true,
            "values": []
          },
          "yaxes": [
            {
              "format": "Bps",
              "label": null,
              "logBase": 1,
              "max": null,
              "min": null,
              "show": true
            },
            {
              "format": "short",
              "label": null,
              "logBase": 1,
              "max": null,
              "min": null,
              "show": false
            }
          ],
          "yaxis": {
            "align": false,
            "alignLevel": null
          }
        },
        {
          "aliasColors": {},
          "bars": false,
          "dashLength": 10,
          "dashes": false,
          "datasource": "$cluster",
          "decimals": 2,
          "editable": true,
          "error": false,
          "fieldConfig": {
            "defaults": {
              "links": []
            },
            "overrides": []
          },
          "fill": 1,
          "fillGradient": 0,
          "grid": {},
          "gridPos": {
            "h": 6,
            "w": 12,
            "x": 12,
            "y": 62
          },
          "hiddenSeries": false,
          "id": 16,
          "isNew": true,
          "legend": {
            "alignAsTable": true,
            "avg": true,
            "current": true,
            "max": false,
            "min": false,
            "rightSide": true,
            "show": true,
            "sideWidth": 200,
            "sort": "current",
            "sortDesc": true,
            "total": false,
            "values": true
          },
          "lines": true,
          "linewidth": 1,
          "links": [],
          "nullPointMode": "connected",
          "options": {
            "alertThreshold": true
          },
          "percentage": false,
          "pluginVersion": "8.0.3",
          "pointradius": 5,
          "points": false,
          "renderer": "flot",
          "seriesOverrides": [],
          "spaceLength": 10,
          "stack": false,
          "steppedLine": false,
          "targets": [
            {
              "expr": "sum (rate (container_network_receive_bytes_total{image!=\"\",name=~\"^k8s_.*\",kubernetes_io_hostname=~\"^$Node$\"}[2m])) by (pod_name)",
              "format": "time_series",
              "interval": "10s",
              "intervalFactor": 1,
              "legendFormat": "-> {{ pod_name }}",
              "metric": "network",
              "refId": "A",
              "step": 10
            },
            {
              "expr": "- sum (rate (container_network_transmit_bytes_total{image!=\"\",name=~\"^k8s_.*\",kubernetes_io_hostname=~\"^$Node$\"}[2m])) by (pod_name)",
              "format": "time_series",
              "interval": "10s",
              "intervalFactor": 1,
              "legendFormat": "<- {{ pod_name }}",
              "metric": "network",
              "refId": "B",
              "step": 10
            }
          ],
          "thresholds": [],
          "timeFrom": null,
          "timeRegions": [],
          "timeShift": null,
          "title": "Pods network I/O (2m avg)",
          "tooltip": {
            "msResolution": false,
            "shared": true,
            "sort": 2,
            "value_type": "cumulative"
          },
          "type": "graph",
          "xaxis": {
            "buckets": null,
            "mode": "time",
            "name": null,
            "show": true,
            "values": []
          },
          "yaxes": [
            {
              "format": "Bps",
              "label": null,
              "logBase": 1,
              "max": null,
              "min": null,
              "show": true
            },
            {
              "format": "short",
              "label": null,
              "logBase": 1,
              "max": null,
              "min": null,
              "show": false
            }
          ],
          "yaxis": {
            "align": false,
            "alignLevel": null
          }
        },
        {
          "aliasColors": {},
          "bars": false,
          "dashLength": 10,
          "dashes": false,
          "datasource": "$cluster",
          "decimals": 2,
          "editable": true,
          "error": false,
          "fieldConfig": {
            "defaults": {
              "links": []
            },
            "overrides": []
          },
          "fill": 1,
          "fillGradient": 0,
          "grid": {},
          "gridPos": {
            "h": 5,
            "w": 24,
            "x": 0,
            "y": 68
          },
          "height": "200px",
          "hiddenSeries": false,
          "id": 32,
          "isNew": true,
          "legend": {
            "alignAsTable": true,
            "avg": false,
            "current": true,
            "max": false,
            "min": false,
            "rightSide": true,
            "show": true,
            "sideWidth": 200,
            "sort": "current",
            "sortDesc": true,
            "total": false,
            "values": true
          },
          "lines": true,
          "linewidth": 1,
          "links": [],
          "nullPointMode": "connected",
          "options": {
            "alertThreshold": true
          },
          "percentage": false,
          "pluginVersion": "8.0.3",
          "pointradius": 5,
          "points": false,
          "renderer": "flot",
          "seriesOverrides": [],
          "spaceLength": 10,
          "stack": false,
          "steppedLine": false,
          "targets": [
            {
              "expr": "sum (rate (container_network_receive_bytes_total{kubernetes_io_hostname=~\"^$Node$\"}[2m]))",
              "format": "time_series",
              "interval": "10s",
              "intervalFactor": 1,
              "legendFormat": "Received",
              "metric": "network",
              "refId": "A",
              "step": 10
            },
            {
              "expr": "- sum (rate (container_network_transmit_bytes_total{kubernetes_io_hostname=~\"^$Node$\"}[2m]))",
              "format": "time_series",
              "interval": "10s",
              "intervalFactor": 1,
              "legendFormat": "Sent",
              "metric": "network",
              "refId": "B",
              "step": 10
            }
          ],
          "thresholds": [],
          "timeFrom": null,
          "timeRegions": [],
          "timeShift": null,
          "title": "Network I/O (2m avg)",
          "tooltip": {
            "msResolution": false,
            "shared": true,
            "sort": 0,
            "value_type": "cumulative"
          },
          "type": "graph",
          "xaxis": {
            "buckets": null,
            "mode": "time",
            "name": null,
            "show": true,
            "values": []
          },
          "yaxes": [
            {
              "format": "Bps",
              "label": null,
              "logBase": 1,
              "max": null,
              "min": null,
              "show": true
            },
            {
              "format": "Bps",
              "label": null,
              "logBase": 1,
              "max": null,
              "min": null,
              "show": false
            }
          ],
          "yaxis": {
            "align": false,
            "alignLevel": null
          }
        }
      ],
      "refresh": "",
      "schemaVersion": 30,
      "style": "dark",
      "tags": [
        "kubernetes",
        "prometheus"
      ],
      "templating": {
        "list": [
          {
            "current": {
              "selected": false,
              "text": "Prometheus",
              "value": "Prometheus"
            },
            "description": null,
            "error": null,
            "hide": 0,
            "includeAll": false,
            "label": null,
            "multi": false,
            "name": "cluster",
            "options": [],
            "query": "prometheus",
            "queryValue": "",
            "refresh": 1,
            "regex": "",
            "skipUrlSync": false,
            "type": "datasource"
          },
          {
            "allValue": ".*",
            "current": {},
            "datasource": "$cluster",
            "definition": "label_values(node)",
            "description": null,
            "error": null,
            "hide": 0,
            "includeAll": true,
            "label": null,
            "multi": false,
            "name": "Node",
            "options": [],
            "query": {
              "query": "label_values(node)",
              "refId": "Kafka-Node-Variable-Query"
            },
            "refresh": 1,
            "regex": "",
            "skipUrlSync": false,
            "sort": 0,
            "tagValuesQuery": "",
            "tagsQuery": "",
            "type": "query",
            "useTags": false
          },
          {
            "allValue": null,
            "current": {},
            "datasource": "$cluster",
            "definition": "label_values(namespace)",
            "description": null,
            "error": null,
            "hide": 0,
            "includeAll": false,
            "label": null,
            "multi": false,
            "name": "namespace",
            "options": [],
            "query": {
              "query": "label_values(namespace)",
              "refId": "Kafka-namespace-Variable-Query"
            },
            "refresh": 1,
            "regex": "",
            "skipUrlSync": false,
            "sort": 0,
            "tagValuesQuery": "",
            "tagsQuery": "",
            "type": "query",
            "useTags": false
          },
          {
            "allValue": null,
            "current": {},
            "datasource": "$cluster",
            "definition": "label_values(container_cpu_usage_seconds_total{namespace=\"$namespace\",container!=\"POD\"},container)",
            "description": null,
            "error": null,
            "hide": 0,
            "includeAll": true,
            "label": null,
            "multi": true,
            "name": "application",
            "options": [],
            "query": {
              "query": "label_values(container_cpu_usage_seconds_total{namespace=\"$namespace\",container!=\"POD\"},container)",
              "refId": "Kafka-application-Variable-Query"
            },
            "refresh": 1,
            "regex": "",
            "skipUrlSync": false,
            "sort": 0,
            "tagValuesQuery": "",
            "tagsQuery": "",
            "type": "query",
            "useTags": false
          }
        ]
      },
      "time": {
        "from": "now-3h",
        "to": "now"
      },
      "timepicker": {
        "refresh_intervals": [
          "5s",
          "10s",
          "30s",
          "2m",
          "5m",
          "15m",
          "30m",
          "1h",
          "2h",
          "1d"
        ],
        "time_options": [
          "5m",
          "15m",
          "1h",
          "6h",
          "12h",
          "24h",
          "2d",
          "7d",
          "30d"
        ]
      },
      "timezone": "browser",
      "title": "Kubernetes Monitoring Overview",
      "uid": "f8W_uzz7z",
      "version": 4
    }
  victoria-metrics-cluster.json: |
    {
      "annotations": {
        "list": [
          {
            "builtIn": 1,
            "datasource": "-- Grafana --",
            "enable": true,
            "hide": true,
            "iconColor": "rgba(0, 211, 255, 1)",
            "name": "Annotations & Alerts",
            "target": {
              "limit": 100,
              "matchAny": false,
              "tags": [],
              "type": "dashboard"
            },
            "type": "dashboard"
          }
        ]
      },
      "description": "Overview for cluster VictoriaMetrics v1.57.0 or higher",
      "editable": true,
      "gnetId": 11176,
      "graphTooltip": 0,
      "id": 19,
      "iteration": 1644153474480,
      "links": [
        {
          "icon": "doc",
          "tags": [],
          "targetBlank": true,
          "title": "Cluster Wiki",
          "type": "link",
          "url": "https://github.com/VictoriaMetrics/VictoriaMetrics/wiki/Cluster-VictoriaMetrics"
        },
        {
          "icon": "external link",
          "tags": [],
          "targetBlank": true,
          "title": "Found a bug?",
          "type": "link",
          "url": "https://github.com/VictoriaMetrics/VictoriaMetrics/issues"
        },
        {
          "icon": "external link",
          "tags": [],
          "targetBlank": true,
          "title": "New releases",
          "type": "link",
          "url": "https://github.com/VictoriaMetrics/VictoriaMetrics/releases"
        }
      ],
      "panels": [
        {
          "collapsed": true,
          "datasource": "Prometheus",
          "gridPos": {
            "h": 1,
            "w": 24,
            "x": 0,
            "y": 0
          },
          "id": 137,
          "panels": [
            {
              "cacheTimeout": null,
              "datasource": "$ds",
              "description": "How many datapoints are in storage",
              "fieldConfig": {
                "defaults": {
                  "color": {
                    "mode": "thresholds"
                  },
                  "mappings": [],
                  "thresholds": {
                    "mode": "absolute",
                    "steps": [
                      {
                        "color": "green",
                        "value": null
                      }
                    ]
                  },
                  "unit": "short"
                },
                "overrides": []
              },
              "gridPos": {
                "h": 2,
                "w": 6,
                "x": 0,
                "y": 1
              },
              "id": 131,
              "interval": null,
              "links": [],
              "maxDataPoints": 100,
              "options": {
                "colorMode": "value",
                "graphMode": "area",
                "justifyMode": "auto",
                "orientation": "horizontal",
                "reduceOptions": {
                  "calcs": [
                    "lastNotNull"
                  ],
                  "fields": "",
                  "values": false
                },
                "text": {},
                "textMode": "auto"
              },
              "pluginVersion": "8.0.0",
              "targets": [
                {
                  "exemplar": true,
                  "expr": "sum(vm_rows{job=\"$job_storage\", type!=\"indexdb\"})",
                  "format": "time_series",
                  "instant": true,
                  "interval": "",
                  "intervalFactor": 1,
                  "legendFormat": "",
                  "refId": "A"
                }
              ],
              "timeFrom": null,
              "timeShift": null,
              "title": "Total datapoints",
              "type": "stat"
            },
            {
              "cacheTimeout": null,
              "datasource": "$ds",
              "description": "The minimum free disk space left among all storage nodes.",
              "fieldConfig": {
                "defaults": {
                  "color": {
                    "mode": "thresholds"
                  },
                  "mappings": [],
                  "thresholds": {
                    "mode": "absolute",
                    "steps": [
                      {
                        "color": "green",
                        "value": null
                      }
                    ]
                  },
                  "unit": "bytes"
                },
                "overrides": []
              },
              "gridPos": {
                "h": 2,
                "w": 6,
                "x": 6,
                "y": 1
              },
              "id": 124,
              "interval": null,
              "links": [],
              "maxDataPoints": 100,
              "options": {
                "colorMode": "value",
                "graphMode": "area",
                "justifyMode": "auto",
                "orientation": "horizontal",
                "reduceOptions": {
                  "calcs": [
                    "lastNotNull"
                  ],
                  "fields": "",
                  "values": false
                },
                "text": {},
                "textMode": "auto"
              },
              "pluginVersion": "8.0.0",
              "targets": [
                {
                  "exemplar": true,
                  "expr": "min(vm_free_disk_space_bytes{job=~\"$job\", instance=~\"$instance\"})",
                  "format": "time_series",
                  "instant": true,
                  "interval": "",
                  "intervalFactor": 1,
                  "legendFormat": "",
                  "refId": "A"
                }
              ],
              "timeFrom": null,
              "timeShift": null,
              "title": "Min free disk space",
              "type": "stat"
            },
            {
              "cacheTimeout": null,
              "datasource": "$ds",
              "description": "Average disk usage per datapoint.",
              "fieldConfig": {
                "defaults": {
                  "color": {
                    "mode": "thresholds"
                  },
                  "decimals": 2,
                  "mappings": [],
                  "thresholds": {
                    "mode": "absolute",
                    "steps": [
                      {
                        "color": "green",
                        "value": null
                      }
                    ]
                  },
                  "unit": "bytes"
                },
                "overrides": []
              },
              "gridPos": {
                "h": 2,
                "w": 6,
                "x": 12,
                "y": 1
              },
              "id": 112,
              "interval": null,
              "links": [],
              "maxDataPoints": 100,
              "options": {
                "colorMode": "value",
                "graphMode": "area",
                "justifyMode": "auto",
                "orientation": "horizontal",
                "reduceOptions": {
                  "calcs": [
                    "lastNotNull"
                  ],
                  "fields": "",
                  "values": false
                },
                "text": {},
                "textMode": "auto"
              },
              "pluginVersion": "8.0.0",
              "targets": [
                {
                  "exemplar": true,
                  "expr": "sum(vm_data_size_bytes{job=\"$job_storage\", type!=\"indexdb\"}) / sum(vm_rows{job=\"$job_storage\", type!=\"indexdb\"})",
                  "format": "time_series",
                  "instant": true,
                  "interval": "",
                  "intervalFactor": 1,
                  "legendFormat": "",
                  "refId": "A"
                }
              ],
              "timeFrom": null,
              "timeShift": null,
              "title": "Bytes per point",
              "type": "stat"
            },
            {
              "cacheTimeout": null,
              "datasource": "$ds",
              "description": "Total size of allowed memory via flag `-memory.allowedPercent` for all VM components",
              "fieldConfig": {
                "defaults": {
                  "color": {
                    "mode": "thresholds"
                  },
                  "mappings": [],
                  "thresholds": {
                    "mode": "absolute",
                    "steps": [
                      {
                        "color": "green",
                        "value": null
                      }
                    ]
                  },
                  "unit": "bytes"
                },
                "overrides": []
              },
              "gridPos": {
                "h": 2,
                "w": 6,
                "x": 18,
                "y": 1
              },
              "id": 130,
              "interval": null,
              "links": [],
              "maxDataPoints": 100,
              "options": {
                "colorMode": "value",
                "graphMode": "area",
                "justifyMode": "auto",
                "orientation": "horizontal",
                "reduceOptions": {
                  "calcs": [
                    "lastNotNull"
                  ],
                  "fields": "",
                  "values": false
                },
                "text": {},
                "textMode": "auto"
              },
              "pluginVersion": "8.0.0",
              "targets": [
                {
                  "exemplar": true,
                  "expr": "sum(vm_allowed_memory_bytes{job=~\"$job\", instance=~\"$instance\"})",
                  "format": "time_series",
                  "instant": true,
                  "interval": "",
                  "intervalFactor": 1,
                  "legendFormat": "",
                  "refId": "A"
                }
              ],
              "timeFrom": null,
              "timeShift": null,
              "title": "Allowed memory",
              "type": "stat"
            },
            {
              "cacheTimeout": null,
              "datasource": "$ds",
              "description": "How many entries inverted index contains. This value is proportional to the number of unique timeseries in storage(cardinality).",
              "fieldConfig": {
                "defaults": {
                  "color": {
                    "mode": "thresholds"
                  },
                  "mappings": [],
                  "thresholds": {
                    "mode": "absolute",
                    "steps": [
                      {
                        "color": "green",
                        "value": null
                      }
                    ]
                  },
                  "unit": "short"
                },
                "overrides": []
              },
              "gridPos": {
                "h": 2,
                "w": 6,
                "x": 0,
                "y": 3
              },
              "id": 34,
              "interval": null,
              "links": [],
              "maxDataPoints": 100,
              "options": {
                "colorMode": "value",
                "graphMode": "area",
                "justifyMode": "auto",
                "orientation": "horizontal",
                "reduceOptions": {
                  "calcs": [
                    "lastNotNull"
                  ],
                  "fields": "",
                  "values": false
                },
                "text": {},
                "textMode": "auto"
              },
              "pluginVersion": "8.0.0",
              "targets": [
                {
                  "exemplar": true,
                  "expr": "sum(vm_rows{job=\"$job_storage\", type=\"indexdb\"})",
                  "format": "time_series",
                  "instant": true,
                  "interval": "",
                  "intervalFactor": 1,
                  "legendFormat": "",
                  "refId": "A"
                }
              ],
              "timeFrom": null,
              "timeShift": null,
              "title": "Index size",
              "type": "stat"
            },
            {
              "cacheTimeout": null,
              "datasource": "$ds",
              "description": "Total amount of used disk space",
              "fieldConfig": {
                "defaults": {
                  "color": {
                    "mode": "thresholds"
                  },
                  "mappings": [],
                  "thresholds": {
                    "mode": "absolute",
                    "steps": [
                      {
                        "color": "green",
                        "value": null
                      }
                    ]
                  },
                  "unit": "bytes"
                },
                "overrides": []
              },
              "gridPos": {
                "h": 2,
                "w": 6,
                "x": 6,
                "y": 3
              },
              "id": 35,
              "interval": null,
              "links": [],
              "maxDataPoints": 100,
              "options": {
                "colorMode": "value",
                "graphMode": "area",
                "justifyMode": "auto",
                "orientation": "horizontal",
                "reduceOptions": {
                  "calcs": [
                    "lastNotNull"
                  ],
                  "fields": "",
                  "values": false
                },
                "text": {},
                "textMode": "auto"
              },
              "pluginVersion": "8.0.0",
              "targets": [
                {
                  "exemplar": true,
                  "expr": "sum(vm_data_size_bytes{job=\"$job_storage\", type!=\"indexdb\"})",
                  "format": "time_series",
                  "instant": true,
                  "interval": "",
                  "intervalFactor": 1,
                  "legendFormat": "",
                  "refId": "A"
                }
              ],
              "timeFrom": null,
              "timeShift": null,
              "title": "Disk space usage",
              "type": "stat"
            },
            {
              "cacheTimeout": null,
              "datasource": "$ds",
              "description": "Total number of available CPUs for all VM components. ",
              "fieldConfig": {
                "defaults": {
                  "color": {
                    "mode": "thresholds"
                  },
                  "mappings": [],
                  "thresholds": {
                    "mode": "absolute",
                    "steps": [
                      {
                        "color": "green",
                        "value": null
                      }
                    ]
                  },
                  "unit": "short"
                },
                "overrides": []
              },
              "gridPos": {
                "h": 2,
                "w": 6,
                "x": 12,
                "y": 3
              },
              "id": 126,
              "interval": null,
              "links": [],
              "maxDataPoints": 100,
              "options": {
                "colorMode": "value",
                "graphMode": "area",
                "justifyMode": "auto",
                "orientation": "horizontal",
                "reduceOptions": {
                  "calcs": [
                    "lastNotNull"
                  ],
                  "fields": "",
                  "values": false
                },
                "text": {},
                "textMode": "auto"
              },
              "pluginVersion": "8.0.0",
              "targets": [
                {
                  "exemplar": true,
                  "expr": "sum(vm_available_cpu_cores{job=~\"$job\", instance=~\"$instance\"})",
                  "format": "time_series",
                  "instant": true,
                  "interval": "",
                  "intervalFactor": 1,
                  "legendFormat": "",
                  "refId": "A"
                }
              ],
              "timeFrom": null,
              "timeShift": null,
              "title": "Available CPU",
              "type": "stat"
            },
            {
              "cacheTimeout": null,
              "datasource": "$ds",
              "description": "Total size of available memory for all VM components.",
              "fieldConfig": {
                "defaults": {
                  "color": {
                    "mode": "thresholds"
                  },
                  "mappings": [],
                  "thresholds": {
                    "mode": "absolute",
                    "steps": [
                      {
                        "color": "green",
                        "value": null
                      }
                    ]
                  },
                  "unit": "bytes"
                },
                "overrides": []
              },
              "gridPos": {
                "h": 2,
                "w": 6,
                "x": 18,
                "y": 3
              },
              "id": 128,
              "interval": null,
              "links": [],
              "maxDataPoints": 100,
              "options": {
                "colorMode": "value",
                "graphMode": "area",
                "justifyMode": "auto",
                "orientation": "horizontal",
                "reduceOptions": {
                  "calcs": [
                    "lastNotNull"
                  ],
                  "fields": "",
                  "values": false
                },
                "text": {},
                "textMode": "auto"
              },
              "pluginVersion": "8.0.0",
              "targets": [
                {
                  "exemplar": true,
                  "expr": "sum(vm_available_memory_bytes{job=~\"$job\", instance=~\"$instance\"})",
                  "format": "time_series",
                  "instant": true,
                  "interval": "",
                  "intervalFactor": 1,
                  "legendFormat": "",
                  "refId": "A"
                }
              ],
              "timeFrom": null,
              "timeShift": null,
              "title": "Available memory",
              "type": "stat"
            },
            {
              "columns": [],
              "datasource": "$ds",
              "fontSize": "100%",
              "gridPos": {
                "h": 5,
                "w": 8,
                "x": 0,
                "y": 5
              },
              "id": 26,
              "pageSize": null,
              "scroll": true,
              "showHeader": true,
              "sort": {
                "col": 3,
                "desc": false
              },
              "styles": [
                {
                  "alias": "uptime",
                  "align": "auto",
                  "colorMode": "cell",
                  "colors": [
                    "rgba(245, 54, 54, 0.9)",
                    "rgba(237, 129, 40, 0.89)",
                    "rgba(50, 172, 45, 0.97)"
                  ],
                  "dateFormat": "YYYY-MM-DD HH:mm:ss",
                  "decimals": 2,
                  "mappingType": 1,
                  "pattern": "Value",
                  "thresholds": [
                    "1800",
                    "3600"
                  ],
                  "type": "number",
                  "unit": "s"
                },
                {
                  "alias": "",
                  "align": "auto",
                  "colorMode": null,
                  "colors": [
                    "rgba(245, 54, 54, 0.9)",
                    "rgba(237, 129, 40, 0.89)",
                    "rgba(50, 172, 45, 0.97)"
                  ],
                  "dateFormat": "YYYY-MM-DD HH:mm:ss",
                  "decimals": 2,
                  "mappingType": 1,
                  "pattern": "instance",
                  "thresholds": [],
                  "type": "string",
                  "unit": "short"
                },
                {
                  "alias": "",
                  "align": "auto",
                  "colorMode": null,
                  "colors": [
                    "rgba(245, 54, 54, 0.9)",
                    "rgba(237, 129, 40, 0.89)",
                    "rgba(50, 172, 45, 0.97)"
                  ],
                  "dateFormat": "YYYY-MM-DD HH:mm:ss",
                  "decimals": 2,
                  "mappingType": 1,
                  "pattern": "/.*/",
                  "thresholds": [],
                  "type": "hidden",
                  "unit": "short"
                }
              ],
              "targets": [
                {
                  "expr": "sort((time() - vm_app_start_timestamp{job=~\"$job\", instance=~\"$instance\"}) or (up{job=~\"$job\", instance=~\"$instance\"}))",
                  "format": "table",
                  "hide": false,
                  "instant": true,
                  "legendFormat": "{{instance}}",
                  "refId": "A"
                }
              ],
              "timeFrom": null,
              "timeShift": null,
              "title": "Uptime",
              "transform": "table",
              "type": "table-old"
            },
            {
              "aliasColors": {},
              "bars": false,
              "dashLength": 10,
              "dashes": false,
              "datasource": "$ds",
              "fieldConfig": {
                "defaults": {
                  "links": []
                },
                "overrides": []
              },
              "fill": 1,
              "fillGradient": 0,
              "gridPos": {
                "h": 5,
                "w": 16,
                "x": 8,
                "y": 5
              },
              "hiddenSeries": false,
              "id": 62,
              "legend": {
                "alignAsTable": true,
                "avg": false,
                "current": true,
                "hideEmpty": false,
                "hideZero": false,
                "max": false,
                "min": false,
                "rightSide": true,
                "show": true,
                "sideWidth": null,
                "sort": "current",
                "sortDesc": false,
                "total": false,
                "values": true
              },
              "lines": true,
              "linewidth": 1,
              "nullPointMode": "null as zero",
              "options": {
                "alertThreshold": true
              },
              "percentage": false,
              "pluginVersion": "8.0.0",
              "pointradius": 2,
              "points": false,
              "renderer": "flot",
              "seriesOverrides": [],
              "spaceLength": 10,
              "stack": false,
              "steppedLine": true,
              "targets": [
                {
                  "expr": "sort(sum(up{job=~\"$job\", instance=~\"$instance\"}) by (job, instance))",
                  "format": "time_series",
                  "instant": false,
                  "legendFormat": "{{instance}}({{job}})",
                  "refId": "A"
                }
              ],
              "thresholds": [],
              "timeFrom": null,
              "timeRegions": [],
              "timeShift": null,
              "title": "Uptime",
              "tooltip": {
                "shared": true,
                "sort": 1,
                "value_type": "individual"
              },
              "type": "graph",
              "xaxis": {
                "buckets": null,
                "mode": "time",
                "name": null,
                "show": true,
                "values": []
              },
              "yaxes": [
                {
                  "decimals": 0,
                  "format": "none",
                  "label": null,
                  "logBase": 1,
                  "max": null,
                  "min": null,
                  "show": true
                },
                {
                  "decimals": null,
                  "format": "short",
                  "label": "",
                  "logBase": 1,
                  "max": null,
                  "min": null,
                  "show": true
                }
              ],
              "yaxis": {
                "align": false,
                "alignLevel": 2
              }
            }
          ],
          "title": "Stats",
          "type": "row"
        },
        {
          "collapsed": false,
          "datasource": "$ds",
          "gridPos": {
            "h": 1,
            "w": 24,
            "x": 0,
            "y": 1
          },
          "id": 10,
          "panels": [],
          "title": "Overview",
          "type": "row"
        },
        {
          "aliasColors": {},
          "bars": false,
          "dashLength": 10,
          "dashes": false,
          "datasource": "$ds",
          "description": "How many datapoints are inserted into storage per second by protocol and accountID",
          "fieldConfig": {
            "defaults": {
              "links": []
            },
            "overrides": []
          },
          "fill": 1,
          "fillGradient": 0,
          "gridPos": {
            "h": 8,
            "w": 12,
            "x": 0,
            "y": 2
          },
          "hiddenSeries": false,
          "id": 2,
          "legend": {
            "alignAsTable": true,
            "avg": true,
            "current": true,
            "max": true,
            "min": false,
            "show": true,
            "sort": "current",
            "sortDesc": true,
            "total": false,
            "values": true
          },
          "lines": true,
          "linewidth": 1,
          "nullPointMode": "null",
          "options": {
            "alertThreshold": true
          },
          "percentage": false,
          "pluginVersion": "8.1.0",
          "pointradius": 2,
          "points": false,
          "renderer": "flot",
          "seriesOverrides": [],
          "spaceLength": 10,
          "stack": true,
          "steppedLine": false,
          "targets": [
            {
              "exemplar": true,
              "expr": "sum(rate(vm_rows_inserted_total{job=~\"$job\", instance=~\"$instance\"}[5m])) by (type,accountID) > 0 ",
              "interval": "",
              "legendFormat": "{{type}}",
              "refId": "A"
            }
          ],
          "thresholds": [],
          "timeFrom": null,
          "timeRegions": [],
          "timeShift": null,
          "title": "Datapoints ingestion rate ($instance)",
          "tooltip": {
            "shared": true,
            "sort": 0,
            "value_type": "individual"
          },
          "type": "graph",
          "xaxis": {
            "buckets": null,
            "mode": "time",
            "name": null,
            "show": true,
            "values": []
          },
          "yaxes": [
            {
              "format": "short",
              "label": null,
              "logBase": 1,
              "max": null,
              "min": "0",
              "show": true
            },
            {
              "format": "short",
              "label": null,
              "logBase": 1,
              "max": null,
              "min": "0",
              "show": true
            }
          ],
          "yaxis": {
            "align": false,
            "alignLevel": null
          }
        },
        {
          "aliasColors": {},
          "bars": false,
          "dashLength": 10,
          "dashes": false,
          "datasource": "$ds",
          "description": "* `*` - unsupported query path\n* `/write` - insert into VM\n* `/metrics` - query VM system metrics\n* `/query` - query instant values\n* `/query_range` - query over a range of time\n* `/series` - match a certain label set\n* `/label/{}/values` - query a list of label values (variables mostly)",
          "fieldConfig": {
            "defaults": {
              "links": []
            },
            "overrides": []
          },
          "fill": 1,
          "fillGradient": 0,
          "gridPos": {
            "h": 8,
            "w": 12,
            "x": 12,
            "y": 2
          },
          "hiddenSeries": false,
          "id": 6,
          "legend": {
            "alignAsTable": true,
            "avg": true,
            "current": true,
            "max": true,
            "min": false,
            "show": true,
            "sort": "current",
            "sortDesc": true,
            "total": false,
            "values": true
          },
          "lines": true,
          "linewidth": 1,
          "links": [],
          "nullPointMode": "null as zero",
          "options": {
            "alertThreshold": true
          },
          "percentage": false,
          "pluginVersion": "8.1.0",
          "pointradius": 2,
          "points": false,
          "renderer": "flot",
          "seriesOverrides": [],
          "spaceLength": 10,
          "stack": false,
          "steppedLine": false,
          "targets": [
            {
              "expr": "sum(rate(vm_http_requests_total{job=~\"$job\", instance=~\"$instance.*\", path!~\"/favicon.ico\"}[5m])) by (path) > 0",
              "format": "time_series",
              "intervalFactor": 1,
              "legendFormat": "{{path}}",
              "refId": "A"
            }
          ],
          "thresholds": [],
          "timeFrom": null,
          "timeRegions": [],
          "timeShift": null,
          "title": "Requests rate ($instance)",
          "tooltip": {
            "shared": true,
            "sort": 2,
            "value_type": "individual"
          },
          "type": "graph",
          "xaxis": {
            "buckets": null,
            "mode": "time",
            "name": null,
            "show": true,
            "values": []
          },
          "yaxes": [
            {
              "format": "short",
              "label": null,
              "logBase": 1,
              "max": null,
              "min": "0",
              "show": true
            },
            {
              "format": "short",
              "label": null,
              "logBase": 1,
              "max": null,
              "min": "0",
              "show": true
            }
          ],
          "yaxis": {
            "align": false,
            "alignLevel": null
          }
        },
        {
          "aliasColors": {},
          "bars": false,
          "dashLength": 10,
          "dashes": false,
          "datasource": "$ds",
          "description": "* `*` - unsupported query path\n* `/write` - insert into VM\n* `/metrics` - query VM system metrics\n* `/query` - query instant values\n* `/query_range` - query over a range of time\n* `/series` - match a certain label set\n* `/label/{}/values` - query a list of label values (variables mostly)",
          "fieldConfig": {
            "defaults": {
              "links": []
            },
            "overrides": []
          },
          "fill": 1,
          "fillGradient": 0,
          "gridPos": {
            "h": 8,
            "w": 12,
            "x": 0,
            "y": 10
          },
          "hiddenSeries": false,
          "id": 52,
          "legend": {
            "alignAsTable": true,
            "avg": true,
            "current": true,
            "max": true,
            "min": false,
            "show": true,
            "sort": "current",
            "sortDesc": true,
            "total": false,
            "values": true
          },
          "lines": true,
          "linewidth": 1,
          "links": [],
          "nullPointMode": "null as zero",
          "options": {
            "alertThreshold": true
          },
          "percentage": false,
          "pluginVersion": "8.1.0",
          "pointradius": 2,
          "points": false,
          "renderer": "flot",
          "seriesOverrides": [],
          "spaceLength": 10,
          "stack": false,
          "steppedLine": false,
          "targets": [
            {
              "expr": "sum(rate(vm_http_request_errors_total{job=~\"$job\", instance=~\"$instance.*\"}[5m])) by (path) > 0",
              "format": "time_series",
              "intervalFactor": 1,
              "legendFormat": "{{path}}",
              "refId": "A"
            }
          ],
          "thresholds": [],
          "timeFrom": null,
          "timeRegions": [],
          "timeShift": null,
          "title": "Requests error rate ($instance)",
          "tooltip": {
            "shared": true,
            "sort": 2,
            "value_type": "individual"
          },
          "type": "graph",
          "xaxis": {
            "buckets": null,
            "mode": "time",
            "name": null,
            "show": true,
            "values": []
          },
          "yaxes": [
            {
              "format": "short",
              "label": null,
              "logBase": 1,
              "max": null,
              "min": "0",
              "show": true
            },
            {
              "format": "short",
              "label": null,
              "logBase": 1,
              "max": null,
              "min": "0",
              "show": true
            }
          ],
          "yaxis": {
            "align": false,
            "alignLevel": null
          }
        },
        {
          "aliasColors": {},
          "bars": false,
          "dashLength": 10,
          "dashes": false,
          "datasource": "$ds",
          "description": "The less time it takes is better.\n* `*` - unsupported query path\n* `/write` - insert into VM\n* `/metrics` - query VM system metrics\n* `/query` - query instant values\n* `/query_range` - query over a range of time\n* `/series` - match a certain label set\n* `/label/{}/values` - query a list of label values (variables mostly)",
          "fieldConfig": {
            "defaults": {
              "links": []
            },
            "overrides": []
          },
          "fill": 1,
          "fillGradient": 0,
          "gridPos": {
            "h": 8,
            "w": 12,
            "x": 12,
            "y": 10
          },
          "hiddenSeries": false,
          "id": 8,
          "legend": {
            "alignAsTable": true,
            "avg": true,
            "current": true,
            "max": true,
            "min": false,
            "show": true,
            "sort": "current",
            "sortDesc": true,
            "total": false,
            "values": true
          },
          "lines": true,
          "linewidth": 1,
          "links": [],
          "nullPointMode": "null as zero",
          "options": {
            "alertThreshold": true
          },
          "percentage": false,
          "pluginVersion": "8.1.0",
          "pointradius": 2,
          "points": false,
          "renderer": "flot",
          "seriesOverrides": [],
          "spaceLength": 10,
          "stack": false,
          "steppedLine": false,
          "targets": [
            {
              "expr": "max(vm_request_duration_seconds{job=~\"$job\", instance=~\"$instance\", quantile=~\"(0.5|0.99)\"}) by (path, quantile) > 0",
              "format": "time_series",
              "intervalFactor": 1,
              "legendFormat": "{{quantile}} ({{path}})",
              "refId": "A"
            }
          ],
          "thresholds": [],
          "timeFrom": null,
          "timeRegions": [],
          "timeShift": null,
          "title": "Query duration ($instance)",
          "tooltip": {
            "shared": true,
            "sort": 2,
            "value_type": "individual"
          },
          "type": "graph",
          "xaxis": {
            "buckets": null,
            "mode": "time",
            "name": null,
            "show": true,
            "values": []
          },
          "yaxes": [
            {
              "format": "s",
              "label": null,
              "logBase": 1,
              "max": null,
              "min": "0",
              "show": true
            },
            {
              "format": "short",
              "label": null,
              "logBase": 1,
              "max": null,
              "min": "0",
              "show": true
            }
          ],
          "yaxis": {
            "align": false,
            "alignLevel": null
          }
        },
        {
          "aliasColors": {},
          "bars": false,
          "dashLength": 10,
          "dashes": false,
          "datasource": "$ds",
          "description": "RPC errors are interconnection errors between cluster components. Errors rate should be 0 if network connection is stable and all components are up and operational.",
          "fieldConfig": {
            "defaults": {
              "links": []
            },
            "overrides": []
          },
          "fill": 1,
          "fillGradient": 0,
          "gridPos": {
            "h": 8,
            "w": 12,
            "x": 0,
            "y": 18
          },
          "hiddenSeries": false,
          "id": 44,
          "legend": {
            "alignAsTable": true,
            "avg": true,
            "current": true,
            "max": true,
            "min": false,
            "show": true,
            "sort": "current",
            "sortDesc": true,
            "total": false,
            "values": true
          },
          "lines": true,
          "linewidth": 1,
          "links": [],
          "nullPointMode": "null",
          "options": {
            "alertThreshold": true
          },
          "percentage": false,
          "pluginVersion": "8.1.0",
          "pointradius": 1,
          "points": false,
          "renderer": "flot",
          "seriesOverrides": [],
          "spaceLength": 10,
          "stack": false,
          "steppedLine": false,
          "targets": [
            {
              "expr": "sum(rate(vm_rpc_connection_errors_total{job=~\"$job\",instance=~\"$instance.*\"}[5m]))",
              "format": "time_series",
              "intervalFactor": 1,
              "legendFormat": "Connection",
              "refId": "A"
            },
            {
              "expr": "sum(rate(vm_rpc_dial_errors_total{job=~\"$job\",instance=~\"$instance.*\"}[5m]))",
              "format": "time_series",
              "intervalFactor": 1,
              "legendFormat": "Dial",
              "refId": "B"
            },
            {
              "expr": "sum(rate(vm_rpc_handshake_errors_total{job=~\"$job\",instance=~\"$instance.*\"}[5m]))",
              "format": "time_series",
              "intervalFactor": 1,
              "legendFormat": "Handshake",
              "refId": "E"
            }
          ],
          "thresholds": [],
          "timeFrom": null,
          "timeRegions": [],
          "timeShift": null,
          "title": "RPC errors ($instance)",
          "tooltip": {
            "shared": true,
            "sort": 0,
            "value_type": "individual"
          },
          "type": "graph",
          "xaxis": {
            "buckets": null,
            "mode": "time",
            "name": null,
            "show": true,
            "values": []
          },
          "yaxes": [
            {
              "format": "rps",
              "label": null,
              "logBase": 1,
              "max": null,
              "min": "0",
              "show": true
            },
            {
              "format": "short",
              "label": null,
              "logBase": 1,
              "max": null,
              "min": "0",
              "show": true
            }
          ],
          "yaxis": {
            "align": false,
            "alignLevel": null
          }
        },
        {
          "aliasColors": {},
          "bars": false,
          "dashLength": 10,
          "dashes": false,
          "datasource": "$ds",
          "description": "Shows the rate of logging the messages by their level. Unexpected spike in rate is a good reason to check logs.",
          "fieldConfig": {
            "defaults": {
              "links": []
            },
            "overrides": []
          },
          "fill": 1,
          "fillGradient": 0,
          "gridPos": {
            "h": 8,
            "w": 12,
            "x": 12,
            "y": 18
          },
          "hiddenSeries": false,
          "id": 104,
          "legend": {
            "alignAsTable": true,
            "avg": true,
            "current": true,
            "max": true,
            "min": false,
            "show": true,
            "sort": "current",
            "sortDesc": true,
            "total": false,
            "values": true
          },
          "lines": true,
          "linewidth": 1,
          "links": [],
          "nullPointMode": "null",
          "options": {
            "alertThreshold": true
          },
          "percentage": false,
          "pluginVersion": "8.1.0",
          "pointradius": 2,
          "points": false,
          "renderer": "flot",
          "seriesOverrides": [],
          "spaceLength": 10,
          "stack": false,
          "steppedLine": false,
          "targets": [
            {
              "exemplar": true,
              "expr": "sum(rate(vm_log_messages_total{job=~\"$job\",instance=~\"$instance.*\", level!=\"info\"}[5m])) by (job, level) ",
              "format": "time_series",
              "hide": false,
              "interval": "",
              "intervalFactor": 1,
              "legendFormat": "{{job}} - {{level}}",
              "refId": "A"
            }
          ],
          "thresholds": [],
          "timeFrom": null,
          "timeRegions": [],
          "timeShift": null,
          "title": "Logging rate",
          "tooltip": {
            "shared": true,
            "sort": 2,
            "value_type": "individual"
          },
          "type": "graph",
          "xaxis": {
            "buckets": null,
            "mode": "time",
            "name": null,
            "show": true,
            "values": []
          },
          "yaxes": [
            {
              "decimals": null,
              "format": "short",
              "label": null,
              "logBase": 1,
              "max": null,
              "min": "0",
              "show": true
            },
            {
              "format": "short",
              "label": null,
              "logBase": 1,
              "max": null,
              "min": null,
              "show": true
            }
          ],
          "yaxis": {
            "align": false,
            "alignLevel": null
          }
        },
        {
          "aliasColors": {},
          "bars": false,
          "dashLength": 10,
          "dashes": false,
          "datasource": "$ds",
          "description": "Shows the percentage of remaining disk space at `-storageDataPath` by instance",
          "fieldConfig": {
            "defaults": {
              "links": []
            },
            "overrides": []
          },
          "fill": 0,
          "fillGradient": 0,
          "gridPos": {
            "h": 8,
            "w": 12,
            "x": 0,
            "y": 26
          },
          "hiddenSeries": false,
          "id": 110,
          "legend": {
            "alignAsTable": true,
            "avg": true,
            "current": true,
            "max": true,
            "min": false,
            "show": true,
            "sort": "current",
            "sortDesc": true,
            "total": false,
            "values": true
          },
          "lines": true,
          "linewidth": 1,
          "links": [],
          "nullPointMode": "null",
          "options": {
            "alertThreshold": true
          },
          "percentage": false,
          "pluginVersion": "8.1.0",
          "pointradius": 2,
          "points": false,
          "renderer": "flot",
          "seriesOverrides": [],
          "spaceLength": 10,
          "stack": false,
          "steppedLine": false,
          "targets": [
            {
              "exemplar": true,
              "expr": "sum(vm_data_size_bytes{job=\"$job_storage\", instance=~\"$instance\"}) by(instance) /\n(\n  sum(vm_free_disk_space_bytes{job=\"$job_storage\", instance=~\"$instance\"}) by(instance) +\n  sum(vm_data_size_bytes{job=\"$job_storage\", instance=~\"$instance\"}) by(instance)\n)",
              "format": "time_series",
              "interval": "",
              "intervalFactor": 1,
              "legendFormat": "{{instance}}",
              "refId": "A"
            }
          ],
          "thresholds": [
            {
              "$$hashKey": "object:89",
              "colorMode": "critical",
              "fill": true,
              "line": true,
              "op": "gt",
              "value": 0.8,
              "yaxis": "left"
            }
          ],
          "timeFrom": null,
          "timeRegions": [],
          "timeShift": null,
          "title": "Disk space used ($instance)",
          "tooltip": {
            "shared": true,
            "sort": 0,
            "value_type": "individual"
          },
          "type": "graph",
          "xaxis": {
            "buckets": null,
            "mode": "time",
            "name": null,
            "show": true,
            "values": []
          },
          "yaxes": [
            {
              "format": "percentunit",
              "label": null,
              "logBase": 1,
              "max": null,
              "min": "0",
              "show": true
            },
            {
              "format": "short",
              "label": null,
              "logBase": 1,
              "max": null,
              "min": null,
              "show": true
            }
          ],
          "yaxis": {
            "align": false,
            "alignLevel": null
          }
        },
        {
          "aliasColors": {},
          "bars": false,
          "dashLength": 10,
          "dashes": false,
          "datasource": "$ds",
          "description": "Shows the number of active time series with new data points inserted during the last hour. High value may result in ingestion slowdown. \n\nSee following link for details:",
          "fieldConfig": {
            "defaults": {
              "links": []
            },
            "overrides": []
          },
          "fill": 1,
          "fillGradient": 0,
          "gridPos": {
            "h": 8,
            "w": 12,
            "x": 12,
            "y": 26
          },
          "hiddenSeries": false,
          "id": 12,
          "legend": {
            "alignAsTable": true,
            "avg": true,
            "current": true,
            "max": true,
            "min": false,
            "show": true,
            "sort": "current",
            "sortDesc": true,
            "total": false,
            "values": true
          },
          "lines": true,
          "linewidth": 1,
          "links": [
            {
              "targetBlank": true,
              "title": "troubleshooting",
              "url": "https://github.com/VictoriaMetrics/VictoriaMetrics/blob/master/README.md#troubleshooting"
            }
          ],
          "nullPointMode": "null",
          "options": {
            "alertThreshold": true
          },
          "percentage": false,
          "pluginVersion": "8.1.0",
          "pointradius": 2,
          "points": false,
          "renderer": "flot",
          "seriesOverrides": [],
          "spaceLength": 10,
          "stack": false,
          "steppedLine": false,
          "targets": [
            {
              "expr": "sum(vm_cache_entries{job=~\"$job\", instance=~\"$instance.*\", type=\"storage/hour_metric_ids\"})",
              "format": "time_series",
              "intervalFactor": 1,
              "legendFormat": "Active time series",
              "refId": "A"
            }
          ],
          "thresholds": [],
          "timeFrom": null,
          "timeRegions": [],
          "timeShift": null,
          "title": "Active time series ($instance)",
          "tooltip": {
            "shared": true,
            "sort": 0,
            "value_type": "individual"
          },
          "type": "graph",
          "xaxis": {
            "buckets": null,
            "mode": "time",
            "name": null,
            "show": true,
            "values": []
          },
          "yaxes": [
            {
              "format": "short",
              "label": null,
              "logBase": 1,
              "max": null,
              "min": "0",
              "show": true
            },
            {
              "format": "short",
              "label": null,
              "logBase": 1,
              "max": null,
              "min": "0",
              "show": true
            }
          ],
          "yaxis": {
            "align": false,
            "alignLevel": null
          }
        },
        {
          "collapsed": true,
          "datasource": "$ds",
          "gridPos": {
            "h": 1,
            "w": 24,
            "x": 0,
            "y": 34
          },
          "id": 46,
          "panels": [
            {
              "aliasColors": {},
              "bars": false,
              "dashLength": 10,
              "dashes": false,
              "datasource": "$ds",
              "description": "Amount of used memory (resident)\nContains memory share which can be freed by OS when needed.",
              "fieldConfig": {
                "defaults": {
                  "links": []
                },
                "overrides": []
              },
              "fill": 0,
              "fillGradient": 0,
              "gridPos": {
                "h": 8,
                "w": 12,
                "x": 0,
                "y": 3
              },
              "hiddenSeries": false,
              "id": 66,
              "legend": {
                "alignAsTable": true,
                "avg": true,
                "current": true,
                "max": true,
                "min": false,
                "show": true,
                "sort": "current",
                "sortDesc": true,
                "total": false,
                "values": true
              },
              "lines": true,
              "linewidth": 1,
              "links": [],
              "nullPointMode": "null",
              "options": {
                "alertThreshold": true
              },
              "percentage": false,
              "pluginVersion": "8.0.0",
              "pointradius": 2,
              "points": false,
              "renderer": "flot",
              "seriesOverrides": [],
              "spaceLength": 10,
              "stack": false,
              "steppedLine": false,
              "targets": [
                {
                  "exemplar": true,
                  "expr": "sum(process_resident_memory_bytes{job=~\"$job\", instance=~\"$instance\"}) by (job, instance)",
                  "interval": "",
                  "legendFormat": "{{instance}} ({{job}})",
                  "refId": "A"
                }
              ],
              "thresholds": [],
              "timeFrom": null,
              "timeRegions": [],
              "timeShift": null,
              "title": "RSS memory usage ($instance)",
              "tooltip": {
                "shared": true,
                "sort": 2,
                "value_type": "individual"
              },
              "type": "graph",
              "xaxis": {
                "buckets": null,
                "mode": "time",
                "name": null,
                "show": true,
                "values": []
              },
              "yaxes": [
                {
                  "format": "bytes",
                  "label": null,
                  "logBase": 1,
                  "max": null,
                  "min": "0",
                  "show": true
                },
                {
                  "format": "short",
                  "label": null,
                  "logBase": 1,
                  "max": null,
                  "min": null,
                  "show": true
                }
              ],
              "yaxis": {
                "align": false,
                "alignLevel": null
              }
            },
            {
              "aliasColors": {},
              "bars": false,
              "dashLength": 10,
              "dashes": false,
              "datasource": "$ds",
              "description": "RSS share for memory allocated by the process itself. This share cannot be freed by the OS, so it must be taken into account by OOM killer.",
              "fieldConfig": {
                "defaults": {
                  "links": []
                },
                "overrides": []
              },
              "fill": 0,
              "fillGradient": 0,
              "gridPos": {
                "h": 8,
                "w": 12,
                "x": 12,
                "y": 3
              },
              "hiddenSeries": false,
              "id": 138,
              "legend": {
                "alignAsTable": true,
                "avg": true,
                "current": true,
                "max": true,
                "min": false,
                "show": true,
                "sort": "current",
                "sortDesc": true,
                "total": false,
                "values": true
              },
              "lines": true,
              "linewidth": 1,
              "links": [],
              "nullPointMode": "null",
              "options": {
                "alertThreshold": true
              },
              "percentage": false,
              "pluginVersion": "8.0.0",
              "pointradius": 2,
              "points": false,
              "renderer": "flot",
              "seriesOverrides": [],
              "spaceLength": 10,
              "stack": false,
              "steppedLine": false,
              "targets": [
                {
                  "exemplar": true,
                  "expr": "sum(process_resident_memory_anon_bytes{job=~\"$job\", instance=~\"$instance\"}) by (job, instance)",
                  "interval": "",
                  "legendFormat": "{{instance}} ({{job}})",
                  "refId": "A"
                }
              ],
              "thresholds": [],
              "timeFrom": null,
              "timeRegions": [],
              "timeShift": null,
              "title": "RSS anonymous memory usage ($instance)",
              "tooltip": {
                "shared": true,
                "sort": 2,
                "value_type": "individual"
              },
              "type": "graph",
              "xaxis": {
                "buckets": null,
                "mode": "time",
                "name": null,
                "show": true,
                "values": []
              },
              "yaxes": [
                {
                  "format": "bytes",
                  "label": null,
                  "logBase": 1,
                  "max": null,
                  "min": "0",
                  "show": true
                },
                {
                  "format": "short",
                  "label": null,
                  "logBase": 1,
                  "max": null,
                  "min": null,
                  "show": true
                }
              ],
              "yaxis": {
                "align": false,
                "alignLevel": null
              }
            },
            {
              "aliasColors": {},
              "bars": false,
              "dashLength": 10,
              "dashes": false,
              "datasource": "$ds",
              "fieldConfig": {
                "defaults": {
                  "links": []
                },
                "overrides": []
              },
              "fill": 0,
              "fillGradient": 0,
              "gridPos": {
                "h": 8,
                "w": 12,
                "x": 0,
                "y": 11
              },
              "hiddenSeries": false,
              "id": 64,
              "legend": {
                "alignAsTable": true,
                "avg": true,
                "current": true,
                "max": true,
                "min": false,
                "show": true,
                "sort": "current",
                "sortDesc": true,
                "total": false,
                "values": true
              },
              "lines": true,
              "linewidth": 1,
              "links": [],
              "nullPointMode": "null",
              "options": {
                "alertThreshold": true
              },
              "percentage": false,
              "pluginVersion": "8.0.0",
              "pointradius": 2,
              "points": false,
              "renderer": "flot",
              "seriesOverrides": [],
              "spaceLength": 10,
              "stack": false,
              "steppedLine": false,
              "targets": [
                {
                  "exemplar": true,
                  "expr": "sum(rate(process_cpu_seconds_total{job=~\"$job\", instance=~\"$instance\"}[5m])) by(job, instance)",
                  "format": "time_series",
                  "interval": "",
                  "intervalFactor": 1,
                  "legendFormat": "{{instance}} ({{job}})",
                  "refId": "A"
                }
              ],
              "thresholds": [],
              "timeFrom": null,
              "timeRegions": [],
              "timeShift": null,
              "title": "CPU ($instance)",
              "tooltip": {
                "shared": true,
                "sort": 0,
                "value_type": "individual"
              },
              "type": "graph",
              "xaxis": {
                "buckets": null,
                "mode": "time",
                "name": null,
                "show": true,
                "values": []
              },
              "yaxes": [
                {
                  "format": "short",
                  "label": null,
                  "logBase": 1,
                  "max": null,
                  "min": "0",
                  "show": true
                },
                {
                  "format": "short",
                  "label": null,
                  "logBase": 1,
                  "max": null,
                  "min": null,
                  "show": true
                }
              ],
              "yaxis": {
                "align": false,
                "alignLevel": null
              }
            },
            {
              "aliasColors": {},
              "bars": false,
              "dashLength": 10,
              "dashes": false,
              "datasource": "$ds",
              "description": "Shows average GC duration by instance",
              "fieldConfig": {
                "defaults": {
                  "links": []
                },
                "overrides": []
              },
              "fill": 0,
              "fillGradient": 0,
              "gridPos": {
                "h": 8,
                "w": 12,
                "x": 12,
                "y": 11
              },
              "hiddenSeries": false,
              "id": 72,
              "legend": {
                "alignAsTable": true,
                "avg": true,
                "current": true,
                "max": true,
                "min": false,
                "show": true,
                "sort": "current",
                "sortDesc": true,
                "total": false,
                "values": true
              },
              "lines": true,
              "linewidth": 1,
              "links": [],
              "nullPointMode": "null",
              "options": {
                "alertThreshold": true
              },
              "percentage": false,
              "pluginVersion": "8.0.0",
              "pointradius": 2,
              "points": false,
              "renderer": "flot",
              "seriesOverrides": [],
              "spaceLength": 10,
              "stack": false,
              "steppedLine": false,
              "targets": [
                {
                  "exemplar": true,
                  "expr": "sum(rate(go_gc_duration_seconds_sum{job=~\"$job\", instance=~\"$instance\"}[5m])) by(job, instance)\n/\nsum(rate(go_gc_duration_seconds_count{job=~\"$job\", instance=~\"$instance\"}[5m])) by(job, instance)",
                  "format": "time_series",
                  "interval": "",
                  "intervalFactor": 2,
                  "legendFormat": "{{instance}} ({{job}})",
                  "refId": "A"
                }
              ],
              "thresholds": [],
              "timeFrom": null,
              "timeRegions": [],
              "timeShift": null,
              "title": "GC duration ($instance)",
              "tooltip": {
                "shared": true,
                "sort": 0,
                "value_type": "individual"
              },
              "type": "graph",
              "xaxis": {
                "buckets": null,
                "mode": "time",
                "name": null,
                "show": true,
                "values": []
              },
              "yaxes": [
                {
                  "format": "s",
                  "label": null,
                  "logBase": 1,
                  "max": null,
                  "min": "0",
                  "show": true
                },
                {
                  "format": "short",
                  "label": null,
                  "logBase": 1,
                  "max": null,
                  "min": null,
                  "show": true
                }
              ],
              "yaxis": {
                "align": false,
                "alignLevel": null
              }
            },
            {
              "aliasColors": {},
              "bars": false,
              "dashLength": 10,
              "dashes": false,
              "datasource": "$ds",
              "description": "Panel shows the number of open file descriptors in the OS.\nReaching the limit of open files can cause various issues and must be prevented.\n\nSee how to change limits here https://medium.com/@muhammadtriwibowo/set-permanently-ulimit-n-open-files-in-ubuntu-4d61064429a",
              "fieldConfig": {
                "defaults": {
                  "links": []
                },
                "overrides": []
              },
              "fill": 0,
              "fillGradient": 0,
              "gridPos": {
                "h": 8,
                "w": 12,
                "x": 0,
                "y": 19
              },
              "hiddenSeries": false,
              "id": 117,
              "legend": {
                "alignAsTable": true,
                "avg": true,
                "current": true,
                "max": true,
                "min": false,
                "show": true,
                "sort": "current",
                "sortDesc": false,
                "total": false,
                "values": true
              },
              "lines": true,
              "linewidth": 1,
              "links": [],
              "nullPointMode": "null",
              "options": {
                "alertThreshold": true
              },
              "percentage": false,
              "pluginVersion": "8.0.0",
              "pointradius": 2,
              "points": false,
              "renderer": "flot",
              "seriesOverrides": [
                {
                  "alias": "/max.*/",
                  "color": "#C4162A"
                }
              ],
              "spaceLength": 10,
              "stack": false,
              "steppedLine": false,
              "targets": [
                {
                  "exemplar": true,
                  "expr": "sum(process_open_fds{job=~\"$job\", instance=~\"$instance\"}) by(job, instance)",
                  "format": "time_series",
                  "interval": "",
                  "intervalFactor": 2,
                  "legendFormat": "{{instance}} ({{job}})",
                  "refId": "A"
                },
                {
                  "exemplar": true,
                  "expr": "sum(process_max_fds{job=~\"$job\", instance=~\"$instance\"}) by(job, instance)",
                  "format": "time_series",
                  "interval": "",
                  "intervalFactor": 2,
                  "legendFormat": "max {{instance}} ({{job}})",
                  "refId": "B"
                }
              ],
              "thresholds": [],
              "timeFrom": null,
              "timeRegions": [],
              "timeShift": null,
              "title": "Open FDs ($instance)",
              "tooltip": {
                "shared": true,
                "sort": 2,
                "value_type": "individual"
              },
              "type": "graph",
              "xaxis": {
                "buckets": null,
                "mode": "time",
                "name": null,
                "show": true,
                "values": []
              },
              "yaxes": [
                {
                  "decimals": 0,
                  "format": "short",
                  "label": null,
                  "logBase": 2,
                  "max": null,
                  "min": "0",
                  "show": true
                },
                {
                  "format": "short",
                  "label": null,
                  "logBase": 1,
                  "max": null,
                  "min": null,
                  "show": true
                }
              ],
              "yaxis": {
                "align": false,
                "alignLevel": null
              }
            },
            {
              "aliasColors": {},
              "bars": false,
              "dashLength": 10,
              "dashes": false,
              "datasource": "$ds",
              "description": "Shows the number of bytes read/write from the storage layer.",
              "fieldConfig": {
                "defaults": {
                  "links": []
                },
                "overrides": []
              },
              "fill": 1,
              "fillGradient": 0,
              "gridPos": {
                "h": 8,
                "w": 12,
                "x": 12,
                "y": 19
              },
              "hiddenSeries": false,
              "id": 122,
              "legend": {
                "alignAsTable": true,
                "avg": true,
                "current": true,
                "max": true,
                "min": false,
                "show": true,
                "sort": "current",
                "sortDesc": true,
                "total": false,
                "values": true
              },
              "lines": true,
              "linewidth": 1,
              "links": [],
              "nullPointMode": "null",
              "options": {
                "alertThreshold": true
              },
              "percentage": false,
              "pluginVersion": "8.0.0",
              "pointradius": 2,
              "points": false,
              "renderer": "flot",
              "seriesOverrides": [
                {
                  "alias": "/read .*/",
                  "transform": "negative-Y"
                }
              ],
              "spaceLength": 10,
              "stack": false,
              "steppedLine": false,
              "targets": [
                {
                  "exemplar": true,
                  "expr": "sum(rate(process_io_storage_read_bytes_total{job=\"$job_storage\", instance=~\"$instance\"}[5m])) by(instance)",
                  "format": "time_series",
                  "hide": false,
                  "interval": "",
                  "intervalFactor": 1,
                  "legendFormat": "read {{instance}}",
                  "refId": "A"
                },
                {
                  "expr": "sum(rate(process_io_storage_written_bytes_total{job=\"$job_storage\", instance=~\"$instance\"}[5m])) by(instance)",
                  "format": "time_series",
                  "hide": false,
                  "interval": "",
                  "intervalFactor": 1,
                  "legendFormat": "write {{instance}}",
                  "refId": "B"
                }
              ],
              "thresholds": [],
              "timeFrom": null,
              "timeRegions": [],
              "timeShift": null,
              "title": "Disk writes/reads ($instance)",
              "tooltip": {
                "shared": true,
                "sort": 0,
                "value_type": "individual"
              },
              "type": "graph",
              "xaxis": {
                "buckets": null,
                "mode": "time",
                "name": null,
                "show": true,
                "values": []
              },
              "yaxes": [
                {
                  "decimals": null,
                  "format": "bytes",
                  "label": null,
                  "logBase": 1,
                  "max": null,
                  "min": null,
                  "show": true
                },
                {
                  "format": "short",
                  "label": null,
                  "logBase": 1,
                  "max": null,
                  "min": "0",
                  "show": true
                }
              ],
              "yaxis": {
                "align": false,
                "alignLevel": null
              }
            },
            {
              "aliasColors": {},
              "bars": false,
              "dashLength": 10,
              "dashes": false,
              "datasource": "$ds",
              "fieldConfig": {
                "defaults": {
                  "links": []
                },
                "overrides": []
              },
              "fill": 0,
              "fillGradient": 0,
              "gridPos": {
                "h": 8,
                "w": 12,
                "x": 0,
                "y": 27
              },
              "hiddenSeries": false,
              "id": 68,
              "legend": {
                "alignAsTable": true,
                "avg": true,
                "current": true,
                "max": true,
                "min": false,
                "show": true,
                "sort": "current",
                "sortDesc": true,
                "total": false,
                "values": true
              },
              "lines": true,
              "linewidth": 1,
              "links": [],
              "nullPointMode": "null",
              "options": {
                "alertThreshold": true
              },
              "percentage": false,
              "pluginVersion": "8.0.0",
              "pointradius": 2,
              "points": false,
              "renderer": "flot",
              "seriesOverrides": [],
              "spaceLength": 10,
              "stack": false,
              "steppedLine": false,
              "targets": [
                {
                  "exemplar": true,
                  "expr": "sum(go_goroutines{job=~\"$job\", instance=~\"$instance\"}) by(job, instance)",
                  "format": "time_series",
                  "interval": "",
                  "intervalFactor": 2,
                  "legendFormat": "{{instance}} ({{job}})",
                  "refId": "A"
                }
              ],
              "thresholds": [],
              "timeFrom": null,
              "timeRegions": [],
              "timeShift": null,
              "title": "Goroutines ($instance)",
              "tooltip": {
                "shared": true,
                "sort": 2,
                "value_type": "individual"
              },
              "type": "graph",
              "xaxis": {
                "buckets": null,
                "mode": "time",
                "name": null,
                "show": true,
                "values": []
              },
              "yaxes": [
                {
                  "decimals": 0,
                  "format": "short",
                  "label": null,
                  "logBase": 1,
                  "max": null,
                  "min": "0",
                  "show": true
                },
                {
                  "format": "short",
                  "label": null,
                  "logBase": 1,
                  "max": null,
                  "min": null,
                  "show": true
                }
              ],
              "yaxis": {
                "align": false,
                "alignLevel": null
              }
            },
            {
              "aliasColors": {},
              "bars": false,
              "dashLength": 10,
              "dashes": false,
              "datasource": "$ds",
              "fill": 0,
              "fillGradient": 0,
              "gridPos": {
                "h": 8,
                "w": 12,
                "x": 12,
                "y": 27
              },
              "hiddenSeries": false,
              "id": 119,
              "legend": {
                "alignAsTable": true,
                "avg": true,
                "current": true,
                "max": true,
                "min": false,
                "show": true,
                "sort": "current",
                "sortDesc": true,
                "total": false,
                "values": true
              },
              "lines": true,
              "linewidth": 1,
              "nullPointMode": "null",
              "options": {
                "alertThreshold": true
              },
              "percentage": false,
              "pluginVersion": "8.0.0",
              "pointradius": 2,
              "points": false,
              "renderer": "flot",
              "seriesOverrides": [],
              "spaceLength": 10,
              "stack": false,
              "steppedLine": false,
              "targets": [
                {
                  "exemplar": true,
                  "expr": "sum(vm_tcplistener_conns{job=~\"$job\", instance=~\"$instance\"}) by(job, instance)",
                  "interval": "",
                  "legendFormat": "{{instance}} ({{job}})",
                  "refId": "A"
                }
              ],
              "thresholds": [],
              "timeFrom": null,
              "timeRegions": [],
              "timeShift": null,
              "title": "TCP connections ($instance)",
              "tooltip": {
                "shared": true,
                "sort": 2,
                "value_type": "individual"
              },
              "type": "graph",
              "xaxis": {
                "buckets": null,
                "mode": "time",
                "name": null,
                "show": true,
                "values": []
              },
              "yaxes": [
                {
                  "format": "short",
                  "label": null,
                  "logBase": 1,
                  "max": null,
                  "min": null,
                  "show": true
                },
                {
                  "format": "short",
                  "label": null,
                  "logBase": 1,
                  "max": null,
                  "min": null,
                  "show": true
                }
              ],
              "yaxis": {
                "align": false,
                "alignLevel": null
              }
            },
            {
              "aliasColors": {},
              "bars": false,
              "dashLength": 10,
              "dashes": false,
              "datasource": "$ds",
              "fieldConfig": {
                "defaults": {
                  "links": []
                },
                "overrides": []
              },
              "fill": 0,
              "fillGradient": 0,
              "gridPos": {
                "h": 8,
                "w": 12,
                "x": 0,
                "y": 35
              },
              "hiddenSeries": false,
              "id": 70,
              "legend": {
                "alignAsTable": true,
                "avg": true,
                "current": true,
                "max": true,
                "min": false,
                "show": true,
                "sort": "current",
                "sortDesc": true,
                "total": false,
                "values": true
              },
              "lines": true,
              "linewidth": 1,
              "links": [],
              "nullPointMode": "null",
              "options": {
                "alertThreshold": true
              },
              "percentage": false,
              "pluginVersion": "8.0.0",
              "pointradius": 2,
              "points": false,
              "renderer": "flot",
              "seriesOverrides": [],
              "spaceLength": 10,
              "stack": false,
              "steppedLine": false,
              "targets": [
                {
                  "exemplar": true,
                  "expr": "sum(process_num_threads{job=~\"$job\", instance=~\"$instance\"}) by(job, instance)",
                  "format": "time_series",
                  "interval": "",
                  "intervalFactor": 2,
                  "legendFormat": "{{instance}} ({{job}})",
                  "refId": "A"
                }
              ],
              "thresholds": [],
              "timeFrom": null,
              "timeRegions": [],
              "timeShift": null,
              "title": "Threads ($instance)",
              "tooltip": {
                "shared": true,
                "sort": 2,
                "value_type": "individual"
              },
              "type": "graph",
              "xaxis": {
                "buckets": null,
                "mode": "time",
                "name": null,
                "show": true,
                "values": []
              },
              "yaxes": [
                {
                  "decimals": 0,
                  "format": "short",
                  "label": null,
                  "logBase": 1,
                  "max": null,
                  "min": "0",
                  "show": true
                },
                {
                  "format": "short",
                  "label": null,
                  "logBase": 1,
                  "max": null,
                  "min": null,
                  "show": true
                }
              ],
              "yaxis": {
                "align": false,
                "alignLevel": null
              }
            },
            {
              "aliasColors": {},
              "bars": false,
              "dashLength": 10,
              "dashes": false,
              "datasource": "$ds",
              "fill": 0,
              "fillGradient": 0,
              "gridPos": {
                "h": 8,
                "w": 12,
                "x": 12,
                "y": 35
              },
              "hiddenSeries": false,
              "id": 120,
              "legend": {
                "alignAsTable": true,
                "avg": true,
                "current": true,
                "max": true,
                "min": false,
                "show": true,
                "sort": "current",
                "sortDesc": true,
                "total": false,
                "values": true
              },
              "lines": true,
              "linewidth": 1,
              "nullPointMode": "null",
              "options": {
                "alertThreshold": true
              },
              "percentage": false,
              "pluginVersion": "8.0.0",
              "pointradius": 2,
              "points": false,
              "renderer": "flot",
              "seriesOverrides": [],
              "spaceLength": 10,
              "stack": false,
              "steppedLine": false,
              "targets": [
                {
                  "exemplar": true,
                  "expr": "sum(rate(vm_tcplistener_accepts_total{job=~\"$job\", instance=~\"$instance\"}[5m])) by(job, instance)",
                  "interval": "",
                  "legendFormat": "{{instance}} ({{job}})",
                  "refId": "A"
                }
              ],
              "thresholds": [],
              "timeFrom": null,
              "timeRegions": [],
              "timeShift": null,
              "title": "TCP connections rate ($instance)",
              "tooltip": {
                "shared": true,
                "sort": 2,
                "value_type": "individual"
              },
              "type": "graph",
              "xaxis": {
                "buckets": null,
                "mode": "time",
                "name": null,
                "show": true,
                "values": []
              },
              "yaxes": [
                {
                  "format": "short",
                  "label": null,
                  "logBase": 1,
                  "max": null,
                  "min": null,
                  "show": true
                },
                {
                  "format": "short",
                  "label": null,
                  "logBase": 1,
                  "max": null,
                  "min": null,
                  "show": true
                }
              ],
              "yaxis": {
                "align": false,
                "alignLevel": null
              }
            }
          ],
          "title": "Resource usage ($job)",
          "type": "row"
        },
        {
          "collapsed": true,
          "datasource": "$ds",
          "gridPos": {
            "h": 1,
            "w": 24,
            "x": 0,
            "y": 35
          },
          "id": 106,
          "panels": [
            {
              "aliasColors": {},
              "bars": false,
              "dashLength": 10,
              "dashes": false,
              "datasource": "$ds",
              "description": "Shows the rate and total number of new series created over last 24h.\n\nHigh churn rate tightly connected with database performance and may result in unexpected OOM's or slow queries. It is recommended to always keep an eye on this metric to avoid unexpected cardinality \"explosions\".\n\nThe higher churn rate is, the more resources required to handle it. Consider to keep the churn rate as low as possible.\n\nTo investigate stats about most expensive series use `api/v1/status/tsdb` handler. More details here https://docs.victoriametrics.com/Cluster-VictoriaMetrics.html#url-format\n\nGood references to read:\n* https://www.robustperception.io/cardinality-is-key\n* https://valyala.medium.com/high-cardinality-tsdb-benchmarks-victoriametrics-vs-timescaledb-vs-influxdb-13e6ee64dd6b",
              "fieldConfig": {
                "defaults": {
                  "links": []
                },
                "overrides": []
              },
              "fill": 1,
              "fillGradient": 0,
              "gridPos": {
                "h": 8,
                "w": 12,
                "x": 0,
                "y": 4
              },
              "hiddenSeries": false,
              "id": 102,
              "legend": {
                "alignAsTable": true,
                "avg": true,
                "current": true,
                "max": true,
                "min": false,
                "show": true,
                "sort": "current",
                "sortDesc": true,
                "total": false,
                "values": true
              },
              "lines": true,
              "linewidth": 1,
              "nullPointMode": "null",
              "options": {
                "alertThreshold": true
              },
              "percentage": false,
              "pluginVersion": "8.0.0",
              "pointradius": 2,
              "points": false,
              "renderer": "flot",
              "seriesOverrides": [
                {
                  "alias": "new series over 24h",
                  "yaxis": 2
                }
              ],
              "spaceLength": 10,
              "stack": false,
              "steppedLine": false,
              "targets": [
                {
                  "exemplar": true,
                  "expr": "sum(rate(vm_new_timeseries_created_total{job=~\"$job_storage\", instance=~\"$instance\"}[5m]))",
                  "interval": "",
                  "legendFormat": "churn rate",
                  "refId": "A"
                },
                {
                  "exemplar": true,
                  "expr": "sum(increase(vm_new_timeseries_created_total{job=~\"$job_storage\", instance=~\"$instance\"}[24h]))",
                  "hide": false,
                  "interval": "",
                  "legendFormat": "new series over 24h",
                  "refId": "B"
                }
              ],
              "thresholds": [],
              "timeFrom": null,
              "timeRegions": [],
              "timeShift": null,
              "title": "Churn rate ($instance)",
              "tooltip": {
                "shared": true,
                "sort": 0,
                "value_type": "individual"
              },
              "type": "graph",
              "xaxis": {
                "buckets": null,
                "mode": "time",
                "name": null,
                "show": true,
                "values": []
              },
              "yaxes": [
                {
                  "format": "short",
                  "label": null,
                  "logBase": 1,
                  "max": null,
                  "min": "0",
                  "show": true
                },
                {
                  "format": "short",
                  "label": null,
                  "logBase": 1,
                  "max": null,
                  "min": null,
                  "show": true
                }
              ],
              "yaxis": {
                "align": false,
                "alignLevel": null
              }
            },
            {
              "aliasColors": {},
              "bars": false,
              "dashLength": 10,
              "dashes": false,
              "datasource": "$ds",
              "description": "Slow queries according to `search.logSlowQueryDuration` flag, which is `5s` by default.",
              "fieldConfig": {
                "defaults": {
                  "links": []
                },
                "overrides": []
              },
              "fill": 1,
              "fillGradient": 0,
              "gridPos": {
                "h": 8,
                "w": 12,
                "x": 12,
                "y": 4
              },
              "hiddenSeries": false,
              "id": 107,
              "legend": {
                "alignAsTable": true,
                "avg": true,
                "current": true,
                "max": true,
                "min": false,
                "show": true,
                "sort": "current",
                "sortDesc": true,
                "total": false,
                "values": true
              },
              "lines": true,
              "linewidth": 1,
              "nullPointMode": "null",
              "options": {
                "alertThreshold": true
              },
              "percentage": false,
              "pluginVersion": "8.0.0",
              "pointradius": 2,
              "points": false,
              "renderer": "flot",
              "seriesOverrides": [],
              "spaceLength": 10,
              "stack": false,
              "steppedLine": false,
              "targets": [
                {
                  "expr": "sum(rate(vm_slow_queries_total{job=\"$job_select\", instance=~\"$instance\"}[5m]))",
                  "interval": "",
                  "legendFormat": "slow queries rate",
                  "refId": "A"
                }
              ],
              "thresholds": [],
              "timeFrom": null,
              "timeRegions": [],
              "timeShift": null,
              "title": "Slow queries rate ($instance)",
              "tooltip": {
                "shared": true,
                "sort": 0,
                "value_type": "individual"
              },
              "type": "graph",
              "xaxis": {
                "buckets": null,
                "mode": "time",
                "name": null,
                "show": true,
                "values": []
              },
              "yaxes": [
                {
                  "$$hashKey": "object:892",
                  "format": "short",
                  "label": null,
                  "logBase": 1,
                  "max": null,
                  "min": "0",
                  "show": true
                },
                {
                  "$$hashKey": "object:893",
                  "format": "short",
                  "label": null,
                  "logBase": 1,
                  "max": null,
                  "min": null,
                  "show": true
                }
              ],
              "yaxis": {
                "align": false,
                "alignLevel": null
              }
            },
            {
              "aliasColors": {},
              "bars": false,
              "dashLength": 10,
              "dashes": false,
              "datasource": "$ds",
              "description": "The percentage of slow inserts comparing to total insertion rate during the last 5 minutes. \n\nThe less value is better. If percentage remains high (>50%) during extended periods of time, then it is likely more RAM is needed for optimal handling of the current number of active time series. \n\nIn general, VictoriaMetrics requires ~1KB or RAM per active time series, so it should be easy calculating the required amounts of RAM for the current workload according to capacity planning docs. But the resulting number may be far from the real number because the required amounts of memory depends on may other factors such as the number of labels per time series and the length of label values.",
              "fieldConfig": {
                "defaults": {
                  "links": []
                },
                "overrides": []
              },
              "fill": 1,
              "fillGradient": 0,
              "gridPos": {
                "h": 8,
                "w": 12,
                "x": 0,
                "y": 12
              },
              "hiddenSeries": false,
              "id": 108,
              "legend": {
                "alignAsTable": true,
                "avg": true,
                "current": true,
                "max": true,
                "min": false,
                "show": true,
                "sort": "current",
                "sortDesc": true,
                "total": false,
                "values": true
              },
              "lines": true,
              "linewidth": 1,
              "nullPointMode": "null",
              "options": {
                "alertThreshold": true
              },
              "percentage": false,
              "pluginVersion": "8.0.0",
              "pointradius": 2,
              "points": false,
              "renderer": "flot",
              "seriesOverrides": [],
              "spaceLength": 10,
              "stack": false,
              "steppedLine": false,
              "targets": [
                {
                  "expr": "sum(rate(vm_slow_row_inserts_total{job=\"$job_storage\"}[5m])) / sum(rate(vm_rows_inserted_total{job=\"$job_insert\"}[5m]))",
                  "interval": "",
                  "legendFormat": "slow inserts",
                  "refId": "A"
                }
              ],
              "thresholds": [],
              "timeFrom": null,
              "timeRegions": [],
              "timeShift": null,
              "title": "Slow inserts",
              "tooltip": {
                "shared": true,
                "sort": 0,
                "value_type": "individual"
              },
              "type": "graph",
              "xaxis": {
                "buckets": null,
                "mode": "time",
                "name": null,
                "show": true,
                "values": []
              },
              "yaxes": [
                {
                  "format": "percentunit",
                  "label": null,
                  "logBase": 1,
                  "max": null,
                  "min": "0",
                  "show": true
                },
                {
                  "format": "short",
                  "label": null,
                  "logBase": 1,
                  "max": null,
                  "min": null,
                  "show": true
                }
              ],
              "yaxis": {
                "align": false,
                "alignLevel": null
              }
            },
            {
              "aliasColors": {},
              "bars": false,
              "dashLength": 10,
              "dashes": false,
              "datasource": "$ds",
              "description": "VictoriaMetrics limits the number of labels per each metric with `-maxLabelsPerTimeseries` command-line flag.\n\nThis prevents from ingesting metrics with too many labels. The value of `maxLabelsPerTimeseries` must be adjusted for your workload.\n\nWhen limit is exceeded (graph is > 0) - extra labels are dropped, which could result in unexpected identical time series.",
              "fieldConfig": {
                "defaults": {
                  "links": []
                },
                "overrides": []
              },
              "fill": 1,
              "fillGradient": 0,
              "gridPos": {
                "h": 8,
                "w": 12,
                "x": 12,
                "y": 12
              },
              "hiddenSeries": false,
              "id": 116,
              "legend": {
                "alignAsTable": true,
                "avg": true,
                "current": true,
                "max": true,
                "min": false,
                "show": true,
                "sort": "current",
                "sortDesc": true,
                "total": false,
                "values": true
              },
              "lines": true,
              "linewidth": 1,
              "links": [],
              "nullPointMode": "null",
              "options": {
                "alertThreshold": true
              },
              "percentage": false,
              "pluginVersion": "8.0.0",
              "pointradius": 2,
              "points": false,
              "renderer": "flot",
              "seriesOverrides": [],
              "spaceLength": 10,
              "stack": false,
              "steppedLine": false,
              "targets": [
                {
                  "exemplar": true,
                  "expr": "sum(increase(vm_metrics_with_dropped_labels_total{job=\"$job_insert\", instance=~\"$instance\"}[5m]))",
                  "format": "time_series",
                  "hide": false,
                  "interval": "",
                  "intervalFactor": 1,
                  "legendFormat": "metrics with dropped labels",
                  "refId": "A"
                }
              ],
              "thresholds": [],
              "timeFrom": null,
              "timeRegions": [],
              "timeShift": null,
              "title": "Labels limit exceeded ($instance)",
              "tooltip": {
                "shared": true,
                "sort": 0,
                "value_type": "individual"
              },
              "type": "graph",
              "xaxis": {
                "buckets": null,
                "mode": "time",
                "name": null,
                "show": true,
                "values": []
              },
              "yaxes": [
                {
                  "$$hashKey": "object:1046",
                  "decimals": 2,
                  "format": "short",
                  "label": null,
                  "logBase": 1,
                  "max": null,
                  "min": "0",
                  "show": true
                },
                {
                  "$$hashKey": "object:1047",
                  "format": "short",
                  "label": null,
                  "logBase": 1,
                  "max": null,
                  "min": "0",
                  "show": true
                }
              ],
              "yaxis": {
                "align": false,
                "alignLevel": null
              }
            }
          ],
          "title": "Troubleshooting",
          "type": "row"
        },
        {
          "collapsed": true,
          "datasource": "$ds",
          "gridPos": {
            "h": 1,
            "w": 24,
            "x": 0,
            "y": 36
          },
          "id": 48,
          "panels": [
            {
              "aliasColors": {},
              "bars": false,
              "dashLength": 10,
              "dashes": false,
              "datasource": "$ds",
              "description": "Shows number of pushed and sent rows. \n* `Pushed rows` - rows added to internal inserter buffers before send\n* `Sent rows` - successfully transmitted rows to storage nodes",
              "fieldConfig": {
                "defaults": {
                  "links": []
                },
                "overrides": []
              },
              "fill": 1,
              "fillGradient": 0,
              "gridPos": {
                "h": 9,
                "w": 12,
                "x": 0,
                "y": 5
              },
              "hiddenSeries": false,
              "id": 76,
              "legend": {
                "alignAsTable": true,
                "avg": true,
                "current": true,
                "max": true,
                "min": false,
                "show": true,
                "sort": "current",
                "sortDesc": true,
                "total": false,
                "values": true
              },
              "lines": true,
              "linewidth": 1,
              "links": [],
              "nullPointMode": "null",
              "options": {
                "alertThreshold": true
              },
              "percentage": false,
              "pluginVersion": "8.0.0",
              "pointradius": 1,
              "points": false,
              "renderer": "flot",
              "seriesOverrides": [],
              "spaceLength": 10,
              "stack": false,
              "steppedLine": false,
              "targets": [
                {
                  "expr": "sum(rate(vm_rpc_rows_pushed_total{job=~\"$job\",instance=~\"$instance\"}[2m]))",
                  "format": "time_series",
                  "intervalFactor": 1,
                  "legendFormat": "Pushed",
                  "refId": "B"
                },
                {
                  "expr": "sum(rate(vm_rpc_rows_sent_total{job=~\"$job\",instance=~\"$instance\"}[2m]))",
                  "format": "time_series",
                  "intervalFactor": 1,
                  "legendFormat": "Sent",
                  "refId": "E"
                }
              ],
              "thresholds": [],
              "timeFrom": null,
              "timeRegions": [],
              "timeShift": null,
              "title": "Rows ($instance)",
              "tooltip": {
                "shared": true,
                "sort": 0,
                "value_type": "individual"
              },
              "type": "graph",
              "xaxis": {
                "buckets": null,
                "mode": "time",
                "name": null,
                "show": true,
                "values": []
              },
              "yaxes": [
                {
                  "$$hashKey": "object:1108",
                  "format": "short",
                  "label": null,
                  "logBase": 1,
                  "max": null,
                  "min": "0",
                  "show": true
                },
                {
                  "$$hashKey": "object:1109",
                  "format": "short",
                  "label": null,
                  "logBase": 1,
                  "max": null,
                  "min": null,
                  "show": true
                }
              ],
              "yaxis": {
                "align": false,
                "alignLevel": null
              }
            },
            {
              "aliasColors": {},
              "bars": false,
              "dashLength": 10,
              "dashes": false,
              "datasource": "$ds",
              "description": "Rate of RPC errors by type:\n* `Connection` - the number of connection errors to vmstorage node\n* `Dial` -  the number of dial errors to vmstorage node.\n* `Handshake` - the number of handshake errors to vmstorage node\n* `Rerouted` - errors appeared during rerouting of rows from un-healthy storage node to a healthy one.",
              "fieldConfig": {
                "defaults": {
                  "links": []
                },
                "overrides": []
              },
              "fill": 1,
              "fillGradient": 0,
              "gridPos": {
                "h": 9,
                "w": 12,
                "x": 12,
                "y": 5
              },
              "hiddenSeries": false,
              "id": 86,
              "legend": {
                "alignAsTable": true,
                "avg": true,
                "current": true,
                "max": true,
                "min": false,
                "show": true,
                "sort": "current",
                "sortDesc": true,
                "total": false,
                "values": true
              },
              "lines": true,
              "linewidth": 1,
              "links": [],
              "nullPointMode": "null",
              "options": {
                "alertThreshold": true
              },
              "percentage": false,
              "pluginVersion": "8.0.0",
              "pointradius": 1,
              "points": false,
              "renderer": "flot",
              "seriesOverrides": [],
              "spaceLength": 10,
              "stack": false,
              "steppedLine": false,
              "targets": [
                {
                  "expr": "sum(rate(vm_rpc_connection_errors_total{job=~\"$job\",instance=~\"$instance\"}[5m]))",
                  "format": "time_series",
                  "intervalFactor": 1,
                  "legendFormat": "Connection",
                  "refId": "A"
                },
                {
                  "expr": "sum(rate(vm_rpc_dial_errors_total{job=~\"$job\",instance=~\"$instance\"}[5m]))",
                  "format": "time_series",
                  "intervalFactor": 1,
                  "legendFormat": "Dial",
                  "refId": "B"
                },
                {
                  "expr": "sum(rate(vm_rpc_handshake_errors_total{job=~\"$job\",instance=~\"$instance\"}[5m]))",
                  "format": "time_series",
                  "intervalFactor": 1,
                  "legendFormat": "Handshake",
                  "refId": "E"
                }
              ],
              "thresholds": [],
              "timeFrom": null,
              "timeRegions": [],
              "timeShift": null,
              "title": "RPC errors ($instance)",
              "tooltip": {
                "shared": true,
                "sort": 0,
                "value_type": "individual"
              },
              "type": "graph",
              "xaxis": {
                "buckets": null,
                "mode": "time",
                "name": null,
                "show": true,
                "values": []
              },
              "yaxes": [
                {
                  "format": "short",
                  "label": null,
                  "logBase": 1,
                  "max": null,
                  "min": "0",
                  "show": true
                },
                {
                  "format": "short",
                  "label": null,
                  "logBase": 1,
                  "max": null,
                  "min": null,
                  "show": true
                }
              ],
              "yaxis": {
                "align": false,
                "alignLevel": null
              }
            },
            {
              "aliasColors": {},
              "bars": false,
              "dashLength": 10,
              "dashes": false,
              "datasource": "$ds",
              "description": "The number of rows rerouted to the vmstorage node from other nodes when they were unhealthy.",
              "fieldConfig": {
                "defaults": {
                  "links": []
                },
                "overrides": []
              },
              "fill": 1,
              "fillGradient": 0,
              "gridPos": {
                "h": 8,
                "w": 12,
                "x": 0,
                "y": 14
              },
              "hiddenSeries": false,
              "id": 80,
              "legend": {
                "alignAsTable": true,
                "avg": true,
                "current": true,
                "max": true,
                "min": false,
                "show": true,
                "sort": "current",
                "sortDesc": true,
                "total": false,
                "values": true
              },
              "lines": true,
              "linewidth": 1,
              "links": [],
              "nullPointMode": "null",
              "options": {
                "alertThreshold": true
              },
              "percentage": false,
              "pluginVersion": "8.0.0",
              "pointradius": 1,
              "points": false,
              "renderer": "flot",
              "seriesOverrides": [],
              "spaceLength": 10,
              "stack": false,
              "steppedLine": false,
              "targets": [
                {
                  "exemplar": true,
                  "expr": "sum(rate(vm_rpc_rows_rerouted_to_here_total{job=~\"$job\", instance=~\"$instance\"}[5m])) by(addr)",
                  "format": "time_series",
                  "interval": "",
                  "intervalFactor": 1,
                  "legendFormat": "{{addr}}",
                  "refId": "A"
                }
              ],
              "thresholds": [],
              "timeFrom": null,
              "timeRegions": [],
              "timeShift": null,
              "title": "Rows ($instance) rerouted to ",
              "tooltip": {
                "shared": true,
                "sort": 0,
                "value_type": "individual"
              },
              "type": "graph",
              "xaxis": {
                "buckets": null,
                "mode": "time",
                "name": null,
                "show": true,
                "values": []
              },
              "yaxes": [
                {
                  "format": "rps",
                  "label": null,
                  "logBase": 1,
                  "max": null,
                  "min": "0",
                  "show": true
                },
                {
                  "format": "short",
                  "label": null,
                  "logBase": 1,
                  "max": null,
                  "min": null,
                  "show": true
                }
              ],
              "yaxis": {
                "align": false,
                "alignLevel": null
              }
            },
            {
              "aliasColors": {},
              "bars": false,
              "dashLength": 10,
              "dashes": false,
              "datasource": "$ds",
              "description": "The number of rows rerouted from the vmstorage node to healthy nodes when the given node was unhealthy.",
              "fieldConfig": {
                "defaults": {
                  "links": []
                },
                "overrides": []
              },
              "fill": 1,
              "fillGradient": 0,
              "gridPos": {
                "h": 8,
                "w": 12,
                "x": 12,
                "y": 14
              },
              "hiddenSeries": false,
              "id": 78,
              "legend": {
                "alignAsTable": true,
                "avg": true,
                "current": true,
                "max": true,
                "min": false,
                "show": true,
                "sort": "current",
                "sortDesc": true,
                "total": false,
                "values": true
              },
              "lines": true,
              "linewidth": 1,
              "links": [],
              "nullPointMode": "null",
              "options": {
                "alertThreshold": true
              },
              "percentage": false,
              "pluginVersion": "8.0.0",
              "pointradius": 1,
              "points": false,
              "renderer": "flot",
              "seriesOverrides": [],
              "spaceLength": 10,
              "stack": false,
              "steppedLine": false,
              "targets": [
                {
                  "exemplar": true,
                  "expr": "sum(rate(vm_rpc_rows_rerouted_from_here_total{job=~\"$job\", instance=~\"$instance\"}[5m])) by(addr)",
                  "format": "time_series",
                  "interval": "",
                  "intervalFactor": 1,
                  "legendFormat": "{{addr}}",
                  "refId": "A"
                }
              ],
              "thresholds": [],
              "timeFrom": null,
              "timeRegions": [],
              "timeShift": null,
              "title": "Rows ($instance) rerouted from",
              "tooltip": {
                "shared": true,
                "sort": 0,
                "value_type": "individual"
              },
              "type": "graph",
              "xaxis": {
                "buckets": null,
                "mode": "time",
                "name": null,
                "show": true,
                "values": []
              },
              "yaxes": [
                {
                  "format": "rps",
                  "label": null,
                  "logBase": 1,
                  "max": null,
                  "min": "0",
                  "show": true
                },
                {
                  "format": "short",
                  "label": null,
                  "logBase": 1,
                  "max": null,
                  "min": "0",
                  "show": true
                }
              ],
              "yaxis": {
                "align": false,
                "alignLevel": null
              }
            },
            {
              "aliasColors": {},
              "bars": false,
              "dashLength": 10,
              "dashes": false,
              "datasource": "$ds",
              "description": "The number of rows or bytes that vminesrt internal buffer contains at the moment.",
              "fieldConfig": {
                "defaults": {
                  "links": []
                },
                "overrides": []
              },
              "fill": 1,
              "fillGradient": 0,
              "gridPos": {
                "h": 8,
                "w": 12,
                "x": 0,
                "y": 22
              },
              "hiddenSeries": false,
              "id": 82,
              "legend": {
                "alignAsTable": true,
                "avg": true,
                "current": true,
                "max": true,
                "min": false,
                "show": true,
                "sort": "current",
                "sortDesc": true,
                "total": false,
                "values": true
              },
              "lines": true,
              "linewidth": 1,
              "nullPointMode": "null",
              "options": {
                "alertThreshold": true
              },
              "percentage": false,
              "pluginVersion": "8.0.0",
              "pointradius": 2,
              "points": false,
              "renderer": "flot",
              "seriesOverrides": [
                {
                  "alias": "bytes",
                  "yaxis": 2
                }
              ],
              "spaceLength": 10,
              "stack": false,
              "steppedLine": false,
              "targets": [
                {
                  "expr": "sum(vm_rpc_buf_pending_bytes{job=~\"$job\", instance=~\"$instance\"})",
                  "legendFormat": "bytes",
                  "refId": "A"
                },
                {
                  "expr": "sum(vm_rpc_rows_pending{job=~\"$job\", instance=~\"$instance\"})",
                  "legendFormat": "rows",
                  "refId": "B"
                }
              ],
              "thresholds": [],
              "timeFrom": null,
              "timeRegions": [],
              "timeShift": null,
              "title": "Pending",
              "tooltip": {
                "shared": true,
                "sort": 0,
                "value_type": "individual"
              },
              "type": "graph",
              "xaxis": {
                "buckets": null,
                "mode": "time",
                "name": null,
                "show": true,
                "values": []
              },
              "yaxes": [
                {
                  "format": "short",
                  "label": null,
                  "logBase": 1,
                  "max": null,
                  "min": "0",
                  "show": true
                },
                {
                  "format": "bytes",
                  "label": null,
                  "logBase": 1,
                  "max": null,
                  "min": "0",
                  "show": true
                }
              ],
              "yaxis": {
                "align": false,
                "alignLevel": null
              }
            },
            {
              "aliasColors": {},
              "bars": false,
              "dashLength": 10,
              "dashes": false,
              "datasource": "$ds",
              "description": "Network usage by internal VictoriaMetrics RPC protocol",
              "fieldConfig": {
                "defaults": {
                  "links": []
                },
                "overrides": []
              },
              "fill": 1,
              "fillGradient": 0,
              "gridPos": {
                "h": 8,
                "w": 12,
                "x": 12,
                "y": 22
              },
              "hiddenSeries": false,
              "id": 74,
              "legend": {
                "alignAsTable": true,
                "avg": true,
                "current": true,
                "max": true,
                "min": false,
                "show": true,
                "sort": "current",
                "sortDesc": true,
                "total": false,
                "values": true
              },
              "lines": true,
              "linewidth": 1,
              "nullPointMode": "null",
              "options": {
                "alertThreshold": true
              },
              "percentage": false,
              "pluginVersion": "8.0.0",
              "pointradius": 2,
              "points": false,
              "renderer": "flot",
              "seriesOverrides": [],
              "spaceLength": 10,
              "stack": false,
              "steppedLine": false,
              "targets": [
                {
                  "expr": "sum(rate(vm_tcpdialer_written_bytes_total{job=~\"$job\", instance=~\"$instance\"}[5m])) * 8",
                  "legendFormat": "network usage",
                  "refId": "A"
                }
              ],
              "thresholds": [],
              "timeFrom": null,
              "timeRegions": [],
              "timeShift": null,
              "title": "RPC network usage ($instance)",
              "tooltip": {
                "shared": true,
                "sort": 0,
                "value_type": "individual"
              },
              "type": "graph",
              "xaxis": {
                "buckets": null,
                "mode": "time",
                "name": null,
                "show": true,
                "values": []
              },
              "yaxes": [
                {
                  "format": "bps",
                  "label": null,
                  "logBase": 1,
                  "max": null,
                  "min": "0",
                  "show": true
                },
                {
                  "format": "short",
                  "label": null,
                  "logBase": 1,
                  "max": null,
                  "min": null,
                  "show": true
                }
              ],
              "yaxis": {
                "align": false,
                "alignLevel": null
              }
            }
          ],
          "title": "Interconnection ($job)",
          "type": "row"
        },
        {
          "collapsed": true,
          "datasource": "$ds",
          "gridPos": {
            "h": 1,
            "w": 24,
            "x": 0,
            "y": 37
          },
          "id": 60,
          "panels": [
            {
              "aliasColors": {},
              "bars": false,
              "dashLength": 10,
              "dashes": false,
              "datasource": "$ds",
              "description": "VictoriaMetrics stores various caches in RAM. Memory size for these caches may be limited with -`memory.allowedPercent` flag. Line `max allowed` shows max allowed memory size for cache.",
              "fieldConfig": {
                "defaults": {
                  "links": []
                },
                "overrides": []
              },
              "fill": 1,
              "fillGradient": 0,
              "gridPos": {
                "h": 8,
                "w": 24,
                "x": 0,
                "y": 6
              },
              "hiddenSeries": false,
              "id": 57,
              "legend": {
                "alignAsTable": true,
                "avg": true,
                "current": true,
                "max": false,
                "min": false,
                "rightSide": true,
                "show": true,
                "sort": "current",
                "sortDesc": true,
                "total": false,
                "values": true
              },
              "lines": true,
              "linewidth": 1,
              "links": [],
              "nullPointMode": "null",
              "options": {
                "alertThreshold": true
              },
              "percentage": false,
              "pluginVersion": "8.0.0",
              "pointradius": 2,
              "points": false,
              "renderer": "flot",
              "seriesOverrides": [
                {
                  "alias": "max allowed",
                  "color": "#C4162A",
                  "fill": 0,
                  "stack": false
                }
              ],
              "spaceLength": 10,
              "stack": true,
              "steppedLine": false,
              "targets": [
                {
                  "expr": "sum(vm_cache_size_bytes{job=~\"$job\", instance=~\"$instance\"}) by(type)",
                  "format": "time_series",
                  "hide": false,
                  "intervalFactor": 1,
                  "legendFormat": "{{type}}",
                  "refId": "A"
                },
                {
                  "expr": "sum(vm_allowed_memory_bytes{job=~\"$job\", instance=~\"$instance\"})",
                  "format": "time_series",
                  "hide": false,
                  "intervalFactor": 1,
                  "legendFormat": "max allowed",
                  "refId": "B"
                }
              ],
              "thresholds": [],
              "timeFrom": null,
              "timeRegions": [],
              "timeShift": null,
              "title": "Cache size ($instance)",
              "tooltip": {
                "shared": true,
                "sort": 2,
                "value_type": "individual"
              },
              "type": "graph",
              "xaxis": {
                "buckets": null,
                "mode": "time",
                "name": null,
                "show": true,
                "values": []
              },
              "yaxes": [
                {
                  "format": "bytes",
                  "label": null,
                  "logBase": 1,
                  "max": null,
                  "min": "0",
                  "show": true
                },
                {
                  "format": "short",
                  "label": null,
                  "logBase": 1,
                  "max": null,
                  "min": "0",
                  "show": true
                }
              ],
              "yaxis": {
                "align": false,
                "alignLevel": null
              }
            },
            {
              "aliasColors": {},
              "bars": false,
              "dashLength": 10,
              "dashes": false,
              "datasource": "$ds",
              "description": "VictoriaMetrics stores various caches in RAM. Memory size for these caches may be limited with -`memory.allowedPercent` flag. Line `max allowed` shows max allowed memory size for cache.",
              "fieldConfig": {
                "defaults": {
                  "links": []
                },
                "overrides": []
              },
              "fill": 0,
              "fillGradient": 0,
              "gridPos": {
                "h": 8,
                "w": 24,
                "x": 0,
                "y": 14
              },
              "hiddenSeries": false,
              "id": 58,
              "legend": {
                "alignAsTable": true,
                "avg": true,
                "current": true,
                "max": true,
                "min": false,
                "rightSide": true,
                "show": true,
                "sort": "current",
                "sortDesc": true,
                "total": false,
                "values": true
              },
              "lines": true,
              "linewidth": 1,
              "links": [],
              "nullPointMode": "null",
              "options": {
                "alertThreshold": true
              },
              "percentage": false,
              "pluginVersion": "8.0.0",
              "pointradius": 2,
              "points": false,
              "renderer": "flot",
              "seriesOverrides": [],
              "spaceLength": 10,
              "stack": false,
              "steppedLine": false,
              "targets": [
                {
                  "exemplar": true,
                  "expr": "1 - (\n sum(rate(vm_cache_misses_total{job=~\"$job\", instance=~\"$instance\"}[5m])) by (type) /\n sum(rate(vm_cache_requests_total{job=~\"$job\", instance=~\"$instance\"}[5m])) by (type)\n)",
                  "format": "time_series",
                  "hide": false,
                  "interval": "",
                  "intervalFactor": 1,
                  "legendFormat": "{{type}}",
                  "refId": "A"
                }
              ],
              "thresholds": [],
              "timeFrom": null,
              "timeRegions": [],
              "timeShift": null,
              "title": "Cache hit ratio ($instance)",
              "tooltip": {
                "shared": true,
                "sort": 2,
                "value_type": "individual"
              },
              "type": "graph",
              "xaxis": {
                "buckets": null,
                "mode": "time",
                "name": null,
                "show": true,
                "values": []
              },
              "yaxes": [
                {
                  "format": "percentunit",
                  "label": null,
                  "logBase": 1,
                  "max": "1",
                  "min": "0",
                  "show": true
                },
                {
                  "format": "short",
                  "label": null,
                  "logBase": 1,
                  "max": null,
                  "min": "0",
                  "show": true
                }
              ],
              "yaxis": {
                "align": false,
                "alignLevel": null
              }
            }
          ],
          "title": "Caches ($job)",
          "type": "row"
        },
        {
          "collapsed": true,
          "datasource": "$ds",
          "gridPos": {
            "h": 1,
            "w": 24,
            "x": 0,
            "y": 38
          },
          "id": 24,
          "panels": [
            {
              "aliasColors": {},
              "bars": false,
              "dashLength": 10,
              "dashes": false,
              "datasource": "$ds",
              "description": "Shows how many rows per second every storage node accepts. This metric doesn't show all stored rows since some of them may be dropped because of wrong timestamps or decode errors.",
              "fieldConfig": {
                "defaults": {
                  "links": []
                },
                "overrides": []
              },
              "fill": 1,
              "fillGradient": 0,
              "gridPos": {
                "h": 8,
                "w": 12,
                "x": 0,
                "y": 39
              },
              "hiddenSeries": false,
              "id": 100,
              "legend": {
                "alignAsTable": true,
                "avg": true,
                "current": true,
                "max": true,
                "min": false,
                "show": true,
                "sort": "current",
                "sortDesc": true,
                "total": false,
                "values": true
              },
              "lines": true,
              "linewidth": 1,
              "links": [],
              "nullPointMode": "null",
              "options": {
                "alertThreshold": true
              },
              "percentage": false,
              "pluginVersion": "8.0.0",
              "pointradius": 2,
              "points": false,
              "renderer": "flot",
              "seriesOverrides": [],
              "spaceLength": 10,
              "stack": true,
              "steppedLine": false,
              "targets": [
                {
                  "expr": "sum(rate(vm_vminsert_metrics_read_total{job=\"$job_storage\", instance=~\"$instance\"}[5m])) by(instance)",
                  "format": "time_series",
                  "intervalFactor": 1,
                  "legendFormat": "{{instance}}",
                  "refId": "A"
                }
              ],
              "thresholds": [],
              "timeFrom": null,
              "timeRegions": [],
              "timeShift": null,
              "title": "Ingestion rate ($instance)",
              "tooltip": {
                "shared": true,
                "sort": 2,
                "value_type": "individual"
              },
              "type": "graph",
              "xaxis": {
                "buckets": null,
                "mode": "time",
                "name": null,
                "show": true,
                "values": []
              },
              "yaxes": [
                {
                  "format": "short",
                  "label": null,
                  "logBase": 1,
                  "max": null,
                  "min": "0",
                  "show": true
                },
                {
                  "format": "short",
                  "label": null,
                  "logBase": 1,
                  "max": null,
                  "min": "0",
                  "show": true
                }
              ],
              "yaxis": {
                "align": false,
                "alignLevel": null
              }
            },
            {
              "aliasColors": {},
              "bars": false,
              "dashLength": 10,
              "dashes": false,
              "datasource": "$ds",
              "description": "Shows the time needed to reach the 100% of disk capacity based on the following params:\n* free disk space;\n* row ingestion rate;\n* dedup rate;\n* compression.\n\nUse this panel for capacity planning in order to estimate the time remaining for running out of the disk space.",
              "fieldConfig": {
                "defaults": {
                  "links": []
                },
                "overrides": []
              },
              "fill": 1,
              "fillGradient": 0,
              "gridPos": {
                "h": 8,
                "w": 12,
                "x": 12,
                "y": 39
              },
              "hiddenSeries": false,
              "id": 113,
              "legend": {
                "alignAsTable": true,
                "avg": true,
                "current": true,
                "max": false,
                "min": true,
                "show": true,
                "sort": "current",
                "sortDesc": true,
                "total": false,
                "values": true
              },
              "lines": true,
              "linewidth": 1,
              "links": [],
              "nullPointMode": "null",
              "options": {
                "alertThreshold": true
              },
              "percentage": false,
              "pluginVersion": "8.0.0",
              "pointradius": 2,
              "points": false,
              "renderer": "flot",
              "seriesOverrides": [],
              "spaceLength": 10,
              "stack": false,
              "steppedLine": false,
              "targets": [
                {
                  "expr": "vm_free_disk_space_bytes{job=\"$job_storage\", instance=~\"$instance\"} / ignoring(path) ((rate(vm_rows_added_to_storage_total{job=\"$job_storage\", instance=~\"$instance\"}[1d]) - ignoring(type) rate(vm_deduplicated_samples_total{job=\"$job_storage\", instance=~\"$instance\", type=\"merge\"}[1d])) * scalar(sum(vm_data_size_bytes{job=\"$job_storage\", instance=~\"$instance\", type!=\"indexdb\"}) / sum(vm_rows{job=\"$job_storage\", instance=~\"$instance\", type!=\"indexdb\"})))",
                  "format": "time_series",
                  "interval": "",
                  "intervalFactor": 1,
                  "legendFormat": "{{instance}}",
                  "refId": "A"
                }
              ],
              "thresholds": [],
              "timeFrom": null,
              "timeRegions": [],
              "timeShift": null,
              "title": "Storage full ETA ($instance)",
              "tooltip": {
                "shared": true,
                "sort": 0,
                "value_type": "individual"
              },
              "type": "graph",
              "xaxis": {
                "buckets": null,
                "mode": "time",
                "name": null,
                "show": true,
                "values": []
              },
              "yaxes": [
                {
                  "format": "s",
                  "label": null,
                  "logBase": 1,
                  "max": null,
                  "min": "0",
                  "show": true
                },
                {
                  "format": "short",
                  "label": null,
                  "logBase": 1,
                  "max": null,
                  "min": null,
                  "show": true
                }
              ],
              "yaxis": {
                "align": false,
                "alignLevel": null
              }
            },
            {
              "aliasColors": {},
              "bars": false,
              "dashLength": 10,
              "dashes": false,
              "datasource": "$ds",
              "description": "Shows how many datapoints are in the storage.",
              "fieldConfig": {
                "defaults": {
                  "links": []
                },
                "overrides": []
              },
              "fill": 1,
              "fillGradient": 0,
              "gridPos": {
                "h": 8,
                "w": 12,
                "x": 0,
                "y": 47
              },
              "hiddenSeries": false,
              "id": 16,
              "legend": {
                "alignAsTable": true,
                "avg": true,
                "current": true,
                "max": true,
                "min": false,
                "show": true,
                "sort": "current",
                "sortDesc": true,
                "total": false,
                "values": true
              },
              "lines": true,
              "linewidth": 1,
              "links": [],
              "nullPointMode": "null",
              "options": {
                "alertThreshold": true
              },
              "percentage": false,
              "pluginVersion": "8.0.0",
              "pointradius": 2,
              "points": false,
              "renderer": "flot",
              "seriesOverrides": [],
              "spaceLength": 10,
              "stack": true,
              "steppedLine": false,
              "targets": [
                {
                  "expr": "sum(vm_rows{job=\"$job_storage\", instance=~\"$instance\", type!=\"indexdb\"}) by(instance)",
                  "format": "time_series",
                  "interval": "",
                  "intervalFactor": 1,
                  "legendFormat": "{{instance}}",
                  "refId": "A"
                }
              ],
              "thresholds": [],
              "timeFrom": null,
              "timeRegions": [],
              "timeShift": null,
              "title": "Datapoints ($instance)",
              "tooltip": {
                "shared": true,
                "sort": 2,
                "value_type": "individual"
              },
              "type": "graph",
              "xaxis": {
                "buckets": null,
                "mode": "time",
                "name": null,
                "show": true,
                "values": []
              },
              "yaxes": [
                {
                  "format": "short",
                  "label": null,
                  "logBase": 1,
                  "max": null,
                  "min": "0",
                  "show": true
                },
                {
                  "decimals": null,
                  "format": "short",
                  "label": null,
                  "logBase": 1,
                  "max": null,
                  "min": "0",
                  "show": true
                }
              ],
              "yaxis": {
                "align": false,
                "alignLevel": null
              }
            },
            {
              "aliasColors": {},
              "bars": false,
              "dashLength": 10,
              "dashes": false,
              "datasource": "$ds",
              "description": "How many datapoints are in RAM queue waiting to be written into storage. The number of pending data points should be in the range from 0 to `2*<ingestion_rate>`, since VictoriaMetrics pushes pending data to persistent storage every second. The index datapoints value in general is much lower.",
              "fieldConfig": {
                "defaults": {
                  "links": []
                },
                "overrides": []
              },
              "fill": 1,
              "fillGradient": 0,
              "gridPos": {
                "h": 8,
                "w": 12,
                "x": 12,
                "y": 47
              },
              "hiddenSeries": false,
              "id": 14,
              "legend": {
                "alignAsTable": true,
                "avg": true,
                "current": true,
                "max": true,
                "min": false,
                "rightSide": false,
                "show": true,
                "sort": "current",
                "sortDesc": true,
                "total": false,
                "values": true
              },
              "lines": true,
              "linewidth": 1,
              "links": [],
              "nullPointMode": "null",
              "options": {
                "alertThreshold": true
              },
              "percentage": false,
              "pluginVersion": "8.0.0",
              "pointradius": 2,
              "points": false,
              "renderer": "flot",
              "seriesOverrides": [
                {
                  "alias": "pending index entries",
                  "yaxis": 2
                }
              ],
              "spaceLength": 10,
              "stack": false,
              "steppedLine": false,
              "targets": [
                {
                  "expr": "sum(vm_pending_rows{job=\"$job_storage\", instance=~\"$instance\", type=\"storage\"})",
                  "format": "time_series",
                  "hide": false,
                  "intervalFactor": 1,
                  "legendFormat": "pending datapoints",
                  "refId": "A"
                },
                {
                  "expr": "sum(vm_pending_rows{job=\"$job_storage\", instance=~\"$instance\", type=\"indexdb\"})",
                  "format": "time_series",
                  "hide": false,
                  "intervalFactor": 1,
                  "legendFormat": "pending index entries",
                  "refId": "B"
                }
              ],
              "thresholds": [],
              "timeFrom": null,
              "timeRegions": [],
              "timeShift": null,
              "title": "Pending datapoints ($instance)",
              "tooltip": {
                "shared": true,
                "sort": 0,
                "value_type": "individual"
              },
              "type": "graph",
              "xaxis": {
                "buckets": null,
                "mode": "time",
                "name": null,
                "show": true,
                "values": []
              },
              "yaxes": [
                {
                  "format": "short",
                  "label": null,
                  "logBase": 1,
                  "max": null,
                  "min": "0",
                  "show": true
                },
                {
                  "decimals": 3,
                  "format": "none",
                  "label": null,
                  "logBase": 1,
                  "max": null,
                  "min": "0",
                  "show": true
                }
              ],
              "yaxis": {
                "align": false,
                "alignLevel": null
              }
            },
            {
              "aliasColors": {},
              "bars": false,
              "dashLength": 10,
              "dashes": false,
              "datasource": "$ds",
              "description": "Shows amount of on-disk space occupied by data points.",
              "fieldConfig": {
                "defaults": {
                  "links": []
                },
                "overrides": []
              },
              "fill": 1,
              "fillGradient": 0,
              "gridPos": {
                "h": 8,
                "w": 12,
                "x": 0,
                "y": 55
              },
              "hiddenSeries": false,
              "id": 18,
              "legend": {
                "alignAsTable": true,
                "avg": true,
                "current": true,
                "max": true,
                "min": false,
                "show": true,
                "sort": "current",
                "sortDesc": true,
                "total": false,
                "values": true
              },
              "lines": true,
              "linewidth": 1,
              "links": [],
              "nullPointMode": "null",
              "options": {
                "alertThreshold": true
              },
              "percentage": false,
              "pluginVersion": "8.0.0",
              "pointradius": 2,
              "points": false,
              "renderer": "flot",
              "seriesOverrides": [],
              "spaceLength": 10,
              "stack": true,
              "steppedLine": false,
              "targets": [
                {
                  "expr": "sum(vm_data_size_bytes{job=\"$job_storage\", instance=~\"$instance\", type!=\"indexdb\"}) by(instance)",
                  "format": "time_series",
                  "intervalFactor": 1,
                  "legendFormat": "{{instance}}",
                  "refId": "A"
                }
              ],
              "thresholds": [],
              "timeFrom": null,
              "timeRegions": [],
              "timeShift": null,
              "title": "Disk space usage (datapoints) ($instance)",
              "tooltip": {
                "shared": true,
                "sort": 0,
                "value_type": "individual"
              },
              "type": "graph",
              "xaxis": {
                "buckets": null,
                "mode": "time",
                "name": null,
                "show": true,
                "values": []
              },
              "yaxes": [
                {
                  "format": "bytes",
                  "label": null,
                  "logBase": 1,
                  "max": null,
                  "min": "0",
                  "show": true
                },
                {
                  "format": "short",
                  "label": null,
                  "logBase": 1,
                  "max": null,
                  "min": "0",
                  "show": true
                }
              ],
              "yaxis": {
                "align": false,
                "alignLevel": null
              }
            },
            {
              "aliasColors": {},
              "bars": false,
              "dashLength": 10,
              "dashes": false,
              "datasource": "$ds",
              "description": "Shows amount of on-disk space occupied by inverted index.",
              "fieldConfig": {
                "defaults": {
                  "links": []
                },
                "overrides": []
              },
              "fill": 1,
              "fillGradient": 0,
              "gridPos": {
                "h": 8,
                "w": 12,
                "x": 12,
                "y": 55
              },
              "hiddenSeries": false,
              "id": 20,
              "legend": {
                "alignAsTable": true,
                "avg": true,
                "current": true,
                "max": true,
                "min": false,
                "show": true,
                "sort": "current",
                "sortDesc": true,
                "total": false,
                "values": true
              },
              "lines": true,
              "linewidth": 1,
              "links": [],
              "nullPointMode": "null",
              "options": {
                "alertThreshold": true
              },
              "percentage": false,
              "pluginVersion": "8.0.0",
              "pointradius": 2,
              "points": false,
              "renderer": "flot",
              "seriesOverrides": [],
              "spaceLength": 10,
              "stack": true,
              "steppedLine": false,
              "targets": [
                {
                  "expr": "sum(vm_data_size_bytes{job=\"$job_storage\", instance=~\"$instance\", type=\"indexdb\"}) by(instance)",
                  "format": "time_series",
                  "intervalFactor": 1,
                  "legendFormat": "{{instance}}",
                  "refId": "A"
                }
              ],
              "thresholds": [],
              "timeFrom": null,
              "timeRegions": [],
              "timeShift": null,
              "title": "Disk space usage (index)  ($instance)",
              "tooltip": {
                "shared": true,
                "sort": 0,
                "value_type": "individual"
              },
              "type": "graph",
              "xaxis": {
                "buckets": null,
                "mode": "time",
                "name": null,
                "show": true,
                "values": []
              },
              "yaxes": [
                {
                  "format": "bytes",
                  "label": null,
                  "logBase": 1,
                  "max": null,
                  "min": "0",
                  "show": true
                },
                {
                  "format": "short",
                  "label": null,
                  "logBase": 1,
                  "max": null,
                  "min": "0",
                  "show": true
                }
              ],
              "yaxis": {
                "align": false,
                "alignLevel": null
              }
            },
            {
              "aliasColors": {},
              "bars": false,
              "dashLength": 10,
              "dashes": false,
              "datasource": "$ds",
              "description": "The number of on-going merges in storage nodes.  It is expected to have high numbers for `storage/small` metric.",
              "fieldConfig": {
                "defaults": {
                  "links": []
                },
                "overrides": []
              },
              "fill": 1,
              "fillGradient": 0,
              "gridPos": {
                "h": 8,
                "w": 12,
                "x": 0,
                "y": 63
              },
              "hiddenSeries": false,
              "id": 54,
              "legend": {
                "alignAsTable": true,
                "avg": true,
                "current": true,
                "max": true,
                "min": false,
                "show": true,
                "sort": "current",
                "sortDesc": true,
                "total": false,
                "values": true
              },
              "lines": true,
              "linewidth": 1,
              "nullPointMode": "null",
              "options": {
                "alertThreshold": true
              },
              "percentage": false,
              "pluginVersion": "8.0.0",
              "pointradius": 2,
              "points": false,
              "renderer": "flot",
              "seriesOverrides": [],
              "spaceLength": 10,
              "stack": false,
              "steppedLine": false,
              "targets": [
                {
                  "expr": "sum(vm_active_merges{job=\"$job_storage\", instance=~\"$instance\"}) by(type)",
                  "legendFormat": "{{type}}",
                  "refId": "A"
                }
              ],
              "thresholds": [],
              "timeFrom": null,
              "timeRegions": [],
              "timeShift": null,
              "title": "Active merges ($instance)",
              "tooltip": {
                "shared": true,
                "sort": 0,
                "value_type": "individual"
              },
              "type": "graph",
              "xaxis": {
                "buckets": null,
                "mode": "time",
                "name": null,
                "show": true,
                "values": []
              },
              "yaxes": [
                {
                  "decimals": 0,
                  "format": "short",
                  "label": null,
                  "logBase": 1,
                  "max": null,
                  "min": "0",
                  "show": true
                },
                {
                  "format": "short",
                  "label": null,
                  "logBase": 1,
                  "max": null,
                  "min": "0",
                  "show": true
                }
              ],
              "yaxis": {
                "align": false,
                "alignLevel": null
              }
            },
            {
              "aliasColors": {},
              "bars": false,
              "dashLength": 10,
              "dashes": false,
              "datasource": "$ds",
              "description": "The number of rows merged per second by storage nodes.",
              "fieldConfig": {
                "defaults": {
                  "links": []
                },
                "overrides": []
              },
              "fill": 1,
              "fillGradient": 0,
              "gridPos": {
                "h": 8,
                "w": 12,
                "x": 12,
                "y": 63
              },
              "hiddenSeries": false,
              "id": 55,
              "legend": {
                "alignAsTable": true,
                "avg": true,
                "current": true,
                "max": true,
                "min": false,
                "show": true,
                "sort": "current",
                "sortDesc": true,
                "total": false,
                "values": true
              },
              "lines": true,
              "linewidth": 1,
              "nullPointMode": "null",
              "options": {
                "alertThreshold": true
              },
              "percentage": false,
              "pluginVersion": "8.0.0",
              "pointradius": 2,
              "points": false,
              "renderer": "flot",
              "seriesOverrides": [],
              "spaceLength": 10,
              "stack": false,
              "steppedLine": false,
              "targets": [
                {
                  "expr": "sum(rate(vm_rows_merged_total{job=\"$job_storage\", instance=~\"$instance\"}[5m])) by(type)",
                  "legendFormat": "{{type}}",
                  "refId": "A"
                }
              ],
              "thresholds": [],
              "timeFrom": null,
              "timeRegions": [],
              "timeShift": null,
              "title": "Merge speed",
              "tooltip": {
                "shared": true,
                "sort": 0,
                "value_type": "individual"
              },
              "type": "graph",
              "xaxis": {
                "buckets": null,
                "mode": "time",
                "name": null,
                "show": true,
                "values": []
              },
              "yaxes": [
                {
                  "decimals": 0,
                  "format": "short",
                  "label": null,
                  "logBase": 1,
                  "max": null,
                  "min": "0",
                  "show": true
                },
                {
                  "format": "short",
                  "label": null,
                  "logBase": 1,
                  "max": null,
                  "min": "0",
                  "show": true
                }
              ],
              "yaxis": {
                "align": false,
                "alignLevel": null
              }
            },
            {
              "aliasColors": {},
              "bars": false,
              "dashLength": 10,
              "dashes": false,
              "datasource": "$ds",
              "description": "Shows how many rows were ignored on insertion due to corrupted or out of retention timestamps.",
              "fill": 1,
              "fillGradient": 0,
              "gridPos": {
                "h": 8,
                "w": 12,
                "x": 0,
                "y": 71
              },
              "hiddenSeries": false,
              "id": 135,
              "legend": {
                "alignAsTable": true,
                "avg": true,
                "current": true,
                "max": true,
                "min": false,
                "show": true,
                "sort": "current",
                "sortDesc": true,
                "total": false,
                "values": true
              },
              "lines": true,
              "linewidth": 1,
              "nullPointMode": "null",
              "options": {
                "alertThreshold": true
              },
              "percentage": false,
              "pluginVersion": "8.0.0",
              "pointradius": 2,
              "points": false,
              "renderer": "flot",
              "seriesOverrides": [],
              "spaceLength": 10,
              "stack": false,
              "steppedLine": false,
              "targets": [
                {
                  "exemplar": true,
                  "expr": "sum(vm_rows_ignored_total{job=\"$job_storage\", instance=~\"$instance\"}) by (reason)",
                  "interval": "",
                  "legendFormat": "{{reason}}",
                  "refId": "A"
                }
              ],
              "thresholds": [],
              "timeFrom": null,
              "timeRegions": [],
              "timeShift": null,
              "title": "Rows ignored ($instance)",
              "tooltip": {
                "shared": true,
                "sort": 0,
                "value_type": "individual"
              },
              "type": "graph",
              "xaxis": {
                "buckets": null,
                "mode": "time",
                "name": null,
                "show": true,
                "values": []
              },
              "yaxes": [
                {
                  "format": "short",
                  "label": null,
                  "logBase": 1,
                  "max": null,
                  "min": null,
                  "show": true
                },
                {
                  "format": "short",
                  "label": null,
                  "logBase": 1,
                  "max": null,
                  "min": null,
                  "show": true
                }
              ],
              "yaxis": {
                "align": false,
                "alignLevel": null
              }
            },
            {
              "aliasColors": {},
              "bars": false,
              "dashLength": 10,
              "dashes": false,
              "datasource": "$ds",
              "description": "Data parts of LSM tree.\nHigh number of parts could be an evidence of slow merge performance - check the resource utilization.\n* `indexdb` - inverted index\n* `storage/small` - recently added parts of data ingested into storage(hot data)\n* `storage/big` -  small parts gradually merged into big parts (cold data)",
              "fieldConfig": {
                "defaults": {
                  "links": []
                },
                "overrides": []
              },
              "fill": 1,
              "fillGradient": 0,
              "gridPos": {
                "h": 8,
                "w": 12,
                "x": 12,
                "y": 71
              },
              "hiddenSeries": false,
              "id": 22,
              "legend": {
                "alignAsTable": true,
                "avg": true,
                "current": true,
                "max": true,
                "min": false,
                "show": true,
                "sort": "current",
                "sortDesc": true,
                "total": false,
                "values": true
              },
              "lines": true,
              "linewidth": 1,
              "links": [],
              "nullPointMode": "null",
              "options": {
                "alertThreshold": true
              },
              "percentage": false,
              "pluginVersion": "8.0.0",
              "pointradius": 2,
              "points": false,
              "renderer": "flot",
              "seriesOverrides": [],
              "spaceLength": 10,
              "stack": false,
              "steppedLine": false,
              "targets": [
                {
                  "expr": "sum(vm_parts{job=\"$job_storage\", instance=~\"$instance\"}) by (type)",
                  "format": "time_series",
                  "interval": "",
                  "intervalFactor": 1,
                  "legendFormat": "{{type}}",
                  "refId": "A"
                }
              ],
              "thresholds": [],
              "timeFrom": null,
              "timeRegions": [],
              "timeShift": null,
              "title": "LSM parts ($instance)",
              "tooltip": {
                "shared": true,
                "sort": 2,
                "value_type": "individual"
              },
              "type": "graph",
              "xaxis": {
                "buckets": null,
                "mode": "time",
                "name": null,
                "show": true,
                "values": []
              },
              "yaxes": [
                {
                  "format": "short",
                  "label": null,
                  "logBase": 1,
                  "max": null,
                  "min": "0",
                  "show": true
                },
                {
                  "format": "short",
                  "label": null,
                  "logBase": 1,
                  "max": null,
                  "min": "0",
                  "show": true
                }
              ],
              "yaxis": {
                "align": false,
                "alignLevel": null
              }
            },
            {
              "aliasColors": {},
              "bars": false,
              "dashLength": 10,
              "dashes": false,
              "datasource": "$ds",
              "description": "Shows how many ongoing insertions (not API /write calls) on disk are taking place, where:\n* `max` - equal to number of CPUs;\n* `current` - current number of goroutines busy with inserting rows into underlying storage.\n\nEvery successful API /write call results into flush on disk. The `max` is an internal limit and can't be changed. It is always equal to the number of CPUs. \n\nWhen `current` hits `max` constantly, it means storage is overloaded and requires more CPU.",
              "fill": 0,
              "fillGradient": 0,
              "gridPos": {
                "h": 8,
                "w": 12,
                "x": 12,
                "y": 79
              },
              "hiddenSeries": false,
              "id": 133,
              "legend": {
                "alignAsTable": true,
                "avg": true,
                "current": true,
                "max": true,
                "min": false,
                "show": true,
                "sort": "current",
                "sortDesc": true,
                "total": false,
                "values": true
              },
              "lines": true,
              "linewidth": 1,
              "links": [
                {
                  "targetBlank": true,
                  "title": "Related discussion",
                  "url": "https://github.com/VictoriaMetrics/VictoriaMetrics/issues/632"
                }
              ],
              "nullPointMode": "null",
              "options": {
                "alertThreshold": true
              },
              "percentage": false,
              "pluginVersion": "8.0.0",
              "pointradius": 2,
              "points": false,
              "renderer": "flot",
              "seriesOverrides": [
                {
                  "alias": "max",
                  "color": "#C4162A"
                }
              ],
              "spaceLength": 10,
              "stack": false,
              "steppedLine": false,
              "targets": [
                {
                  "exemplar": true,
                  "expr": "max(vm_concurrent_addrows_capacity{job=\"$job_storage\", instance=~\"$instance\"})",
                  "interval": "",
                  "legendFormat": "max",
                  "refId": "A"
                },
                {
                  "exemplar": true,
                  "expr": "sum(avg_over_time(vm_concurrent_addrows_current{job=\"$job_storage\", instance=~\"$instance\"}[1m])) by(instance)",
                  "hide": false,
                  "interval": "",
                  "legendFormat": "{{instance}}",
                  "refId": "B"
                }
              ],
              "thresholds": [],
              "timeFrom": null,
              "timeRegions": [],
              "timeShift": null,
              "title": "Concurrent flushes on disk ($instance)",
              "tooltip": {
                "shared": true,
                "sort": 0,
                "value_type": "individual"
              },
              "type": "graph",
              "xaxis": {
                "buckets": null,
                "mode": "time",
                "name": null,
                "show": true,
                "values": []
              },
              "yaxes": [
                {
                  "format": "short",
                  "label": null,
                  "logBase": 1,
                  "max": null,
                  "min": null,
                  "show": true
                },
                {
                  "format": "short",
                  "label": null,
                  "logBase": 1,
                  "max": null,
                  "min": null,
                  "show": true
                }
              ],
              "yaxis": {
                "align": false,
                "alignLevel": null
              }
            }
          ],
          "title": "vmstorage ($instance)",
          "type": "row"
        },
        {
          "collapsed": true,
          "datasource": "$ds",
          "gridPos": {
            "h": 1,
            "w": 24,
            "x": 0,
            "y": 39
          },
          "id": 42,
          "panels": [
            {
              "aliasColors": {},
              "bars": false,
              "dashLength": 10,
              "dashes": false,
              "datasource": "$ds",
              "description": "Request rate accepted by vmselect nodes",
              "fieldConfig": {
                "defaults": {
                  "links": []
                },
                "overrides": []
              },
              "fill": 1,
              "fillGradient": 0,
              "gridPos": {
                "h": 8,
                "w": 12,
                "x": 0,
                "y": 8
              },
              "hiddenSeries": false,
              "id": 92,
              "legend": {
                "alignAsTable": true,
                "avg": true,
                "current": true,
                "max": true,
                "min": false,
                "show": true,
                "sort": "current",
                "sortDesc": true,
                "total": false,
                "values": true
              },
              "lines": true,
              "linewidth": 1,
              "links": [],
              "nullPointMode": "null as zero",
              "options": {
                "alertThreshold": true
              },
              "percentage": false,
              "pluginVersion": "8.0.0",
              "pointradius": 2,
              "points": false,
              "renderer": "flot",
              "seriesOverrides": [],
              "spaceLength": 10,
              "stack": false,
              "steppedLine": false,
              "targets": [
                {
                  "expr": "sum(rate(vm_http_requests_total{job=~\"$job_select\", instance=~\"$instance.*\", path!~\"/favicon.ico\"}[5m])) by (path) > 0",
                  "format": "time_series",
                  "intervalFactor": 1,
                  "legendFormat": "{{path}}",
                  "refId": "A"
                }
              ],
              "thresholds": [],
              "timeFrom": null,
              "timeRegions": [],
              "timeShift": null,
              "title": "Requests rate ($instance)",
              "tooltip": {
                "shared": true,
                "sort": 2,
                "value_type": "individual"
              },
              "type": "graph",
              "xaxis": {
                "buckets": null,
                "mode": "time",
                "name": null,
                "show": true,
                "values": []
              },
              "yaxes": [
                {
                  "format": "short",
                  "label": null,
                  "logBase": 1,
                  "max": null,
                  "min": "0",
                  "show": true
                },
                {
                  "format": "short",
                  "label": null,
                  "logBase": 1,
                  "max": null,
                  "min": "0",
                  "show": true
                }
              ],
              "yaxis": {
                "align": false,
                "alignLevel": null
              }
            },
            {
              "aliasColors": {},
              "bars": false,
              "dashLength": 10,
              "dashes": false,
              "datasource": "$ds",
              "description": "Shows how many ongoing insertions are taking place.\n* `max` - equal to number of CPU * 2 by default. May be configured with `search.maxConcurrentRequests` flag\n* `current` - current number of goroutines busy with processing requests\n\nWhen `current` hits `max` constantly, it means vmselect node is overloaded and require more CPU or higher limits.",
              "fieldConfig": {
                "defaults": {
                  "links": []
                },
                "overrides": []
              },
              "fill": 1,
              "fillGradient": 0,
              "gridPos": {
                "h": 8,
                "w": 12,
                "x": 12,
                "y": 8
              },
              "hiddenSeries": false,
              "id": 95,
              "legend": {
                "alignAsTable": true,
                "avg": true,
                "current": true,
                "hideEmpty": false,
                "hideZero": false,
                "max": true,
                "min": false,
                "show": true,
                "sort": "current",
                "sortDesc": true,
                "total": false,
                "values": true
              },
              "lines": true,
              "linewidth": 1,
              "links": [],
              "nullPointMode": "null",
              "options": {
                "alertThreshold": true
              },
              "percentage": false,
              "pluginVersion": "8.0.0",
              "pointradius": 2,
              "points": false,
              "renderer": "flot",
              "seriesOverrides": [
                {
                  "alias": "max",
                  "color": "#C4162A",
                  "fill": 0
                }
              ],
              "spaceLength": 10,
              "stack": false,
              "steppedLine": false,
              "targets": [
                {
                  "expr": "sum(max_over_time(vm_concurrent_queries{job=\"$job_select\", instance=~\"$instance\"}[1m]))",
                  "format": "time_series",
                  "interval": "",
                  "intervalFactor": 1,
                  "legendFormat": "current",
                  "refId": "A"
                },
                {
                  "expr": "sum(vm_concurrent_select_capacity{job=\"$job_select\", instance=~\"$instance\"})",
                  "format": "time_series",
                  "intervalFactor": 1,
                  "legendFormat": "max",
                  "refId": "B"
                }
              ],
              "thresholds": [],
              "timeFrom": null,
              "timeRegions": [],
              "timeShift": null,
              "title": "Concurrent selects ($instance)",
              "tooltip": {
                "shared": true,
                "sort": 2,
                "value_type": "individual"
              },
              "type": "graph",
              "xaxis": {
                "buckets": null,
                "mode": "time",
                "name": null,
                "show": true,
                "values": []
              },
              "yaxes": [
                {
                  "decimals": 0,
                  "format": "short",
                  "label": null,
                  "logBase": 1,
                  "max": null,
                  "min": "0",
                  "show": true
                },
                {
                  "decimals": 0,
                  "format": "short",
                  "label": null,
                  "logBase": 1,
                  "max": null,
                  "min": "0",
                  "show": true
                }
              ],
              "yaxis": {
                "align": false,
                "alignLevel": null
              }
            },
            {
              "aliasColors": {},
              "bars": false,
              "dashLength": 10,
              "dashes": false,
              "datasource": "$ds",
              "description": "",
              "fieldConfig": {
                "defaults": {
                  "links": []
                },
                "overrides": []
              },
              "fill": 6,
              "fillGradient": 0,
              "gridPos": {
                "h": 8,
                "w": 24,
                "x": 0,
                "y": 16
              },
              "hiddenSeries": false,
              "id": 93,
              "legend": {
                "alignAsTable": true,
                "avg": true,
                "current": true,
                "max": false,
                "min": false,
                "show": true,
                "sort": "current",
                "sortDesc": true,
                "total": false,
                "values": true
              },
              "lines": true,
              "linewidth": 1,
              "links": [],
              "nullPointMode": "null as zero",
              "options": {
                "alertThreshold": true
              },
              "percentage": false,
              "pluginVersion": "8.0.0",
              "pointradius": 2,
              "points": false,
              "renderer": "flot",
              "seriesOverrides": [
                {
                  "alias": "/read.*/",
                  "transform": "negative-Y"
                }
              ],
              "spaceLength": 10,
              "stack": false,
              "steppedLine": false,
              "targets": [
                {
                  "expr": "sum(rate(vm_tcplistener_read_bytes_total{job=~\"$job_select\", instance=~\"$instance\"}[5m])) by (instance) * 8 > 0",
                  "format": "time_series",
                  "intervalFactor": 1,
                  "legendFormat": "read - {{instance}}",
                  "refId": "A"
                },
                {
                  "expr": "sum(rate(vm_tcplistener_written_bytes_total{job=~\"$job_select\", instance=~\"$instance\"}[5m])) by (instance) * 8 > 0",
                  "format": "time_series",
                  "hide": false,
                  "intervalFactor": 1,
                  "legendFormat": "write - {{instance}}",
                  "refId": "B"
                }
              ],
              "thresholds": [],
              "timeFrom": null,
              "timeRegions": [],
              "timeShift": null,
              "title": "Network usage ($instance)",
              "tooltip": {
                "shared": true,
                "sort": 2,
                "value_type": "individual"
              },
              "type": "graph",
              "xaxis": {
                "buckets": null,
                "mode": "time",
                "name": null,
                "show": true,
                "values": []
              },
              "yaxes": [
                {
                  "format": "bps",
                  "label": null,
                  "logBase": 1,
                  "max": null,
                  "min": null,
                  "show": true
                },
                {
                  "format": "short",
                  "label": null,
                  "logBase": 1,
                  "max": null,
                  "min": null,
                  "show": true
                }
              ],
              "yaxis": {
                "align": false,
                "alignLevel": null
              }
            }
          ],
          "title": "vmselect ($instance)",
          "type": "row"
        },
        {
          "collapsed": true,
          "datasource": "$ds",
          "gridPos": {
            "h": 1,
            "w": 24,
            "x": 0,
            "y": 40
          },
          "id": 40,
          "panels": [
            {
              "aliasColors": {},
              "bars": false,
              "dashLength": 10,
              "dashes": false,
              "datasource": "$ds",
              "description": "* `*` - unsupported query path\n* `/write` - insert into VM\n* `/metrics` - query VM system metrics\n* `/query` - query instant values\n* `/query_range` - query over a range of time\n* `/series` - match a certain label set\n* `/label/{}/values` - query a list of label values (variables mostly)",
              "fieldConfig": {
                "defaults": {
                  "links": []
                },
                "overrides": []
              },
              "fill": 1,
              "fillGradient": 0,
              "gridPos": {
                "h": 8,
                "w": 12,
                "x": 0,
                "y": 9
              },
              "hiddenSeries": false,
              "id": 97,
              "legend": {
                "alignAsTable": true,
                "avg": true,
                "current": true,
                "max": true,
                "min": false,
                "show": true,
                "sort": "current",
                "sortDesc": true,
                "total": false,
                "values": true
              },
              "lines": true,
              "linewidth": 1,
              "links": [],
              "nullPointMode": "null as zero",
              "options": {
                "alertThreshold": true
              },
              "percentage": false,
              "pluginVersion": "8.0.0",
              "pointradius": 2,
              "points": false,
              "renderer": "flot",
              "seriesOverrides": [],
              "spaceLength": 10,
              "stack": false,
              "steppedLine": false,
              "targets": [
                {
                  "expr": "sum(rate(vm_http_requests_total{job=~\"$job_insert\", instance=~\"$instance.*\", path!~\"/favicon.ico\"}[5m])) by (path) > 0",
                  "format": "time_series",
                  "intervalFactor": 1,
                  "legendFormat": "{{path}}",
                  "refId": "A"
                }
              ],
              "thresholds": [],
              "timeFrom": null,
              "timeRegions": [],
              "timeShift": null,
              "title": "Requests rate ($instance)",
              "tooltip": {
                "shared": true,
                "sort": 2,
                "value_type": "individual"
              },
              "type": "graph",
              "xaxis": {
                "buckets": null,
                "mode": "time",
                "name": null,
                "show": true,
                "values": []
              },
              "yaxes": [
                {
                  "format": "short",
                  "label": null,
                  "logBase": 1,
                  "max": null,
                  "min": "0",
                  "show": true
                },
                {
                  "format": "short",
                  "label": null,
                  "logBase": 1,
                  "max": null,
                  "min": "0",
                  "show": true
                }
              ],
              "yaxis": {
                "align": false,
                "alignLevel": null
              }
            },
            {
              "aliasColors": {},
              "bars": false,
              "dashLength": 10,
              "dashes": false,
              "datasource": "$ds",
              "description": "Shows how many ongoing insertions are taking place.\n* `max` - equal to number of CPU * 4 by default. May be configured with `maxConcurrentInserts` flag;\n* `current` - current number of goroutines busy with processing requests.\n\n`-maxConcurrentInserts` limits the number of insert requests which may be actively processed at any given point in time. All the other insert requests are queued for up to `-insert.maxQueueDuration` in the hope they will get a chance to be processed. This queue is used mostly for absorbing spikes for incoming insert request rate.\n\nWhen `current` hits `max` constantly, it means vminsert node is overloaded and requires more CPU or higher limits.",
              "fieldConfig": {
                "defaults": {
                  "links": []
                },
                "overrides": []
              },
              "fill": 1,
              "fillGradient": 0,
              "gridPos": {
                "h": 8,
                "w": 12,
                "x": 12,
                "y": 9
              },
              "hiddenSeries": false,
              "id": 99,
              "legend": {
                "alignAsTable": true,
                "avg": true,
                "current": true,
                "hideEmpty": false,
                "hideZero": false,
                "max": true,
                "min": false,
                "show": true,
                "sort": "current",
                "sortDesc": true,
                "total": false,
                "values": true
              },
              "lines": true,
              "linewidth": 1,
              "links": [],
              "nullPointMode": "null",
              "options": {
                "alertThreshold": true
              },
              "percentage": false,
              "pluginVersion": "8.0.0",
              "pointradius": 2,
              "points": false,
              "renderer": "flot",
              "seriesOverrides": [
                {
                  "alias": "max",
                  "color": "#C4162A",
                  "fill": 0
                }
              ],
              "spaceLength": 10,
              "stack": false,
              "steppedLine": false,
              "targets": [
                {
                  "expr": "sum(vm_concurrent_insert_current{job=\"$job_insert\", instance=~\"$instance\"})",
                  "format": "time_series",
                  "interval": "",
                  "intervalFactor": 1,
                  "legendFormat": "current",
                  "refId": "A"
                },
                {
                  "exemplar": true,
                  "expr": "sum(vm_concurrent_insert_capacity{job=\"$job_insert\", instance=~\"$instance\"})",
                  "format": "time_series",
                  "interval": "",
                  "intervalFactor": 1,
                  "legendFormat": "max",
                  "refId": "B"
                }
              ],
              "thresholds": [],
              "timeFrom": null,
              "timeRegions": [],
              "timeShift": null,
              "title": "Concurrent inserts ($instance)",
              "tooltip": {
                "shared": true,
                "sort": 2,
                "value_type": "individual"
              },
              "type": "graph",
              "xaxis": {
                "buckets": null,
                "mode": "time",
                "name": null,
                "show": true,
                "values": []
              },
              "yaxes": [
                {
                  "decimals": 0,
                  "format": "short",
                  "label": null,
                  "logBase": 1,
                  "max": null,
                  "min": "0",
                  "show": true
                },
                {
                  "decimals": 0,
                  "format": "short",
                  "label": null,
                  "logBase": 1,
                  "max": null,
                  "min": "0",
                  "show": true
                }
              ],
              "yaxis": {
                "align": false,
                "alignLevel": null
              }
            },
            {
              "aliasColors": {},
              "bars": false,
              "dashLength": 10,
              "dashes": false,
              "datasource": "$ds",
              "description": "",
              "fieldConfig": {
                "defaults": {
                  "links": []
                },
                "overrides": []
              },
              "fill": 6,
              "fillGradient": 0,
              "gridPos": {
                "h": 8,
                "w": 12,
                "x": 0,
                "y": 17
              },
              "hiddenSeries": false,
              "id": 90,
              "legend": {
                "alignAsTable": true,
                "avg": true,
                "current": true,
                "max": true,
                "min": false,
                "show": true,
                "sort": "current",
                "sortDesc": true,
                "total": false,
                "values": true
              },
              "lines": true,
              "linewidth": 1,
              "links": [],
              "nullPointMode": "null as zero",
              "options": {
                "alertThreshold": true
              },
              "percentage": false,
              "pluginVersion": "8.0.0",
              "pointradius": 2,
              "points": false,
              "renderer": "flot",
              "seriesOverrides": [
                {
                  "alias": "/write.*/",
                  "transform": "negative-Y"
                }
              ],
              "spaceLength": 10,
              "stack": false,
              "steppedLine": false,
              "targets": [
                {
                  "expr": "sum(rate(vm_tcplistener_read_bytes_total{job=~\"$job_insert\", instance=~\"$instance\"}[5m])) by (instance) * 8 > 0",
                  "format": "time_series",
                  "intervalFactor": 1,
                  "legendFormat": "read - {{instance}}",
                  "refId": "A"
                },
                {
                  "expr": "sum(rate(vm_tcplistener_written_bytes_total{job=~\"$job_insert\", instance=~\"$instance\"}[5m])) by (instance) * 8 > 0",
                  "format": "time_series",
                  "hide": false,
                  "intervalFactor": 1,
                  "legendFormat": "write - {{instance}}",
                  "refId": "B"
                }
              ],
              "thresholds": [],
              "timeFrom": null,
              "timeRegions": [],
              "timeShift": null,
              "title": "Network usage ($instance)",
              "tooltip": {
                "shared": true,
                "sort": 2,
                "value_type": "individual"
              },
              "type": "graph",
              "xaxis": {
                "buckets": null,
                "mode": "time",
                "name": null,
                "show": true,
                "values": []
              },
              "yaxes": [
                {
                  "format": "bps",
                  "label": null,
                  "logBase": 1,
                  "max": null,
                  "min": null,
                  "show": true
                },
                {
                  "format": "short",
                  "label": null,
                  "logBase": 1,
                  "max": null,
                  "min": "0",
                  "show": true
                }
              ],
              "yaxis": {
                "align": false,
                "alignLevel": null
              }
            },
            {
              "aliasColors": {},
              "bars": false,
              "dashLength": 10,
              "dashes": false,
              "datasource": "$ds",
              "description": "",
              "fieldConfig": {
                "defaults": {
                  "links": []
                },
                "overrides": []
              },
              "fill": 1,
              "fillGradient": 0,
              "gridPos": {
                "h": 8,
                "w": 12,
                "x": 12,
                "y": 17
              },
              "hiddenSeries": false,
              "id": 88,
              "legend": {
                "alignAsTable": true,
                "avg": true,
                "current": true,
                "max": true,
                "min": false,
                "show": true,
                "sort": "current",
                "sortDesc": true,
                "total": false,
                "values": true
              },
              "lines": true,
              "linewidth": 1,
              "links": [],
              "nullPointMode": "null as zero",
              "options": {
                "alertThreshold": true
              },
              "percentage": false,
              "pluginVersion": "8.0.0",
              "pointradius": 2,
              "points": false,
              "renderer": "flot",
              "seriesOverrides": [],
              "spaceLength": 10,
              "stack": false,
              "steppedLine": false,
              "targets": [
                {
                  "expr": "histogram_quantile(0.99, sum(increase(vm_rows_per_insert_bucket{job=~\"$job\", instance=~\"$instance\"}[5m])) by (instance, vmrange))",
                  "format": "time_series",
                  "interval": "",
                  "intervalFactor": 1,
                  "legendFormat": "{{instance}}",
                  "refId": "A"
                }
              ],
              "thresholds": [],
              "timeFrom": null,
              "timeRegions": [],
              "timeShift": null,
              "title": "Rows per insert ($instance)",
              "tooltip": {
                "shared": true,
                "sort": 2,
                "value_type": "individual"
              },
              "type": "graph",
              "xaxis": {
                "buckets": null,
                "mode": "time",
                "name": null,
                "show": true,
                "values": []
              },
              "yaxes": [
                {
                  "decimals": 2,
                  "format": "short",
                  "label": null,
                  "logBase": 1,
                  "max": null,
                  "min": "0",
                  "show": true
                },
                {
                  "format": "short",
                  "label": null,
                  "logBase": 1,
                  "max": null,
                  "min": "0",
                  "show": true
                }
              ],
              "yaxis": {
                "align": false,
                "alignLevel": null
              }
            },
            {
              "aliasColors": {},
              "bars": false,
              "dashLength": 10,
              "dashes": false,
              "datasource": "$ds",
              "description": "Shows if vmstorage node is reachable for vminsert. If below 1 means vmstorage is not reachable at this moment of time. ",
              "fieldConfig": {
                "defaults": {
                  "links": []
                },
                "overrides": []
              },
              "fill": 1,
              "fillGradient": 0,
              "gridPos": {
                "h": 8,
                "w": 12,
                "x": 12,
                "y": 25
              },
              "hiddenSeries": false,
              "id": 114,
              "legend": {
                "alignAsTable": true,
                "avg": true,
                "current": true,
                "max": false,
                "min": false,
                "show": true,
                "sort": "current",
                "sortDesc": true,
                "total": false,
                "values": true
              },
              "lines": true,
              "linewidth": 1,
              "links": [],
              "nullPointMode": "null as zero",
              "options": {
                "alertThreshold": true
              },
              "percentage": false,
              "pluginVersion": "8.0.0",
              "pointradius": 2,
              "points": false,
              "renderer": "flot",
              "seriesOverrides": [],
              "spaceLength": 10,
              "stack": false,
              "steppedLine": false,
              "targets": [
                {
                  "expr": "vm_rpc_vmstorage_is_reachable{job=~\"$job\", instance=~\"$instance\"}",
                  "format": "time_series",
                  "interval": "",
                  "intervalFactor": 1,
                  "legendFormat": "{{instance}} => {{addr}}",
                  "refId": "A"
                }
              ],
              "thresholds": [],
              "timeFrom": null,
              "timeRegions": [],
              "timeShift": null,
              "title": "Storage reachability ($instance)",
              "tooltip": {
                "shared": true,
                "sort": 2,
                "value_type": "individual"
              },
              "type": "graph",
              "xaxis": {
                "buckets": null,
                "mode": "time",
                "name": null,
                "show": true,
                "values": []
              },
              "yaxes": [
                {
                  "decimals": 0,
                  "format": "short",
                  "label": null,
                  "logBase": 1,
                  "max": null,
                  "min": "0",
                  "show": true
                },
                {
                  "format": "short",
                  "label": null,
                  "logBase": 1,
                  "max": null,
                  "min": "0",
                  "show": true
                }
              ],
              "yaxis": {
                "align": false,
                "alignLevel": null
              }
            }
          ],
          "title": "vminsert ($instance)",
          "type": "row"
        }
      ],
      "schemaVersion": 30,
      "style": "dark",
      "tags": [],
      "templating": {
        "list": [
          {
            "current": {
              "selected": false,
              "text": "Prometheus",
              "value": "Prometheus"
            },
            "description": null,
            "error": null,
            "hide": 0,
            "includeAll": false,
            "label": null,
            "multi": false,
            "name": "ds",
            "options": [],
            "query": "prometheus",
            "refresh": 1,
            "regex": "",
            "skipUrlSync": false,
            "type": "datasource"
          },
          {
            "allValue": null,
            "current": {
              "selected": false,
              "text": "kubernetes-pods",
              "value": "kubernetes-pods"
            },
            "datasource": "$ds",
            "definition": "label_values(vm_app_version{version=~\"^vminsert.*\"}, job)",
            "description": null,
            "error": null,
            "hide": 2,
            "includeAll": false,
            "label": null,
            "multi": false,
            "name": "job_insert",
            "options": [],
            "query": {
              "query": "label_values(vm_app_version{version=~\"^vminsert.*\"}, job)",
              "refId": "VictoriaMetrics-job_insert-Variable-Query"
            },
            "refresh": 1,
            "regex": "",
            "skipUrlSync": false,
            "sort": 0,
            "tagValuesQuery": "",
            "tagsQuery": "",
            "type": "query",
            "useTags": false
          },
          {
            "allValue": null,
            "current": {
              "selected": false,
              "text": "kubernetes-pods",
              "value": "kubernetes-pods"
            },
            "datasource": "$ds",
            "definition": "label_values(vm_app_version{version=~\"^vmselect.*\"}, job)",
            "description": null,
            "error": null,
            "hide": 2,
            "includeAll": false,
            "label": null,
            "multi": false,
            "name": "job_select",
            "options": [],
            "query": {
              "query": "label_values(vm_app_version{version=~\"^vmselect.*\"}, job)",
              "refId": "VictoriaMetrics-job_select-Variable-Query"
            },
            "refresh": 1,
            "regex": "",
            "skipUrlSync": false,
            "sort": 0,
            "tagValuesQuery": "",
            "tagsQuery": "",
            "type": "query",
            "useTags": false
          },
          {
            "allValue": null,
            "current": {
              "selected": false,
              "text": "kubernetes-pods",
              "value": "kubernetes-pods"
            },
            "datasource": "$ds",
            "definition": "label_values(vm_app_version{version=~\"^vmstorage.*\"}, job)",
            "description": null,
            "error": null,
            "hide": 2,
            "includeAll": false,
            "label": null,
            "multi": false,
            "name": "job_storage",
            "options": [],
            "query": {
              "query": "label_values(vm_app_version{version=~\"^vmstorage.*\"}, job)",
              "refId": "VictoriaMetrics-job_storage-Variable-Query"
            },
            "refresh": 1,
            "regex": "",
            "skipUrlSync": false,
            "sort": 0,
            "tagValuesQuery": "",
            "tagsQuery": "",
            "type": "query",
            "useTags": false
          },
          {
            "allValue": null,
            "current": {
              "selected": false,
              "text": "All",
              "value": "$__all"
            },
            "datasource": "$ds",
            "definition": "label_values(vm_app_version{version=~\"^vm(insert|select|storage).*\"}, job)",
            "description": null,
            "error": null,
            "hide": 0,
            "includeAll": true,
            "label": null,
            "multi": true,
            "name": "job",
            "options": [],
            "query": {
              "query": "label_values(vm_app_version{version=~\"^vm(insert|select|storage).*\"}, job)",
              "refId": "VictoriaMetrics-job-Variable-Query"
            },
            "refresh": 1,
            "regex": "",
            "skipUrlSync": false,
            "sort": 0,
            "tagValuesQuery": "",
            "tagsQuery": "",
            "type": "query",
            "useTags": false
          },
          {
            "allValue": ".*",
            "current": {
              "selected": false,
              "text": "All",
              "value": "$__all"
            },
            "datasource": "$ds",
            "definition": "label_values(vm_app_version{job=~\"$job\"}, instance)",
            "description": null,
            "error": null,
            "hide": 0,
            "includeAll": true,
            "label": null,
            "multi": true,
            "name": "instance",
            "options": [],
            "query": {
              "query": "label_values(vm_app_version{job=~\"$job\"}, instance)",
              "refId": "VictoriaMetrics-instance-Variable-Query"
            },
            "refresh": 1,
            "regex": "",
            "skipUrlSync": false,
            "sort": 0,
            "type": "query"
          }
        ]
      },
      "time": {
        "from": "now-3h",
        "to": "now"
      },
      "timepicker": {
        "refresh_intervals": [
          "10s",
          "30s",
          "1m",
          "5m",
          "15m",
          "30m",
          "1h",
          "2h",
          "1d"
        ]
      },
      "timezone": "",
      "title": "VictoriaMetrics - cluster",
      "uid": "G7Rvscn7k",
      "version": 1
    }
  wekahome-stats-handler.json: |-
    {
      "annotations": {
        "list": [
          {
            "builtIn": 1,
            "datasource": "Prometheus",
            "enable": true,
            "hide": true,
            "iconColor": "rgba(0, 211, 255, 1)",
            "limit": 100,
            "name": "Annotations & Alerts",
            "showIn": 0,
            "target": {
              "limit": 100,
              "matchAny": false,
              "tags": [],
              "type": "dashboard"
            },
            "type": "dashboard"
          }
        ]
      },
      "editable": true,
      "gnetId": null,
      "graphTooltip": 1,
      "id": 5,
      "iteration": 1660633810371,
      "links": [],
      "panels": [
        {
          "collapsed": false,
          "datasource": "Prometheus",
          "gridPos": {
            "h": 1,
            "w": 24,
            "x": 0,
            "y": 0
          },
          "id": 27,
          "panels": [],
          "title": "General Stats",
          "type": "row"
        },
        {
          "aliasColors": {},
          "bars": false,
          "dashLength": 10,
          "dashes": false,
          "datasource": "Prometheus",
          "fill": 1,
          "fillGradient": 0,
          "gridPos": {
            "h": 5,
            "w": 6,
            "x": 0,
            "y": 1
          },
          "hiddenSeries": false,
          "id": 10,
          "interval": "$precision",
          "legend": {
            "alignAsTable": true,
            "avg": false,
            "current": false,
            "hideEmpty": false,
            "hideZero": false,
            "max": false,
            "min": false,
            "rightSide": true,
            "show": true,
            "total": false,
            "values": false
          },
          "lines": true,
          "linewidth": 1,
          "maxDataPoints": 200,
          "nullPointMode": "null",
          "options": {
            "alertThreshold": true
          },
          "percentage": false,
          "pluginVersion": "8.1.0",
          "pointradius": 2,
          "points": false,
          "renderer": "flot",
          "seriesOverrides": [
            {
              "$$hashKey": "object:397",
              "alias": "RECEIVED",
              "linewidth": 4,
              "stack": false
            },
            {
              "$$hashKey": "object:527",
              "alias": "DONE",
              "linewidth": 4
            }
          ],
          "spaceLength": 10,
          "stack": true,
          "steppedLine": false,
          "targets": [
            {
              "expr": "sum(rate(wekahome_stats_received[$precision]))",
              "interval": "",
              "legendFormat": "RECEIVED",
              "refId": "A"
            },
            {
              "expr": "sum(rate(wekahome_stats_malformed[$precision]))",
              "interval": "",
              "legendFormat": "MALFORMED",
              "refId": "B"
            },
            {
              "expr": "sum(rate(wekahome_stats_processed[$precision]))",
              "interval": "",
              "legendFormat": "DONE",
              "refId": "C"
            },
            {
              "expr": "sum(rate(wekahome_stats_errors[$precision]))",
              "interval": "",
              "legendFormat": "ERROR",
              "refId": "D"
            },
            {
              "expr": "sum(rate(wekahome_stats_queue_timeouts[$precision]))",
              "interval": "",
              "legendFormat": "TIMEOUT",
              "refId": "E"
            }
          ],
          "thresholds": [],
          "timeFrom": null,
          "timeRegions": [],
          "timeShift": null,
          "title": "Stats Packages Processed/sec",
          "tooltip": {
            "shared": true,
            "sort": 0,
            "value_type": "individual"
          },
          "type": "graph",
          "xaxis": {
            "buckets": null,
            "mode": "time",
            "name": null,
            "show": true,
            "values": []
          },
          "yaxes": [
            {
              "format": "short",
              "label": null,
              "logBase": 1,
              "max": null,
              "min": "0",
              "show": true
            },
            {
              "format": "short",
              "label": null,
              "logBase": 1,
              "max": null,
              "min": null,
              "show": true
            }
          ],
          "yaxis": {
            "align": false,
            "alignLevel": null
          }
        },
        {
          "aliasColors": {},
          "bars": false,
          "dashLength": 10,
          "dashes": false,
          "datasource": "Prometheus",
          "fill": 1,
          "fillGradient": 0,
          "gridPos": {
            "h": 5,
            "w": 6,
            "x": 6,
            "y": 1
          },
          "hiddenSeries": false,
          "id": 8,
          "interval": "$precision",
          "legend": {
            "alignAsTable": true,
            "avg": false,
            "current": false,
            "max": false,
            "min": false,
            "rightSide": true,
            "show": true,
            "total": false,
            "values": false
          },
          "lines": true,
          "linewidth": 1,
          "nullPointMode": "null",
          "options": {
            "alertThreshold": true
          },
          "percentage": false,
          "pluginVersion": "8.1.0",
          "pointradius": 2,
          "points": false,
          "renderer": "flot",
          "seriesOverrides": [],
          "spaceLength": 10,
          "stack": false,
          "steppedLine": false,
          "targets": [
            {
              "expr": "histogram_quantile(0.99, sum(rate(wekahome_stats_save_duration_bucket[$precision])) by (le))",
              "interval": "",
              "legendFormat": "99%",
              "refId": "A"
            },
            {
              "expr": "histogram_quantile(0.8, sum(rate(wekahome_stats_save_duration_bucket[$precision])) by (le))",
              "interval": "",
              "legendFormat": "80%",
              "refId": "B"
            },
            {
              "expr": "histogram_quantile(0.5, sum(rate(wekahome_stats_save_duration_bucket[$precision])) by (le))",
              "interval": "",
              "legendFormat": "50%",
              "refId": "C"
            }
          ],
          "thresholds": [],
          "timeFrom": null,
          "timeRegions": [],
          "timeShift": null,
          "title": "Overall Stats Processing Latency",
          "tooltip": {
            "shared": true,
            "sort": 0,
            "value_type": "individual"
          },
          "type": "graph",
          "xaxis": {
            "buckets": null,
            "mode": "time",
            "name": null,
            "show": true,
            "values": []
          },
          "yaxes": [
            {
              "format": "s",
              "label": null,
              "logBase": 1,
              "max": null,
              "min": "0",
              "show": true
            },
            {
              "format": "short",
              "label": null,
              "logBase": 1,
              "max": null,
              "min": null,
              "show": true
            }
          ],
          "yaxis": {
            "align": false,
            "alignLevel": null
          }
        },
        {
          "aliasColors": {
            "Internal Server Error ": "dark-red",
            "OK ": "dark-green",
            "Unauthorized ": "dark-purple"
          },
          "bars": false,
          "dashLength": 10,
          "dashes": false,
          "datasource": "Prometheus",
          "decimals": 0,
          "fill": 1,
          "fillGradient": 0,
          "gridPos": {
            "h": 5,
            "w": 6,
            "x": 12,
            "y": 1
          },
          "hiddenSeries": false,
          "id": 12,
          "interval": "$precision",
          "legend": {
            "alignAsTable": true,
            "avg": true,
            "current": true,
            "hideEmpty": true,
            "hideZero": true,
            "max": false,
            "min": false,
            "rightSide": true,
            "show": true,
            "total": false,
            "values": true
          },
          "lines": true,
          "linewidth": 1,
          "nullPointMode": "null as zero",
          "options": {
            "alertThreshold": true
          },
          "percentage": false,
          "pluginVersion": "8.1.0",
          "pointradius": 2,
          "points": false,
          "renderer": "flot",
          "seriesOverrides": [
            {
              "$$hashKey": "object:468",
              "alias": "OK",
              "color": "#37872D"
            },
            {
              "$$hashKey": "object:469",
              "alias": "Unauthorized",
              "hiddenSeries": true
            },
            {
              "$$hashKey": "object:470",
              "alias": "Internal Server Error",
              "color": "#C4162A"
            }
          ],
          "spaceLength": 10,
          "stack": false,
          "steppedLine": false,
          "targets": [
            {
              "expr": "sum by(code,path)(rate(chi_pattern_request_duration_milliseconds_count{method=\"POST\", kubernetes_namespace=\"home-weka-io\", app=\"stats-handler\"}[$precision]))",
              "interval": "",
              "legendFormat": "{{code}} ",
              "refId": "A"
            }
          ],
          "thresholds": [],
          "timeFrom": null,
          "timeRegions": [],
          "timeShift": null,
          "title": "HTTP Status Codes/sec",
          "tooltip": {
            "shared": true,
            "sort": 0,
            "value_type": "individual"
          },
          "type": "graph",
          "xaxis": {
            "buckets": null,
            "mode": "time",
            "name": null,
            "show": true,
            "values": []
          },
          "yaxes": [
            {
              "$$hashKey": "object:489",
              "format": "short",
              "label": null,
              "logBase": 1,
              "max": null,
              "min": "0",
              "show": true
            },
            {
              "$$hashKey": "object:490",
              "format": "short",
              "label": null,
              "logBase": 1,
              "max": null,
              "min": null,
              "show": true
            }
          ],
          "yaxis": {
            "align": false,
            "alignLevel": null
          }
        },
        {
          "datasource": "Prometheus",
          "fieldConfig": {
            "defaults": {
              "color": {
                "mode": "continuous-RdYlGr",
                "seriesBy": "last"
              },
              "custom": {
                "axisLabel": "",
                "axisPlacement": "auto",
                "barAlignment": 0,
                "drawStyle": "line",
                "fillOpacity": 10,
                "gradientMode": "hue",
                "hideFrom": {
                  "legend": false,
                  "tooltip": false,
                  "viz": false
                },
                "lineInterpolation": "smooth",
                "lineWidth": 2,
                "pointSize": 5,
                "scaleDistribution": {
                  "type": "linear"
                },
                "showPoints": "never",
                "spanNulls": true,
                "stacking": {
                  "group": "A",
                  "mode": "none"
                },
                "thresholdsStyle": {
                  "mode": "line"
                }
              },
              "mappings": [],
              "min": 0,
              "thresholds": {
                "mode": "absolute",
                "steps": [
                  {
                    "color": "transparent",
                    "value": null
                  },
                  {
                    "color": "red",
                    "value": 5
                  }
                ]
              },
              "unit": "percent"
            },
            "overrides": []
          },
          "gridPos": {
            "h": 5,
            "w": 3,
            "x": 18,
            "y": 1
          },
          "id": 33,
          "interval": "5m",
          "options": {
            "legend": {
              "calcs": [],
              "displayMode": "hidden",
              "placement": "bottom"
            },
            "tooltip": {
              "mode": "single"
            }
          },
          "pluginVersion": "8.1.0",
          "targets": [
            {
              "exemplar": true,
              "expr": "(1-avg(wekahome_stats_processed / wekahome_stats_received))*100",
              "interval": "",
              "legendFormat": "Error Ratio",
              "refId": "A"
            }
          ],
          "thresholds": [],
          "timeFrom": null,
          "timeShift": null,
          "title": "Error Rate",
          "type": "timeseries"
        },
        {
          "datasource": null,
          "fieldConfig": {
            "defaults": {
              "color": {
                "mode": "thresholds"
              },
              "mappings": [],
              "min": 0,
              "thresholds": {
                "mode": "absolute",
                "steps": [
                  {
                    "color": "green",
                    "value": null
                  },
                  {
                    "color": "red",
                    "value": 80
                  }
                ]
              }
            },
            "overrides": []
          },
          "gridPos": {
            "h": 5,
            "w": 3,
            "x": 21,
            "y": 1
          },
          "id": 36,
          "interval": null,
          "maxDataPoints": 20,
          "options": {
            "colorMode": "value",
            "graphMode": "area",
            "justifyMode": "auto",
            "orientation": "auto",
            "reduceOptions": {
              "calcs": [
                "max"
              ],
              "fields": "",
              "values": false
            },
            "text": {},
            "textMode": "auto"
          },
          "pluginVersion": "8.1.0",
          "targets": [
            {
              "exemplar": true,
              "expr": "count(count by (cluster_guid) (jrpc.jrpc_server_processing_avg{node_id=\"0\",method=\"status\"}[$precision]))",
              "interval": "",
              "legendFormat": "",
              "refId": "A"
            }
          ],
          "timeFrom": null,
          "timeShift": null,
          "title": "Reporting clusters",
          "transparent": true,
          "type": "stat"
        },
        {
          "collapsed": false,
          "datasource": "Prometheus",
          "gridPos": {
            "h": 1,
            "w": 24,
            "x": 0,
            "y": 6
          },
          "id": 31,
          "panels": [],
          "title": "Weka Home Internals",
          "type": "row"
        },
        {
          "aliasColors": {},
          "bars": false,
          "dashLength": 10,
          "dashes": false,
          "datasource": "Prometheus",
          "fill": 1,
          "fillGradient": 0,
          "gridPos": {
            "h": 5,
            "w": 6,
            "x": 0,
            "y": 7
          },
          "hiddenSeries": false,
          "id": 29,
          "interval": "$precision",
          "legend": {
            "avg": true,
            "current": false,
            "max": false,
            "min": false,
            "show": false,
            "total": false,
            "values": true
          },
          "lines": true,
          "linewidth": 1,
          "nullPointMode": "null",
          "options": {
            "alertThreshold": true
          },
          "percentage": false,
          "pluginVersion": "8.1.0",
          "pointradius": 2,
          "points": false,
          "renderer": "flot",
          "seriesOverrides": [],
          "spaceLength": 10,
          "stack": false,
          "steppedLine": false,
          "targets": [
            {
              "expr": "sum(avg_over_time(wekahome_stats_save_queue_size[$precision]))",
              "interval": "",
              "legendFormat": "15s avg",
              "refId": "A"
            }
          ],
          "thresholds": [],
          "timeFrom": null,
          "timeRegions": [],
          "timeShift": null,
          "title": "Requests in queue",
          "tooltip": {
            "shared": true,
            "sort": 0,
            "value_type": "individual"
          },
          "type": "graph",
          "xaxis": {
            "buckets": null,
            "mode": "time",
            "name": null,
            "show": true,
            "values": []
          },
          "yaxes": [
            {
              "$$hashKey": "object:104",
              "format": "short",
              "label": null,
              "logBase": 1,
              "max": null,
              "min": "0",
              "show": true
            },
            {
              "$$hashKey": "object:105",
              "format": "short",
              "label": null,
              "logBase": 1,
              "max": null,
              "min": null,
              "show": true
            }
          ],
          "yaxis": {
            "align": false,
            "alignLevel": null
          }
        },
        {
          "aliasColors": {},
          "bars": false,
          "dashLength": 10,
          "dashes": false,
          "datasource": "Prometheus",
          "fill": 1,
          "fillGradient": 0,
          "gridPos": {
            "h": 5,
            "w": 6,
            "x": 6,
            "y": 7
          },
          "hiddenSeries": false,
          "id": 2,
          "interval": "$precision",
          "legend": {
            "alignAsTable": true,
            "avg": false,
            "current": false,
            "max": false,
            "min": false,
            "rightSide": true,
            "show": true,
            "total": false,
            "values": false
          },
          "lines": true,
          "linewidth": 1,
          "nullPointMode": "null",
          "options": {
            "alertThreshold": true
          },
          "percentage": false,
          "pluginVersion": "8.1.0",
          "pointradius": 2,
          "points": false,
          "renderer": "flot",
          "seriesOverrides": [],
          "spaceLength": 10,
          "stack": false,
          "steppedLine": false,
          "targets": [
            {
              "expr": "histogram_quantile(0.99, sum(rate(wekahome_stats_semaphore_acquire_duration_bucket[$precision])) by (le))",
              "interval": "",
              "legendFormat": "99%",
              "refId": "A"
            },
            {
              "expr": "histogram_quantile(0.8, sum(rate(wekahome_stats_semaphore_acquire_duration_bucket[$precision])) by (le))",
              "interval": "",
              "legendFormat": "80%",
              "refId": "B"
            },
            {
              "expr": "histogram_quantile(0.5, sum(rate(wekahome_stats_semaphore_acquire_duration_bucket[$precision])) by (le))",
              "interval": "",
              "legendFormat": "50%",
              "refId": "C"
            }
          ],
          "thresholds": [],
          "timeFrom": null,
          "timeRegions": [],
          "timeShift": null,
          "title": "Queue Wait Duration",
          "tooltip": {
            "shared": true,
            "sort": 0,
            "value_type": "individual"
          },
          "type": "graph",
          "xaxis": {
            "buckets": null,
            "mode": "time",
            "name": null,
            "show": true,
            "values": []
          },
          "yaxes": [
            {
              "format": "s",
              "label": null,
              "logBase": 1,
              "max": null,
              "min": null,
              "show": true
            },
            {
              "format": "short",
              "label": null,
              "logBase": 1,
              "max": null,
              "min": null,
              "show": true
            }
          ],
          "yaxis": {
            "align": false,
            "alignLevel": null
          }
        },
        {
          "aliasColors": {},
          "bars": false,
          "dashLength": 10,
          "dashes": false,
          "datasource": "Prometheus",
          "fill": 1,
          "fillGradient": 0,
          "gridPos": {
            "h": 5,
            "w": 6,
            "x": 12,
            "y": 7
          },
          "hiddenSeries": false,
          "id": 32,
          "interval": "$precision",
          "legend": {
            "avg": true,
            "current": false,
            "max": false,
            "min": false,
            "show": false,
            "total": false,
            "values": true
          },
          "lines": true,
          "linewidth": 1,
          "maxDataPoints": 300,
          "nullPointMode": "null",
          "options": {
            "alertThreshold": true
          },
          "percentage": false,
          "pluginVersion": "8.1.0",
          "pointradius": 2,
          "points": false,
          "renderer": "flot",
          "seriesOverrides": [
            {
              "alias": "max",
              "dashes": true,
              "fill": 0
            }
          ],
          "spaceLength": 10,
          "stack": false,
          "steppedLine": false,
          "targets": [
            {
              "expr": "sum(wekahome_stats_current_concurrent_saves)",
              "interval": "",
              "legendFormat": "current",
              "refId": "A"
            },
            {
              "expr": "sum(wekahome_stats_max_concurrent_saves{app_kubernetes_io_name=\"stats-handler\"})",
              "interval": "",
              "legendFormat": "max",
              "refId": "B"
            }
          ],
          "thresholds": [],
          "timeFrom": null,
          "timeRegions": [],
          "timeShift": null,
          "title": "Requests in process",
          "tooltip": {
            "shared": true,
            "sort": 0,
            "value_type": "individual"
          },
          "type": "graph",
          "xaxis": {
            "buckets": null,
            "mode": "time",
            "name": null,
            "show": true,
            "values": []
          },
          "yaxes": [
            {
              "$$hashKey": "object:1315",
              "format": "short",
              "label": null,
              "logBase": 1,
              "max": null,
              "min": null,
              "show": true
            },
            {
              "$$hashKey": "object:1316",
              "format": "short",
              "label": null,
              "logBase": 1,
              "max": null,
              "min": null,
              "show": true
            }
          ],
          "yaxis": {
            "align": false,
            "alignLevel": null
          }
        },
        {
          "aliasColors": {},
          "bars": false,
          "dashLength": 10,
          "dashes": false,
          "datasource": "Prometheus",
          "fill": 1,
          "fillGradient": 0,
          "gridPos": {
            "h": 5,
            "w": 6,
            "x": 18,
            "y": 7
          },
          "hiddenSeries": false,
          "id": 34,
          "interval": "$precision",
          "legend": {
            "alignAsTable": true,
            "avg": true,
            "current": true,
            "max": false,
            "min": false,
            "rightSide": true,
            "show": true,
            "total": false,
            "values": true
          },
          "lines": true,
          "linewidth": 1,
          "nullPointMode": "null",
          "options": {
            "alertThreshold": true
          },
          "percentage": false,
          "pluginVersion": "8.1.0",
          "pointradius": 2,
          "points": false,
          "renderer": "flot",
          "seriesOverrides": [
            {
              "$$hashKey": "object:110",
              "alias": "max",
              "dashes": true,
              "fill": 0
            }
          ],
          "spaceLength": 10,
          "stack": false,
          "steppedLine": false,
          "targets": [
            {
              "expr": "sum(rate(wekahome_stats_processed[$precision])) ",
              "interval": "",
              "legendFormat": "OK",
              "refId": "A"
            },
            {
              "expr": "sum(rate(wekahome_stats_errors[$precision])) ",
              "interval": "",
              "legendFormat": "ERR",
              "refId": "B"
            },
            {
              "expr": "sum(rate(wekahome_stats_queue_timeouts[$precision])) ",
              "interval": "",
              "legendFormat": "TMOUT",
              "refId": "C"
            },
            {
              "expr": "sum(rate(wekahome_stats_malformed[$precision])) ",
              "interval": "",
              "legendFormat": "MLFRMD",
              "refId": "D"
            }
          ],
          "thresholds": [],
          "timeFrom": null,
          "timeRegions": [],
          "timeShift": null,
          "title": "Requests completed",
          "tooltip": {
            "shared": true,
            "sort": 0,
            "value_type": "individual"
          },
          "type": "graph",
          "xaxis": {
            "buckets": null,
            "mode": "time",
            "name": null,
            "show": true,
            "values": []
          },
          "yaxes": [
            {
              "$$hashKey": "object:137",
              "format": "short",
              "label": null,
              "logBase": 1,
              "max": null,
              "min": "0",
              "show": true
            },
            {
              "$$hashKey": "object:138",
              "format": "short",
              "label": null,
              "logBase": 1,
              "max": null,
              "min": null,
              "show": true
            }
          ],
          "yaxis": {
            "align": false,
            "alignLevel": null
          }
        },
        {
          "aliasColors": {},
          "bars": false,
          "dashLength": 10,
          "dashes": false,
          "datasource": "Prometheus",
          "fill": 1,
          "fillGradient": 0,
          "gridPos": {
            "h": 5,
            "w": 6,
            "x": 0,
            "y": 12
          },
          "hiddenSeries": false,
          "id": 6,
          "interval": "$precision",
          "legend": {
            "alignAsTable": true,
            "avg": false,
            "current": false,
            "max": false,
            "min": false,
            "rightSide": true,
            "show": true,
            "total": false,
            "values": false
          },
          "lines": true,
          "linewidth": 1,
          "nullPointMode": "null",
          "options": {
            "alertThreshold": true
          },
          "percentage": false,
          "pluginVersion": "8.1.0",
          "pointradius": 2,
          "points": false,
          "renderer": "flot",
          "seriesOverrides": [],
          "spaceLength": 10,
          "stack": false,
          "steppedLine": false,
          "targets": [
            {
              "expr": "histogram_quantile(0.99, sum(rate(wekahome_stats_msgpack_decode_duration_bucket\n[$precision])) by (le))",
              "interval": "",
              "legendFormat": "99%",
              "refId": "A"
            },
            {
              "expr": "histogram_quantile(0.8, sum(rate(wekahome_stats_msgpack_decode_duration_bucket\n[$precision])) by (le))",
              "interval": "",
              "legendFormat": "80%",
              "refId": "B"
            },
            {
              "expr": "histogram_quantile(0.5, sum(rate(wekahome_stats_msgpack_decode_duration_bucket\n[$precision])) by (le))",
              "interval": "",
              "legendFormat": "50%",
              "refId": "C"
            }
          ],
          "thresholds": [],
          "timeFrom": null,
          "timeRegions": [],
          "timeShift": null,
          "title": "Messagepack Decoding Latency",
          "tooltip": {
            "shared": true,
            "sort": 0,
            "value_type": "individual"
          },
          "type": "graph",
          "xaxis": {
            "buckets": null,
            "mode": "time",
            "name": null,
            "show": true,
            "values": []
          },
          "yaxes": [
            {
              "format": "s",
              "label": null,
              "logBase": 1,
              "max": null,
              "min": null,
              "show": true
            },
            {
              "format": "short",
              "label": null,
              "logBase": 1,
              "max": null,
              "min": null,
              "show": true
            }
          ],
          "yaxis": {
            "align": false,
            "alignLevel": null
          }
        },
        {
          "aliasColors": {},
          "bars": false,
          "dashLength": 10,
          "dashes": false,
          "datasource": "Prometheus",
          "fill": 1,
          "fillGradient": 0,
          "gridPos": {
            "h": 5,
            "w": 6,
            "x": 6,
            "y": 12
          },
          "hiddenSeries": false,
          "id": 14,
          "interval": "$precision",
          "legend": {
            "avg": false,
            "current": false,
            "max": false,
            "min": false,
            "show": false,
            "total": false,
            "values": false
          },
          "lines": true,
          "linewidth": 1,
          "nullPointMode": "null",
          "options": {
            "alertThreshold": true
          },
          "percentage": false,
          "pluginVersion": "8.1.0",
          "pointradius": 2,
          "points": false,
          "renderer": "flot",
          "seriesOverrides": [],
          "spaceLength": 10,
          "stack": false,
          "steppedLine": false,
          "targets": [
            {
              "expr": "sum(rate(wekahome_stats_msgpack_size_sum[$precision]))",
              "interval": "",
              "legendFormat": "",
              "refId": "A"
            }
          ],
          "thresholds": [],
          "timeFrom": null,
          "timeRegions": [],
          "timeShift": null,
          "title": "MessagePack Throughtput",
          "tooltip": {
            "shared": true,
            "sort": 0,
            "value_type": "individual"
          },
          "type": "graph",
          "xaxis": {
            "buckets": null,
            "mode": "time",
            "name": null,
            "show": true,
            "values": []
          },
          "yaxes": [
            {
              "format": "Bps",
              "label": null,
              "logBase": 1,
              "max": null,
              "min": "0",
              "show": true
            },
            {
              "format": "short",
              "label": null,
              "logBase": 1,
              "max": null,
              "min": null,
              "show": true
            }
          ],
          "yaxis": {
            "align": false,
            "alignLevel": null
          }
        },
        {
          "aliasColors": {},
          "bars": false,
          "dashLength": 10,
          "dashes": false,
          "datasource": "Prometheus",
          "fill": 1,
          "fillGradient": 0,
          "gridPos": {
            "h": 5,
            "w": 6,
            "x": 12,
            "y": 12
          },
          "hiddenSeries": false,
          "id": 4,
          "interval": "$precision",
          "legend": {
            "alignAsTable": true,
            "avg": false,
            "current": false,
            "max": false,
            "min": false,
            "rightSide": true,
            "show": true,
            "total": false,
            "values": false
          },
          "lines": true,
          "linewidth": 1,
          "nullPointMode": "null",
          "options": {
            "alertThreshold": true
          },
          "percentage": false,
          "pluginVersion": "8.1.0",
          "pointradius": 2,
          "points": false,
          "renderer": "flot",
          "seriesOverrides": [],
          "spaceLength": 10,
          "stack": false,
          "steppedLine": false,
          "targets": [
            {
              "expr": "histogram_quantile(0.99, sum(rate(wekahome_stats_ingest_duration_bucket[$precision])) by (le))",
              "interval": "",
              "legendFormat": "99%",
              "refId": "A"
            },
            {
              "exemplar": true,
              "expr": "histogram_quantile(0.8, sum(rate(wekahome_stats_ingest_duration_bucket[$precision])) by (le))",
              "interval": "",
              "legendFormat": "80%",
              "refId": "B"
            },
            {
              "expr": "histogram_quantile(0.5, sum(rate(wekahome_stats_ingest_duration_bucket[$precision])) by (le))",
              "interval": "",
              "legendFormat": "50%",
              "refId": "C"
            }
          ],
          "thresholds": [],
          "timeFrom": null,
          "timeRegions": [],
          "timeShift": null,
          "title": "VictoriaDB Ingestion Latency",
          "tooltip": {
            "shared": true,
            "sort": 0,
            "value_type": "individual"
          },
          "type": "graph",
          "xaxis": {
            "buckets": null,
            "mode": "time",
            "name": null,
            "show": true,
            "values": []
          },
          "yaxes": [
            {
              "$$hashKey": "object:997",
              "format": "s",
              "label": null,
              "logBase": 1,
              "max": null,
              "min": null,
              "show": true
            },
            {
              "$$hashKey": "object:998",
              "format": "short",
              "label": null,
              "logBase": 1,
              "max": null,
              "min": null,
              "show": true
            }
          ],
          "yaxis": {
            "align": false,
            "alignLevel": null
          }
        },
        {
          "aliasColors": {},
          "bars": false,
          "dashLength": 10,
          "dashes": false,
          "datasource": "Prometheus",
          "fill": 1,
          "fillGradient": 0,
          "gridPos": {
            "h": 5,
            "w": 6,
            "x": 18,
            "y": 12
          },
          "hiddenSeries": false,
          "id": 15,
          "interval": "$precision",
          "legend": {
            "alignAsTable": true,
            "avg": true,
            "current": true,
            "hideZero": false,
            "max": true,
            "min": false,
            "rightSide": false,
            "show": false,
            "total": false,
            "values": true
          },
          "lines": true,
          "linewidth": 1,
          "nullPointMode": "null",
          "options": {
            "alertThreshold": true
          },
          "percentage": false,
          "pluginVersion": "8.1.0",
          "pointradius": 2,
          "points": false,
          "renderer": "flot",
          "seriesOverrides": [],
          "spaceLength": 10,
          "stack": false,
          "steppedLine": false,
          "targets": [
            {
              "exemplar": true,
              "expr": "sum(rate(wekahome_stats_ingest_size_sum[$precision]))",
              "interval": "",
              "legendFormat": "Rate",
              "refId": "A"
            }
          ],
          "thresholds": [],
          "timeFrom": null,
          "timeRegions": [],
          "timeShift": null,
          "title": "MetricsQL Throughput",
          "tooltip": {
            "shared": true,
            "sort": 0,
            "value_type": "individual"
          },
          "type": "graph",
          "xaxis": {
            "buckets": null,
            "mode": "time",
            "name": null,
            "show": true,
            "values": []
          },
          "yaxes": [
            {
              "$$hashKey": "object:247",
              "format": "Bps",
              "label": null,
              "logBase": 1,
              "max": null,
              "min": "0",
              "show": true
            },
            {
              "$$hashKey": "object:248",
              "format": "short",
              "label": null,
              "logBase": 1,
              "max": null,
              "min": null,
              "show": true
            }
          ],
          "yaxis": {
            "align": false,
            "alignLevel": null
          }
        },
        {
          "collapsed": false,
          "datasource": "Prometheus",
          "gridPos": {
            "h": 1,
            "w": 24,
            "x": 0,
            "y": 17
          },
          "id": 25,
          "panels": [],
          "title": "VictoriaMetrics",
          "type": "row"
        },
        {
          "datasource": "Prometheus",
          "fieldConfig": {
            "defaults": {
              "mappings": [],
              "min": 0,
              "thresholds": {
                "mode": "absolute",
                "steps": [
                  {
                    "color": "green",
                    "value": null
                  },
                  {
                    "color": "red",
                    "value": 80
                  }
                ]
              }
            },
            "overrides": []
          },
          "gridPos": {
            "h": 5,
            "w": 6,
            "x": 0,
            "y": 18
          },
          "id": 17,
          "options": {
            "colorMode": "value",
            "graphMode": "area",
            "justifyMode": "auto",
            "orientation": "auto",
            "reduceOptions": {
              "calcs": [
                "lastNotNull"
              ],
              "fields": "",
              "values": false
            },
            "text": {},
            "textMode": "auto"
          },
          "pluginVersion": "8.1.0",
          "targets": [
            {
              "expr": "count(count by (kubernetes_pod_name) (wekahome_stats_save_duration_count))",
              "interval": "",
              "legendFormat": "stats-handler",
              "refId": "A"
            },
            {
              "exemplar": true,
              "expr": "count(count by (kubernetes_pod_name) (vminsert_request_duration_seconds_bucket))",
              "interval": "",
              "legendFormat": "vminsert",
              "refId": "B"
            },
            {
              "exemplar": true,
              "expr": "count(count by (kubernetes_pod_name) (vmselect_request_duration_seconds_bucket))",
              "interval": "",
              "legendFormat": "vmselect",
              "refId": "C"
            },
            {
              "expr": "count(count by (kubernetes_pod_name) (vm_active_force_merges))",
              "interval": "",
              "legendFormat": "vmstorage",
              "refId": "D"
            }
          ],
          "timeFrom": null,
          "timeShift": null,
          "title": "Stats handler nodes",
          "type": "stat"
        },
        {
          "aliasColors": {},
          "bars": false,
          "dashLength": 10,
          "dashes": false,
          "datasource": "Prometheus",
          "fill": 1,
          "fillGradient": 0,
          "gridPos": {
            "h": 5,
            "w": 3,
            "x": 6,
            "y": 18
          },
          "hiddenSeries": false,
          "id": 22,
          "interval": "$precision",
          "legend": {
            "avg": false,
            "current": false,
            "max": false,
            "min": false,
            "show": false,
            "total": false,
            "values": false
          },
          "lines": true,
          "linewidth": 1,
          "nullPointMode": "null",
          "options": {
            "alertThreshold": true
          },
          "percentage": false,
          "pluginVersion": "8.1.0",
          "pointradius": 2,
          "points": false,
          "renderer": "flot",
          "seriesOverrides": [],
          "spaceLength": 10,
          "stack": false,
          "steppedLine": false,
          "targets": [
            {
              "expr": "sum(vm_new_timeseries_created_total)",
              "instant": false,
              "interval": "",
              "legendFormat": "",
              "refId": "A"
            }
          ],
          "thresholds": [],
          "timeFrom": null,
          "timeRegions": [],
          "timeShift": null,
          "title": "Total unique series",
          "tooltip": {
            "shared": true,
            "sort": 0,
            "value_type": "individual"
          },
          "type": "graph",
          "xaxis": {
            "buckets": null,
            "mode": "time",
            "name": null,
            "show": true,
            "values": []
          },
          "yaxes": [
            {
              "format": "short",
              "label": null,
              "logBase": 1,
              "max": null,
              "min": "0",
              "show": true
            },
            {
              "format": "short",
              "label": null,
              "logBase": 1,
              "max": null,
              "min": null,
              "show": true
            }
          ],
          "yaxis": {
            "align": false,
            "alignLevel": null
          }
        },
        {
          "aliasColors": {},
          "bars": false,
          "dashLength": 10,
          "dashes": false,
          "datasource": "Prometheus",
          "fill": 1,
          "fillGradient": 0,
          "gridPos": {
            "h": 5,
            "w": 4,
            "x": 9,
            "y": 18
          },
          "hiddenSeries": false,
          "id": 23,
          "interval": "$precision",
          "legend": {
            "avg": false,
            "current": false,
            "max": false,
            "min": false,
            "show": false,
            "total": false,
            "values": false
          },
          "lines": true,
          "linewidth": 1,
          "nullPointMode": "null",
          "options": {
            "alertThreshold": true
          },
          "percentage": false,
          "pluginVersion": "8.1.0",
          "pointradius": 2,
          "points": false,
          "renderer": "flot",
          "seriesOverrides": [],
          "spaceLength": 10,
          "stack": false,
          "steppedLine": false,
          "targets": [
            {
              "expr": "sum(rate(vm_new_timeseries_created_total[1h]))",
              "instant": false,
              "interval": "",
              "legendFormat": "",
              "refId": "A"
            }
          ],
          "thresholds": [],
          "timeFrom": null,
          "timeRegions": [],
          "timeShift": null,
          "title": "New series created/hour",
          "tooltip": {
            "shared": true,
            "sort": 0,
            "value_type": "individual"
          },
          "type": "graph",
          "xaxis": {
            "buckets": null,
            "mode": "time",
            "name": null,
            "show": true,
            "values": []
          },
          "yaxes": [
            {
              "$$hashKey": "object:186",
              "format": "short",
              "label": null,
              "logBase": 1,
              "max": null,
              "min": "0",
              "show": true
            },
            {
              "$$hashKey": "object:187",
              "format": "short",
              "label": null,
              "logBase": 1,
              "max": null,
              "min": null,
              "show": true
            }
          ],
          "yaxis": {
            "align": false,
            "alignLevel": null
          }
        },
        {
          "datasource": "Prometheus",
          "fieldConfig": {
            "defaults": {
              "color": {
                "mode": "thresholds"
              },
              "decimals": 0,
              "mappings": [],
              "max": 1,
              "min": 0,
              "thresholds": {
                "mode": "percentage",
                "steps": [
                  {
                    "color": "green",
                    "value": null
                  },
                  {
                    "color": "yellow",
                    "value": 75
                  },
                  {
                    "color": "red",
                    "value": 85
                  },
                  {
                    "color": "dark-red",
                    "value": 95
                  }
                ]
              },
              "unit": "percentunit"
            },
            "overrides": []
          },
          "gridPos": {
            "h": 5,
            "w": 5,
            "x": 13,
            "y": 18
          },
          "id": 19,
          "options": {
            "orientation": "horizontal",
            "reduceOptions": {
              "calcs": [
                "lastNotNull"
              ],
              "fields": "",
              "values": false
            },
            "showThresholdLabels": false,
            "showThresholdMarkers": true,
            "text": {}
          },
          "pluginVersion": "8.1.0",
          "targets": [
            {
              "expr": "label_replace(sum by(kubernetes_pod_name)(vm_data_size_bytes) / ( sum by(kubernetes_pod_name)(vm_data_size_bytes) + sum by(kubernetes_pod_name)(vm_free_disk_space_bytes)), \"storage_node\", \"vmstorage-$1\", \"kubernetes_pod_name\", \".*-([0-9]*)$\") ",
              "interval": "",
              "legendFormat": "{{storage_node}}",
              "refId": "A"
            }
          ],
          "timeFrom": null,
          "timeShift": null,
          "title": "vmstorage space usage",
          "type": "gauge"
        },
        {
          "aliasColors": {},
          "bars": false,
          "dashLength": 10,
          "dashes": false,
          "datasource": "Prometheus",
          "decimals": 0,
          "fieldConfig": {
            "defaults": {
              "unit": "percentunit"
            },
            "overrides": []
          },
          "fill": 1,
          "fillGradient": 0,
          "gridPos": {
            "h": 5,
            "w": 6,
            "x": 18,
            "y": 18
          },
          "hiddenSeries": false,
          "id": 20,
          "interval": "5m",
          "legend": {
            "alignAsTable": true,
            "avg": false,
            "current": true,
            "max": false,
            "min": false,
            "rightSide": true,
            "show": true,
            "total": false,
            "values": true
          },
          "lines": true,
          "linewidth": 1,
          "nullPointMode": "null",
          "options": {
            "alertThreshold": true
          },
          "percentage": false,
          "pluginVersion": "8.1.0",
          "pointradius": 2,
          "points": false,
          "renderer": "flot",
          "seriesOverrides": [],
          "spaceLength": 10,
          "stack": false,
          "steppedLine": false,
          "targets": [
            {
              "expr": "label_replace(sum by(kubernetes_pod_name)(vm_data_size_bytes) / ( sum by(kubernetes_pod_name)(vm_data_size_bytes) + sum by(kubernetes_pod_name)(vm_free_disk_space_bytes)), \"storage_node\", \"vmstorage-$1\", \"kubernetes_pod_name\", \".*-([0-9]*)$\") ",
              "interval": "",
              "legendFormat": "{{storage_node}}",
              "refId": "A"
            }
          ],
          "thresholds": [],
          "timeFrom": null,
          "timeRegions": [],
          "timeShift": null,
          "title": "vmstorage space usage",
          "tooltip": {
            "shared": true,
            "sort": 2,
            "value_type": "individual"
          },
          "type": "graph",
          "xaxis": {
            "buckets": null,
            "mode": "time",
            "name": null,
            "show": true,
            "values": []
          },
          "yaxes": [
            {
              "$$hashKey": "object:245",
              "decimals": null,
              "format": "percentunit",
              "label": "",
              "logBase": 1,
              "max": "1",
              "min": "0",
              "show": true
            },
            {
              "$$hashKey": "object:246",
              "format": "short",
              "label": null,
              "logBase": 1,
              "max": null,
              "min": null,
              "show": true
            }
          ],
          "yaxis": {
            "align": false,
            "alignLevel": null
          }
        }
      ],
      "refresh": "",
      "schemaVersion": 30,
      "style": "dark",
      "tags": [],
      "templating": {
        "list": [
          {
            "allValue": null,
            "current": {
              "selected": true,
              "text": "5m",
              "value": "5m"
            },
            "description": null,
            "error": null,
            "hide": 0,
            "includeAll": false,
            "label": "Precision",
            "multi": false,
            "name": "precision",
            "options": [
              {
                "selected": false,
                "text": "30s",
                "value": "30s"
              },
              {
                "selected": false,
                "text": "1m",
                "value": "1m"
              },
              {
                "selected": true,
                "text": "5m",
                "value": "5m"
              },
              {
                "selected": false,
                "text": "15m",
                "value": "15m"
              },
              {
                "selected": false,
                "text": "1h",
                "value": "1h"
              }
            ],
            "query": "30s, 1m, 5m, 15m, 1h",
            "queryValue": "",
            "skipUrlSync": false,
            "type": "custom"
          }
        ]
      },
      "time": {
        "from": "now-1h",
        "to": "now"
      },
      "timepicker": {
        "refresh_intervals": [
          "1m",
          "5m",
          "15m",
          "30m",
          "1h",
          "2h",
          "1d"
        ]
      },
      "timezone": "",
      "title": "Wekahome stats handler",
      "version": 18
    }
---
# Source: home-weka-io/templates/grafana-dashboard-provider.yaml
apiVersion: v1
kind: ConfigMap
metadata:
  name: grafana-dashboard-provider
data:
  default-provider.yaml: |-
    apiVersion: 1
    providers:
    - name: 'default-provider'
      orgId: 1
      folder: "Weka Presets"
      folderUid: ''
      type: file
      disableDeletion: false
      allowUiUpdates: true
      updateIntervalSeconds: 10
      options:
        path: /opt/bitnami/grafana/dashboards
---
# Source: home-weka-io/charts/grafana/templates/pvc.yaml
kind: PersistentVolumeClaim
apiVersion: v1
metadata:
  name: homewekaio-grafana
  namespace: home-weka-io
  labels:
    app.kubernetes.io/name: grafana
    helm.sh/chart: grafana-7.6.1
    app.kubernetes.io/instance: homewekaio
    app.kubernetes.io/managed-by: Helm
    app.group: common
    app.kubernetes.io/component: grafana
spec:
  accessModes:
    - "ReadWriteOnce"
  resources:
    requests:
      storage: "10Gi"
  storageClassName: local-path
---
# Source: home-weka-io/charts/prometheus/templates/alertmanager/pvc.yaml
apiVersion: v1
kind: PersistentVolumeClaim
metadata:
  labels:
    component: "alertmanager"
    app: prometheus
    release: homewekaio
    chart: prometheus-15.8.6
    heritage: Helm
  name: homewekaio-prometheus-alertmanager
  namespace: home-weka-io
spec:
  accessModes:
    - ReadWriteOnce
  storageClassName: "local-path"
  resources:
    requests:
      storage: "2Gi"
---
# Source: home-weka-io/charts/prometheus/templates/server/pvc.yaml
apiVersion: v1
kind: PersistentVolumeClaim
metadata:
  labels:
    component: "server"
    app: prometheus
    release: homewekaio
    chart: prometheus-15.8.6
    heritage: Helm
  name: homewekaio-prometheus-server
  namespace: home-weka-io
spec:
  accessModes:
    - ReadWriteOnce
  storageClassName: "local-path"
  resources:
    requests:
      storage: "8Gi"
---
# Source: home-weka-io/templates/api-diags-handler-pvc.yaml
kind: PersistentVolumeClaim
apiVersion: v1
metadata:
  name: diags-handler-pvc
  labels:
    app: diags-handler-pvc
    app.kubernetes.io/name: diags-handler-pvc
spec:
  accessModes:
    - ReadWriteOnce
  resources:
    requests:
      storage: "15Gi"
  storageClassName: local-path
---
# Source: home-weka-io/charts/prometheus/charts/kube-state-metrics/templates/role.yaml
apiVersion: rbac.authorization.k8s.io/v1
kind: ClusterRole
metadata:
  labels:    
    helm.sh/chart: kube-state-metrics-4.7.0
    app.kubernetes.io/managed-by: Helm
    app.kubernetes.io/component: metrics
    app.kubernetes.io/part-of: kube-state-metrics
    app.kubernetes.io/name: kube-state-metrics
    app.kubernetes.io/instance: homewekaio
    app.kubernetes.io/version: "2.4.1"
  name: homewekaio-kube-state-metrics
rules:

- apiGroups: ["certificates.k8s.io"]
  resources:
  - certificatesigningrequests
  verbs: ["list", "watch"]

- apiGroups: [""]
  resources:
  - configmaps
  verbs: ["list", "watch"]

- apiGroups: ["batch"]
  resources:
  - cronjobs
  verbs: ["list", "watch"]

- apiGroups: ["extensions", "apps"]
  resources:
  - daemonsets
  verbs: ["list", "watch"]

- apiGroups: ["extensions", "apps"]
  resources:
  - deployments
  verbs: ["list", "watch"]

- apiGroups: [""]
  resources:
  - endpoints
  verbs: ["list", "watch"]

- apiGroups: ["autoscaling"]
  resources:
  - horizontalpodautoscalers
  verbs: ["list", "watch"]

- apiGroups: ["extensions", "networking.k8s.io"]
  resources:
  - ingresses
  verbs: ["list", "watch"]

- apiGroups: ["batch"]
  resources:
  - jobs
  verbs: ["list", "watch"]

- apiGroups: [""]
  resources:
  - limitranges
  verbs: ["list", "watch"]

- apiGroups: ["admissionregistration.k8s.io"]
  resources:
    - mutatingwebhookconfigurations
  verbs: ["list", "watch"]

- apiGroups: [""]
  resources:
  - namespaces
  verbs: ["list", "watch"]

- apiGroups: ["networking.k8s.io"]
  resources:
  - networkpolicies
  verbs: ["list", "watch"]

- apiGroups: [""]
  resources:
  - nodes
  verbs: ["list", "watch"]

- apiGroups: [""]
  resources:
  - persistentvolumeclaims
  verbs: ["list", "watch"]

- apiGroups: [""]
  resources:
  - persistentvolumes
  verbs: ["list", "watch"]

- apiGroups: ["policy"]
  resources:
    - poddisruptionbudgets
  verbs: ["list", "watch"]

- apiGroups: [""]
  resources:
  - pods
  verbs: ["list", "watch"]

- apiGroups: ["extensions", "apps"]
  resources:
  - replicasets
  verbs: ["list", "watch"]

- apiGroups: [""]
  resources:
  - replicationcontrollers
  verbs: ["list", "watch"]

- apiGroups: [""]
  resources:
  - resourcequotas
  verbs: ["list", "watch"]

- apiGroups: [""]
  resources:
  - secrets
  verbs: ["list", "watch"]

- apiGroups: [""]
  resources:
  - services
  verbs: ["list", "watch"]

- apiGroups: ["apps"]
  resources:
  - statefulsets
  verbs: ["list", "watch"]

- apiGroups: ["storage.k8s.io"]
  resources:
    - storageclasses
  verbs: ["list", "watch"]

- apiGroups: ["admissionregistration.k8s.io"]
  resources:
    - validatingwebhookconfigurations
  verbs: ["list", "watch"]

- apiGroups: ["storage.k8s.io"]
  resources:
    - volumeattachments
  verbs: ["list", "watch"]
---
# Source: home-weka-io/charts/prometheus/templates/alertmanager/clusterrole.yaml
apiVersion: rbac.authorization.k8s.io/v1
kind: ClusterRole
metadata:
  labels:
    component: "alertmanager"
    app: prometheus
    release: homewekaio
    chart: prometheus-15.8.6
    heritage: Helm
  name: homewekaio-prometheus-alertmanager
rules:
  []
---
# Source: home-weka-io/charts/prometheus/templates/pushgateway/clusterrole.yaml
apiVersion: rbac.authorization.k8s.io/v1
kind: ClusterRole
metadata:
  labels:
    component: "pushgateway"
    app: prometheus
    release: homewekaio
    chart: prometheus-15.8.6
    heritage: Helm
  name: homewekaio-prometheus-pushgateway
rules:
  []
---
# Source: home-weka-io/charts/prometheus/templates/server/clusterrole.yaml
apiVersion: rbac.authorization.k8s.io/v1
kind: ClusterRole
metadata:
  labels:
    component: "server"
    app: prometheus
    release: homewekaio
    chart: prometheus-15.8.6
    heritage: Helm
  name: homewekaio-prometheus-server
rules:
  - apiGroups:
      - ""
    resources:
      - nodes
      - nodes/proxy
      - nodes/metrics
      - services
      - endpoints
      - pods
      - ingresses
      - configmaps
    verbs:
      - get
      - list
      - watch
  - apiGroups:
      - "extensions"
      - "networking.k8s.io"
    resources:
      - ingresses/status
      - ingresses
    verbs:
      - get
      - list
      - watch
  - nonResourceURLs:
      - "/metrics"
    verbs:
      - get
---
# Source: home-weka-io/charts/statsdb/templates/clusterrole.yaml
kind: ClusterRole
apiVersion: rbac.authorization.k8s.io/v1
metadata:
  name: homewekaio-statsdb-clusterrole
  namespace: home-weka-io
  labels:
    helm.sh/chart: statsdb-0.9.1
    app.kubernetes.io/managed-by: Helm
rules:
  - apiGroups:      ['extensions']
    resources:      ['podsecuritypolicies']
    verbs:          ['use']
    resourceNames:  [homewekaio-statsdb]
---
# Source: home-weka-io/charts/prometheus/charts/kube-state-metrics/templates/clusterrolebinding.yaml
apiVersion: rbac.authorization.k8s.io/v1
kind: ClusterRoleBinding
metadata:
  labels:    
    helm.sh/chart: kube-state-metrics-4.7.0
    app.kubernetes.io/managed-by: Helm
    app.kubernetes.io/component: metrics
    app.kubernetes.io/part-of: kube-state-metrics
    app.kubernetes.io/name: kube-state-metrics
    app.kubernetes.io/instance: homewekaio
    app.kubernetes.io/version: "2.4.1"
  name: homewekaio-kube-state-metrics
roleRef:
  apiGroup: rbac.authorization.k8s.io
  kind: ClusterRole
  name: homewekaio-kube-state-metrics
subjects:
- kind: ServiceAccount
  name: homewekaio-kube-state-metrics
  namespace: home-weka-io
---
# Source: home-weka-io/charts/prometheus/templates/alertmanager/clusterrolebinding.yaml
apiVersion: rbac.authorization.k8s.io/v1
kind: ClusterRoleBinding
metadata:
  labels:
    component: "alertmanager"
    app: prometheus
    release: homewekaio
    chart: prometheus-15.8.6
    heritage: Helm
  name: homewekaio-prometheus-alertmanager
subjects:
  - kind: ServiceAccount
    name: homewekaio-prometheus-alertmanager
    namespace: home-weka-io
roleRef:
  apiGroup: rbac.authorization.k8s.io
  kind: ClusterRole
  name: homewekaio-prometheus-alertmanager
---
# Source: home-weka-io/charts/prometheus/templates/pushgateway/clusterrolebinding.yaml
apiVersion: rbac.authorization.k8s.io/v1
kind: ClusterRoleBinding
metadata:
  labels:
    component: "pushgateway"
    app: prometheus
    release: homewekaio
    chart: prometheus-15.8.6
    heritage: Helm
  name: homewekaio-prometheus-pushgateway
subjects:
  - kind: ServiceAccount
    name: homewekaio-prometheus-pushgateway
    namespace: home-weka-io
roleRef:
  apiGroup: rbac.authorization.k8s.io
  kind: ClusterRole
  name: homewekaio-prometheus-pushgateway
---
# Source: home-weka-io/charts/prometheus/templates/server/clusterrolebinding.yaml
apiVersion: rbac.authorization.k8s.io/v1
kind: ClusterRoleBinding
metadata:
  labels:
    component: "server"
    app: prometheus
    release: homewekaio
    chart: prometheus-15.8.6
    heritage: Helm
  name: homewekaio-prometheus-server
subjects:
  - kind: ServiceAccount
    name: homewekaio-prometheus-server
    namespace: home-weka-io
roleRef:
  apiGroup: rbac.authorization.k8s.io
  kind: ClusterRole
  name: homewekaio-prometheus-server
---
# Source: home-weka-io/charts/statsdb/templates/clusterrolebinding.yaml
kind: ClusterRoleBinding
apiVersion: rbac.authorization.k8s.io/v1
metadata:
  name: homewekaio-statsdb-clusterrolebinding
  namespace: home-weka-io
  labels:
    helm.sh/chart: statsdb-0.9.1
    app.kubernetes.io/managed-by: Helm
subjects:
  - kind: ServiceAccount
    name: homewekaio-statsdb
    namespace: home-weka-io
roleRef:
  kind: ClusterRole
  name: homewekaio-statsdb-clusterrole
  apiGroup: rbac.authorization.k8s.io
---
# Source: home-weka-io/charts/nack/templates/rbac-jetstream-controller.yml
apiVersion: rbac.authorization.k8s.io/v1
kind: Role
metadata:
  name: jetstream-controller-role
  namespace: home-weka-io
rules:
- apiGroups:
  - ''
  resources:
  - events
  verbs:
  - create
  - update
  - patch
- apiGroups:
  - ''
  resources:
  - secrets
  verbs:
  - get
  - watch
  - list
- apiGroups:
  - jetstream.nats.io
  resources:
  - streams
  - streams/status
  - consumers
  - consumers/status
  - streamtemplates
  - streamtemplates/status
  - accounts
  verbs:
  - create
  - get
  - list
  - watch
  - patch
  - update
  - delete
---
# Source: home-weka-io/charts/statsdb/templates/role.yaml
apiVersion: rbac.authorization.k8s.io/v1
kind: Role
metadata:
  name: homewekaio-statsdb
  namespace: home-weka-io
  labels:
    helm.sh/chart: statsdb-0.9.1
    app.kubernetes.io/managed-by: Helm
rules:
- apiGroups:      ['extensions']
  resources:      ['podsecuritypolicies']
  verbs:          ['use']
  resourceNames:  [homewekaio-statsdb]
---
# Source: home-weka-io/templates/serviceaccount.yaml
kind: Role
apiVersion: rbac.authorization.k8s.io/v1
metadata:
  name: home-weka-io.role
  namespace: home-weka-io
rules:
  - apiGroups:
      - "batch"
    resources:
      - jobs
    verbs:
      - get
      - list
      - watch
---
# Source: home-weka-io/charts/nack/templates/rbac-jetstream-controller.yml
apiVersion: rbac.authorization.k8s.io/v1
kind: RoleBinding
metadata:
  name: jetstream-controller-role-binding
  namespace: home-weka-io
subjects:
- kind: ServiceAccount
  name: jetstream-controller
  namespace: home-weka-io
roleRef:
  kind: Role
  name: jetstream-controller-role
  apiGroup: rbac.authorization.k8s.io
---
# Source: home-weka-io/charts/statsdb/templates/rolebinding.yaml
apiVersion: rbac.authorization.k8s.io/v1
kind: RoleBinding
metadata:
  name: homewekaio-statsdb
  namespace: home-weka-io
  labels:
    helm.sh/chart: statsdb-0.9.1
    app.kubernetes.io/managed-by: Helm
roleRef:
  apiGroup: rbac.authorization.k8s.io
  kind: Role
  name: homewekaio-statsdb
subjects:
- kind: ServiceAccount
  name: homewekaio-statsdb
  namespace: home-weka-io
---
# Source: home-weka-io/templates/serviceaccount.yaml
kind: RoleBinding
apiVersion: rbac.authorization.k8s.io/v1
metadata:
  name: home-weka-io.role-binding
  namespace: home-weka-io
subjects:
  - kind: ServiceAccount
    name: home-weka-io-serviceaccount
    namespace: home-weka-io
roleRef:
  apiGroup: rbac.authorization.k8s.io
  kind: Role
  name: home-weka-io.role
---
# Source: home-weka-io/charts/event_db_0/templates/metrics-svc.yaml
apiVersion: v1
kind: Service
metadata:
  name: homewekaio-event-db-0-metrics
  labels:
    app.kubernetes.io/name: event-db-0
    helm.sh/chart: event_db_0-10.14.3
    app.kubernetes.io/instance: homewekaio
    app.kubernetes.io/managed-by: Helm
    app.group: common
  annotations:
    prometheus.io/port: "9187"
    prometheus.io/scrape: "true"
  namespace: home-weka-io
spec:
  type: ClusterIP
  ports:
    - name: http-metrics
      port: 9187
      targetPort: http-metrics
  selector:
    app.kubernetes.io/name: event-db-0
    app.kubernetes.io/instance: homewekaio
    role: primary
---
# Source: home-weka-io/charts/event_db_0/templates/svc-headless.yaml
apiVersion: v1
kind: Service
metadata:
  name: homewekaio-event-db-0-headless
  labels:
    app.kubernetes.io/name: event-db-0
    helm.sh/chart: event_db_0-10.14.3
    app.kubernetes.io/instance: homewekaio
    app.kubernetes.io/managed-by: Helm
    app.group: common
    # Use this annotation in addition to the actual publishNotReadyAddresses
    # field below because the annotation will stop being respected soon but the
    # field is broken in some versions of Kubernetes:
    # https://github.com/kubernetes/kubernetes/issues/58662
    service.alpha.kubernetes.io/tolerate-unready-endpoints: "true"
  namespace: home-weka-io
spec:
  type: ClusterIP
  clusterIP: None
  # We want all pods in the StatefulSet to have their addresses published for
  # the sake of the other Postgresql pods even before they're ready, since they
  # have to be able to talk to each other in order to become ready.
  publishNotReadyAddresses: true
  ports:
    - name: tcp-postgresql
      port: 5432
      targetPort: tcp-postgresql
  selector:
    app.kubernetes.io/name: event-db-0
    app.kubernetes.io/instance: homewekaio
---
# Source: home-weka-io/charts/event_db_0/templates/svc.yaml
apiVersion: v1
kind: Service
metadata:
  name: homewekaio-event-db-0
  labels:
    app.kubernetes.io/name: event-db-0
    helm.sh/chart: event_db_0-10.14.3
    app.kubernetes.io/instance: homewekaio
    app.kubernetes.io/managed-by: Helm
    app.group: common
  annotations:
  namespace: home-weka-io
spec:
  type: ClusterIP
  ports:
    - name: tcp-postgresql
      port: 5432
      targetPort: tcp-postgresql
  selector:
    app.kubernetes.io/name: event-db-0
    app.kubernetes.io/instance: homewekaio
    role: primary
---
# Source: home-weka-io/charts/grafana/templates/service.yaml
apiVersion: v1
kind: Service
metadata:
  name: homewekaio-grafana
  namespace: home-weka-io
  labels:
    app.kubernetes.io/name: grafana
    helm.sh/chart: grafana-7.6.1
    app.kubernetes.io/instance: homewekaio
    app.kubernetes.io/managed-by: Helm
    app.group: common
    app.kubernetes.io/component: grafana
  annotations:
    prometheus.io/path: /metrics
    prometheus.io/port: "3000"
    prometheus.io/scrape: "true"
spec:
  type: NodePort
  externalTrafficPolicy: "Cluster"
  ports:
    - port: 3000
      targetPort: dashboard
      protocol: TCP
      name: http
  selector:
    app.kubernetes.io/name: grafana
    app.kubernetes.io/instance: homewekaio
    app.kubernetes.io/component: grafana
---
# Source: home-weka-io/charts/main_db/templates/metrics-svc.yaml
apiVersion: v1
kind: Service
metadata:
  name: homewekaio-main-db-metrics
  labels:
    app.kubernetes.io/name: main-db
    helm.sh/chart: main_db-10.14.3
    app.kubernetes.io/instance: homewekaio
    app.kubernetes.io/managed-by: Helm
    app.group: common
  annotations:
    prometheus.io/port: "9187"
    prometheus.io/scrape: "true"
  namespace: home-weka-io
spec:
  type: ClusterIP
  ports:
    - name: http-metrics
      port: 9187
      targetPort: http-metrics
  selector:
    app.kubernetes.io/name: main-db
    app.kubernetes.io/instance: homewekaio
    role: primary
---
# Source: home-weka-io/charts/main_db/templates/svc-headless.yaml
apiVersion: v1
kind: Service
metadata:
  name: homewekaio-main-db-headless
  labels:
    app.kubernetes.io/name: main-db
    helm.sh/chart: main_db-10.14.3
    app.kubernetes.io/instance: homewekaio
    app.kubernetes.io/managed-by: Helm
    app.group: common
    # Use this annotation in addition to the actual publishNotReadyAddresses
    # field below because the annotation will stop being respected soon but the
    # field is broken in some versions of Kubernetes:
    # https://github.com/kubernetes/kubernetes/issues/58662
    service.alpha.kubernetes.io/tolerate-unready-endpoints: "true"
  namespace: home-weka-io
spec:
  type: ClusterIP
  clusterIP: None
  # We want all pods in the StatefulSet to have their addresses published for
  # the sake of the other Postgresql pods even before they're ready, since they
  # have to be able to talk to each other in order to become ready.
  publishNotReadyAddresses: true
  ports:
    - name: tcp-postgresql
      port: 5432
      targetPort: tcp-postgresql
  selector:
    app.kubernetes.io/name: main-db
    app.kubernetes.io/instance: homewekaio
---
# Source: home-weka-io/charts/main_db/templates/svc.yaml
apiVersion: v1
kind: Service
metadata:
  name: homewekaio-main-db
  labels:
    app.kubernetes.io/name: main-db
    helm.sh/chart: main_db-10.14.3
    app.kubernetes.io/instance: homewekaio
    app.kubernetes.io/managed-by: Helm
    app.group: common
  annotations:
  namespace: home-weka-io
spec:
  type: ClusterIP
  ports:
    - name: tcp-postgresql
      port: 5432
      targetPort: tcp-postgresql
  selector:
    app.kubernetes.io/name: main-db
    app.kubernetes.io/instance: homewekaio
    role: primary
---
# Source: home-weka-io/charts/nats/templates/service.yaml
apiVersion: v1
kind: Service
metadata:
  name: nats
  namespace: home-weka-io
  labels:
    helm.sh/chart: nats-0.19.13
    app.kubernetes.io/name: nats
    app.kubernetes.io/instance: homewekaio
    app.kubernetes.io/version: "2.9.16"
    app.kubernetes.io/managed-by: Helm
spec:
  selector:
    app.kubernetes.io/name: nats
    app.kubernetes.io/instance: homewekaio
  clusterIP: None
  publishNotReadyAddresses: true
  ports:
  - name: client
    port: 4222
    appProtocol: tcp
  - name: cluster
    port: 6222
    appProtocol: tcp
  - name: monitor
    port: 8222
    appProtocol: http
  - name: metrics
    port: 7777
    appProtocol: http
  - name: leafnodes
    port: 7422
    appProtocol: tcp
  - name: gateways
    port: 7522
    appProtocol: tcp
---
# Source: home-weka-io/charts/prometheus/charts/kube-state-metrics/templates/service.yaml
apiVersion: v1
kind: Service
metadata:
  name: homewekaio-kube-state-metrics
  namespace: home-weka-io
  labels:    
    helm.sh/chart: kube-state-metrics-4.7.0
    app.kubernetes.io/managed-by: Helm
    app.kubernetes.io/component: metrics
    app.kubernetes.io/part-of: kube-state-metrics
    app.kubernetes.io/name: kube-state-metrics
    app.kubernetes.io/instance: homewekaio
    app.kubernetes.io/version: "2.4.1"
  annotations:
    prometheus.io/scrape: 'true'
spec:
  type: "ClusterIP"
  ports:
  - name: "http"
    protocol: TCP
    port: 8080
    targetPort: 8080
  
  selector:    
    app.kubernetes.io/name: kube-state-metrics
    app.kubernetes.io/instance: homewekaio
---
# Source: home-weka-io/charts/prometheus/templates/alertmanager/service.yaml
apiVersion: v1
kind: Service
metadata:
  labels:
    component: "alertmanager"
    app: prometheus
    release: homewekaio
    chart: prometheus-15.8.6
    heritage: Helm
  name: homewekaio-prometheus-alertmanager
  namespace: home-weka-io
spec:
  ports:
    - name: http
      port: 80
      protocol: TCP
      targetPort: 9093
  selector:
    component: "alertmanager"
    app: prometheus
    release: homewekaio
  sessionAffinity: None
  type: "ClusterIP"
---
# Source: home-weka-io/charts/prometheus/templates/node-exporter/svc.yaml
apiVersion: v1
kind: Service
metadata:
  annotations:
    prometheus.io/scrape: "true"
  labels:
    component: "node-exporter"
    app: prometheus
    release: homewekaio
    chart: prometheus-15.8.6
    heritage: Helm
  name: homewekaio-prometheus-node-exporter
  namespace: home-weka-io
spec:
  clusterIP: None
  ports:
    - name: metrics
      port: 9100
      protocol: TCP
      targetPort: 9100
  selector:
    component: "node-exporter"
    app: prometheus
    release: homewekaio
  type: "ClusterIP"
---
# Source: home-weka-io/charts/prometheus/templates/pushgateway/service.yaml
apiVersion: v1
kind: Service
metadata:
  annotations:
    prometheus.io/probe: pushgateway
  labels:
    component: "pushgateway"
    app: prometheus
    release: homewekaio
    chart: prometheus-15.8.6
    heritage: Helm
  name: homewekaio-prometheus-pushgateway
  namespace: home-weka-io
spec:
  ports:
    - name: http
      port: 9091
      protocol: TCP
      targetPort: 9091
  selector:
    component: "pushgateway"
    app: prometheus
    release: homewekaio
  type: "ClusterIP"
---
# Source: home-weka-io/charts/prometheus/templates/server/service.yaml
apiVersion: v1
kind: Service
metadata:
  labels:
    component: "server"
    app: prometheus
    release: homewekaio
    chart: prometheus-15.8.6
    heritage: Helm
  name: homewekaio-prometheus-server
  namespace: home-weka-io
spec:
  ports:
    - name: http
      port: 80
      protocol: TCP
      targetPort: 9090
  selector:
    component: "server"
    app: prometheus
    release: homewekaio
  sessionAffinity: None
  type: "ClusterIP"
---
# Source: home-weka-io/charts/statsdb/templates/vminsert-service.yaml
apiVersion: v1
kind: Service
metadata:
  labels:
    app: vminsert
    app.kubernetes.io/name: statsdb
    app.kubernetes.io/instance: homewekaio
    helm.sh/chart: statsdb-0.9.1
    app.kubernetes.io/managed-by: Helm
  name: homewekaio-statsdb-vminsert
  namespace: home-weka-io
spec:
  ports:
    - name: http
      port: 8480
      protocol: TCP
      targetPort: http

  selector:
    app: vminsert
    app.kubernetes.io/name: statsdb
    app.kubernetes.io/instance: homewekaio
  type: "ClusterIP"
---
# Source: home-weka-io/charts/statsdb/templates/vmselect-service-headless.yaml
apiVersion: v1
kind: Service
metadata:
  labels:
    app: vmselect
    app.kubernetes.io/name: statsdb
    app.kubernetes.io/instance: homewekaio
    helm.sh/chart: statsdb-0.9.1
    app.kubernetes.io/managed-by: Helm
  name: homewekaio-statsdb-vmselect
  namespace: home-weka-io
spec:
  clusterIP: None
  ports:
    - name: http
      port: 8481
      protocol: TCP
      targetPort: http
  selector:
    app: vmselect
    app.kubernetes.io/name: statsdb
    app.kubernetes.io/instance: homewekaio
---
# Source: home-weka-io/charts/statsdb/templates/vmstorage-service.yaml
apiVersion: v1
kind: Service
metadata:
  labels:
    app: vmstorage
    app.kubernetes.io/name: statsdb
    app.kubernetes.io/instance: homewekaio
    helm.sh/chart: statsdb-0.9.1
    app.kubernetes.io/managed-by: Helm
  name: homewekaio-statsdb-vmstorage
  namespace: home-weka-io
spec:
  clusterIP: None
  ports:
    - port: 8482
      targetPort: http
      protocol: TCP
      name: http
    - port: 8401
      targetPort: vmselect
      protocol: TCP
      name: vmselect
    - port: 8400
      targetPort: vminsert
      protocol: TCP
      name: vminsert
  selector:
    app: vmstorage
    app.kubernetes.io/name: statsdb
    app.kubernetes.io/instance: homewekaio
---
# Source: home-weka-io/charts/support_db/templates/metrics-svc.yaml
apiVersion: v1
kind: Service
metadata:
  name: homewekaio-support-db-metrics
  labels:
    app.kubernetes.io/name: support-db
    helm.sh/chart: support_db-10.14.3
    app.kubernetes.io/instance: homewekaio
    app.kubernetes.io/managed-by: Helm
    app.group: common
  annotations:
    prometheus.io/port: "9187"
    prometheus.io/scrape: "true"
  namespace: home-weka-io
spec:
  type: ClusterIP
  ports:
    - name: http-metrics
      port: 9187
      targetPort: http-metrics
  selector:
    app.kubernetes.io/name: support-db
    app.kubernetes.io/instance: homewekaio
    role: primary
---
# Source: home-weka-io/charts/support_db/templates/svc-headless.yaml
apiVersion: v1
kind: Service
metadata:
  name: homewekaio-support-db-headless
  labels:
    app.kubernetes.io/name: support-db
    helm.sh/chart: support_db-10.14.3
    app.kubernetes.io/instance: homewekaio
    app.kubernetes.io/managed-by: Helm
    app.group: common
    # Use this annotation in addition to the actual publishNotReadyAddresses
    # field below because the annotation will stop being respected soon but the
    # field is broken in some versions of Kubernetes:
    # https://github.com/kubernetes/kubernetes/issues/58662
    service.alpha.kubernetes.io/tolerate-unready-endpoints: "true"
  namespace: home-weka-io
spec:
  type: ClusterIP
  clusterIP: None
  # We want all pods in the StatefulSet to have their addresses published for
  # the sake of the other Postgresql pods even before they're ready, since they
  # have to be able to talk to each other in order to become ready.
  publishNotReadyAddresses: true
  ports:
    - name: tcp-postgresql
      port: 5432
      targetPort: tcp-postgresql
  selector:
    app.kubernetes.io/name: support-db
    app.kubernetes.io/instance: homewekaio
---
# Source: home-weka-io/charts/support_db/templates/svc.yaml
apiVersion: v1
kind: Service
metadata:
  name: homewekaio-support-db
  labels:
    app.kubernetes.io/name: support-db
    helm.sh/chart: support_db-10.14.3
    app.kubernetes.io/instance: homewekaio
    app.kubernetes.io/managed-by: Helm
    app.group: common
  annotations:
  namespace: home-weka-io
spec:
  type: ClusterIP
  ports:
    - name: tcp-postgresql
      port: 5432
      targetPort: tcp-postgresql
  selector:
    app.kubernetes.io/name: support-db
    app.kubernetes.io/instance: homewekaio
    role: primary
---
# Source: home-weka-io/templates/service-api.yaml
apiVersion: v1
kind: Service
metadata:
  name: home-weka-io-api
  labels:
    app.kubernetes.io/name: api

spec:
  type: NodePort
  ports:
    - port: 8000
      targetPort: 8000
      protocol: TCP
  selector:
    app: api
  externalTrafficPolicy: Cluster
---
# Source: home-weka-io/templates/service-diags.yaml
apiVersion: v1
kind: Service
metadata:
  name: home-weka-io-diags-handler
  labels:
    app.kubernetes.io/name: diags-handler

spec:
  type: NodePort
  ports:
    - port: 8002
      targetPort: 8000
      protocol: TCP
  selector:
    app: diags-handler
  externalTrafficPolicy: Cluster
---
# Source: home-weka-io/templates/service-frontend.yaml
apiVersion: v1
kind: Service
metadata:
  name: home-weka-io-frontend
  labels:
    app.kubernetes.io/name: frontend

spec:
  type: NodePort
  ports:
    - port: 80
      targetPort: 80
      protocol: TCP
  selector:
    app: frontend
  externalTrafficPolicy: Cluster
---
# Source: home-weka-io/templates/service-stats.yaml
apiVersion: v1
kind: Service
metadata:
  name: home-weka-io-stats-handler
  labels:
    app.kubernetes.io/name: stats-handler

spec:
  type: NodePort
  ports:
    - port: 8001
      targetPort: 8000
      protocol: TCP
  selector:
    app: stats-handler
  externalTrafficPolicy: Cluster
---
# Source: home-weka-io/charts/prometheus/templates/node-exporter/daemonset.yaml
apiVersion: apps/v1
kind: DaemonSet
metadata:
  labels:
    component: "node-exporter"
    app: prometheus
    release: homewekaio
    chart: prometheus-15.8.6
    heritage: Helm
  name: homewekaio-prometheus-node-exporter
  namespace: home-weka-io
spec:
  selector:
    matchLabels:
      component: "node-exporter"
      app: prometheus
      release: homewekaio
  updateStrategy:
    type: RollingUpdate
  template:
    metadata:
      labels:
        component: "node-exporter"
        app: prometheus
        release: homewekaio
        chart: prometheus-15.8.6
        heritage: Helm
    spec:
      serviceAccountName: homewekaio-prometheus-node-exporter
      containers:
        - name: prometheus-node-exporter
          image: "quay.io/prometheus/node-exporter:v1.3.0"
          imagePullPolicy: "Never"
          args:
            - --path.procfs=/host/proc
            - --path.sysfs=/host/sys
            - --path.rootfs=/host/root
            - --web.listen-address=:9100
          ports:
            - name: metrics
              containerPort: 9100
              hostPort: 9100
          resources:
            {}
          securityContext:
            allowPrivilegeEscalation: false          
          volumeMounts:
            - name: proc
              mountPath: /host/proc
              readOnly:  true
            - name: sys
              mountPath: /host/sys
              readOnly: true
            - name: root
              mountPath: /host/root
              mountPropagation: HostToContainer
              readOnly: true
      hostNetwork: true
      hostPID: true
      securityContext:
        fsGroup: 65534
        runAsGroup: 65534
        runAsNonRoot: true
        runAsUser: 65534
      volumes:
        - name: proc
          hostPath:
            path: /proc
        - name: sys
          hostPath:
            path: /sys
        - name: root
          hostPath:
            path: /
---
# Source: home-weka-io/charts/grafana/templates/deployment.yaml
apiVersion: apps/v1
kind: Deployment
metadata:
  name: homewekaio-grafana
  namespace: home-weka-io
  labels:
    app.kubernetes.io/name: grafana
    helm.sh/chart: grafana-7.6.1
    app.kubernetes.io/instance: homewekaio
    app.kubernetes.io/managed-by: Helm
    app.group: common
    app.kubernetes.io/component: grafana
spec:
  replicas: 1
  selector:
    matchLabels:
      app.kubernetes.io/name: grafana
      app.kubernetes.io/instance: homewekaio
      app.kubernetes.io/component: grafana
  strategy: 
    type: Recreate
  template:
    metadata:
      labels:
        app.kubernetes.io/name: grafana
        helm.sh/chart: grafana-7.6.1
        app.kubernetes.io/instance: homewekaio
        app.kubernetes.io/managed-by: Helm
        app.kubernetes.io/component: grafana
        app.group: common
      annotations:
        checksum/config: b021acf4ac0bc9899af2753372296a1d6623e890029a91b036204a22176e462b
        checksum/dashboard-provider: 01ba4719c80b6fe911b091a7c05124b64eeece964e09c058ef8f9805daca546b
    spec:
      
      serviceAccountName: homewekaio-grafana
      affinity:
        podAffinity:
          
        podAntiAffinity:
          preferredDuringSchedulingIgnoredDuringExecution:
            - podAffinityTerm:
                labelSelector:
                  matchLabels:
                    app.kubernetes.io/name: grafana
                    app.kubernetes.io/instance: homewekaio
                    app.kubernetes.io/component: grafana
                namespaces:
                  - "home-weka-io"
                topologyKey: kubernetes.io/hostname
              weight: 1
        nodeAffinity:
          
      securityContext:
        runAsUser: 1001
        fsGroup: 1001
        runAsNonRoot: true
      initContainers:
      containers:
        - name: grafana
          image: docker.io/bitnami/grafana:8.1.0-debian-10-r0
          imagePullPolicy: Never
          securityContext:
            runAsUser: 1001
          envFrom:
            - configMapRef:
                name: homewekaio-grafana-envvars
          env:
            - name: GF_SECURITY_ADMIN_PASSWORD
              valueFrom:
                secretKeyRef:
                  name: weka-home-grafana-credentials
                  key: password
            - name: MAIN_DB_HOSTNAME
              valueFrom:
                secretKeyRef:
                  key: hostname
                  name: weka-home-main-db-credentials
            - name: MAIN_DB_PORT
              valueFrom:
                secretKeyRef:
                  key: port
                  name: weka-home-main-db-credentials
            - name: MAIN_DB_USERNAME
              valueFrom:
                secretKeyRef:
                  key: username
                  name: weka-home-main-db-credentials
            - name: MAIN_DB_DATABASE
              valueFrom:
                secretKeyRef:
                  key: database
                  name: weka-home-main-db-credentials
            - name: MAIN_DB_PASSWORD
              valueFrom:
                secretKeyRef:
                  key: password
                  name: weka-home-main-db-credentials
            - name: STATS_STORE_QUERY_URL
              valueFrom:
                secretKeyRef:
                  key: stats_store_query_url
                  name: weka-home-stats-db-credentials
            - name: GF_DASHBOARDS_DEFAULT_HOME_DASHBOARD_PATH
              value: /opt/bitnami/grafana/dashboards/cluster-summary-dashboard.json
            - name: PROMETHEUS_QUERY_URL
              valueFrom:
                secretKeyRef:
                  key: prometheus_query_url
                  name: weka-home-stats-db-credentials
            - name: WEBHOOK_TOKEN
              valueFrom:
                secretKeyRef:
                  key: webhook_token
                  name: grafana-webhook
            - name: WEBHOOK_URL
              valueFrom:
                secretKeyRef:
                  key: webhook_url
                  name: grafana-webhook
          volumeMounts:
            - name: grafana-ini
              mountPath: /opt/bitnami/grafana/conf/grafana.ini
              subPath: grafana.ini
            - name: data
              mountPath: /opt/bitnami/grafana/data
            - name: dashboards-provider
              mountPath: /opt/bitnami/grafana/conf/provisioning/dashboards
            - name: grafana-dashboards
              mountPath: /opt/bitnami/grafana/dashboards/
              subPath: 
            - name: datasources
              mountPath: /opt/bitnami/grafana/conf/provisioning/datasources
            - name: notifiers
              mountPath: /opt/bitnami/grafana/conf/provisioning/notifiers
          ports:
            - name: dashboard
              containerPort: 3000
              protocol: TCP
          livenessProbe:
            httpGet:
              path: /api/health
              port: dashboard
              scheme: HTTP
            initialDelaySeconds: 120
            periodSeconds: 10
            timeoutSeconds: 5
            successThreshold: 1
            failureThreshold: 6
          readinessProbe:
            httpGet:
              path: /api/health
              port: dashboard
              scheme: HTTP
            initialDelaySeconds: 30
            periodSeconds: 10
            timeoutSeconds: 5
            successThreshold: 1
            failureThreshold: 6
          resources:
            limits: {}
            requests: {}
        - args:
          - --volume-dir=/opt/bitnami/grafana/dashboards
          - --webhook-url=$(GRAFANA_API_DASHBOARD_RELOAD_URL)
          env:
          - name: GRAFANA_API_DASHBOARD_RELOAD_URL
            valueFrom:
              secretKeyRef:
                key: grafana_api_dashboard_reload_url
                name: weka-home-grafana-credentials
          image: jimmidyson/configmap-reload:v0.5.0
          imagePullPolicy: IfNotPresent
          name: grafana-configmap-reload
          resources: {}
          terminationMessagePath: /dev/termination-log
          terminationMessagePolicy: File
          volumeMounts:
          - mountPath: /opt/bitnami/grafana/dashboards
            name: grafana-dashboards
            readOnly: true
      volumes:
        - name: data
          persistentVolumeClaim:
            claimName: homewekaio-grafana
        - name: dashboards-provider
          configMap:
            name: grafana-dashboard-provider
        - name: grafana-dashboards
          configMap:
            name: grafana-dashboards
        - name: datasources
          secret:
            secretName: weka-home-grafana-datasources
        - name: notifiers
          configMap:
            name: grafana-alerts
        - name: grafana-ini
          configMap:
            name: grafana-custom-config
---
# Source: home-weka-io/charts/nack/templates/deployment-jetstream-controller.yml
apiVersion: apps/v1
kind: Deployment
metadata:
  name: homewekaio
  namespace: home-weka-io
  labels:
    app: homewekaio
    chart: nack-0.21.1_discard-per
spec:
  selector:
    matchLabels:
      app: homewekaio

  # Singleton Replica per JetStream controller
  replicas: 1

  template:
    metadata:
      labels:
        app: homewekaio
        chart: nack-0.21.1_discard-per
    spec:
      terminationGracePeriodSeconds: 30
      volumes:
      - name : runtime
        emptyDir : {}

      serviceAccountName: jetstream-controller
      containers:
        - name: jsc
          image: wekaio/nack:0.10.1-discard-per
          imagePullPolicy: IfNotPresent
          workingDir: /nack
          command:
          - /jetstream-controller
          args:
          - -s=nats://nats:4222
          - --namespace=home-weka-io
          env:
          - name: POD_NAME
            valueFrom:
              fieldRef:
                fieldPath: metadata.name
          - name: POD_NAMESPACE
            valueFrom:
              fieldRef:
                fieldPath: metadata.namespace
          volumeMounts:
          - name: runtime
            mountPath: /nack
---
# Source: home-weka-io/charts/nats/templates/nats-box.yaml
apiVersion: apps/v1
kind: Deployment
metadata:
  name: nats-box
  namespace: home-weka-io
  labels:
    app: nats-box
    chart: nats-0.19.13
spec:
  replicas: 1
  selector:
    matchLabels:
      app: nats-box
  template:
    metadata:
      labels:
        app: nats-box
    spec:
      volumes:
      containers:
      - name: nats-box
        image: natsio/nats-box:0.13.8
        imagePullPolicy: IfNotPresent
        resources:
          {}
        env:
        - name: NATS_URL
          value: nats
        command:
        - "tail"
        - "-f"
        - "/dev/null"
        volumeMounts:
---
# Source: home-weka-io/charts/prometheus/charts/kube-state-metrics/templates/deployment.yaml
apiVersion: apps/v1
kind: Deployment
metadata:
  name: homewekaio-kube-state-metrics
  namespace: home-weka-io
  labels:    
    helm.sh/chart: kube-state-metrics-4.7.0
    app.kubernetes.io/managed-by: Helm
    app.kubernetes.io/component: metrics
    app.kubernetes.io/part-of: kube-state-metrics
    app.kubernetes.io/name: kube-state-metrics
    app.kubernetes.io/instance: homewekaio
    app.kubernetes.io/version: "2.4.1"
spec:
  selector:
    matchLabels:      
      app.kubernetes.io/name: kube-state-metrics
      app.kubernetes.io/instance: homewekaio
  replicas: 1
  template:
    metadata:
      labels:        
        helm.sh/chart: kube-state-metrics-4.7.0
        app.kubernetes.io/managed-by: Helm
        app.kubernetes.io/component: metrics
        app.kubernetes.io/part-of: kube-state-metrics
        app.kubernetes.io/name: kube-state-metrics
        app.kubernetes.io/instance: homewekaio
        app.kubernetes.io/version: "2.4.1"
    spec:
      hostNetwork: false
      serviceAccountName: homewekaio-kube-state-metrics
      securityContext:
        fsGroup: 65534
        runAsGroup: 65534
        runAsUser: 65534
      containers:
      - name: kube-state-metrics
        args:
        - --port=8080
        - --resources=certificatesigningrequests,configmaps,cronjobs,daemonsets,deployments,endpoints,horizontalpodautoscalers,ingresses,jobs,limitranges,mutatingwebhookconfigurations,namespaces,networkpolicies,nodes,persistentvolumeclaims,persistentvolumes,poddisruptionbudgets,pods,replicasets,replicationcontrollers,resourcequotas,secrets,services,statefulsets,storageclasses,validatingwebhookconfigurations,volumeattachments
        - --telemetry-port=8081
        imagePullPolicy: IfNotPresent
        image: "k8s.gcr.io/kube-state-metrics/kube-state-metrics:v2.4.1"
        ports:
        - containerPort: 8080
          name: "http"
        livenessProbe:
          httpGet:
            path: /healthz
            port: 8080
          initialDelaySeconds: 5
          timeoutSeconds: 5
        readinessProbe:
          httpGet:
            path: /
            port: 8080
          initialDelaySeconds: 5
          timeoutSeconds: 5
---
# Source: home-weka-io/charts/prometheus/templates/alertmanager/deploy.yaml
apiVersion: apps/v1
kind: Deployment
metadata:
  labels:
    component: "alertmanager"
    app: prometheus
    release: homewekaio
    chart: prometheus-15.8.6
    heritage: Helm
  name: homewekaio-prometheus-alertmanager
  namespace: home-weka-io
spec:
  selector:
    matchLabels:
      component: "alertmanager"
      app: prometheus
      release: homewekaio
  replicas: 1
  template:
    metadata:
      labels:
        component: "alertmanager"
        app: prometheus
        release: homewekaio
        chart: prometheus-15.8.6
        heritage: Helm
    spec:
      serviceAccountName: homewekaio-prometheus-alertmanager
      containers:
        - name: prometheus-alertmanager
          image: "quay.io/prometheus/alertmanager:v0.23.0"
          imagePullPolicy: "Never"
          env:
            - name: POD_IP
              valueFrom:
                fieldRef:
                  apiVersion: v1
                  fieldPath: status.podIP
          args:
            - --config.file=/etc/config/alertmanager.yml
            - --storage.path=/data
            - --cluster.listen-address=
            - --web.external-url=http://localhost:9093

          ports:
            - containerPort: 9093
          readinessProbe:
            httpGet:
              path: /-/ready
              port: 9093
            initialDelaySeconds: 30
            timeoutSeconds: 30
          resources:
            {}
          volumeMounts:
            - name: config-volume
              mountPath: /etc/config
            - name: storage-volume
              mountPath: "/data"
              subPath: ""
        - name: prometheus-alertmanager-configmap-reload
          image: "jimmidyson/configmap-reload:v0.5.0"
          imagePullPolicy: "Never"
          args:
            - --volume-dir=/etc/config
            - --webhook-url=http://127.0.0.1:9093/-/reload
          resources:
            {}
          volumeMounts:
            - name: config-volume
              mountPath: /etc/config
              readOnly: true
      securityContext:
        fsGroup: 65534
        runAsGroup: 65534
        runAsNonRoot: true
        runAsUser: 65534
      volumes:
        - name: config-volume
          configMap:
            name: homewekaio-prometheus-alertmanager
        - name: storage-volume
          persistentVolumeClaim:
            claimName: homewekaio-prometheus-alertmanager
---
# Source: home-weka-io/charts/prometheus/templates/pushgateway/deploy.yaml
apiVersion: apps/v1
kind: Deployment
metadata:
  labels:
    component: "pushgateway"
    app: prometheus
    release: homewekaio
    chart: prometheus-15.8.6
    heritage: Helm
  name: homewekaio-prometheus-pushgateway
  namespace: home-weka-io
spec:
  selector:
    matchLabels:
      component: "pushgateway"
      app: prometheus
      release: homewekaio
  replicas: 1
  template:
    metadata:
      labels:
        component: "pushgateway"
        app: prometheus
        release: homewekaio
        chart: prometheus-15.8.6
        heritage: Helm
    spec:
      serviceAccountName: homewekaio-prometheus-pushgateway
      containers:
        - name: prometheus-pushgateway
          image: "prom/pushgateway:v1.4.2"
          imagePullPolicy: "Never"
          args:
          ports:
            - containerPort: 9091
          livenessProbe:
            httpGet:
              path: /-/healthy
              port: 9091
            initialDelaySeconds: 10
            timeoutSeconds: 10
          readinessProbe:
            httpGet:
              path: /-/ready
              port: 9091
            initialDelaySeconds: 10
            timeoutSeconds: 10
          resources:
            {}
      securityContext:
        runAsNonRoot: true
        runAsUser: 65534
---
# Source: home-weka-io/charts/prometheus/templates/server/deploy.yaml
apiVersion: apps/v1
kind: Deployment
metadata:
  labels:
    component: "server"
    app: prometheus
    release: homewekaio
    chart: prometheus-15.8.6
    heritage: Helm
  name: homewekaio-prometheus-server
  namespace: home-weka-io
spec:
  selector:
    matchLabels:
      component: "server"
      app: prometheus
      release: homewekaio
  replicas: 1
  template:
    metadata:
      labels:
        component: "server"
        app: prometheus
        release: homewekaio
        chart: prometheus-15.8.6
        heritage: Helm
    spec:
      enableServiceLinks: true
      serviceAccountName: homewekaio-prometheus-server
      containers:
        - name: prometheus-server-configmap-reload
          image: "jimmidyson/configmap-reload:v0.5.0"
          imagePullPolicy: "Never"
          args:
            - --volume-dir=/etc/config
            - --webhook-url=http://127.0.0.1:9090/-/reload
          resources:
            {}
          volumeMounts:
            - name: config-volume
              mountPath: /etc/config
              readOnly: true

        - name: prometheus-server
          image: "quay.io/prometheus/prometheus:v2.34.0"
          imagePullPolicy: "Never"
          args:
            - --storage.tsdb.retention.time=15d
            - --config.file=/etc/config/prometheus.yml
            - --storage.tsdb.path=/data
            - --web.console.libraries=/etc/prometheus/console_libraries
            - --web.console.templates=/etc/prometheus/consoles
            - --web.enable-lifecycle
          ports:
            - containerPort: 9090
          readinessProbe:
            httpGet:
              path: /-/ready
              port: 9090
              scheme: HTTP
            initialDelaySeconds: 30
            periodSeconds: 5
            timeoutSeconds: 4
            failureThreshold: 3
            successThreshold: 1
          livenessProbe:
            httpGet:
              path: /-/healthy
              port: 9090
              scheme: HTTP
            initialDelaySeconds: 30
            periodSeconds: 15
            timeoutSeconds: 10
            failureThreshold: 3
            successThreshold: 1
          resources:
            {}
          volumeMounts:
            - name: config-volume
              mountPath: /etc/config
            - name: storage-volume
              mountPath: /data
              subPath: ""
      hostNetwork: false
      dnsPolicy: ClusterFirst
      securityContext:
        fsGroup: 65534
        runAsGroup: 65534
        runAsNonRoot: true
        runAsUser: 65534
      terminationGracePeriodSeconds: 300
      volumes:
        - name: config-volume
          configMap:
            name: homewekaio-prometheus-server
        - name: storage-volume
          persistentVolumeClaim:
            claimName: homewekaio-prometheus-server
---
# Source: home-weka-io/charts/statsdb/templates/vminsert-deployment.yaml
apiVersion: apps/v1
kind: Deployment
metadata:
  labels:
    app: vminsert
    app.kubernetes.io/name: statsdb
    app.kubernetes.io/instance: homewekaio
    helm.sh/chart: statsdb-0.9.1
    app.kubernetes.io/managed-by: Helm
    app.group: hpa
  name: homewekaio-statsdb-vminsert
  namespace: home-weka-io
spec:
  selector:
    matchLabels:
      app: vminsert
      app.kubernetes.io/name: statsdb
      app.kubernetes.io/instance: homewekaio
  replicas: 2
  template:
    metadata:
      annotations:
        prometheus.io/path: /metrics
        prometheus.io/scrape: "true"
      labels:
        app: vminsert
        app.kubernetes.io/name: statsdb
        app.kubernetes.io/instance: homewekaio
        helm.sh/chart: statsdb-0.9.1
        app.kubernetes.io/managed-by: Helm
        app.group: hpa
    spec:
      automountServiceAccountToken: true
      containers:
        - name: statsdb-vminsert
          image: "victoriametrics/vminsert:v1.64.0-cluster"
          imagePullPolicy: "Never"
          securityContext:
            {}
          args:
            - --storageNode=homewekaio-statsdb-vmstorage-0.homewekaio-statsdb-vmstorage.home-weka-io.svc.cluster.local:8400
            - --storageNode=homewekaio-statsdb-vmstorage-1.homewekaio-statsdb-vmstorage.home-weka-io.svc.cluster.local:8400
            - --storageNode=homewekaio-statsdb-vmstorage-2.homewekaio-statsdb-vmstorage.home-weka-io.svc.cluster.local:8400
            
            - --envflag.enable=true
            - --envflag.prefix=VM_
            - --loggerFormat=json
          ports:
            - name: http
              containerPort: 8480
          readinessProbe:
            httpGet:
              path: /health
              port: http
            initialDelaySeconds: 5
            periodSeconds: 15
            timeoutSeconds: 5
            failureThreshold: 3
          livenessProbe:
            tcpSocket:
              port: http
            initialDelaySeconds: 5
            periodSeconds: 15
            timeoutSeconds: 5
            failureThreshold: 3
          resources:
            limits:
              cpu: 250m
              memory: 500Mi
            requests:
              cpu: 250m
              memory: 500Mi
      serviceAccountName: homewekaio-statsdb
---
# Source: home-weka-io/templates/api-alert-dispatcher.yaml
apiVersion: apps/v1
kind: Deployment
metadata:
  name: alertdispatcher
  labels:
    app: alertdispatcher
    app.kubernetes.io/name: alertdispatcher
    app.kubernetes.io/instance: "homewekaio"
    app.group: common
spec:
  replicas: 1
  strategy:
    rollingUpdate:
      maxUnavailable: 1
  selector:
    matchLabels:
      app.kubernetes.io/name: "alertdispatcher"
      app.kubernetes.io/instance: "homewekaio"
  template:
    metadata:
      labels:
        app: alertdispatcher
        app.kubernetes.io/name: alertdispatcher
        app.kubernetes.io/instance: "homewekaio"
        app.group: common
      annotations:
        prometheus.io/port: "9187"
        prometheus.io/scrape: "true"
        prometheus.io/path: /metrics
    spec:
      serviceAccountName: home-weka-io-serviceaccount
      nodeSelector: 
        {}
      containers:
        - name: home-weka-io
          image: gohome:33414c551ec9939d784e308cab53a45f
          imagePullPolicy: Never
          ports:
            - name: http
              containerPort: 8000
            - name: metrics
              containerPort: 9187
          livenessProbe:
            initialDelaySeconds: 5
            periodSeconds: 1
            httpGet:
              path: /api/v3/status
              port: 8000
            timeoutSeconds: 3
            successThreshold: 1
            failureThreshold: 1
          resources:
            limits:
              cpu: 100m
              memory: 200Mi
            requests:
              cpu: 100m
              memory: 200Mi
          command:
            - ./wekahome
            - run
            - --with-dispatch-alerts
            - --with-http-service
            - --exit-fast
            - --with-metrics
          env:
            - name: IS_OFFLINE
              value: "true"
            - name: GOHOME_API_BIND_TO
              value: ""
            - name: LOG_LEVEL
              value: INFO
            - name: PORT
              value: "8000"
            - name: MAIN_DB_POOL_SIZE
              value: "8"
            - name: SUPPORT_FILE_DB_POOL_SIZE
              value: "8"
            - name: EVENT_STORE_DB_POOL_SIZE
              value: "8"
            - name: FILTER_HTTP_REQUESTS_USER_AGENT_LOGGING
              value: "kube-probe/1.23"
            - name: NATS_URL
              value: "nats://nats:4222"
            - name: LIVENESS_PROBE_ENABLED
              value: "1"
            - name: SUPPORT_FILES_PATH
              value: /support-file-uploads
            - name: EMAIL_LINK_DOMAIN_NAME
              value: 10.108.170.142
            - name: EMAIL_LINK_DOMAIN_PROTOCOL
              value: http
            - name: METRICS_PORT
              value: "9187"
            - name: FORWARDING_ENABLED
              value: "false"
            - name: FORWARDING_URL
              value: https://api.home.weka.io
            - name: FORWARDING_CLUSTER_REGISTRATION_ENABLED
              value: "true"
            - name: FORWARDING_EVENTS_ENABLED
              value: "true"
            - name: FORWARDING_USAGE_REPORT_ENABLED
              value: "true"
            - name: FORWARDING_ANALYTICS_ENABLED
              value: "true"
            - name: FORWARDING_DIAGNOSTICS_ENABLED
              value: "true"
            - name: FORWARDING_STATS_ENABLED
              value: "true"
            - name: FORWARDING_BULK_SIZE
              value: "50"
            # ------------- START DB connectivity ---------------- #
            # USING MAIN DB WITHOUT READONLY REPLICAS
            - name: MAIN_DB_HOSTNAME
              valueFrom:
                secretKeyRef:
                  name: weka-home-main-db-credentials
                  key: hostname
            - name: READONLY_DB_HOSTNAME
              valueFrom:
                secretKeyRef:
                  name: weka-home-main-db-credentials
                  key: hostname
            - name: SUPPORT_DB_HOSTNAME
              valueFrom:
                secretKeyRef:
                  name: weka-home-support-db-credentials
                  key: hostname
            - name: MAIN_DB_PORT
              valueFrom:
                secretKeyRef:
                  name: weka-home-main-db-credentials
                  key: port
            - name: READONLY_DB_PORT
              valueFrom:
                secretKeyRef:
                  name: weka-home-main-db-credentials
                  key: port
            - name: SUPPORT_DB_PORT
              valueFrom:
                secretKeyRef:
                  name: weka-home-support-db-credentials
                  key: port
            - name: MAIN_DB_USERNAME
              valueFrom:
                secretKeyRef:
                  name: weka-home-main-db-credentials
                  key: username
            - name: READONLY_DB_USERNAME
              valueFrom:
                secretKeyRef:
                  name: weka-home-main-db-credentials
                  key: username
            - name: SUPPORT_DB_USERNAME
              valueFrom:
                secretKeyRef:
                  name: weka-home-support-db-credentials
                  key: username
            - name: MAIN_DB_PASSWORD
              valueFrom:
                secretKeyRef:
                  name: weka-home-main-db-credentials
                  key: password
            - name: READONLY_DB_PASSWORD
              valueFrom:
                secretKeyRef:
                  name: weka-home-main-db-credentials
                  key: password
            - name: SUPPORT_DB_PASSWORD
              valueFrom:
                secretKeyRef:
                  name: weka-home-support-db-credentials
                  key: password
            - name: MAIN_DB_DATABASE
              valueFrom:
                secretKeyRef:
                  name: weka-home-main-db-credentials
                  key: database
            - name: READONLY_DB_DATABASE
              valueFrom:
                secretKeyRef:
                  name: weka-home-main-db-credentials
                  key: database
            - name: SUPPORT_DB_DATABASE
              valueFrom:
                secretKeyRef:
                  name: weka-home-support-db-credentials
                  key: database
            - name: NUM_EVENT_STORES
              value: "1"
            - name: EVENT_STORE_0_HOSTNAME
              valueFrom:
                secretKeyRef:
                  name: weka-home-event-db-credentials-0
                  key: hostname
            - name: EVENT_STORE_0_PORT
              valueFrom:
                secretKeyRef:
                  name: weka-home-event-db-credentials-0
                  key: port
            - name: EVENT_STORE_0_USERNAME
              valueFrom:
                secretKeyRef:
                  name: weka-home-event-db-credentials-0
                  key: username
            - name: EVENT_STORE_0_PASSWORD
              valueFrom:
                secretKeyRef:
                  name: weka-home-event-db-credentials-0
                  key: password
            - name: EVENT_STORE_0_DATABASE
              valueFrom:
                secretKeyRef:
                  name: weka-home-event-db-credentials-0
                  key: database
            
            - name: DATABASE_URL
              value: "postgres://$(MAIN_DB_USERNAME):$(MAIN_DB_PASSWORD)@$(MAIN_DB_HOSTNAME):$(MAIN_DB_PORT)/$(MAIN_DB_DATABASE)?sslmode=disable"

            - name: RO_DATABASE_URL
              value: "postgres://$(READONLY_DB_USERNAME):$(READONLY_DB_PASSWORD)@$(READONLY_DB_HOSTNAME):$(READONLY_DB_PORT)/$(READONLY_DB_DATABASE)?sslmode=disable"
            - name: SUPPORT_FILES_DATABASE_URL
              value: "postgres://$(SUPPORT_DB_USERNAME):$(SUPPORT_DB_PASSWORD)@$(SUPPORT_DB_HOSTNAME):$(SUPPORT_DB_PORT)/$(SUPPORT_DB_DATABASE)?sslmode=disable"
            - name: EVENT_STORE_0_URL
              value: "postgres://$(EVENT_STORE_0_USERNAME):$(EVENT_STORE_0_PASSWORD)@$(EVENT_STORE_0_HOSTNAME):$(EVENT_STORE_0_PORT)/$(EVENT_STORE_0_DATABASE)?sslmode=disable"
            # ------------- END DB connectivity ---------------- #
            # ------------- START STATS DB connectivity ----------- #
            - name: STATS_STORE_URL
              valueFrom:
                secretKeyRef:
                  name: weka-home-stats-db-credentials
                  key: stats_store_url
            - name: STATS_STORE_QUERY_URL
              valueFrom:
                secretKeyRef:
                  name: weka-home-stats-db-credentials
                  key: stats_store_query_url
            - name: NUM_STATS_STORES
              value: "1"
            # ------------- END STATS DB connectivity ----------- #
            - name: STATS_UPLOAD_STRATEGY
              value: "push-to-stream"
            - name: STATS_BUCKET_NAME
              value: ""
            - name: SMTP_HOST
              value: 
            - name: SMTP_PORT
              value: ""
            - name: SMTP_PASSWORD
              value: 
            - name: SMTP_USERNAME
              value: 
            - name: SENDER_EMAIL_NAME
              value: Weka Home
            - name: SENDER_EMAIL
              value: weka-home-noreply@weka.io
            - name: SMTP_INSECURE_TLS
              value: "false"
            - name: ADMIN_USERNAME
              valueFrom:
                secretKeyRef:
                    name: weka-home-admin-credentials
                    key: admin_username
            - name: ADMIN_PASSWORD
              valueFrom:
                secretKeyRef:
                    name: weka-home-admin-credentials
                    key: admin_password
            - name: WEKA_SECRET_KEY
              valueFrom:
                secretKeyRef:
                    name: weka-home-encryption
                    key: encryption_secret_key
---
# Source: home-weka-io/templates/api-alert-processor.yaml
apiVersion: apps/v1
kind: Deployment
metadata:
  name: alertprocessor
  labels:
    app: alertprocessor
    app.kubernetes.io/name: alertprocessor
    app.kubernetes.io/instance: "homewekaio"
    app.group: common
spec:
  replicas: 1
  strategy:
    rollingUpdate:
      maxUnavailable: 1
  selector:
    matchLabels:
      app.kubernetes.io/name: "alertprocessor"
      app.kubernetes.io/instance: "homewekaio"
  template:
    metadata:
      labels:
        app: alertprocessor
        app.kubernetes.io/name: alertprocessor
        app.kubernetes.io/instance: "homewekaio"
        app.group: common
      annotations:
        prometheus.io/port: "9187"
        prometheus.io/scrape: "true"
        prometheus.io/path: /metrics
    spec:
      serviceAccountName: home-weka-io-serviceaccount
      nodeSelector: 
        {}
      containers:
        - name: home-weka-io
          image: gohome:33414c551ec9939d784e308cab53a45f
          imagePullPolicy: Never
          ports:
            - name: http
              containerPort: 8000
            - name: metrics
              containerPort: 9187
          livenessProbe:
            initialDelaySeconds: 5
            periodSeconds: 1
            httpGet:
              path: /api/v3/status
              port: 8000
            timeoutSeconds: 3
            successThreshold: 1
            failureThreshold: 1
          resources:
            limits:
              cpu: 100m
              memory: 200Mi
            requests:
              cpu: 100m
              memory: 200Mi
          command:
            - ./wekahome
            - run
            - --with-alert-processor
            - --with-http-service
            - --exit-fast
            - --with-metrics
          env:
            - name: PAGER_DUTY_WEKA_HOME_URL
              value: "10.108.170.142"
            - name: ALERT_PROCESSOR_FREQUENCY_MAX_PERIOD
              value: "15m"
            - name: ALERT_PROCESSOR_SLEEP
              value: "2s"
            - name: ALERT_PROCESSOR_BATCH_SIZE
              value: "500"
            - name: IS_OFFLINE
              value: "true"
            - name: GOHOME_API_BIND_TO
              value: ""
            - name: LOG_LEVEL
              value: INFO
            - name: PORT
              value: "8000"
            - name: MAIN_DB_POOL_SIZE
              value: "8"
            - name: SUPPORT_FILE_DB_POOL_SIZE
              value: "8"
            - name: EVENT_STORE_DB_POOL_SIZE
              value: "8"
            - name: FILTER_HTTP_REQUESTS_USER_AGENT_LOGGING
              value: "kube-probe/1.23"
            - name: NATS_URL
              value: "nats://nats:4222"
            - name: LIVENESS_PROBE_ENABLED
              value: "1"
            - name: SUPPORT_FILES_PATH
              value: /support-file-uploads
            - name: EMAIL_LINK_DOMAIN_NAME
              value: 10.108.170.142
            - name: EMAIL_LINK_DOMAIN_PROTOCOL
              value: http
            - name: METRICS_PORT
              value: "9187"
            - name: FORWARDING_ENABLED
              value: "false"
            - name: FORWARDING_URL
              value: https://api.home.weka.io
            - name: FORWARDING_CLUSTER_REGISTRATION_ENABLED
              value: "true"
            - name: FORWARDING_EVENTS_ENABLED
              value: "true"
            - name: FORWARDING_USAGE_REPORT_ENABLED
              value: "true"
            - name: FORWARDING_ANALYTICS_ENABLED
              value: "true"
            - name: FORWARDING_DIAGNOSTICS_ENABLED
              value: "true"
            - name: FORWARDING_STATS_ENABLED
              value: "true"
            - name: FORWARDING_BULK_SIZE
              value: "50"
            # ------------- START DB connectivity ---------------- #
            # USING MAIN DB WITHOUT READONLY REPLICAS
            - name: MAIN_DB_HOSTNAME
              valueFrom:
                secretKeyRef:
                  name: weka-home-main-db-credentials
                  key: hostname
            - name: READONLY_DB_HOSTNAME
              valueFrom:
                secretKeyRef:
                  name: weka-home-main-db-credentials
                  key: hostname
            - name: SUPPORT_DB_HOSTNAME
              valueFrom:
                secretKeyRef:
                  name: weka-home-support-db-credentials
                  key: hostname
            - name: MAIN_DB_PORT
              valueFrom:
                secretKeyRef:
                  name: weka-home-main-db-credentials
                  key: port
            - name: READONLY_DB_PORT
              valueFrom:
                secretKeyRef:
                  name: weka-home-main-db-credentials
                  key: port
            - name: SUPPORT_DB_PORT
              valueFrom:
                secretKeyRef:
                  name: weka-home-support-db-credentials
                  key: port
            - name: MAIN_DB_USERNAME
              valueFrom:
                secretKeyRef:
                  name: weka-home-main-db-credentials
                  key: username
            - name: READONLY_DB_USERNAME
              valueFrom:
                secretKeyRef:
                  name: weka-home-main-db-credentials
                  key: username
            - name: SUPPORT_DB_USERNAME
              valueFrom:
                secretKeyRef:
                  name: weka-home-support-db-credentials
                  key: username
            - name: MAIN_DB_PASSWORD
              valueFrom:
                secretKeyRef:
                  name: weka-home-main-db-credentials
                  key: password
            - name: READONLY_DB_PASSWORD
              valueFrom:
                secretKeyRef:
                  name: weka-home-main-db-credentials
                  key: password
            - name: SUPPORT_DB_PASSWORD
              valueFrom:
                secretKeyRef:
                  name: weka-home-support-db-credentials
                  key: password
            - name: MAIN_DB_DATABASE
              valueFrom:
                secretKeyRef:
                  name: weka-home-main-db-credentials
                  key: database
            - name: READONLY_DB_DATABASE
              valueFrom:
                secretKeyRef:
                  name: weka-home-main-db-credentials
                  key: database
            - name: SUPPORT_DB_DATABASE
              valueFrom:
                secretKeyRef:
                  name: weka-home-support-db-credentials
                  key: database
            - name: NUM_EVENT_STORES
              value: "1"
            - name: EVENT_STORE_0_HOSTNAME
              valueFrom:
                secretKeyRef:
                  name: weka-home-event-db-credentials-0
                  key: hostname
            - name: EVENT_STORE_0_PORT
              valueFrom:
                secretKeyRef:
                  name: weka-home-event-db-credentials-0
                  key: port
            - name: EVENT_STORE_0_USERNAME
              valueFrom:
                secretKeyRef:
                  name: weka-home-event-db-credentials-0
                  key: username
            - name: EVENT_STORE_0_PASSWORD
              valueFrom:
                secretKeyRef:
                  name: weka-home-event-db-credentials-0
                  key: password
            - name: EVENT_STORE_0_DATABASE
              valueFrom:
                secretKeyRef:
                  name: weka-home-event-db-credentials-0
                  key: database
            
            - name: DATABASE_URL
              value: "postgres://$(MAIN_DB_USERNAME):$(MAIN_DB_PASSWORD)@$(MAIN_DB_HOSTNAME):$(MAIN_DB_PORT)/$(MAIN_DB_DATABASE)?sslmode=disable"

            - name: RO_DATABASE_URL
              value: "postgres://$(READONLY_DB_USERNAME):$(READONLY_DB_PASSWORD)@$(READONLY_DB_HOSTNAME):$(READONLY_DB_PORT)/$(READONLY_DB_DATABASE)?sslmode=disable"
            - name: SUPPORT_FILES_DATABASE_URL
              value: "postgres://$(SUPPORT_DB_USERNAME):$(SUPPORT_DB_PASSWORD)@$(SUPPORT_DB_HOSTNAME):$(SUPPORT_DB_PORT)/$(SUPPORT_DB_DATABASE)?sslmode=disable"
            - name: EVENT_STORE_0_URL
              value: "postgres://$(EVENT_STORE_0_USERNAME):$(EVENT_STORE_0_PASSWORD)@$(EVENT_STORE_0_HOSTNAME):$(EVENT_STORE_0_PORT)/$(EVENT_STORE_0_DATABASE)?sslmode=disable"
            # ------------- END DB connectivity ---------------- #
            # ------------- START STATS DB connectivity ----------- #
            - name: STATS_STORE_URL
              valueFrom:
                secretKeyRef:
                  name: weka-home-stats-db-credentials
                  key: stats_store_url
            - name: STATS_STORE_QUERY_URL
              valueFrom:
                secretKeyRef:
                  name: weka-home-stats-db-credentials
                  key: stats_store_query_url
            - name: NUM_STATS_STORES
              value: "1"
            # ------------- END STATS DB connectivity ----------- #
            - name: STATS_UPLOAD_STRATEGY
              value: "push-to-stream"
            - name: STATS_BUCKET_NAME
              value: ""
            - name: ADMIN_USERNAME
              valueFrom:
                secretKeyRef:
                    name: weka-home-admin-credentials
                    key: admin_username
            - name: ADMIN_PASSWORD
              valueFrom:
                secretKeyRef:
                    name: weka-home-admin-credentials
                    key: admin_password
---
# Source: home-weka-io/templates/api-diags-handler.yaml
apiVersion: apps/v1
kind: Deployment
metadata:
  name: diags-handler
  labels:
    app: diags-handler
    app.kubernetes.io/name: diags-handler
    app.kubernetes.io/instance: "homewekaio"
    app.group: common
spec:
  replicas: 1
  selector:
    matchLabels:
      app.kubernetes.io/name: "diags-handler"
      app.kubernetes.io/instance: "homewekaio"
  template:
    metadata:
      labels:
        app: diags-handler
        app.kubernetes.io/name: diags-handler
        app.kubernetes.io/instance: "homewekaio"
        app.group: common
      annotations:
        prometheus.io/port: "9187"
        prometheus.io/scrape: "true"
        prometheus.io/path: /metrics
    spec:
      serviceAccountName: home-weka-io-serviceaccount
      nodeSelector: 
        {}
      containers:
        - name: home-weka-io
          image: gohome:33414c551ec9939d784e308cab53a45f
          imagePullPolicy: Never
          ports:
            - name: http
              containerPort: 8000
            - name: metrics
              containerPort: 9187
          livenessProbe:
            initialDelaySeconds: 5
            periodSeconds: 1
            httpGet:
              path: /api/v3/status
              port: 8000
            timeoutSeconds: 3
            successThreshold: 1
            failureThreshold: 1
          resources:
            limits:
              cpu: 100m
              memory: 200Mi
            requests:
              cpu: 100m
              memory: 200Mi
          # with http-service for livenessprobe only
          command:
            - ./wekahome
            - run
            - --with-http-service
            - --with-metrics
          env:
            - name: IS_OFFLINE
              value: "true"
            - name: GOHOME_API_BIND_TO
              value: ""
            - name: LOG_LEVEL
              value: INFO
            - name: PORT
              value: "8000"
            - name: MAIN_DB_POOL_SIZE
              value: "8"
            - name: SUPPORT_FILE_DB_POOL_SIZE
              value: "8"
            - name: EVENT_STORE_DB_POOL_SIZE
              value: "8"
            - name: FILTER_HTTP_REQUESTS_USER_AGENT_LOGGING
              value: "kube-probe/1.23"
            - name: NATS_URL
              value: "nats://nats:4222"
            - name: LIVENESS_PROBE_ENABLED
              value: "1"
            - name: SUPPORT_FILES_PATH
              value: /support-file-uploads
            - name: EMAIL_LINK_DOMAIN_NAME
              value: 10.108.170.142
            - name: EMAIL_LINK_DOMAIN_PROTOCOL
              value: http
            - name: METRICS_PORT
              value: "9187"
            - name: FORWARDING_ENABLED
              value: "false"
            - name: FORWARDING_URL
              value: https://api.home.weka.io
            - name: FORWARDING_CLUSTER_REGISTRATION_ENABLED
              value: "true"
            - name: FORWARDING_EVENTS_ENABLED
              value: "true"
            - name: FORWARDING_USAGE_REPORT_ENABLED
              value: "true"
            - name: FORWARDING_ANALYTICS_ENABLED
              value: "true"
            - name: FORWARDING_DIAGNOSTICS_ENABLED
              value: "true"
            - name: FORWARDING_STATS_ENABLED
              value: "true"
            - name: FORWARDING_BULK_SIZE
              value: "50"
            # ------------- START DB connectivity ---------------- #
            # USING MAIN DB WITHOUT READONLY REPLICAS
            - name: MAIN_DB_HOSTNAME
              valueFrom:
                secretKeyRef:
                  name: weka-home-main-db-credentials
                  key: hostname
            - name: READONLY_DB_HOSTNAME
              valueFrom:
                secretKeyRef:
                  name: weka-home-main-db-credentials
                  key: hostname
            - name: SUPPORT_DB_HOSTNAME
              valueFrom:
                secretKeyRef:
                  name: weka-home-support-db-credentials
                  key: hostname
            - name: MAIN_DB_PORT
              valueFrom:
                secretKeyRef:
                  name: weka-home-main-db-credentials
                  key: port
            - name: READONLY_DB_PORT
              valueFrom:
                secretKeyRef:
                  name: weka-home-main-db-credentials
                  key: port
            - name: SUPPORT_DB_PORT
              valueFrom:
                secretKeyRef:
                  name: weka-home-support-db-credentials
                  key: port
            - name: MAIN_DB_USERNAME
              valueFrom:
                secretKeyRef:
                  name: weka-home-main-db-credentials
                  key: username
            - name: READONLY_DB_USERNAME
              valueFrom:
                secretKeyRef:
                  name: weka-home-main-db-credentials
                  key: username
            - name: SUPPORT_DB_USERNAME
              valueFrom:
                secretKeyRef:
                  name: weka-home-support-db-credentials
                  key: username
            - name: MAIN_DB_PASSWORD
              valueFrom:
                secretKeyRef:
                  name: weka-home-main-db-credentials
                  key: password
            - name: READONLY_DB_PASSWORD
              valueFrom:
                secretKeyRef:
                  name: weka-home-main-db-credentials
                  key: password
            - name: SUPPORT_DB_PASSWORD
              valueFrom:
                secretKeyRef:
                  name: weka-home-support-db-credentials
                  key: password
            - name: MAIN_DB_DATABASE
              valueFrom:
                secretKeyRef:
                  name: weka-home-main-db-credentials
                  key: database
            - name: READONLY_DB_DATABASE
              valueFrom:
                secretKeyRef:
                  name: weka-home-main-db-credentials
                  key: database
            - name: SUPPORT_DB_DATABASE
              valueFrom:
                secretKeyRef:
                  name: weka-home-support-db-credentials
                  key: database
            - name: NUM_EVENT_STORES
              value: "1"
            - name: EVENT_STORE_0_HOSTNAME
              valueFrom:
                secretKeyRef:
                  name: weka-home-event-db-credentials-0
                  key: hostname
            - name: EVENT_STORE_0_PORT
              valueFrom:
                secretKeyRef:
                  name: weka-home-event-db-credentials-0
                  key: port
            - name: EVENT_STORE_0_USERNAME
              valueFrom:
                secretKeyRef:
                  name: weka-home-event-db-credentials-0
                  key: username
            - name: EVENT_STORE_0_PASSWORD
              valueFrom:
                secretKeyRef:
                  name: weka-home-event-db-credentials-0
                  key: password
            - name: EVENT_STORE_0_DATABASE
              valueFrom:
                secretKeyRef:
                  name: weka-home-event-db-credentials-0
                  key: database
            
            - name: DATABASE_URL
              value: "postgres://$(MAIN_DB_USERNAME):$(MAIN_DB_PASSWORD)@$(MAIN_DB_HOSTNAME):$(MAIN_DB_PORT)/$(MAIN_DB_DATABASE)?sslmode=disable"

            - name: RO_DATABASE_URL
              value: "postgres://$(READONLY_DB_USERNAME):$(READONLY_DB_PASSWORD)@$(READONLY_DB_HOSTNAME):$(READONLY_DB_PORT)/$(READONLY_DB_DATABASE)?sslmode=disable"
            - name: SUPPORT_FILES_DATABASE_URL
              value: "postgres://$(SUPPORT_DB_USERNAME):$(SUPPORT_DB_PASSWORD)@$(SUPPORT_DB_HOSTNAME):$(SUPPORT_DB_PORT)/$(SUPPORT_DB_DATABASE)?sslmode=disable"
            - name: EVENT_STORE_0_URL
              value: "postgres://$(EVENT_STORE_0_USERNAME):$(EVENT_STORE_0_PASSWORD)@$(EVENT_STORE_0_HOSTNAME):$(EVENT_STORE_0_PORT)/$(EVENT_STORE_0_DATABASE)?sslmode=disable"
            # ------------- END DB connectivity ---------------- #
            # ------------- START STATS DB connectivity ----------- #
            - name: STATS_STORE_URL
              valueFrom:
                secretKeyRef:
                  name: weka-home-stats-db-credentials
                  key: stats_store_url
            - name: STATS_STORE_QUERY_URL
              valueFrom:
                secretKeyRef:
                  name: weka-home-stats-db-credentials
                  key: stats_store_query_url
            - name: NUM_STATS_STORES
              value: "1"
            # ------------- END STATS DB connectivity ----------- #
            - name: STATS_UPLOAD_STRATEGY
              value: "push-to-stream"
            - name: STATS_BUCKET_NAME
              value: ""
            - name: ADMIN_USERNAME
              valueFrom:
                secretKeyRef:
                    name: weka-home-admin-credentials
                    key: admin_username
            - name: ADMIN_PASSWORD
              valueFrom:
                secretKeyRef:
                    name: weka-home-admin-credentials
                    key: admin_password
            - name: WEKA_SECRET_KEY
              valueFrom:
                secretKeyRef:
                    name: weka-home-encryption
                    key: encryption_secret_key
          volumeMounts:
            - mountPath: /support-file-uploads
              name: support-files
      volumes:
        - name: support-files
          persistentVolumeClaim:
            claimName: diags-handler-pvc
---
# Source: home-weka-io/templates/api-event-processor.yaml
apiVersion: apps/v1
kind: Deployment
metadata:
  name: eventprocessor
  labels:
    app: eventprocessor
    app.kubernetes.io/name: eventprocessor
    app.kubernetes.io/instance: "homewekaio"
    app.group: common
spec:
  replicas: 1
  strategy:
    rollingUpdate:
      maxUnavailable: 1
  selector:
    matchLabels:
      app.kubernetes.io/name: "eventprocessor"
      app.kubernetes.io/instance: "homewekaio"
  template:
    metadata:
      labels:
        app: eventprocessor
        app.kubernetes.io/name: eventprocessor
        app.kubernetes.io/instance: "homewekaio"
        app.group: common
      annotations:
        prometheus.io/port: "9187"
        prometheus.io/scrape: "true"
        prometheus.io/path: /metrics
    spec:
      serviceAccountName: home-weka-io-serviceaccount
      nodeSelector: 
        {}
      containers:
        - name: home-weka-io
          image: gohome:33414c551ec9939d784e308cab53a45f
          imagePullPolicy: Never
          ports:
            - name: http
              containerPort: 8000
            - name: metrics
              containerPort: 9187
          livenessProbe:
            initialDelaySeconds: 5
            periodSeconds: 1
            httpGet:
              path: /api/v3/status
              port: 8000
            timeoutSeconds: 3
            successThreshold: 1
            failureThreshold: 1
          resources:
            limits:
              cpu: 100m
              memory: 200Mi
            requests:
              cpu: 100m
              memory: 200Mi
          command:
            - ./wekahome
            - run
            - --with-event-processor
            - --with-http-service
            - --exit-fast
            - --with-metrics
          env:
            - name: PAGER_DUTY_WEKA_HOME_URL
              value: "10.108.170.142"
            - name: EVENT_PROCESSOR_FREQUENCY_MAX_PERIOD
              value: "15m"
            - name: EVENT_PROCESSOR_SLEEP
              value: "2s"
            - name: EVENT_PROCESSOR_BATCH_SIZE
              value: "1000"
            - name: IS_OFFLINE
              value: "true"
            - name: GOHOME_API_BIND_TO
              value: ""
            - name: LOG_LEVEL
              value: INFO
            - name: PORT
              value: "8000"
            - name: MAIN_DB_POOL_SIZE
              value: "8"
            - name: SUPPORT_FILE_DB_POOL_SIZE
              value: "8"
            - name: EVENT_STORE_DB_POOL_SIZE
              value: "8"
            - name: FILTER_HTTP_REQUESTS_USER_AGENT_LOGGING
              value: "kube-probe/1.23"
            - name: NATS_URL
              value: "nats://nats:4222"
            - name: LIVENESS_PROBE_ENABLED
              value: "1"
            - name: SUPPORT_FILES_PATH
              value: /support-file-uploads
            - name: EMAIL_LINK_DOMAIN_NAME
              value: 10.108.170.142
            - name: EMAIL_LINK_DOMAIN_PROTOCOL
              value: http
            - name: METRICS_PORT
              value: "9187"
            - name: FORWARDING_ENABLED
              value: "false"
            - name: FORWARDING_URL
              value: https://api.home.weka.io
            - name: FORWARDING_CLUSTER_REGISTRATION_ENABLED
              value: "true"
            - name: FORWARDING_EVENTS_ENABLED
              value: "true"
            - name: FORWARDING_USAGE_REPORT_ENABLED
              value: "true"
            - name: FORWARDING_ANALYTICS_ENABLED
              value: "true"
            - name: FORWARDING_DIAGNOSTICS_ENABLED
              value: "true"
            - name: FORWARDING_STATS_ENABLED
              value: "true"
            - name: FORWARDING_BULK_SIZE
              value: "50"
            # ------------- START DB connectivity ---------------- #
            # USING MAIN DB WITHOUT READONLY REPLICAS
            - name: MAIN_DB_HOSTNAME
              valueFrom:
                secretKeyRef:
                  name: weka-home-main-db-credentials
                  key: hostname
            - name: READONLY_DB_HOSTNAME
              valueFrom:
                secretKeyRef:
                  name: weka-home-main-db-credentials
                  key: hostname
            - name: SUPPORT_DB_HOSTNAME
              valueFrom:
                secretKeyRef:
                  name: weka-home-support-db-credentials
                  key: hostname
            - name: MAIN_DB_PORT
              valueFrom:
                secretKeyRef:
                  name: weka-home-main-db-credentials
                  key: port
            - name: READONLY_DB_PORT
              valueFrom:
                secretKeyRef:
                  name: weka-home-main-db-credentials
                  key: port
            - name: SUPPORT_DB_PORT
              valueFrom:
                secretKeyRef:
                  name: weka-home-support-db-credentials
                  key: port
            - name: MAIN_DB_USERNAME
              valueFrom:
                secretKeyRef:
                  name: weka-home-main-db-credentials
                  key: username
            - name: READONLY_DB_USERNAME
              valueFrom:
                secretKeyRef:
                  name: weka-home-main-db-credentials
                  key: username
            - name: SUPPORT_DB_USERNAME
              valueFrom:
                secretKeyRef:
                  name: weka-home-support-db-credentials
                  key: username
            - name: MAIN_DB_PASSWORD
              valueFrom:
                secretKeyRef:
                  name: weka-home-main-db-credentials
                  key: password
            - name: READONLY_DB_PASSWORD
              valueFrom:
                secretKeyRef:
                  name: weka-home-main-db-credentials
                  key: password
            - name: SUPPORT_DB_PASSWORD
              valueFrom:
                secretKeyRef:
                  name: weka-home-support-db-credentials
                  key: password
            - name: MAIN_DB_DATABASE
              valueFrom:
                secretKeyRef:
                  name: weka-home-main-db-credentials
                  key: database
            - name: READONLY_DB_DATABASE
              valueFrom:
                secretKeyRef:
                  name: weka-home-main-db-credentials
                  key: database
            - name: SUPPORT_DB_DATABASE
              valueFrom:
                secretKeyRef:
                  name: weka-home-support-db-credentials
                  key: database
            - name: NUM_EVENT_STORES
              value: "1"
            - name: EVENT_STORE_0_HOSTNAME
              valueFrom:
                secretKeyRef:
                  name: weka-home-event-db-credentials-0
                  key: hostname
            - name: EVENT_STORE_0_PORT
              valueFrom:
                secretKeyRef:
                  name: weka-home-event-db-credentials-0
                  key: port
            - name: EVENT_STORE_0_USERNAME
              valueFrom:
                secretKeyRef:
                  name: weka-home-event-db-credentials-0
                  key: username
            - name: EVENT_STORE_0_PASSWORD
              valueFrom:
                secretKeyRef:
                  name: weka-home-event-db-credentials-0
                  key: password
            - name: EVENT_STORE_0_DATABASE
              valueFrom:
                secretKeyRef:
                  name: weka-home-event-db-credentials-0
                  key: database
            
            - name: DATABASE_URL
              value: "postgres://$(MAIN_DB_USERNAME):$(MAIN_DB_PASSWORD)@$(MAIN_DB_HOSTNAME):$(MAIN_DB_PORT)/$(MAIN_DB_DATABASE)?sslmode=disable"

            - name: RO_DATABASE_URL
              value: "postgres://$(READONLY_DB_USERNAME):$(READONLY_DB_PASSWORD)@$(READONLY_DB_HOSTNAME):$(READONLY_DB_PORT)/$(READONLY_DB_DATABASE)?sslmode=disable"
            - name: SUPPORT_FILES_DATABASE_URL
              value: "postgres://$(SUPPORT_DB_USERNAME):$(SUPPORT_DB_PASSWORD)@$(SUPPORT_DB_HOSTNAME):$(SUPPORT_DB_PORT)/$(SUPPORT_DB_DATABASE)?sslmode=disable"
            - name: EVENT_STORE_0_URL
              value: "postgres://$(EVENT_STORE_0_USERNAME):$(EVENT_STORE_0_PASSWORD)@$(EVENT_STORE_0_HOSTNAME):$(EVENT_STORE_0_PORT)/$(EVENT_STORE_0_DATABASE)?sslmode=disable"
            # ------------- END DB connectivity ---------------- #
            # ------------- START STATS DB connectivity ----------- #
            - name: STATS_STORE_URL
              valueFrom:
                secretKeyRef:
                  name: weka-home-stats-db-credentials
                  key: stats_store_url
            - name: STATS_STORE_QUERY_URL
              valueFrom:
                secretKeyRef:
                  name: weka-home-stats-db-credentials
                  key: stats_store_query_url
            - name: NUM_STATS_STORES
              value: "1"
            # ------------- END STATS DB connectivity ----------- #
            - name: STATS_UPLOAD_STRATEGY
              value: "push-to-stream"
            - name: STATS_BUCKET_NAME
              value: ""
            - name: ADMIN_USERNAME
              valueFrom:
                secretKeyRef:
                    name: weka-home-admin-credentials
                    key: admin_username
            - name: ADMIN_PASSWORD
              valueFrom:
                secretKeyRef:
                    name: weka-home-admin-credentials
                    key: admin_password
            - name: WEKA_SECRET_KEY
              valueFrom:
                secretKeyRef:
                    name: weka-home-encryption
                    key: encryption_secret_key
---
# Source: home-weka-io/templates/api-main.yaml
apiVersion: apps/v1
kind: Deployment
metadata:
  name: api
  labels:
    app: api
    app.kubernetes.io/name: api
    app.kubernetes.io/instance: "homewekaio"
    app.group: hpa
spec:
  replicas: 2
  strategy:
    rollingUpdate:
      maxUnavailable: 1
  selector:
    matchLabels:
      app.kubernetes.io/name: "api"
      app.kubernetes.io/instance: "homewekaio"
  template:
    metadata:
      labels:
        app: api
        app.kubernetes.io/name: api
        app.kubernetes.io/instance: "homewekaio"
        app.group: hpa
      annotations:
        prometheus.io/port: "9187"
        prometheus.io/scrape: "true"
        prometheus.io/path: /metrics
    spec:
      serviceAccountName: home-weka-io-serviceaccount
      nodeSelector:
        
        {}
      containers:
        - name: home-weka-io
          image: gohome:33414c551ec9939d784e308cab53a45f
          imagePullPolicy: Never
          ports:
            - name: http
              containerPort: 8000
            - name: metrics
              containerPort: 9187
          livenessProbe:
            initialDelaySeconds: 5
            periodSeconds: 1
            httpGet:
              path: /api/v3/status
              port: 8000
            timeoutSeconds: 3
            successThreshold: 1
            failureThreshold: 1
          resources:
            limits:
              cpu: 200m
              memory: 250Mi
            requests:
              cpu: 200m
              memory: 250Mi
          command:
            - ./wekahome
            - run
            - --with-http-service
            - --with-metrics
          env:
            - name: IS_OFFLINE
              value: "true"
            - name: GOHOME_API_BIND_TO
              value: ""
            - name: LOG_LEVEL
              value: INFO
            - name: PORT
              value: "8000"
            - name: MAIN_DB_POOL_SIZE
              value: "8"
            - name: SUPPORT_FILE_DB_POOL_SIZE
              value: "8"
            - name: EVENT_STORE_DB_POOL_SIZE
              value: "8"
            - name: FILTER_HTTP_REQUESTS_USER_AGENT_LOGGING
              value: "kube-probe/1.23"
            - name: NATS_URL
              value: "nats://nats:4222"
            - name: LIVENESS_PROBE_ENABLED
              value: "1"
            - name: SUPPORT_FILES_PATH
              value: /support-file-uploads
            - name: EMAIL_LINK_DOMAIN_NAME
              value: 10.108.170.142
            - name: EMAIL_LINK_DOMAIN_PROTOCOL
              value: http
            - name: METRICS_PORT
              value: "9187"
            - name: FORWARDING_ENABLED
              value: "false"
            - name: FORWARDING_URL
              value: https://api.home.weka.io
            - name: FORWARDING_CLUSTER_REGISTRATION_ENABLED
              value: "true"
            - name: FORWARDING_EVENTS_ENABLED
              value: "true"
            - name: FORWARDING_USAGE_REPORT_ENABLED
              value: "true"
            - name: FORWARDING_ANALYTICS_ENABLED
              value: "true"
            - name: FORWARDING_DIAGNOSTICS_ENABLED
              value: "true"
            - name: FORWARDING_STATS_ENABLED
              value: "true"
            - name: FORWARDING_BULK_SIZE
              value: "50"
            # ------------- START DB connectivity ---------------- #
            # USING MAIN DB WITHOUT READONLY REPLICAS
            - name: MAIN_DB_HOSTNAME
              valueFrom:
                secretKeyRef:
                  name: weka-home-main-db-credentials
                  key: hostname
            - name: READONLY_DB_HOSTNAME
              valueFrom:
                secretKeyRef:
                  name: weka-home-main-db-credentials
                  key: hostname
            - name: SUPPORT_DB_HOSTNAME
              valueFrom:
                secretKeyRef:
                  name: weka-home-support-db-credentials
                  key: hostname
            - name: MAIN_DB_PORT
              valueFrom:
                secretKeyRef:
                  name: weka-home-main-db-credentials
                  key: port
            - name: READONLY_DB_PORT
              valueFrom:
                secretKeyRef:
                  name: weka-home-main-db-credentials
                  key: port
            - name: SUPPORT_DB_PORT
              valueFrom:
                secretKeyRef:
                  name: weka-home-support-db-credentials
                  key: port
            - name: MAIN_DB_USERNAME
              valueFrom:
                secretKeyRef:
                  name: weka-home-main-db-credentials
                  key: username
            - name: READONLY_DB_USERNAME
              valueFrom:
                secretKeyRef:
                  name: weka-home-main-db-credentials
                  key: username
            - name: SUPPORT_DB_USERNAME
              valueFrom:
                secretKeyRef:
                  name: weka-home-support-db-credentials
                  key: username
            - name: MAIN_DB_PASSWORD
              valueFrom:
                secretKeyRef:
                  name: weka-home-main-db-credentials
                  key: password
            - name: READONLY_DB_PASSWORD
              valueFrom:
                secretKeyRef:
                  name: weka-home-main-db-credentials
                  key: password
            - name: SUPPORT_DB_PASSWORD
              valueFrom:
                secretKeyRef:
                  name: weka-home-support-db-credentials
                  key: password
            - name: MAIN_DB_DATABASE
              valueFrom:
                secretKeyRef:
                  name: weka-home-main-db-credentials
                  key: database
            - name: READONLY_DB_DATABASE
              valueFrom:
                secretKeyRef:
                  name: weka-home-main-db-credentials
                  key: database
            - name: SUPPORT_DB_DATABASE
              valueFrom:
                secretKeyRef:
                  name: weka-home-support-db-credentials
                  key: database
            - name: NUM_EVENT_STORES
              value: "1"
            - name: EVENT_STORE_0_HOSTNAME
              valueFrom:
                secretKeyRef:
                  name: weka-home-event-db-credentials-0
                  key: hostname
            - name: EVENT_STORE_0_PORT
              valueFrom:
                secretKeyRef:
                  name: weka-home-event-db-credentials-0
                  key: port
            - name: EVENT_STORE_0_USERNAME
              valueFrom:
                secretKeyRef:
                  name: weka-home-event-db-credentials-0
                  key: username
            - name: EVENT_STORE_0_PASSWORD
              valueFrom:
                secretKeyRef:
                  name: weka-home-event-db-credentials-0
                  key: password
            - name: EVENT_STORE_0_DATABASE
              valueFrom:
                secretKeyRef:
                  name: weka-home-event-db-credentials-0
                  key: database
            
            - name: DATABASE_URL
              value: "postgres://$(MAIN_DB_USERNAME):$(MAIN_DB_PASSWORD)@$(MAIN_DB_HOSTNAME):$(MAIN_DB_PORT)/$(MAIN_DB_DATABASE)?sslmode=disable"

            - name: RO_DATABASE_URL
              value: "postgres://$(READONLY_DB_USERNAME):$(READONLY_DB_PASSWORD)@$(READONLY_DB_HOSTNAME):$(READONLY_DB_PORT)/$(READONLY_DB_DATABASE)?sslmode=disable"
            - name: SUPPORT_FILES_DATABASE_URL
              value: "postgres://$(SUPPORT_DB_USERNAME):$(SUPPORT_DB_PASSWORD)@$(SUPPORT_DB_HOSTNAME):$(SUPPORT_DB_PORT)/$(SUPPORT_DB_DATABASE)?sslmode=disable"
            - name: EVENT_STORE_0_URL
              value: "postgres://$(EVENT_STORE_0_USERNAME):$(EVENT_STORE_0_PASSWORD)@$(EVENT_STORE_0_HOSTNAME):$(EVENT_STORE_0_PORT)/$(EVENT_STORE_0_DATABASE)?sslmode=disable"
            # ------------- END DB connectivity ---------------- #
            # ------------- START STATS DB connectivity ----------- #
            - name: STATS_STORE_URL
              valueFrom:
                secretKeyRef:
                  name: weka-home-stats-db-credentials
                  key: stats_store_url
            - name: STATS_STORE_QUERY_URL
              valueFrom:
                secretKeyRef:
                  name: weka-home-stats-db-credentials
                  key: stats_store_query_url
            - name: NUM_STATS_STORES
              value: "1"
            # ------------- END STATS DB connectivity ----------- #
            - name: STATS_UPLOAD_STRATEGY
              value: "push-to-stream"
            - name: STATS_BUCKET_NAME
              value: ""
            - name: ADMIN_USERNAME
              valueFrom:
                secretKeyRef:
                    name: weka-home-admin-credentials
                    key: admin_username
            - name: ADMIN_PASSWORD
              valueFrom:
                secretKeyRef:
                    name: weka-home-admin-credentials
                    key: admin_password
            - name: WEKA_SECRET_KEY
              valueFrom:
                secretKeyRef:
                    name: weka-home-encryption
                    key: encryption_secret_key
            - name: SMTP_HOST
              value: 
            - name: SMTP_PORT
              value: ""
            - name: SMTP_PASSWORD
              value: 
            - name: SMTP_USERNAME
              value: 
            - name: SENDER_EMAIL_NAME
              value: Weka Home
            - name: SENDER_EMAIL
              value: weka-home-noreply@weka.io
            - name: SMTP_INSECURE_TLS
              value: "false"
            - name: GRAFANA_WEBHOOK_TOKEN
              valueFrom:
                secretKeyRef:
                  name: grafana-webhook
                  key: webhook_token
            - name: GRAFANA_API_USER
              valueFrom:
                secretKeyRef:
                  name: weka-home-grafana-credentials
                  key: user
            - name: GRAFANA_API_PASSWORD
              valueFrom:
                secretKeyRef:
                  name: weka-home-grafana-credentials
                  key: password
            - name: GRAFANA_API_URL
              valueFrom:
                secretKeyRef:
                  name: weka-home-grafana-credentials
                  key: api_url
            - name: GRAFANA_HEALTH_DASHBOARD_UID
              value: WH_Health_Dashboard_UID_1
            - name: REMOTE_ACCESS_KILL_EXPIRED_SESSIONS
              value: "1"
            - name: REMOTE_ACCESS_KILL_UNKNOWN_SESSIONS
              value: "0"
            - name: REMOTE_ACCESS_PROVIDE_HTTPS_TERMINAL_LINKS
              value: "1"
---
# Source: home-weka-io/templates/api-stats-handler.yaml
apiVersion: apps/v1
kind: Deployment
metadata:
  name: stats-handler
  labels:
    app: stats-handler
    app.kubernetes.io/name: stats-handler
    app.kubernetes.io/instance: "homewekaio"
    app.group: hpa
spec:
  replicas: 2
  strategy:
    rollingUpdate:
      maxUnavailable: 1
  selector:
    matchLabels:
      app.kubernetes.io/name: "stats-handler"
      app.kubernetes.io/instance: "homewekaio"
  template:
    metadata:
      labels:
        app: stats-handler
        app.kubernetes.io/name: stats-handler
        app.kubernetes.io/instance: "homewekaio"
        app.group: hpa
      annotations:
        prometheus.io/port: "9187"
        prometheus.io/scrape: "true"
        prometheus.io/path: /metrics
    spec:
      serviceAccountName: home-weka-io-serviceaccount
      nodeSelector:
        
        {}
      containers:
        - name: home-weka-io
          image: gohome:33414c551ec9939d784e308cab53a45f
          imagePullPolicy: Never
          ports:
            - name: http
              containerPort: 8000
            - name: metrics
              containerPort: 9187
          livenessProbe:
            initialDelaySeconds: 5
            periodSeconds: 1
            httpGet:
              path: /api/v3/status
              port: 8000
            timeoutSeconds: 3
            successThreshold: 1
            failureThreshold: 1
          resources:
            limits:
              cpu: 250m
              memory: 250Mi
            requests:
              cpu: 250m
              memory: 250Mi
          command:
            - ./wekahome
            - run
            - --with-http-service
            - --with-metrics
          env:
            - name: IS_OFFLINE
              value: "true"
            - name: GOHOME_API_BIND_TO
              value: ""
            - name: LOG_LEVEL
              value: INFO
            - name: PORT
              value: "8000"
            - name: MAIN_DB_POOL_SIZE
              value: "8"
            - name: SUPPORT_FILE_DB_POOL_SIZE
              value: "8"
            - name: EVENT_STORE_DB_POOL_SIZE
              value: "8"
            - name: FILTER_HTTP_REQUESTS_USER_AGENT_LOGGING
              value: "kube-probe/1.23"
            - name: NATS_URL
              value: "nats://nats:4222"
            - name: LIVENESS_PROBE_ENABLED
              value: "1"
            - name: SUPPORT_FILES_PATH
              value: /support-file-uploads
            - name: EMAIL_LINK_DOMAIN_NAME
              value: 10.108.170.142
            - name: EMAIL_LINK_DOMAIN_PROTOCOL
              value: http
            - name: METRICS_PORT
              value: "9187"
            - name: FORWARDING_ENABLED
              value: "false"
            - name: FORWARDING_URL
              value: https://api.home.weka.io
            - name: FORWARDING_CLUSTER_REGISTRATION_ENABLED
              value: "true"
            - name: FORWARDING_EVENTS_ENABLED
              value: "true"
            - name: FORWARDING_USAGE_REPORT_ENABLED
              value: "true"
            - name: FORWARDING_ANALYTICS_ENABLED
              value: "true"
            - name: FORWARDING_DIAGNOSTICS_ENABLED
              value: "true"
            - name: FORWARDING_STATS_ENABLED
              value: "true"
            - name: FORWARDING_BULK_SIZE
              value: "50"
            # ------------- START DB connectivity ---------------- #
            # USING MAIN DB WITHOUT READONLY REPLICAS
            - name: MAIN_DB_HOSTNAME
              valueFrom:
                secretKeyRef:
                  name: weka-home-main-db-credentials
                  key: hostname
            - name: READONLY_DB_HOSTNAME
              valueFrom:
                secretKeyRef:
                  name: weka-home-main-db-credentials
                  key: hostname
            - name: SUPPORT_DB_HOSTNAME
              valueFrom:
                secretKeyRef:
                  name: weka-home-support-db-credentials
                  key: hostname
            - name: MAIN_DB_PORT
              valueFrom:
                secretKeyRef:
                  name: weka-home-main-db-credentials
                  key: port
            - name: READONLY_DB_PORT
              valueFrom:
                secretKeyRef:
                  name: weka-home-main-db-credentials
                  key: port
            - name: SUPPORT_DB_PORT
              valueFrom:
                secretKeyRef:
                  name: weka-home-support-db-credentials
                  key: port
            - name: MAIN_DB_USERNAME
              valueFrom:
                secretKeyRef:
                  name: weka-home-main-db-credentials
                  key: username
            - name: READONLY_DB_USERNAME
              valueFrom:
                secretKeyRef:
                  name: weka-home-main-db-credentials
                  key: username
            - name: SUPPORT_DB_USERNAME
              valueFrom:
                secretKeyRef:
                  name: weka-home-support-db-credentials
                  key: username
            - name: MAIN_DB_PASSWORD
              valueFrom:
                secretKeyRef:
                  name: weka-home-main-db-credentials
                  key: password
            - name: READONLY_DB_PASSWORD
              valueFrom:
                secretKeyRef:
                  name: weka-home-main-db-credentials
                  key: password
            - name: SUPPORT_DB_PASSWORD
              valueFrom:
                secretKeyRef:
                  name: weka-home-support-db-credentials
                  key: password
            - name: MAIN_DB_DATABASE
              valueFrom:
                secretKeyRef:
                  name: weka-home-main-db-credentials
                  key: database
            - name: READONLY_DB_DATABASE
              valueFrom:
                secretKeyRef:
                  name: weka-home-main-db-credentials
                  key: database
            - name: SUPPORT_DB_DATABASE
              valueFrom:
                secretKeyRef:
                  name: weka-home-support-db-credentials
                  key: database
            - name: NUM_EVENT_STORES
              value: "1"
            - name: EVENT_STORE_0_HOSTNAME
              valueFrom:
                secretKeyRef:
                  name: weka-home-event-db-credentials-0
                  key: hostname
            - name: EVENT_STORE_0_PORT
              valueFrom:
                secretKeyRef:
                  name: weka-home-event-db-credentials-0
                  key: port
            - name: EVENT_STORE_0_USERNAME
              valueFrom:
                secretKeyRef:
                  name: weka-home-event-db-credentials-0
                  key: username
            - name: EVENT_STORE_0_PASSWORD
              valueFrom:
                secretKeyRef:
                  name: weka-home-event-db-credentials-0
                  key: password
            - name: EVENT_STORE_0_DATABASE
              valueFrom:
                secretKeyRef:
                  name: weka-home-event-db-credentials-0
                  key: database
            
            - name: DATABASE_URL
              value: "postgres://$(MAIN_DB_USERNAME):$(MAIN_DB_PASSWORD)@$(MAIN_DB_HOSTNAME):$(MAIN_DB_PORT)/$(MAIN_DB_DATABASE)?sslmode=disable"

            - name: RO_DATABASE_URL
              value: "postgres://$(READONLY_DB_USERNAME):$(READONLY_DB_PASSWORD)@$(READONLY_DB_HOSTNAME):$(READONLY_DB_PORT)/$(READONLY_DB_DATABASE)?sslmode=disable"
            - name: SUPPORT_FILES_DATABASE_URL
              value: "postgres://$(SUPPORT_DB_USERNAME):$(SUPPORT_DB_PASSWORD)@$(SUPPORT_DB_HOSTNAME):$(SUPPORT_DB_PORT)/$(SUPPORT_DB_DATABASE)?sslmode=disable"
            - name: EVENT_STORE_0_URL
              value: "postgres://$(EVENT_STORE_0_USERNAME):$(EVENT_STORE_0_PASSWORD)@$(EVENT_STORE_0_HOSTNAME):$(EVENT_STORE_0_PORT)/$(EVENT_STORE_0_DATABASE)?sslmode=disable"
            # ------------- END DB connectivity ---------------- #
            # ------------- START STATS DB connectivity ----------- #
            - name: STATS_STORE_URL
              valueFrom:
                secretKeyRef:
                  name: weka-home-stats-db-credentials
                  key: stats_store_url
            - name: STATS_STORE_QUERY_URL
              valueFrom:
                secretKeyRef:
                  name: weka-home-stats-db-credentials
                  key: stats_store_query_url
            - name: NUM_STATS_STORES
              value: "1"
            # ------------- END STATS DB connectivity ----------- #
            - name: STATS_UPLOAD_STRATEGY
              value: "push-to-stream"
            - name: STATS_BUCKET_NAME
              value: ""
            - name: ADMIN_USERNAME
              valueFrom:
                secretKeyRef:
                    name: weka-home-admin-credentials
                    key: admin_username
            - name: ADMIN_PASSWORD
              valueFrom:
                secretKeyRef:
                    name: weka-home-admin-credentials
                    key: admin_password
            - name: WEKA_SECRET_KEY
              valueFrom:
                secretKeyRef:
                    name: weka-home-encryption
                    key: encryption_secret_key
            - name: STATS_QUEUE_TIMEOUT
              value: 60s
            - name: CONCURRENT_STATS_UPLOADS
              value: "-1"
---
# Source: home-weka-io/templates/deployment-debug-tools.yaml
# Debug pod
apiVersion: apps/v1
kind: Deployment
metadata:
  name: debug-pod
  namespace: home-weka-io
  labels:
    app: debug-pod
    app.kubernetes.io/name: debug-pod
    app.kubernetes.io/instance: "homewekaio"
    app.group: common
  annotations:
    config_checksum: 37d979c6fd2256b6848313287706595cd020d37d7c1df0c2367daa5fd14001ef
spec:
  replicas: 1
  selector:
    matchLabels:
      app: debug-pod
  template:
    metadata:
      labels:
        app: debug-pod
        app.kubernetes.io/name: debug-pod
        app.kubernetes.io/instance: "homewekaio"
        app.group: common
    spec:
      serviceAccountName: home-weka-io-serviceaccount
      containers:
        - image: gohome-debug-pod:d48067c1d33c0f7f1b895211850fdfdd
          imagePullPolicy: Never
          name: psql
          command:
            - sleep
          args:
            - infinity
          env:
            # ------------- START DB connectivity ---------------- #
            # USING MAIN DB WITHOUT READONLY REPLICAS
            - name: MAIN_DB_HOSTNAME
              valueFrom:
                secretKeyRef:
                  name: weka-home-main-db-credentials
                  key: hostname
            - name: READONLY_DB_HOSTNAME
              valueFrom:
                secretKeyRef:
                  name: weka-home-main-db-credentials
                  key: hostname
            - name: SUPPORT_DB_HOSTNAME
              valueFrom:
                secretKeyRef:
                  name: weka-home-support-db-credentials
                  key: hostname
            - name: MAIN_DB_PORT
              valueFrom:
                secretKeyRef:
                  name: weka-home-main-db-credentials
                  key: port
            - name: READONLY_DB_PORT
              valueFrom:
                secretKeyRef:
                  name: weka-home-main-db-credentials
                  key: port
            - name: SUPPORT_DB_PORT
              valueFrom:
                secretKeyRef:
                  name: weka-home-support-db-credentials
                  key: port
            - name: MAIN_DB_USERNAME
              valueFrom:
                secretKeyRef:
                  name: weka-home-main-db-credentials
                  key: username
            - name: READONLY_DB_USERNAME
              valueFrom:
                secretKeyRef:
                  name: weka-home-main-db-credentials
                  key: username
            - name: SUPPORT_DB_USERNAME
              valueFrom:
                secretKeyRef:
                  name: weka-home-support-db-credentials
                  key: username
            - name: MAIN_DB_PASSWORD
              valueFrom:
                secretKeyRef:
                  name: weka-home-main-db-credentials
                  key: password
            - name: READONLY_DB_PASSWORD
              valueFrom:
                secretKeyRef:
                  name: weka-home-main-db-credentials
                  key: password
            - name: SUPPORT_DB_PASSWORD
              valueFrom:
                secretKeyRef:
                  name: weka-home-support-db-credentials
                  key: password
            - name: MAIN_DB_DATABASE
              valueFrom:
                secretKeyRef:
                  name: weka-home-main-db-credentials
                  key: database
            - name: READONLY_DB_DATABASE
              valueFrom:
                secretKeyRef:
                  name: weka-home-main-db-credentials
                  key: database
            - name: SUPPORT_DB_DATABASE
              valueFrom:
                secretKeyRef:
                  name: weka-home-support-db-credentials
                  key: database
            - name: NUM_EVENT_STORES
              value: "1"
            - name: EVENT_STORE_0_HOSTNAME
              valueFrom:
                secretKeyRef:
                  name: weka-home-event-db-credentials-0
                  key: hostname
            - name: EVENT_STORE_0_PORT
              valueFrom:
                secretKeyRef:
                  name: weka-home-event-db-credentials-0
                  key: port
            - name: EVENT_STORE_0_USERNAME
              valueFrom:
                secretKeyRef:
                  name: weka-home-event-db-credentials-0
                  key: username
            - name: EVENT_STORE_0_PASSWORD
              valueFrom:
                secretKeyRef:
                  name: weka-home-event-db-credentials-0
                  key: password
            - name: EVENT_STORE_0_DATABASE
              valueFrom:
                secretKeyRef:
                  name: weka-home-event-db-credentials-0
                  key: database
            
            - name: DATABASE_URL
              value: "postgres://$(MAIN_DB_USERNAME):$(MAIN_DB_PASSWORD)@$(MAIN_DB_HOSTNAME):$(MAIN_DB_PORT)/$(MAIN_DB_DATABASE)?sslmode=disable"

            - name: RO_DATABASE_URL
              value: "postgres://$(READONLY_DB_USERNAME):$(READONLY_DB_PASSWORD)@$(READONLY_DB_HOSTNAME):$(READONLY_DB_PORT)/$(READONLY_DB_DATABASE)?sslmode=disable"
            - name: SUPPORT_FILES_DATABASE_URL
              value: "postgres://$(SUPPORT_DB_USERNAME):$(SUPPORT_DB_PASSWORD)@$(SUPPORT_DB_HOSTNAME):$(SUPPORT_DB_PORT)/$(SUPPORT_DB_DATABASE)?sslmode=disable"
            - name: EVENT_STORE_0_URL
              value: "postgres://$(EVENT_STORE_0_USERNAME):$(EVENT_STORE_0_PASSWORD)@$(EVENT_STORE_0_HOSTNAME):$(EVENT_STORE_0_PORT)/$(EVENT_STORE_0_DATABASE)?sslmode=disable"
            # ------------- END DB connectivity ---------------- #
            # ------------- START STATS DB connectivity ----------- #
            - name: STATS_STORE_URL
              valueFrom:
                secretKeyRef:
                  name: weka-home-stats-db-credentials
                  key: stats_store_url
            - name: STATS_STORE_QUERY_URL
              valueFrom:
                secretKeyRef:
                  name: weka-home-stats-db-credentials
                  key: stats_store_query_url
            - name: NUM_STATS_STORES
              value: "1"
            # ------------- END STATS DB connectivity ----------- #
            - name: STATS_UPLOAD_STRATEGY
              value: "push-to-stream"
            - name: STATS_BUCKET_NAME
              value: ""
      restartPolicy: Always
---
# Source: home-weka-io/templates/frontend.yaml
apiVersion: apps/v1
kind: Deployment
metadata:
  name: frontend
  labels:
    app: frontend
    app.kubernetes.io/name: frontend
    app.kubernetes.io/instance: "homewekaio"
    app.group: common
spec:
  replicas: 1
  strategy:
    rollingUpdate:
      maxUnavailable: 1
  selector:
    matchLabels:
      app.kubernetes.io/name: "frontend"
      app.kubernetes.io/instance: "homewekaio"
  template:
    metadata:
      labels:
        app: frontend
        app.kubernetes.io/name: frontend
        app.kubernetes.io/instance: "homewekaio"
        app.group: common

    spec:
      serviceAccountName: home-weka-io-serviceaccount
      nodeSelector:
        
        {}
      containers:
        - name: frontend
          image: public.ecr.aws/weka/wekahome-frontend:1e850a4107d0334fc3c261ef1ea430b305bb8b93
          imagePullPolicy: Never
          ports:
            - name: http
              containerPort: 80





          resources:
            limits:
              cpu: 50m
              memory: 100Mi
            requests:
              cpu: 50m
              memory: 100Mi
          env:
            - name: IS_OFFLINE
              value: "true"
            - name: GOHOME_API_BIND_TO
              value: ""
            - name: LOG_LEVEL
              value: INFO
            - name: PORT
              value: "8000"
            - name: MAIN_DB_POOL_SIZE
              value: "8"
            - name: SUPPORT_FILE_DB_POOL_SIZE
              value: "8"
            - name: EVENT_STORE_DB_POOL_SIZE
              value: "8"
            - name: FILTER_HTTP_REQUESTS_USER_AGENT_LOGGING
              value: "kube-probe/1.23"
            - name: NATS_URL
              value: "nats://nats:4222"
            - name: LIVENESS_PROBE_ENABLED
              value: "1"
            - name: SUPPORT_FILES_PATH
              value: /support-file-uploads
            - name: EMAIL_LINK_DOMAIN_NAME
              value: 10.108.170.142
            - name: EMAIL_LINK_DOMAIN_PROTOCOL
              value: http
            - name: METRICS_PORT
              value: "9187"
            - name: ADMIN_USERNAME
              valueFrom:
                secretKeyRef:
                    name: weka-home-admin-credentials
                    key: admin_username
            - name: ADMIN_PASSWORD
              valueFrom:
                secretKeyRef:
                    name: weka-home-admin-credentials
                    key: admin_password
            - name: WEKA_SECRET_KEY
              valueFrom:
                secretKeyRef:
                    name: weka-home-encryption
                    key: encryption_secret_key
---
# Source: home-weka-io/templates/stats-worker-deployment.yaml
apiVersion: apps/v1
kind: Deployment
metadata:
  name: stats-worker
  labels:
    app: stats-worker
    app.kubernetes.io/name: stats-worker
    app.kubernetes.io/instance: "homewekaio"
    app.group: hpa
spec:
  replicas: 1
  strategy:
    rollingUpdate:
      maxUnavailable: 1
  selector:
    matchLabels:
      app.kubernetes.io/name: "stats-worker"
      app.kubernetes.io/instance: "homewekaio"
  template:
    metadata:
      labels:
        app: stats-worker
        app.kubernetes.io/name: stats-worker
        app.kubernetes.io/instance: "homewekaio"
        app.group: hpa
      annotations:
        prometheus.io/port: "9187"
        prometheus.io/scrape: "true"
        prometheus.io/path: /metrics
    spec:
      serviceAccountName: home-weka-io-serviceaccount
      nodeSelector:
        
        {}
      containers:
        - name: home-weka-io
          image: gohome:33414c551ec9939d784e308cab53a45f
          imagePullPolicy: Never
          ports:
            - name: metrics
              containerPort: 9187
          resources:
            limits:
              cpu: 1000m
              memory: 1000Mi
            requests:
              cpu: 1000m
              memory: 1000Mi
          command:
            - ./wekahome
            - stats-worker
          env:
            - name: IS_OFFLINE
              value: "true"
            - name: GOHOME_API_BIND_TO
              value: ""
            - name: LOG_LEVEL
              value: INFO
            - name: PORT
              value: "8000"
            - name: MAIN_DB_POOL_SIZE
              value: "8"
            - name: SUPPORT_FILE_DB_POOL_SIZE
              value: "8"
            - name: EVENT_STORE_DB_POOL_SIZE
              value: "8"
            - name: FILTER_HTTP_REQUESTS_USER_AGENT_LOGGING
              value: "kube-probe/1.23"
            - name: NATS_URL
              value: "nats://nats:4222"
            - name: LIVENESS_PROBE_ENABLED
              value: "1"
            - name: SUPPORT_FILES_PATH
              value: /support-file-uploads
            - name: EMAIL_LINK_DOMAIN_NAME
              value: 10.108.170.142
            - name: EMAIL_LINK_DOMAIN_PROTOCOL
              value: http
            - name: METRICS_PORT
              value: "9187"
            - name: FORWARDING_ENABLED
              value: "false"
            - name: FORWARDING_URL
              value: https://api.home.weka.io
            - name: FORWARDING_CLUSTER_REGISTRATION_ENABLED
              value: "true"
            - name: FORWARDING_EVENTS_ENABLED
              value: "true"
            - name: FORWARDING_USAGE_REPORT_ENABLED
              value: "true"
            - name: FORWARDING_ANALYTICS_ENABLED
              value: "true"
            - name: FORWARDING_DIAGNOSTICS_ENABLED
              value: "true"
            - name: FORWARDING_STATS_ENABLED
              value: "true"
            - name: FORWARDING_BULK_SIZE
              value: "50"
            # ------------- START DB connectivity ---------------- #
            # USING MAIN DB WITHOUT READONLY REPLICAS
            - name: MAIN_DB_HOSTNAME
              valueFrom:
                secretKeyRef:
                  name: weka-home-main-db-credentials
                  key: hostname
            - name: READONLY_DB_HOSTNAME
              valueFrom:
                secretKeyRef:
                  name: weka-home-main-db-credentials
                  key: hostname
            - name: SUPPORT_DB_HOSTNAME
              valueFrom:
                secretKeyRef:
                  name: weka-home-support-db-credentials
                  key: hostname
            - name: MAIN_DB_PORT
              valueFrom:
                secretKeyRef:
                  name: weka-home-main-db-credentials
                  key: port
            - name: READONLY_DB_PORT
              valueFrom:
                secretKeyRef:
                  name: weka-home-main-db-credentials
                  key: port
            - name: SUPPORT_DB_PORT
              valueFrom:
                secretKeyRef:
                  name: weka-home-support-db-credentials
                  key: port
            - name: MAIN_DB_USERNAME
              valueFrom:
                secretKeyRef:
                  name: weka-home-main-db-credentials
                  key: username
            - name: READONLY_DB_USERNAME
              valueFrom:
                secretKeyRef:
                  name: weka-home-main-db-credentials
                  key: username
            - name: SUPPORT_DB_USERNAME
              valueFrom:
                secretKeyRef:
                  name: weka-home-support-db-credentials
                  key: username
            - name: MAIN_DB_PASSWORD
              valueFrom:
                secretKeyRef:
                  name: weka-home-main-db-credentials
                  key: password
            - name: READONLY_DB_PASSWORD
              valueFrom:
                secretKeyRef:
                  name: weka-home-main-db-credentials
                  key: password
            - name: SUPPORT_DB_PASSWORD
              valueFrom:
                secretKeyRef:
                  name: weka-home-support-db-credentials
                  key: password
            - name: MAIN_DB_DATABASE
              valueFrom:
                secretKeyRef:
                  name: weka-home-main-db-credentials
                  key: database
            - name: READONLY_DB_DATABASE
              valueFrom:
                secretKeyRef:
                  name: weka-home-main-db-credentials
                  key: database
            - name: SUPPORT_DB_DATABASE
              valueFrom:
                secretKeyRef:
                  name: weka-home-support-db-credentials
                  key: database
            - name: NUM_EVENT_STORES
              value: "1"
            - name: EVENT_STORE_0_HOSTNAME
              valueFrom:
                secretKeyRef:
                  name: weka-home-event-db-credentials-0
                  key: hostname
            - name: EVENT_STORE_0_PORT
              valueFrom:
                secretKeyRef:
                  name: weka-home-event-db-credentials-0
                  key: port
            - name: EVENT_STORE_0_USERNAME
              valueFrom:
                secretKeyRef:
                  name: weka-home-event-db-credentials-0
                  key: username
            - name: EVENT_STORE_0_PASSWORD
              valueFrom:
                secretKeyRef:
                  name: weka-home-event-db-credentials-0
                  key: password
            - name: EVENT_STORE_0_DATABASE
              valueFrom:
                secretKeyRef:
                  name: weka-home-event-db-credentials-0
                  key: database
            
            - name: DATABASE_URL
              value: "postgres://$(MAIN_DB_USERNAME):$(MAIN_DB_PASSWORD)@$(MAIN_DB_HOSTNAME):$(MAIN_DB_PORT)/$(MAIN_DB_DATABASE)?sslmode=disable"

            - name: RO_DATABASE_URL
              value: "postgres://$(READONLY_DB_USERNAME):$(READONLY_DB_PASSWORD)@$(READONLY_DB_HOSTNAME):$(READONLY_DB_PORT)/$(READONLY_DB_DATABASE)?sslmode=disable"
            - name: SUPPORT_FILES_DATABASE_URL
              value: "postgres://$(SUPPORT_DB_USERNAME):$(SUPPORT_DB_PASSWORD)@$(SUPPORT_DB_HOSTNAME):$(SUPPORT_DB_PORT)/$(SUPPORT_DB_DATABASE)?sslmode=disable"
            - name: EVENT_STORE_0_URL
              value: "postgres://$(EVENT_STORE_0_USERNAME):$(EVENT_STORE_0_PASSWORD)@$(EVENT_STORE_0_HOSTNAME):$(EVENT_STORE_0_PORT)/$(EVENT_STORE_0_DATABASE)?sslmode=disable"
            # ------------- END DB connectivity ---------------- #
            # ------------- START STATS DB connectivity ----------- #
            - name: STATS_STORE_URL
              valueFrom:
                secretKeyRef:
                  name: weka-home-stats-db-credentials
                  key: stats_store_url
            - name: STATS_STORE_QUERY_URL
              valueFrom:
                secretKeyRef:
                  name: weka-home-stats-db-credentials
                  key: stats_store_query_url
            - name: NUM_STATS_STORES
              value: "1"
            # ------------- END STATS DB connectivity ----------- #
            - name: ADMIN_USERNAME
              valueFrom:
                secretKeyRef:
                    name: weka-home-admin-credentials
                    key: admin_username
            - name: ADMIN_PASSWORD
              valueFrom:
                secretKeyRef:
                    name: weka-home-admin-credentials
                    key: admin_password
            - name: WEKA_SECRET_KEY
              valueFrom:
                secretKeyRef:
                    name: weka-home-encryption
                    key: encryption_secret_key
            - name: STATS_UPLOAD_STRATEGY
              value: "push-to-vm"
            - name: STATS_SQS_QUEUE_NAME
              value: ""
            - name: CONCURRENT_STATS_UPLOADS
              value: "8"
---
# Source: home-weka-io/templates/api-diags-handler-hpa.yaml
apiVersion: autoscaling/v2beta1
kind: HorizontalPodAutoscaler
metadata:
  name: api-diags-handler-hpa
  labels:
    app: api-diags-handler-hpa
    app.kubernetes.io/name: api-diags-handler-hpa
    app.kubernetes.io/instance: "homewekaio"
spec:
  scaleTargetRef:
    apiVersion: apps/v1
    kind: Deployment
    name: diags-handler
  minReplicas: 1
  maxReplicas: 5
  metrics:
    - type: Resource
      resource:
        name: cpu
        targetAverageUtilization: 70
    - type: Resource
      resource:
        name: memory
        targetAverageUtilization: 80
---
# Source: home-weka-io/templates/api-main-hpa.yaml
apiVersion: autoscaling/v2beta1
kind: HorizontalPodAutoscaler
metadata:
  name: api-hpa
  labels:
    app: api-hpa
    app.kubernetes.io/name: api-hpa
    app.kubernetes.io/instance: "homewekaio"
spec:
  scaleTargetRef:
    apiVersion: apps/v1
    kind: Deployment
    name: api
  minReplicas: 1
  maxReplicas: 5
  metrics:
    - type: Resource
      resource:
        name: cpu
        targetAverageUtilization: 70
    - type: Resource
      resource:
        name: memory
        targetAverageUtilization: 80
---
# Source: home-weka-io/templates/api-stats-handler-hpa.yaml
apiVersion: autoscaling/v2beta1
kind: HorizontalPodAutoscaler
metadata:
  name: stats-handler-hpa
  labels:
    app: stats-handler-hpa
    app.kubernetes.io/name: stats-handler-hpa
    app.kubernetes.io/instance: "homewekaio"
spec:
  scaleTargetRef:
    apiVersion: apps/v1
    kind: Deployment
    name: stats-handler
  minReplicas: 1
  maxReplicas: 10
  metrics:
    - type: Resource
      resource:
        name: cpu
        targetAverageUtilization: 70
    - type: Resource
      resource:
        name: memory
        targetAverageUtilization: 80
---
# Source: home-weka-io/templates/frontend-hpa.yaml
apiVersion: autoscaling/v2beta1
kind: HorizontalPodAutoscaler
metadata:
  name: frontend-hpa
  labels:
    app: frontend-hpa
    app.kubernetes.io/name: frontend-hpa
    app.kubernetes.io/instance: "homewekaio"
spec:
  scaleTargetRef:
    apiVersion: apps/v1
    kind: Deployment
    name: frontend
  minReplicas: 1
  maxReplicas: 5
  metrics:
    - type: Resource
      resource:
        name: cpu
        targetAverageUtilization: 70
    - type: Resource
      resource:
        name: memory
        targetAverageUtilization: 80
---
# Source: home-weka-io/templates/stats-worker-hpa.yaml
apiVersion: autoscaling/v2beta1
kind: HorizontalPodAutoscaler
metadata:
  name: stats-worker-hpa
  labels:
    app: stats-worker-hpa
    app.kubernetes.io/name: stats-worker-hpa
    app.kubernetes.io/instance: "homewekaio"
spec:
  scaleTargetRef:
    apiVersion: apps/v1
    kind: Deployment
    name: stats-worker
  minReplicas: 1
  maxReplicas: 20
  metrics:
    - type: Resource
      resource:
        name: cpu
        targetAverageUtilization: 80
    - type: Resource
      resource:
        name: memory
        targetAverageUtilization: 80
---
# Source: home-weka-io/templates/vm-insert-hpa.yaml
apiVersion: autoscaling/v2beta1
kind: HorizontalPodAutoscaler
metadata:
  name: statsdb-vminsert-hpa
  labels:
    app: statsdb-vminsert-hpa
    app.kubernetes.io/name: statsdb-vminsert-hpa
    app.kubernetes.io/instance: "homewekaio"
spec:
  scaleTargetRef:
    apiVersion: apps/v1
    kind: Deployment
    name: homewekaio-statsdb-vminsert
  minReplicas: 1
  maxReplicas: 5
  metrics:
    - type: Resource
      resource:
        name: cpu
        targetAverageUtilization: 70
    - type: Resource
      resource:
        name: memory
        targetAverageUtilization: 80
---
# Source: home-weka-io/charts/event_db_0/templates/statefulset.yaml
apiVersion: apps/v1
kind: StatefulSet
metadata:
  name: homewekaio-event-db-0
  labels:
    app.kubernetes.io/name: event-db-0
    helm.sh/chart: event_db_0-10.14.3
    app.kubernetes.io/instance: homewekaio
    app.kubernetes.io/managed-by: Helm
    app.kubernetes.io/component: primary
    app.group: common
  annotations:
  namespace: home-weka-io
spec:
  serviceName: homewekaio-event-db-0-headless
  replicas: 1
  updateStrategy:
    type: RollingUpdate
  selector:
    matchLabels:
      app.kubernetes.io/name: event-db-0
      app.kubernetes.io/instance: homewekaio
      role: primary
  template:
    metadata:
      name: homewekaio-event-db-0
      labels:
        app.kubernetes.io/name: event-db-0
        helm.sh/chart: event_db_0-10.14.3
        app.kubernetes.io/instance: homewekaio
        app.kubernetes.io/managed-by: Helm
        role: primary
        app.kubernetes.io/component: primary
        app.group: common
    spec:      
      affinity:
        podAffinity:
          
        podAntiAffinity:
          preferredDuringSchedulingIgnoredDuringExecution:
            - podAffinityTerm:
                labelSelector:
                  matchLabels:
                    app.kubernetes.io/name: event-db-0
                    app.kubernetes.io/instance: homewekaio
                    app.kubernetes.io/component: primary
                namespaces:
                  - "home-weka-io"
                topologyKey: kubernetes.io/hostname
              weight: 1
        nodeAffinity:
          
      securityContext:
        fsGroup: 1001
      automountServiceAccountToken: false
      containers:
        - name: homewekaio-event-db-0
          image: docker.io/bitnami/postgresql:11.14.0-debian-10-r21
          imagePullPolicy: "Never"
          resources:
            limits:
              cpu: 200m
              memory: 200Mi
            requests:
              cpu: 200m
              memory: 200Mi
          securityContext:
            runAsUser: 1001
          env:
            - name: BITNAMI_DEBUG
              value: "false"
            - name: POSTGRESQL_PORT_NUMBER
              value: "5432"
            - name: POSTGRESQL_VOLUME_DIR
              value: "/bitnami/postgresql"
            - name: POSTGRESQL_INITSCRIPTS_USERNAME
              value: postgres
            - name: PGDATA
              value: "/bitnami/postgresql/data"
            - name: POSTGRES_USER
              value: "postgres"
            - name: POSTGRES_PASSWORD
              valueFrom:
                secretKeyRef:
                  name: weka-home-event-db-credentials-0
                  key: postgresql-password
            - name: POSTGRES_DB
              value: "postgres"
            - name: POSTGRESQL_ENABLE_LDAP
              value: "no"
            - name: POSTGRESQL_ENABLE_TLS
              value: "no"
            - name: POSTGRESQL_LOG_HOSTNAME
              value: "false"
            - name: POSTGRESQL_LOG_CONNECTIONS
              value: "false"
            - name: POSTGRESQL_LOG_DISCONNECTIONS
              value: "false"
            - name: POSTGRESQL_PGAUDIT_LOG_CATALOG
              value: "off"
            - name: POSTGRESQL_CLIENT_MIN_MESSAGES
              value: "error"
            - name: POSTGRESQL_SHARED_PRELOAD_LIBRARIES
              value: "pgaudit"
          ports:
            - name: tcp-postgresql
              containerPort: 5432
          startupProbe:
            exec:
              command:
                - /bin/sh
                - -c
                - exec pg_isready -U "postgres" -d "dbname=postgres" -h 127.0.0.1 -p 5432
            initialDelaySeconds: 30
            periodSeconds: 15
            timeoutSeconds: 5
            successThreshold: 1
            failureThreshold: 10
          livenessProbe:
            exec:
              command:
                - /bin/sh
                - -c
                - exec pg_isready -U "postgres" -d "dbname=postgres" -h 127.0.0.1 -p 5432
            initialDelaySeconds: 30
            periodSeconds: 10
            timeoutSeconds: 5
            successThreshold: 1
            failureThreshold: 6
          readinessProbe:
            exec:
              command:
                - /bin/sh
                - -c
                - -e
                - |
                  exec pg_isready -U "postgres" -d "dbname=postgres" -h 127.0.0.1 -p 5432
                  [ -f /opt/bitnami/postgresql/tmp/.initialized ] || [ -f /bitnami/postgresql/.initialized ]
            initialDelaySeconds: 5
            periodSeconds: 10
            timeoutSeconds: 5
            successThreshold: 1
            failureThreshold: 6
          volumeMounts:
            - name: custom-init-scripts
              mountPath: /docker-entrypoint-initdb.d/
            - name: dshm
              mountPath: /dev/shm
            - name: data
              mountPath: /bitnami/postgresql
              subPath: 
        - name: metrics
          image: docker.io/bitnami/postgres-exporter:0.10.0-debian-10-r166
          imagePullPolicy: "IfNotPresent"
          env:
            - name: DATA_SOURCE_URI
              value: 127.0.0.1:5432/postgres?sslmode=disable
            - name: DATA_SOURCE_PASS
              valueFrom:
                secretKeyRef:
                  name: weka-home-event-db-credentials-0
                  key: postgresql-password
            - name: DATA_SOURCE_USER
              value: postgres
          livenessProbe:
            httpGet:
              path: /
              port: http-metrics
            initialDelaySeconds: 5
            periodSeconds: 10
            timeoutSeconds: 5
            successThreshold: 1
            failureThreshold: 6
          readinessProbe:
            httpGet:
              path: /
              port: http-metrics
            initialDelaySeconds: 5
            periodSeconds: 10
            timeoutSeconds: 5
            successThreshold: 1
            failureThreshold: 6
          volumeMounts:
          ports:
            - name: http-metrics
              containerPort: 9187
      volumes:
        - name: custom-init-scripts
          configMap:
            name: event-db-init-configmap-0
        - name: dshm
          emptyDir:
            medium: Memory
  volumeClaimTemplates:
    - metadata:
        name: data
      spec:
        accessModes:
          - "ReadWriteOnce"
        resources:
          requests:
            storage: "100Gi"
        storageClassName: local-path
---
# Source: home-weka-io/charts/main_db/templates/statefulset.yaml
apiVersion: apps/v1
kind: StatefulSet
metadata:
  name: homewekaio-main-db
  labels:
    app.kubernetes.io/name: main-db
    helm.sh/chart: main_db-10.14.3
    app.kubernetes.io/instance: homewekaio
    app.kubernetes.io/managed-by: Helm
    app.kubernetes.io/component: primary
    app.group: common
  annotations:
  namespace: home-weka-io
spec:
  serviceName: homewekaio-main-db-headless
  replicas: 1
  updateStrategy:
    type: RollingUpdate
  selector:
    matchLabels:
      app.kubernetes.io/name: main-db
      app.kubernetes.io/instance: homewekaio
      role: primary
  template:
    metadata:
      name: homewekaio-main-db
      labels:
        app.kubernetes.io/name: main-db
        helm.sh/chart: main_db-10.14.3
        app.kubernetes.io/instance: homewekaio
        app.kubernetes.io/managed-by: Helm
        role: primary
        app.kubernetes.io/component: primary
        app.group: common
    spec:      
      affinity:
        podAffinity:
          
        podAntiAffinity:
          preferredDuringSchedulingIgnoredDuringExecution:
            - podAffinityTerm:
                labelSelector:
                  matchLabels:
                    app.kubernetes.io/name: main-db
                    app.kubernetes.io/instance: homewekaio
                    app.kubernetes.io/component: primary
                namespaces:
                  - "home-weka-io"
                topologyKey: kubernetes.io/hostname
              weight: 1
        nodeAffinity:
          
      securityContext:
        fsGroup: 1001
      automountServiceAccountToken: false
      containers:
        - name: homewekaio-main-db
          image: docker.io/bitnami/postgresql:11.14.0-debian-10-r21
          imagePullPolicy: "Never"
          resources:
            limits:
              cpu: 500m
              memory: 500Mi
            requests:
              cpu: 500m
              memory: 500Mi
          securityContext:
            runAsUser: 1001
          env:
            - name: BITNAMI_DEBUG
              value: "false"
            - name: POSTGRESQL_PORT_NUMBER
              value: "5432"
            - name: POSTGRESQL_VOLUME_DIR
              value: "/bitnami/postgresql"
            - name: POSTGRESQL_INITSCRIPTS_USERNAME
              value: postgres
            - name: PGDATA
              value: "/bitnami/postgresql/data"
            - name: POSTGRES_USER
              value: "postgres"
            - name: POSTGRES_PASSWORD
              valueFrom:
                secretKeyRef:
                  name: weka-home-main-db-credentials
                  key: postgresql-password
            - name: POSTGRES_DB
              value: "postgres"
            - name: POSTGRESQL_ENABLE_LDAP
              value: "no"
            - name: POSTGRESQL_ENABLE_TLS
              value: "no"
            - name: POSTGRESQL_LOG_HOSTNAME
              value: "false"
            - name: POSTGRESQL_LOG_CONNECTIONS
              value: "false"
            - name: POSTGRESQL_LOG_DISCONNECTIONS
              value: "false"
            - name: POSTGRESQL_PGAUDIT_LOG_CATALOG
              value: "off"
            - name: POSTGRESQL_CLIENT_MIN_MESSAGES
              value: "error"
            - name: POSTGRESQL_SHARED_PRELOAD_LIBRARIES
              value: "pgaudit"
          ports:
            - name: tcp-postgresql
              containerPort: 5432
          startupProbe:
            exec:
              command:
                - /bin/sh
                - -c
                - exec pg_isready -U "postgres" -d "dbname=postgres" -h 127.0.0.1 -p 5432
            initialDelaySeconds: 30
            periodSeconds: 15
            timeoutSeconds: 5
            successThreshold: 1
            failureThreshold: 10
          livenessProbe:
            exec:
              command:
                - /bin/sh
                - -c
                - exec pg_isready -U "postgres" -d "dbname=postgres" -h 127.0.0.1 -p 5432
            initialDelaySeconds: 30
            periodSeconds: 10
            timeoutSeconds: 5
            successThreshold: 1
            failureThreshold: 6
          readinessProbe:
            exec:
              command:
                - /bin/sh
                - -c
                - -e
                - |
                  exec pg_isready -U "postgres" -d "dbname=postgres" -h 127.0.0.1 -p 5432
                  [ -f /opt/bitnami/postgresql/tmp/.initialized ] || [ -f /bitnami/postgresql/.initialized ]
            initialDelaySeconds: 5
            periodSeconds: 10
            timeoutSeconds: 5
            successThreshold: 1
            failureThreshold: 6
          volumeMounts:
            - name: custom-init-scripts
              mountPath: /docker-entrypoint-initdb.d/
            - name: dshm
              mountPath: /dev/shm
            - name: data
              mountPath: /bitnami/postgresql
              subPath: 
        - name: metrics
          image: docker.io/bitnami/postgres-exporter:0.10.0-debian-10-r166
          imagePullPolicy: "IfNotPresent"
          env:
            - name: DATA_SOURCE_URI
              value: 127.0.0.1:5432/postgres?sslmode=disable
            - name: DATA_SOURCE_PASS
              valueFrom:
                secretKeyRef:
                  name: weka-home-main-db-credentials
                  key: postgresql-password
            - name: DATA_SOURCE_USER
              value: postgres
          livenessProbe:
            httpGet:
              path: /
              port: http-metrics
            initialDelaySeconds: 5
            periodSeconds: 10
            timeoutSeconds: 5
            successThreshold: 1
            failureThreshold: 6
          readinessProbe:
            httpGet:
              path: /
              port: http-metrics
            initialDelaySeconds: 5
            periodSeconds: 10
            timeoutSeconds: 5
            successThreshold: 1
            failureThreshold: 6
          volumeMounts:
          ports:
            - name: http-metrics
              containerPort: 9187
      volumes:
        - name: custom-init-scripts
          configMap:
            name: main-db-init-configmap
        - name: dshm
          emptyDir:
            medium: Memory
  volumeClaimTemplates:
    - metadata:
        name: data
      spec:
        accessModes:
          - "ReadWriteOnce"
        resources:
          requests:
            storage: "100Gi"
        storageClassName: local-path
---
# Source: home-weka-io/charts/nats/templates/statefulset.yaml
apiVersion: apps/v1
kind: StatefulSet
metadata:
  name: nats
  namespace: home-weka-io
  labels:
    helm.sh/chart: nats-0.19.13
    app.kubernetes.io/name: nats
    app.kubernetes.io/instance: homewekaio
    app.kubernetes.io/version: "2.9.16"
    app.kubernetes.io/managed-by: Helm
spec:
  selector:
    matchLabels:
      app.kubernetes.io/name: nats
      app.kubernetes.io/instance: homewekaio
  replicas: 3
  serviceName: nats

  podManagementPolicy: Parallel

  template:
    metadata:
      annotations:
        prometheus.io/path: /metrics
        prometheus.io/port: "7777"
        prometheus.io/scrape: "true"
        checksum/config: e403a409eea59fe23378ab542021ebb22b19dd080d09fcfde0d5d4cd0f0e56a5
      labels:
        app.kubernetes.io/name: nats
        app.kubernetes.io/instance: homewekaio
    spec:
      dnsPolicy: ClusterFirst
      # Common volumes for the containers.
      volumes:
      - name: config-volume
        configMap:
          name: nats-config

      # Local volume shared with the reloader.
      - name: pid
        emptyDir: {}

      #################
      #               #
      #  TLS Volumes  #
      #               #
      #################

      serviceAccountName: nats

      # Required to be able to HUP signal and apply config
      # reload to the server without restarting the pod.
      shareProcessNamespace: true

      #################
      #               #
      #  NATS Server  #
      #               #
      #################
      terminationGracePeriodSeconds: 60
      containers:
      - name: nats
        image: nats:2.9.16-alpine
        imagePullPolicy: Never
        resources:
          limits:
            cpu: 200m
            memory: 500Mi
          requests:
            cpu: 200m
            memory: 500Mi
        ports:
        - containerPort: 4222
          name: client
        - containerPort: 6222
          name: cluster
        - containerPort: 8222
          name: monitor

        command:
        - "nats-server"
        - "--config"
        - "/etc/nats-config/nats.conf"

        # Required to be able to define an environment variable
        # that refers to other environment variables.  This env var
        # is later used as part of the configuration file.
        env:
        - name: POD_NAME
          valueFrom:
            fieldRef:
              fieldPath: metadata.name
        - name: SERVER_NAME
          value: $(POD_NAME)
        - name: POD_NAMESPACE
          valueFrom:
            fieldRef:
              fieldPath: metadata.namespace
        - name: CLUSTER_ADVERTISE
          value: $(POD_NAME).nats.$(POD_NAMESPACE).svc.cluster.local
        volumeMounts:
        - name: config-volume
          mountPath: /etc/nats-config
        - name: pid
          mountPath: /var/run/nats
        - name: nats-js-pvc
          mountPath: /data
        

        #######################
        #                     #
        # Healthcheck Probes  #
        #                     #
        #######################
        livenessProbe:
          failureThreshold: 3
          httpGet:
            path: /
            port: 8222
          initialDelaySeconds: 10
          periodSeconds: 30
          successThreshold: 1
          timeoutSeconds: 5
        readinessProbe:
          failureThreshold: 3
          httpGet:
            path: /
            port: 8222
          initialDelaySeconds: 10
          periodSeconds: 10
          successThreshold: 1
          timeoutSeconds: 5
        startupProbe:
          # for NATS server versions >=2.7.1, /healthz will be enabled
          # startup probe checks that the JS server is enabled, is current with the meta leader,
          # and that all streams and consumers assigned to this JS server are current
          failureThreshold: 90
          httpGet:
            path: /healthz
            port: 8222
          initialDelaySeconds: 10
          periodSeconds: 10
          successThreshold: 1
          timeoutSeconds: 5

        # Gracefully stop NATS Server on pod deletion or image upgrade.
        #
        lifecycle:
          preStop:
            exec:
              # send the lame duck shutdown signal to trigger a graceful shutdown
              # nats-server will ignore the TERM signal it receives after this
              #
              command:
              - "nats-server"
              - "-sl=ldm=/var/run/nats/nats.pid"

      #################################
      #                               #
      #  NATS Configuration Reloader  #
      #                               #
      #################################
      - name: reloader
        image: natsio/nats-server-config-reloader:0.10.1
        imagePullPolicy: IfNotPresent
        resources:
          {}
        command:
        - "nats-server-config-reloader"
        - "-pid"
        - "/var/run/nats/nats.pid"
        - "-config"
        - "/etc/nats-config/nats.conf"
        volumeMounts:
        - name: config-volume
          mountPath: /etc/nats-config
        - name: pid
          mountPath: /var/run/nats
        

      ##############################
      #                            #
      #  NATS Prometheus Exporter  #
      #                            #
      ##############################
      - name: metrics
        image: natsio/prometheus-nats-exporter:0.10.1
        imagePullPolicy: IfNotPresent
        resources:
          {}
        args:
        - -connz
        - -routez
        - -subz
        - -varz
        - -prefix=nats
        - -use_internal_server_id
        - -jsz=all
        - http://localhost:8222/
        ports:
        - containerPort: 7777
          name: metrics

  volumeClaimTemplates:
  #####################################
  #                                   #
  #  Jetstream New Persistent Volume  #
  #                                   #
  #####################################
    - metadata:
        name: nats-js-pvc
      spec:
        accessModes:
          - ReadWriteOnce
        resources:
          requests:
            storage: 30Gi
---
# Source: home-weka-io/charts/statsdb/templates/vmselect-statefulset.yaml
apiVersion: apps/v1
kind: StatefulSet
metadata:
  labels:
    app: vmselect
    app.kubernetes.io/name: statsdb
    app.kubernetes.io/instance: homewekaio
    helm.sh/chart: statsdb-0.9.1
    app.kubernetes.io/managed-by: Helm
    app.group: common
  name: homewekaio-statsdb-vmselect
  namespace: home-weka-io
spec:
  serviceName: homewekaio-statsdb-vmselect
  selector:
    matchLabels:
      app: vmselect
      app.kubernetes.io/name: statsdb
      app.kubernetes.io/instance: homewekaio
  replicas: 2
  podManagementPolicy: 
  template:
    metadata:
      annotations:
        prometheus.io/path: /metrics
        prometheus.io/scrape: "true"
      labels:
        app: vmselect
        app.kubernetes.io/name: statsdb
        app.kubernetes.io/instance: homewekaio
        helm.sh/chart: statsdb-0.9.1
        app.kubernetes.io/managed-by: Helm
        app.group: common
    spec:
      automountServiceAccountToken: true
      containers:
        - name: statsdb-vmselect
          image: "victoriametrics/vmselect:v1.64.0-cluster"
          imagePullPolicy: "Never"
          securityContext:
            {}
          args:
            - "--cacheDataPath=/cache"
            - --storageNode=homewekaio-statsdb-vmstorage-0.homewekaio-statsdb-vmstorage.home-weka-io.svc.cluster.local:8401
            - --storageNode=homewekaio-statsdb-vmstorage-1.homewekaio-statsdb-vmstorage.home-weka-io.svc.cluster.local:8401
            - --storageNode=homewekaio-statsdb-vmstorage-2.homewekaio-statsdb-vmstorage.home-weka-io.svc.cluster.local:8401
            
            - --selectNode=homewekaio-statsdb-vmselect-0.homewekaio-statsdb-vmselect.home-weka-io.svc.cluster.local:8481
            - --selectNode=homewekaio-statsdb-vmselect-1.homewekaio-statsdb-vmselect.home-weka-io.svc.cluster.local:8481
            
            - --envflag.enable=true
            - --envflag.prefix=VM_
            - --loggerFormat=json
          ports:
            - name: http
              containerPort: 8481
          readinessProbe:
            httpGet:
              path: /health
              port: http
            initialDelaySeconds: 5
            periodSeconds: 15
          livenessProbe:
            tcpSocket:
              port: http
            initialDelaySeconds: 5
            periodSeconds: 15
            timeoutSeconds: 5
          volumeMounts:
            - mountPath: /cache
              name: cache-volume
          resources:
            limits:
              cpu: 200m
              memory: 500Mi
            requests:
              cpu: 200m
              memory: 500Mi
      serviceAccountName: homewekaio-statsdb
      volumes:
  volumeClaimTemplates:
    - metadata:
        name: cache-volume
      spec:
        accessModes:
                  - ReadWriteOnce
        resources:
          requests:
            storage: "1Gi"
        storageClassName: "local-path"
---
# Source: home-weka-io/charts/statsdb/templates/vmstorage-statefulset.yaml
apiVersion: apps/v1
kind: StatefulSet
metadata:
  labels:
    app: vmstorage
    app.kubernetes.io/name: statsdb
    app.kubernetes.io/instance: homewekaio
    helm.sh/chart: statsdb-0.9.1
    app.kubernetes.io/managed-by: Helm
    app.group: common
  name: homewekaio-statsdb-vmstorage
  namespace: home-weka-io
spec:
  serviceName: homewekaio-statsdb-vmstorage
  selector:
    matchLabels:
      app: vmstorage
      app.kubernetes.io/name: statsdb
      app.kubernetes.io/instance: homewekaio
  replicas: 3
  podManagementPolicy: OrderedReady
  template:
    metadata:
      annotations:
        prometheus.io/path: /metrics
        prometheus.io/scrape: "true"
      labels:
        app: vmstorage
        app.kubernetes.io/name: statsdb
        app.kubernetes.io/instance: homewekaio
        helm.sh/chart: statsdb-0.9.1
        app.kubernetes.io/managed-by: Helm
        app.group: common
    spec:
      automountServiceAccountToken: true
      containers:
        - name: statsdb-vmstorage
          image: "victoriametrics/vmstorage:v1.64.0-cluster"
          imagePullPolicy: "Never"
          securityContext:
            {}
          args:
            - "--retentionPeriod=7d"
            - "--storageDataPath=/storage"
            - --envflag.enable=true
            - --envflag.prefix=VM_
            - --loggerFormat=json
            - --search.maxUniqueTimeseries=10000000
          ports:
            - name: http
              containerPort: 8482
            - name: vminsert
              containerPort: 8400
            - name: vmselect
              containerPort: 8401
          livenessProbe:
            failureThreshold: 10
            initialDelaySeconds: 30
            periodSeconds: 30
            tcpSocket:
              port: http
            timeoutSeconds: 5
          readinessProbe:
            failureThreshold: 3
            httpGet:
              path: /health
              port: http
            initialDelaySeconds: 5
            periodSeconds: 15
            timeoutSeconds: 5
          resources: 
            limits:
              cpu: 500m
              memory: 2Gi
            requests:
              cpu: 500m
              memory: 2Gi
          volumeMounts:
            - name: vmstorage-volume
              mountPath: /storage
              subPath: 
      serviceAccountName: homewekaio-statsdb
      terminationGracePeriodSeconds: 60
      volumes:
  volumeClaimTemplates:
    - metadata:
        name: vmstorage-volume
      spec:
        accessModes:
          - ReadWriteOnce
        resources:
          requests:
            storage: "100Gi"
        storageClassName: "local-path"
---
# Source: home-weka-io/charts/support_db/templates/statefulset.yaml
apiVersion: apps/v1
kind: StatefulSet
metadata:
  name: homewekaio-support-db
  labels:
    app.kubernetes.io/name: support-db
    helm.sh/chart: support_db-10.14.3
    app.kubernetes.io/instance: homewekaio
    app.kubernetes.io/managed-by: Helm
    app.kubernetes.io/component: primary
    app.group: common
  annotations:
  namespace: home-weka-io
spec:
  serviceName: homewekaio-support-db-headless
  replicas: 1
  updateStrategy:
    type: RollingUpdate
  selector:
    matchLabels:
      app.kubernetes.io/name: support-db
      app.kubernetes.io/instance: homewekaio
      role: primary
  template:
    metadata:
      name: homewekaio-support-db
      labels:
        app.kubernetes.io/name: support-db
        helm.sh/chart: support_db-10.14.3
        app.kubernetes.io/instance: homewekaio
        app.kubernetes.io/managed-by: Helm
        role: primary
        app.kubernetes.io/component: primary
        app.group: common
    spec:      
      affinity:
        podAffinity:
          
        podAntiAffinity:
          preferredDuringSchedulingIgnoredDuringExecution:
            - podAffinityTerm:
                labelSelector:
                  matchLabels:
                    app.kubernetes.io/name: support-db
                    app.kubernetes.io/instance: homewekaio
                    app.kubernetes.io/component: primary
                namespaces:
                  - "home-weka-io"
                topologyKey: kubernetes.io/hostname
              weight: 1
        nodeAffinity:
          
      securityContext:
        fsGroup: 1001
      automountServiceAccountToken: false
      containers:
        - name: homewekaio-support-db
          image: docker.io/bitnami/postgresql:11.14.0-debian-10-r21
          imagePullPolicy: "Never"
          resources:
            limits:
              cpu: 200m
              memory: 200Mi
            requests:
              cpu: 200m
              memory: 200Mi
          securityContext:
            runAsUser: 1001
          env:
            - name: BITNAMI_DEBUG
              value: "false"
            - name: POSTGRESQL_PORT_NUMBER
              value: "5432"
            - name: POSTGRESQL_VOLUME_DIR
              value: "/bitnami/postgresql"
            - name: POSTGRESQL_INITSCRIPTS_USERNAME
              value: postgres
            - name: PGDATA
              value: "/bitnami/postgresql/data"
            - name: POSTGRES_USER
              value: "postgres"
            - name: POSTGRES_PASSWORD
              valueFrom:
                secretKeyRef:
                  name: weka-home-support-db-credentials
                  key: postgresql-password
            - name: POSTGRES_DB
              value: "postgres"
            - name: POSTGRESQL_ENABLE_LDAP
              value: "no"
            - name: POSTGRESQL_ENABLE_TLS
              value: "no"
            - name: POSTGRESQL_LOG_HOSTNAME
              value: "false"
            - name: POSTGRESQL_LOG_CONNECTIONS
              value: "false"
            - name: POSTGRESQL_LOG_DISCONNECTIONS
              value: "false"
            - name: POSTGRESQL_PGAUDIT_LOG_CATALOG
              value: "off"
            - name: POSTGRESQL_CLIENT_MIN_MESSAGES
              value: "error"
            - name: POSTGRESQL_SHARED_PRELOAD_LIBRARIES
              value: "pgaudit"
          ports:
            - name: tcp-postgresql
              containerPort: 5432
          startupProbe:
            exec:
              command:
                - /bin/sh
                - -c
                - exec pg_isready -U "postgres" -d "dbname=postgres" -h 127.0.0.1 -p 5432
            initialDelaySeconds: 30
            periodSeconds: 15
            timeoutSeconds: 5
            successThreshold: 1
            failureThreshold: 10
          livenessProbe:
            exec:
              command:
                - /bin/sh
                - -c
                - exec pg_isready -U "postgres" -d "dbname=postgres" -h 127.0.0.1 -p 5432
            initialDelaySeconds: 30
            periodSeconds: 10
            timeoutSeconds: 5
            successThreshold: 1
            failureThreshold: 6
          readinessProbe:
            exec:
              command:
                - /bin/sh
                - -c
                - -e
                - |
                  exec pg_isready -U "postgres" -d "dbname=postgres" -h 127.0.0.1 -p 5432
                  [ -f /opt/bitnami/postgresql/tmp/.initialized ] || [ -f /bitnami/postgresql/.initialized ]
            initialDelaySeconds: 5
            periodSeconds: 10
            timeoutSeconds: 5
            successThreshold: 1
            failureThreshold: 6
          volumeMounts:
            - name: custom-init-scripts
              mountPath: /docker-entrypoint-initdb.d/
            - name: dshm
              mountPath: /dev/shm
            - name: data
              mountPath: /bitnami/postgresql
              subPath: 
        - name: metrics
          image: docker.io/bitnami/postgres-exporter:0.10.0-debian-10-r166
          imagePullPolicy: "IfNotPresent"
          env:
            - name: DATA_SOURCE_URI
              value: 127.0.0.1:5432/postgres?sslmode=disable
            - name: DATA_SOURCE_PASS
              valueFrom:
                secretKeyRef:
                  name: weka-home-support-db-credentials
                  key: postgresql-password
            - name: DATA_SOURCE_USER
              value: postgres
          livenessProbe:
            httpGet:
              path: /
              port: http-metrics
            initialDelaySeconds: 5
            periodSeconds: 10
            timeoutSeconds: 5
            successThreshold: 1
            failureThreshold: 6
          readinessProbe:
            httpGet:
              path: /
              port: http-metrics
            initialDelaySeconds: 5
            periodSeconds: 10
            timeoutSeconds: 5
            successThreshold: 1
            failureThreshold: 6
          volumeMounts:
          ports:
            - name: http-metrics
              containerPort: 9187
      volumes:
        - name: custom-init-scripts
          configMap:
            name: support-db-init-configmap
        - name: dshm
          emptyDir:
            medium: Memory
  volumeClaimTemplates:
    - metadata:
        name: data
      spec:
        accessModes:
          - "ReadWriteOnce"
        resources:
          requests:
            storage: "100Gi"
        storageClassName: local-path
---
# Source: home-weka-io/templates/job-alert-generator.yaml
apiVersion: batch/v1beta1
kind: CronJob
metadata:
  name: alert-generator
  labels:
    app.kubernetes.io/name: alert-generator
    app.kubernetes.io/instance: "homewekaio"
    app: alert-generator
spec:
  schedule: "*/30 * * * *"
  concurrencyPolicy: Forbid
  failedJobsHistoryLimit: 3
  successfulJobsHistoryLimit: 1
  jobTemplate:
    spec:
      template:
        metadata:
          labels:
            app: alert-generator
            app.kubernetes.io/name: alert-generator
            app.kubernetes.io/instance: "homewekaio"
        spec:
          serviceAccountName: home-weka-io-serviceaccount
          restartPolicy: OnFailure
          containers:
            - name: alert-generator    
              image: gohome:33414c551ec9939d784e308cab53a45f
              imagePullPolicy: Never
              resources:
                limits:
                  cpu: 100m
                  memory: 250Mi
                requests:
                  cpu: 100m
                  memory: 250Mi
              command:
                - ./wekahome
                - job
                - generate-alerts
              env:    
                - name: IS_OFFLINE
                  value: "true"
                - name: GOHOME_API_BIND_TO
                  value: ""
                - name: LOG_LEVEL
                  value: INFO
                - name: PORT
                  value: "8000"
                - name: MAIN_DB_POOL_SIZE
                  value: "8"
                - name: SUPPORT_FILE_DB_POOL_SIZE
                  value: "8"
                - name: EVENT_STORE_DB_POOL_SIZE
                  value: "8"
                - name: FILTER_HTTP_REQUESTS_USER_AGENT_LOGGING
                  value: "kube-probe/1.23"
                - name: NATS_URL
                  value: "nats://nats:4222"
                - name: LIVENESS_PROBE_ENABLED
                  value: "1"
                - name: SUPPORT_FILES_PATH
                  value: /support-file-uploads
                - name: EMAIL_LINK_DOMAIN_NAME
                  value: 10.108.170.142
                - name: EMAIL_LINK_DOMAIN_PROTOCOL
                  value: http
                - name: METRICS_PORT
                  value: "9187"    
                - name: FORWARDING_ENABLED
                  value: "false"
                - name: FORWARDING_URL
                  value: https://api.home.weka.io
                - name: FORWARDING_CLUSTER_REGISTRATION_ENABLED
                  value: "true"
                - name: FORWARDING_EVENTS_ENABLED
                  value: "true"
                - name: FORWARDING_USAGE_REPORT_ENABLED
                  value: "true"
                - name: FORWARDING_ANALYTICS_ENABLED
                  value: "true"
                - name: FORWARDING_DIAGNOSTICS_ENABLED
                  value: "true"
                - name: FORWARDING_STATS_ENABLED
                  value: "true"
                - name: FORWARDING_BULK_SIZE
                  value: "50"    
                # ------------- START DB connectivity ---------------- #
                # USING MAIN DB WITHOUT READONLY REPLICAS
                - name: MAIN_DB_HOSTNAME
                  valueFrom:
                    secretKeyRef:
                      name: weka-home-main-db-credentials
                      key: hostname
                - name: READONLY_DB_HOSTNAME
                  valueFrom:
                    secretKeyRef:
                      name: weka-home-main-db-credentials
                      key: hostname
                - name: SUPPORT_DB_HOSTNAME
                  valueFrom:
                    secretKeyRef:
                      name: weka-home-support-db-credentials
                      key: hostname
                - name: MAIN_DB_PORT
                  valueFrom:
                    secretKeyRef:
                      name: weka-home-main-db-credentials
                      key: port
                - name: READONLY_DB_PORT
                  valueFrom:
                    secretKeyRef:
                      name: weka-home-main-db-credentials
                      key: port
                - name: SUPPORT_DB_PORT
                  valueFrom:
                    secretKeyRef:
                      name: weka-home-support-db-credentials
                      key: port
                - name: MAIN_DB_USERNAME
                  valueFrom:
                    secretKeyRef:
                      name: weka-home-main-db-credentials
                      key: username
                - name: READONLY_DB_USERNAME
                  valueFrom:
                    secretKeyRef:
                      name: weka-home-main-db-credentials
                      key: username
                - name: SUPPORT_DB_USERNAME
                  valueFrom:
                    secretKeyRef:
                      name: weka-home-support-db-credentials
                      key: username
                - name: MAIN_DB_PASSWORD
                  valueFrom:
                    secretKeyRef:
                      name: weka-home-main-db-credentials
                      key: password
                - name: READONLY_DB_PASSWORD
                  valueFrom:
                    secretKeyRef:
                      name: weka-home-main-db-credentials
                      key: password
                - name: SUPPORT_DB_PASSWORD
                  valueFrom:
                    secretKeyRef:
                      name: weka-home-support-db-credentials
                      key: password
                - name: MAIN_DB_DATABASE
                  valueFrom:
                    secretKeyRef:
                      name: weka-home-main-db-credentials
                      key: database
                - name: READONLY_DB_DATABASE
                  valueFrom:
                    secretKeyRef:
                      name: weka-home-main-db-credentials
                      key: database
                - name: SUPPORT_DB_DATABASE
                  valueFrom:
                    secretKeyRef:
                      name: weka-home-support-db-credentials
                      key: database
                - name: NUM_EVENT_STORES
                  value: "1"
                - name: EVENT_STORE_0_HOSTNAME
                  valueFrom:
                    secretKeyRef:
                      name: weka-home-event-db-credentials-0
                      key: hostname
                - name: EVENT_STORE_0_PORT
                  valueFrom:
                    secretKeyRef:
                      name: weka-home-event-db-credentials-0
                      key: port
                - name: EVENT_STORE_0_USERNAME
                  valueFrom:
                    secretKeyRef:
                      name: weka-home-event-db-credentials-0
                      key: username
                - name: EVENT_STORE_0_PASSWORD
                  valueFrom:
                    secretKeyRef:
                      name: weka-home-event-db-credentials-0
                      key: password
                - name: EVENT_STORE_0_DATABASE
                  valueFrom:
                    secretKeyRef:
                      name: weka-home-event-db-credentials-0
                      key: database
                
                - name: DATABASE_URL
                  value: "postgres://$(MAIN_DB_USERNAME):$(MAIN_DB_PASSWORD)@$(MAIN_DB_HOSTNAME):$(MAIN_DB_PORT)/$(MAIN_DB_DATABASE)?sslmode=disable"
    
                - name: RO_DATABASE_URL
                  value: "postgres://$(READONLY_DB_USERNAME):$(READONLY_DB_PASSWORD)@$(READONLY_DB_HOSTNAME):$(READONLY_DB_PORT)/$(READONLY_DB_DATABASE)?sslmode=disable"
                - name: SUPPORT_FILES_DATABASE_URL
                  value: "postgres://$(SUPPORT_DB_USERNAME):$(SUPPORT_DB_PASSWORD)@$(SUPPORT_DB_HOSTNAME):$(SUPPORT_DB_PORT)/$(SUPPORT_DB_DATABASE)?sslmode=disable"
                - name: EVENT_STORE_0_URL
                  value: "postgres://$(EVENT_STORE_0_USERNAME):$(EVENT_STORE_0_PASSWORD)@$(EVENT_STORE_0_HOSTNAME):$(EVENT_STORE_0_PORT)/$(EVENT_STORE_0_DATABASE)?sslmode=disable"
                # ------------- END DB connectivity ---------------- #    
                # ------------- START STATS DB connectivity ----------- #
                - name: STATS_STORE_URL
                  valueFrom:
                    secretKeyRef:
                      name: weka-home-stats-db-credentials
                      key: stats_store_url
                - name: STATS_STORE_QUERY_URL
                  valueFrom:
                    secretKeyRef:
                      name: weka-home-stats-db-credentials
                      key: stats_store_query_url
                - name: NUM_STATS_STORES
                  value: "1"
                # ------------- END STATS DB connectivity ----------- #                    
                - name: ADMIN_USERNAME
                  valueFrom:
                    secretKeyRef:
                        name: weka-home-admin-credentials
                        key: admin_username
                - name: ADMIN_PASSWORD
                  valueFrom:
                    secretKeyRef:
                        name: weka-home-admin-credentials
                        key: admin_password    
                - name: WEKA_SECRET_KEY
                  valueFrom:
                    secretKeyRef:
                        name: weka-home-encryption
                        key: encryption_secret_key
---
# Source: home-weka-io/templates/job-email-digest-sender.yaml
apiVersion: batch/v1beta1
kind: CronJob
metadata:
  name: email-digest-sender
  labels:
    app.kubernetes.io/name: email-digest-sender
    app.kubernetes.io/instance: "homewekaio"
    app: email-digest-sender
spec:
  schedule: "0 8 * * *"
  concurrencyPolicy: Forbid
  jobTemplate:
    spec:
      template:
        metadata:
          labels:
            app: email-digest-sender
            app.kubernetes.io/name: email-digest-sender
            app.kubernetes.io/instance: "homewekaio"
        spec:
          serviceAccountName: home-weka-io-serviceaccount
          restartPolicy: OnFailure
          containers:
            - name: email-digest-sender    
              image: gohome:33414c551ec9939d784e308cab53a45f
              imagePullPolicy: Never
              resources:
                limits:
                  cpu: 50m
                  memory: 200Mi
                requests:
                  cpu: 50m
                  memory: 200Mi
              command:
                - ./wekahome
                - job
                - send-digest-emails
              env:    
                - name: IS_OFFLINE
                  value: "true"
                - name: GOHOME_API_BIND_TO
                  value: ""
                - name: LOG_LEVEL
                  value: INFO
                - name: PORT
                  value: "8000"
                - name: MAIN_DB_POOL_SIZE
                  value: "8"
                - name: SUPPORT_FILE_DB_POOL_SIZE
                  value: "8"
                - name: EVENT_STORE_DB_POOL_SIZE
                  value: "8"
                - name: FILTER_HTTP_REQUESTS_USER_AGENT_LOGGING
                  value: "kube-probe/1.23"
                - name: NATS_URL
                  value: "nats://nats:4222"
                - name: LIVENESS_PROBE_ENABLED
                  value: "1"
                - name: SUPPORT_FILES_PATH
                  value: /support-file-uploads
                - name: EMAIL_LINK_DOMAIN_NAME
                  value: 10.108.170.142
                - name: EMAIL_LINK_DOMAIN_PROTOCOL
                  value: http
                - name: METRICS_PORT
                  value: "9187"    
                - name: FORWARDING_ENABLED
                  value: "false"
                - name: FORWARDING_URL
                  value: https://api.home.weka.io
                - name: FORWARDING_CLUSTER_REGISTRATION_ENABLED
                  value: "true"
                - name: FORWARDING_EVENTS_ENABLED
                  value: "true"
                - name: FORWARDING_USAGE_REPORT_ENABLED
                  value: "true"
                - name: FORWARDING_ANALYTICS_ENABLED
                  value: "true"
                - name: FORWARDING_DIAGNOSTICS_ENABLED
                  value: "true"
                - name: FORWARDING_STATS_ENABLED
                  value: "true"
                - name: FORWARDING_BULK_SIZE
                  value: "50"    
                # ------------- START DB connectivity ---------------- #
                # USING MAIN DB WITHOUT READONLY REPLICAS
                - name: MAIN_DB_HOSTNAME
                  valueFrom:
                    secretKeyRef:
                      name: weka-home-main-db-credentials
                      key: hostname
                - name: READONLY_DB_HOSTNAME
                  valueFrom:
                    secretKeyRef:
                      name: weka-home-main-db-credentials
                      key: hostname
                - name: SUPPORT_DB_HOSTNAME
                  valueFrom:
                    secretKeyRef:
                      name: weka-home-support-db-credentials
                      key: hostname
                - name: MAIN_DB_PORT
                  valueFrom:
                    secretKeyRef:
                      name: weka-home-main-db-credentials
                      key: port
                - name: READONLY_DB_PORT
                  valueFrom:
                    secretKeyRef:
                      name: weka-home-main-db-credentials
                      key: port
                - name: SUPPORT_DB_PORT
                  valueFrom:
                    secretKeyRef:
                      name: weka-home-support-db-credentials
                      key: port
                - name: MAIN_DB_USERNAME
                  valueFrom:
                    secretKeyRef:
                      name: weka-home-main-db-credentials
                      key: username
                - name: READONLY_DB_USERNAME
                  valueFrom:
                    secretKeyRef:
                      name: weka-home-main-db-credentials
                      key: username
                - name: SUPPORT_DB_USERNAME
                  valueFrom:
                    secretKeyRef:
                      name: weka-home-support-db-credentials
                      key: username
                - name: MAIN_DB_PASSWORD
                  valueFrom:
                    secretKeyRef:
                      name: weka-home-main-db-credentials
                      key: password
                - name: READONLY_DB_PASSWORD
                  valueFrom:
                    secretKeyRef:
                      name: weka-home-main-db-credentials
                      key: password
                - name: SUPPORT_DB_PASSWORD
                  valueFrom:
                    secretKeyRef:
                      name: weka-home-support-db-credentials
                      key: password
                - name: MAIN_DB_DATABASE
                  valueFrom:
                    secretKeyRef:
                      name: weka-home-main-db-credentials
                      key: database
                - name: READONLY_DB_DATABASE
                  valueFrom:
                    secretKeyRef:
                      name: weka-home-main-db-credentials
                      key: database
                - name: SUPPORT_DB_DATABASE
                  valueFrom:
                    secretKeyRef:
                      name: weka-home-support-db-credentials
                      key: database
                - name: NUM_EVENT_STORES
                  value: "1"
                - name: EVENT_STORE_0_HOSTNAME
                  valueFrom:
                    secretKeyRef:
                      name: weka-home-event-db-credentials-0
                      key: hostname
                - name: EVENT_STORE_0_PORT
                  valueFrom:
                    secretKeyRef:
                      name: weka-home-event-db-credentials-0
                      key: port
                - name: EVENT_STORE_0_USERNAME
                  valueFrom:
                    secretKeyRef:
                      name: weka-home-event-db-credentials-0
                      key: username
                - name: EVENT_STORE_0_PASSWORD
                  valueFrom:
                    secretKeyRef:
                      name: weka-home-event-db-credentials-0
                      key: password
                - name: EVENT_STORE_0_DATABASE
                  valueFrom:
                    secretKeyRef:
                      name: weka-home-event-db-credentials-0
                      key: database
                
                - name: DATABASE_URL
                  value: "postgres://$(MAIN_DB_USERNAME):$(MAIN_DB_PASSWORD)@$(MAIN_DB_HOSTNAME):$(MAIN_DB_PORT)/$(MAIN_DB_DATABASE)?sslmode=disable"
    
                - name: RO_DATABASE_URL
                  value: "postgres://$(READONLY_DB_USERNAME):$(READONLY_DB_PASSWORD)@$(READONLY_DB_HOSTNAME):$(READONLY_DB_PORT)/$(READONLY_DB_DATABASE)?sslmode=disable"
                - name: SUPPORT_FILES_DATABASE_URL
                  value: "postgres://$(SUPPORT_DB_USERNAME):$(SUPPORT_DB_PASSWORD)@$(SUPPORT_DB_HOSTNAME):$(SUPPORT_DB_PORT)/$(SUPPORT_DB_DATABASE)?sslmode=disable"
                - name: EVENT_STORE_0_URL
                  value: "postgres://$(EVENT_STORE_0_USERNAME):$(EVENT_STORE_0_PASSWORD)@$(EVENT_STORE_0_HOSTNAME):$(EVENT_STORE_0_PORT)/$(EVENT_STORE_0_DATABASE)?sslmode=disable"
                # ------------- END DB connectivity ---------------- #    
                # ------------- START STATS DB connectivity ----------- #
                - name: STATS_STORE_URL
                  valueFrom:
                    secretKeyRef:
                      name: weka-home-stats-db-credentials
                      key: stats_store_url
                - name: STATS_STORE_QUERY_URL
                  valueFrom:
                    secretKeyRef:
                      name: weka-home-stats-db-credentials
                      key: stats_store_query_url
                - name: NUM_STATS_STORES
                  value: "1"
                # ------------- END STATS DB connectivity ----------- #                    
                - name: SMTP_HOST
                  value: 
                - name: SMTP_PORT
                  value: ""
                - name: SMTP_PASSWORD
                  value: 
                - name: SMTP_USERNAME
                  value: 
                - name: SENDER_EMAIL_NAME
                  value: Weka Home
                - name: SENDER_EMAIL
                  value: weka-home-noreply@weka.io
                - name: SMTP_INSECURE_TLS
                  value: "false"    
                - name: ADMIN_USERNAME
                  valueFrom:
                    secretKeyRef:
                        name: weka-home-admin-credentials
                        key: admin_username
                - name: ADMIN_PASSWORD
                  valueFrom:
                    secretKeyRef:
                        name: weka-home-admin-credentials
                        key: admin_password    
                - name: WEKA_SECRET_KEY
                  valueFrom:
                    secretKeyRef:
                        name: weka-home-encryption
                        key: encryption_secret_key
---
# Source: home-weka-io/templates/job-garbage-collector.yaml
apiVersion: batch/v1beta1
kind: CronJob
metadata:
  name: garbage-collector
  labels:
    app.kubernetes.io/name: garbage-collector
    app.kubernetes.io/instance: "homewekaio"
    app: garbage-collector
spec:
  schedule: "*/5 * * * *"
  concurrencyPolicy: Forbid
  startingDeadlineSeconds: 180
  suspend: false
  failedJobsHistoryLimit: 3
  successfulJobsHistoryLimit: 1
  jobTemplate:
    spec:
      ttlSecondsAfterFinished: 3600
      template:
        metadata:
          labels:
            app: garbage-collector
            app.kubernetes.io/name: garbage-collector
            app.kubernetes.io/instance: "homewekaio"
        spec:
          serviceAccountName: home-weka-io-serviceaccount
          restartPolicy: OnFailure
          containers:
            - name: garbage-collector    
              image: gohome:33414c551ec9939d784e308cab53a45f
              imagePullPolicy: Never
              resources:
                limits:
                  cpu: 50m
                  memory: 100Mi
                requests:
                  cpu: 50m
                  memory: 100Mi
              command:
                - ./wekahome
                - job
                - gc
              env:    
                - name: IS_OFFLINE
                  value: "true"
                - name: GOHOME_API_BIND_TO
                  value: ""
                - name: LOG_LEVEL
                  value: INFO
                - name: PORT
                  value: "8000"
                - name: MAIN_DB_POOL_SIZE
                  value: "8"
                - name: SUPPORT_FILE_DB_POOL_SIZE
                  value: "8"
                - name: EVENT_STORE_DB_POOL_SIZE
                  value: "8"
                - name: FILTER_HTTP_REQUESTS_USER_AGENT_LOGGING
                  value: "kube-probe/1.23"
                - name: NATS_URL
                  value: "nats://nats:4222"
                - name: LIVENESS_PROBE_ENABLED
                  value: "1"
                - name: SUPPORT_FILES_PATH
                  value: /support-file-uploads
                - name: EMAIL_LINK_DOMAIN_NAME
                  value: 10.108.170.142
                - name: EMAIL_LINK_DOMAIN_PROTOCOL
                  value: http
                - name: METRICS_PORT
                  value: "9187"    
                - name: FORWARDING_ENABLED
                  value: "false"
                - name: FORWARDING_URL
                  value: https://api.home.weka.io
                - name: FORWARDING_CLUSTER_REGISTRATION_ENABLED
                  value: "true"
                - name: FORWARDING_EVENTS_ENABLED
                  value: "true"
                - name: FORWARDING_USAGE_REPORT_ENABLED
                  value: "true"
                - name: FORWARDING_ANALYTICS_ENABLED
                  value: "true"
                - name: FORWARDING_DIAGNOSTICS_ENABLED
                  value: "true"
                - name: FORWARDING_STATS_ENABLED
                  value: "true"
                - name: FORWARDING_BULK_SIZE
                  value: "50"    
                # ------------- START DB connectivity ---------------- #
                # USING MAIN DB WITHOUT READONLY REPLICAS
                - name: MAIN_DB_HOSTNAME
                  valueFrom:
                    secretKeyRef:
                      name: weka-home-main-db-credentials
                      key: hostname
                - name: READONLY_DB_HOSTNAME
                  valueFrom:
                    secretKeyRef:
                      name: weka-home-main-db-credentials
                      key: hostname
                - name: SUPPORT_DB_HOSTNAME
                  valueFrom:
                    secretKeyRef:
                      name: weka-home-support-db-credentials
                      key: hostname
                - name: MAIN_DB_PORT
                  valueFrom:
                    secretKeyRef:
                      name: weka-home-main-db-credentials
                      key: port
                - name: READONLY_DB_PORT
                  valueFrom:
                    secretKeyRef:
                      name: weka-home-main-db-credentials
                      key: port
                - name: SUPPORT_DB_PORT
                  valueFrom:
                    secretKeyRef:
                      name: weka-home-support-db-credentials
                      key: port
                - name: MAIN_DB_USERNAME
                  valueFrom:
                    secretKeyRef:
                      name: weka-home-main-db-credentials
                      key: username
                - name: READONLY_DB_USERNAME
                  valueFrom:
                    secretKeyRef:
                      name: weka-home-main-db-credentials
                      key: username
                - name: SUPPORT_DB_USERNAME
                  valueFrom:
                    secretKeyRef:
                      name: weka-home-support-db-credentials
                      key: username
                - name: MAIN_DB_PASSWORD
                  valueFrom:
                    secretKeyRef:
                      name: weka-home-main-db-credentials
                      key: password
                - name: READONLY_DB_PASSWORD
                  valueFrom:
                    secretKeyRef:
                      name: weka-home-main-db-credentials
                      key: password
                - name: SUPPORT_DB_PASSWORD
                  valueFrom:
                    secretKeyRef:
                      name: weka-home-support-db-credentials
                      key: password
                - name: MAIN_DB_DATABASE
                  valueFrom:
                    secretKeyRef:
                      name: weka-home-main-db-credentials
                      key: database
                - name: READONLY_DB_DATABASE
                  valueFrom:
                    secretKeyRef:
                      name: weka-home-main-db-credentials
                      key: database
                - name: SUPPORT_DB_DATABASE
                  valueFrom:
                    secretKeyRef:
                      name: weka-home-support-db-credentials
                      key: database
                - name: NUM_EVENT_STORES
                  value: "1"
                - name: EVENT_STORE_0_HOSTNAME
                  valueFrom:
                    secretKeyRef:
                      name: weka-home-event-db-credentials-0
                      key: hostname
                - name: EVENT_STORE_0_PORT
                  valueFrom:
                    secretKeyRef:
                      name: weka-home-event-db-credentials-0
                      key: port
                - name: EVENT_STORE_0_USERNAME
                  valueFrom:
                    secretKeyRef:
                      name: weka-home-event-db-credentials-0
                      key: username
                - name: EVENT_STORE_0_PASSWORD
                  valueFrom:
                    secretKeyRef:
                      name: weka-home-event-db-credentials-0
                      key: password
                - name: EVENT_STORE_0_DATABASE
                  valueFrom:
                    secretKeyRef:
                      name: weka-home-event-db-credentials-0
                      key: database
                
                - name: DATABASE_URL
                  value: "postgres://$(MAIN_DB_USERNAME):$(MAIN_DB_PASSWORD)@$(MAIN_DB_HOSTNAME):$(MAIN_DB_PORT)/$(MAIN_DB_DATABASE)?sslmode=disable"
    
                - name: RO_DATABASE_URL
                  value: "postgres://$(READONLY_DB_USERNAME):$(READONLY_DB_PASSWORD)@$(READONLY_DB_HOSTNAME):$(READONLY_DB_PORT)/$(READONLY_DB_DATABASE)?sslmode=disable"
                - name: SUPPORT_FILES_DATABASE_URL
                  value: "postgres://$(SUPPORT_DB_USERNAME):$(SUPPORT_DB_PASSWORD)@$(SUPPORT_DB_HOSTNAME):$(SUPPORT_DB_PORT)/$(SUPPORT_DB_DATABASE)?sslmode=disable"
                - name: EVENT_STORE_0_URL
                  value: "postgres://$(EVENT_STORE_0_USERNAME):$(EVENT_STORE_0_PASSWORD)@$(EVENT_STORE_0_HOSTNAME):$(EVENT_STORE_0_PORT)/$(EVENT_STORE_0_DATABASE)?sslmode=disable"
                # ------------- END DB connectivity ---------------- #    
                # ------------- START STATS DB connectivity ----------- #
                - name: STATS_STORE_URL
                  valueFrom:
                    secretKeyRef:
                      name: weka-home-stats-db-credentials
                      key: stats_store_url
                - name: STATS_STORE_QUERY_URL
                  valueFrom:
                    secretKeyRef:
                      name: weka-home-stats-db-credentials
                      key: stats_store_query_url
                - name: NUM_STATS_STORES
                  value: "1"
                # ------------- END STATS DB connectivity ----------- #    
                - name: GC_CLUSTERS_MAX_AGE
                  value: "90d"
                - name: GC_CLUSTERS_DELETE_BATCH_SIZE
                  value: "1000"
                - name: GC_EVENTS_MAX_AGE
                  value: "30d"
                - name: GC_EVENTS_DELETE_BATCH_SIZE
                  value: "500000"
                - name: GC_SUPPORT_FILES_MAX_AGE
                  value: "365d"
                - name: GC_SUPPORT_FILES_DELETE_BATCH_SIZE
                  value: "5000"                    
                - name: ADMIN_USERNAME
                  valueFrom:
                    secretKeyRef:
                        name: weka-home-admin-credentials
                        key: admin_username
                - name: ADMIN_PASSWORD
                  valueFrom:
                    secretKeyRef:
                        name: weka-home-admin-credentials
                        key: admin_password    
                - name: WEKA_SECRET_KEY
                  valueFrom:
                    secretKeyRef:
                        name: weka-home-encryption
                        key: encryption_secret_key
                - name: REMOTE_ACCESS_DELETE_CLOSED_SESSIONS_AFTER
                  value: 365d
                - name: REMOTE_ACCESS_LEGACY_SESSION_MAX_AGE
                  value: 14d
                - name: REMOTE_ACCESS_NO_HEARTBEAT_EXPIRE_AGE
                  value: 1h
---
# Source: home-weka-io/templates/job-grafana-api.yaml
apiVersion: batch/v1beta1
kind: CronJob
metadata:
  name: grafana-api
  labels:
    app.kubernetes.io/name: grafana-api
    app.kubernetes.io/instance: "homewekaio"
    app: grafana-api
spec:
  schedule: "*/1 * * * *"
  concurrencyPolicy: Forbid
  failedJobsHistoryLimit: 3
  successfulJobsHistoryLimit: 1
  jobTemplate:
    spec:
      template:
        metadata:
          labels:
            app: grafana-api
            app.kubernetes.io/name: grafana-api
            app.kubernetes.io/instance: "homewekaio"
        spec:
          serviceAccountName: home-weka-io-serviceaccount
          restartPolicy: OnFailure
          containers:
            - name: grafana-api    
              image: gohome:33414c551ec9939d784e308cab53a45f
              imagePullPolicy: Never
              resources:
                limits:
                  cpu: 50m
                  memory: 200Mi
                requests:
                  cpu: 50m
                  memory: 200Mi
              command:
                - ./wekahome
                - job
                - grafana-api
              env:    
                - name: IS_OFFLINE
                  value: "true"
                - name: GOHOME_API_BIND_TO
                  value: ""
                - name: LOG_LEVEL
                  value: INFO
                - name: PORT
                  value: "8000"
                - name: MAIN_DB_POOL_SIZE
                  value: "8"
                - name: SUPPORT_FILE_DB_POOL_SIZE
                  value: "8"
                - name: EVENT_STORE_DB_POOL_SIZE
                  value: "8"
                - name: FILTER_HTTP_REQUESTS_USER_AGENT_LOGGING
                  value: "kube-probe/1.23"
                - name: NATS_URL
                  value: "nats://nats:4222"
                - name: LIVENESS_PROBE_ENABLED
                  value: "1"
                - name: SUPPORT_FILES_PATH
                  value: /support-file-uploads
                - name: EMAIL_LINK_DOMAIN_NAME
                  value: 10.108.170.142
                - name: EMAIL_LINK_DOMAIN_PROTOCOL
                  value: http
                - name: METRICS_PORT
                  value: "9187"    
                - name: FORWARDING_ENABLED
                  value: "false"
                - name: FORWARDING_URL
                  value: https://api.home.weka.io
                - name: FORWARDING_CLUSTER_REGISTRATION_ENABLED
                  value: "true"
                - name: FORWARDING_EVENTS_ENABLED
                  value: "true"
                - name: FORWARDING_USAGE_REPORT_ENABLED
                  value: "true"
                - name: FORWARDING_ANALYTICS_ENABLED
                  value: "true"
                - name: FORWARDING_DIAGNOSTICS_ENABLED
                  value: "true"
                - name: FORWARDING_STATS_ENABLED
                  value: "true"
                - name: FORWARDING_BULK_SIZE
                  value: "50"    
                # ------------- START DB connectivity ---------------- #
                # USING MAIN DB WITHOUT READONLY REPLICAS
                - name: MAIN_DB_HOSTNAME
                  valueFrom:
                    secretKeyRef:
                      name: weka-home-main-db-credentials
                      key: hostname
                - name: READONLY_DB_HOSTNAME
                  valueFrom:
                    secretKeyRef:
                      name: weka-home-main-db-credentials
                      key: hostname
                - name: SUPPORT_DB_HOSTNAME
                  valueFrom:
                    secretKeyRef:
                      name: weka-home-support-db-credentials
                      key: hostname
                - name: MAIN_DB_PORT
                  valueFrom:
                    secretKeyRef:
                      name: weka-home-main-db-credentials
                      key: port
                - name: READONLY_DB_PORT
                  valueFrom:
                    secretKeyRef:
                      name: weka-home-main-db-credentials
                      key: port
                - name: SUPPORT_DB_PORT
                  valueFrom:
                    secretKeyRef:
                      name: weka-home-support-db-credentials
                      key: port
                - name: MAIN_DB_USERNAME
                  valueFrom:
                    secretKeyRef:
                      name: weka-home-main-db-credentials
                      key: username
                - name: READONLY_DB_USERNAME
                  valueFrom:
                    secretKeyRef:
                      name: weka-home-main-db-credentials
                      key: username
                - name: SUPPORT_DB_USERNAME
                  valueFrom:
                    secretKeyRef:
                      name: weka-home-support-db-credentials
                      key: username
                - name: MAIN_DB_PASSWORD
                  valueFrom:
                    secretKeyRef:
                      name: weka-home-main-db-credentials
                      key: password
                - name: READONLY_DB_PASSWORD
                  valueFrom:
                    secretKeyRef:
                      name: weka-home-main-db-credentials
                      key: password
                - name: SUPPORT_DB_PASSWORD
                  valueFrom:
                    secretKeyRef:
                      name: weka-home-support-db-credentials
                      key: password
                - name: MAIN_DB_DATABASE
                  valueFrom:
                    secretKeyRef:
                      name: weka-home-main-db-credentials
                      key: database
                - name: READONLY_DB_DATABASE
                  valueFrom:
                    secretKeyRef:
                      name: weka-home-main-db-credentials
                      key: database
                - name: SUPPORT_DB_DATABASE
                  valueFrom:
                    secretKeyRef:
                      name: weka-home-support-db-credentials
                      key: database
                - name: NUM_EVENT_STORES
                  value: "1"
                - name: EVENT_STORE_0_HOSTNAME
                  valueFrom:
                    secretKeyRef:
                      name: weka-home-event-db-credentials-0
                      key: hostname
                - name: EVENT_STORE_0_PORT
                  valueFrom:
                    secretKeyRef:
                      name: weka-home-event-db-credentials-0
                      key: port
                - name: EVENT_STORE_0_USERNAME
                  valueFrom:
                    secretKeyRef:
                      name: weka-home-event-db-credentials-0
                      key: username
                - name: EVENT_STORE_0_PASSWORD
                  valueFrom:
                    secretKeyRef:
                      name: weka-home-event-db-credentials-0
                      key: password
                - name: EVENT_STORE_0_DATABASE
                  valueFrom:
                    secretKeyRef:
                      name: weka-home-event-db-credentials-0
                      key: database
                
                - name: DATABASE_URL
                  value: "postgres://$(MAIN_DB_USERNAME):$(MAIN_DB_PASSWORD)@$(MAIN_DB_HOSTNAME):$(MAIN_DB_PORT)/$(MAIN_DB_DATABASE)?sslmode=disable"
    
                - name: RO_DATABASE_URL
                  value: "postgres://$(READONLY_DB_USERNAME):$(READONLY_DB_PASSWORD)@$(READONLY_DB_HOSTNAME):$(READONLY_DB_PORT)/$(READONLY_DB_DATABASE)?sslmode=disable"
                - name: SUPPORT_FILES_DATABASE_URL
                  value: "postgres://$(SUPPORT_DB_USERNAME):$(SUPPORT_DB_PASSWORD)@$(SUPPORT_DB_HOSTNAME):$(SUPPORT_DB_PORT)/$(SUPPORT_DB_DATABASE)?sslmode=disable"
                - name: EVENT_STORE_0_URL
                  value: "postgres://$(EVENT_STORE_0_USERNAME):$(EVENT_STORE_0_PASSWORD)@$(EVENT_STORE_0_HOSTNAME):$(EVENT_STORE_0_PORT)/$(EVENT_STORE_0_DATABASE)?sslmode=disable"
                # ------------- END DB connectivity ---------------- #    
                # ------------- START STATS DB connectivity ----------- #
                - name: STATS_STORE_URL
                  valueFrom:
                    secretKeyRef:
                      name: weka-home-stats-db-credentials
                      key: stats_store_url
                - name: STATS_STORE_QUERY_URL
                  valueFrom:
                    secretKeyRef:
                      name: weka-home-stats-db-credentials
                      key: stats_store_query_url
                - name: NUM_STATS_STORES
                  value: "1"
                # ------------- END STATS DB connectivity ----------- #                    
                - name: ADMIN_USERNAME
                  valueFrom:
                    secretKeyRef:
                        name: weka-home-admin-credentials
                        key: admin_username
                - name: ADMIN_PASSWORD
                  valueFrom:
                    secretKeyRef:
                        name: weka-home-admin-credentials
                        key: admin_password    
                - name: WEKA_SECRET_KEY
                  valueFrom:
                    secretKeyRef:
                        name: weka-home-encryption
                        key: encryption_secret_key    
                - name: GRAFANA_WEBHOOK_TOKEN
                  valueFrom:
                    secretKeyRef:
                      name: grafana-webhook
                      key: webhook_token
                - name: GRAFANA_API_USER
                  valueFrom:
                    secretKeyRef:
                      name: weka-home-grafana-credentials
                      key: user
                - name: GRAFANA_API_PASSWORD
                  valueFrom:
                    secretKeyRef:
                      name: weka-home-grafana-credentials
                      key: password
                - name: GRAFANA_API_URL
                  valueFrom:
                    secretKeyRef:
                      name: weka-home-grafana-credentials
                      key: api_url
                - name: GRAFANA_HEALTH_DASHBOARD_UID
                  value: WH_Health_Dashboard_UID_1
---
# Source: home-weka-io/templates/ingress-main.yaml
apiVersion: networking.k8s.io/v1
kind: Ingress
metadata:
  name: weka-home-ingress
  annotations:
    kubernetes.io/ingress.class: nginx
    nginx.ingress.kubernetes.io/backend-protocol: http
    nginx.ingress.kubernetes.io/enable-access-log: "true"
    nginx.ingress.kubernetes.io/enable-cors: "true"
    nginx.ingress.kubernetes.io/enable-modsecurity: "true"
    nginx.ingress.kubernetes.io/enable-owasp-core-rules: "true"
    nginx.ingress.kubernetes.io/proxy-body-size: 1000m
    nginx.ingress.kubernetes.io/proxy-buffering: "off"
    nginx.ingress.kubernetes.io/ssl-redirect: "false"
    nginx.ingress.kubernetes.io/use-regex: "true"

spec:
  rules:
    # SSL REDIRECT RULE
    # RULES FOR USING URL PREFIX FOR STATISTICS
    - http:
        paths:
          - path: /stats/.* 
            pathType: Prefix
            backend:
              service:
                name: homewekaio-grafana
                port:
                  number: 3000
          - path: /api/.*/clusters/.*/stats 
            pathType: Prefix
            backend:
              service:
                name: home-weka-io-stats-handler
                port:
                  number: 8001
          - path: /api/.*/clusters/.*/support/.* 
            pathType: Prefix
            backend:
              service:
                name: home-weka-io-diags-handler
                port:
                  number: 8002

          - path: /api/.* 
            pathType: Prefix
            backend:
              service:
                name: home-weka-io-api
                port:
                  number: 8000

          - path: /.* 
            pathType: Prefix
            backend:
              service:
                name: home-weka-io-frontend
                port:
                  number: 80
      host: ""
---
# Source: home-weka-io/templates/nats-streams.yaml
apiVersion: jetstream.nats.io/v1beta2
kind: Consumer
metadata:
  name: events-db-ingest
spec:
  streamName: EVENTS
  durableName: EVENTS_DB_INGEST
  ackPolicy: explicit
  ackWait: 60s
  deliverPolicy: all
  maxAckPending: 10000
  maxDeliver: 400
  replayPolicy: instant
---
# Source: home-weka-io/templates/nats-streams.yaml
apiVersion: jetstream.nats.io/v1beta2
kind: Consumer
metadata:
  name: alerts-db-ingest
spec:
  streamName: ALERTS
  durableName: ALERTS_DB_INGEST
  filterSubject: ingest.alerts.new.>
  ackPolicy: explicit
  ackWait: 60s
  deliverPolicy: all
  maxAckPending: 10000
  maxDeliver: 400
  replayPolicy: instant
---
# Source: home-weka-io/templates/nats-streams.yaml
apiVersion: jetstream.nats.io/v1beta2
kind: Consumer
metadata:
  name: notifications-email
spec:
  streamName: NOTIFICATIONS
  durableName: NOTIFICATIONS_EMAIL
  filterSubject: ingest.notifications.email.>
  ackPolicy: explicit
  ackWait: 60s
  deliverPolicy: all
  maxAckPending: 10000
  maxDeliver: 400
  replayPolicy: instant
---
# Source: home-weka-io/templates/nats-streams.yaml
apiVersion: jetstream.nats.io/v1beta2
kind: Consumer
metadata:
  name: notifications-pagerduty
spec:
  streamName: NOTIFICATIONS
  durableName: NOTIFICATIONS_PAGERDUTY
  filterSubject: ingest.notifications.pagerduty.>
  ackPolicy: explicit
  ackWait: 60s
  deliverPolicy: all
  maxAckPending: 10000
  maxDeliver: 400
  replayPolicy: instant
---
# Source: home-weka-io/templates/nats-streams.yaml
apiVersion: jetstream.nats.io/v1beta2
kind: Consumer
metadata:
  name: notifications-snmp
spec:
  streamName: NOTIFICATIONS
  durableName: NOTIFICATIONS_SNMP
  filterSubject: ingest.notifications.snmp.>
  ackPolicy: explicit
  ackWait: 60s
  deliverPolicy: all
  maxAckPending: 10000
  maxDeliver: 400
  replayPolicy: instant
---
# Source: home-weka-io/templates/nats-streams.yaml
apiVersion: jetstream.nats.io/v1beta2
kind: Consumer
metadata:
  name: stats-vm-ingest
spec:
  streamName: STATS
  durableName: STATS_VM_INGEST
  ackPolicy: explicit
  ackWait: 300s
  deliverPolicy: all
  maxAckPending: 10000
  maxDeliver: 2
  replayPolicy: instant
---
# Source: home-weka-io/templates/nats-streams.yaml
apiVersion: jetstream.nats.io/v1beta2
kind: Consumer
metadata:
  name: requests-forwarding-high
spec:
  streamName: FORWARDING_HIGH
  durableName: REQUESTS_FORWARDING_HIGH
  ackPolicy: explicit
  ackWait: 300s
  deliverPolicy: all
  maxAckPending: 10000
  maxDeliver: -1
  replayPolicy: instant
---
# Source: home-weka-io/templates/nats-streams.yaml
apiVersion: jetstream.nats.io/v1beta2
kind: Consumer
metadata:
  name: requests-forwarding-low
spec:
  streamName: FORWARDING_LOW
  durableName: REQUESTS_FORWARDING_LOW
  ackPolicy: explicit
  ackWait: 300s
  deliverPolicy: all
  maxAckPending: 10000
  maxDeliver: -1
  replayPolicy: instant
---
# Source: home-weka-io/templates/nats-streams.yaml
apiVersion: jetstream.nats.io/v1beta2
kind: Stream
metadata:
  name: events
spec:
  name: EVENTS
  subjects:
  - ingest.events.>
  replicas: 3
  retention: interest
  storage: file
  discard: new
  discardPerSubject: false
  maxConsumers: -1
  maxMsgsPerSubject: -1
  maxMsgs: -1
  maxBytes: 2.147483e+09
  maxMsgSize: -1
  maxAge: "0"
  duplicateWindow: 120s
---
# Source: home-weka-io/templates/nats-streams.yaml
apiVersion: jetstream.nats.io/v1beta2
kind: Stream
metadata:
  name: alerts
spec:
  name: ALERTS
  subjects:
    - ingest.alerts.>
  replicas: 3
  retention: interest
  storage: file
  discard: old
  discardPerSubject: false
  maxConsumers: -1
  maxMsgsPerSubject: -1
  maxMsgs: -1
  maxBytes: 1.073741e+09
  maxMsgSize: -1
  maxAge: "0"
  duplicateWindow: 120s
---
# Source: home-weka-io/templates/nats-streams.yaml
apiVersion: jetstream.nats.io/v1beta2
kind: Stream
metadata:
  name: notifications
spec:
  name: NOTIFICATIONS
  subjects:
    - ingest.notifications.>
  replicas: 3
  retention: interest
  storage: file
  discard: new
  discardPerSubject: false
  maxConsumers: -1
  maxMsgsPerSubject: -1
  maxMsgs: -1
  maxBytes: 1.073741e+09
  maxMsgSize: -1
  maxAge: "0"
  duplicateWindow: 120s
---
# Source: home-weka-io/templates/nats-streams.yaml
apiVersion: jetstream.nats.io/v1beta2
kind: Stream
metadata:
  name: stats
spec:
  name: STATS
  subjects:
  - ingest.stats.>
  replicas: 3
  retention: interest
  storage: file
  discard: new
  discardPerSubject: false
  maxConsumers: -1
  maxMsgsPerSubject: -1
  maxMsgs: -1
  maxBytes: 1.073741e+10
  maxMsgSize: -1
  maxAge: "0"
  duplicateWindow: 120s
---
# Source: home-weka-io/templates/nats-streams.yaml
apiVersion: jetstream.nats.io/v1beta2
kind: Stream
metadata:
  name: forwarding-high
spec:
  name: FORWARDING_HIGH
  subjects:
    - ingest.forwarding.high.>
  replicas: 3
  retention: interest
  storage: file
  discard: new
  discardPerSubject: false
  maxConsumers: -1
  maxMsgsPerSubject: -1
  maxMsgs: -1
  maxBytes: 3.221225e+09
  maxMsgSize: -1
  maxAge: "0"
  duplicateWindow: 120s
---
# Source: home-weka-io/templates/nats-streams.yaml
apiVersion: jetstream.nats.io/v1beta2
kind: Stream
metadata:
  name: forwarding-low
spec:
  name: FORWARDING_LOW
  subjects:
    - ingest.forwarding.low.>
  replicas: 3
  retention: interest
  storage: file
  discard: new
  discardPerSubject: false
  maxConsumers: -1
  maxMsgsPerSubject: -1
  maxMsgs: -1
  maxBytes: 1.073741e+10
  maxMsgSize: -1
  maxAge: "0"
  duplicateWindow: 120s

NOTES:
Thank you for installing home-weka-io.

Your release is named homewekaio

To learn more about the release, try:

  $ helm status homewekaio -n home-weka-io
  $ helm get all homewekaio -n home-weka-io

------------------------------------------------------------------------
Weka Home Frontend:
------------------------------------------------------------------------
URL:
http://10.108.170.142
Username:
admin
To obtain password, run:
kubectl get secret -n home-weka-io weka-home-admin-credentials  -o jsonpath='{.data.admin_password}' | base64 -d

------------------------------------------------------------------------
Weka Home REST API:
------------------------------------------------------------------------
URL:
http://10.108.170.142/api/

------------------------------------------------------------------------
Weka Home Statistics (Grafana):
------------------------------------------------------------------------
URL:
http://10.108.170.142/stats/
Username:
admin
To obtain password, run:
kubectl get secret -n home-weka-io weka-home-grafana-credentials  -o jsonpath='{.data.password}' | base64 -d

------------------------------------------------------------------------
Weka Home Encryption Secret Key
------------------------------------------------------------------------
To obtain secretkey, run:
kubectl get secret -n home-weka-io weka-home-encryption  -o jsonpath='{.data.encryption_secret_key}' | base64 -d

------------------------------------------------------------------------
Technical information
------------------------------------------------------------------------
Number of event store databases: 1
Easy wekahoming!
Waiting for all pods to be ready...
pod/alertdispatcher-57cd954ddb-2lzpr condition met
pod/alertprocessor-5d6f5d9c95-hppk6 condition met
pod/debug-pod-6cd8b6d96b-s2dwc condition met
pod/diags-handler-86d5c4466-px67d condition met
pod/eventprocessor-6d4965f78-b2r8j condition met
pod/frontend-5f88d5c55f-kd4fh condition met
pod/homewekaio-event-db-0-0 condition met
pod/homewekaio-grafana-677db5bd54-pxdx5 condition met
pod/homewekaio-main-db-0 condition met
pod/homewekaio-statsdb-vmselect-0 condition met
pod/homewekaio-statsdb-vmselect-1 condition met
pod/homewekaio-statsdb-vmstorage-0 condition met
pod/homewekaio-statsdb-vmstorage-1 condition met
pod/homewekaio-statsdb-vmstorage-2 condition met
pod/homewekaio-support-db-0 condition met
